(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
window.performance=window.performance||{},window.performance.now=function(){return window.performance.now||window.performance.mozNow||window.performance.msNow||window.performance.oNow||window.performance.webkitNow||Date.now}();var shim=require("browserify-shim");global.$=global.jQuery=require("jquery"),require("bselect");var _=require("lodash"),Backbone=require("backbone");Backbone.$=$,Backbone._=_;var bootstrap=require("bootstrap");require("./lib/iconset-fontawesome"),require("./lib/bootstrap-iconpicker"),require("./lib/jquery.ui.pos");var d3=require("d3"),Opentip=require("./lib/opentip"),ignoreCrap=require("./lib/spectrum"),dhtmlxslider=require("./lib/dhtmlxslider"),dhtmlxmenu=require("./lib/dhtmlxmenu"),winToolbar=require("./winToolbar.js"),webToolbar=require("./webToolbar.js"),winMenu=require("./winMenu.js"),jstree=require("jstree");ATMainTimelineApp=require("./timeline/ATMainTimelineApp"),ATWelcomeScreen=require("./welcome/ATWelcomeScreen"),window.isAeonWebExport=!1,function(e,n){"use strict";var o=document.createElement("i");o.className="syncBinder-item-status",e.jstree.defaults.questionmark=e.noop,e.jstree.plugins.questionmark=function(n,i){this.bind=function(){i.bind.call(this),this.element.on("click.jstree",".jstree-questionmark",e.proxy(function(e){e.stopImmediatePropagation(),this.settings.questionmark.call(this,this.get_node(e.target))},this))},this.teardown=function(){this.settings.questionmark&&this.element.find(".jstree-questionmark").remove(),i.teardown.call(this)},this.redraw_node=function(e,n,r,t){this.get_node(e);if(e=i.redraw_node.call(this,e,n,r,t)){var a=o.cloneNode(!0);e.insertBefore(a,e.childNodes[2])}return e}}}(jQuery),function(e){e.fn.blurOnEnter=function(){return this.bind("keypress",function(e){13==e.keyCode&&this.blur()}),this}}(jQuery),window.checkApplicationReady=function(){window.ApplicationInterface&&window.ApplicationInterface.readyForData(window.timelineDocumentId)},window.createToolbar=function(){window.welcomeScreen?window.welcomeScreen.createToolbar():window.mainApp&&window.mainApp.createToolbar()},window.configureWebExport=function(){window.isAeonWebExport=!0,window.mainApp.createWebToolbar(),window.mainApp.disableNonWebElements(),window.mainApp.timelineView.resizeWindow()},window.setTimelineDocumentId=function(e){window.timelineDocumentId=e},window.ATConsoleLog=function(e){console.log(e),window.ApplicationInterface&&window.ApplicationInterface.consoleLog&&window.ApplicationInterface.consoleLog(window.timelineDocumentId,e)},window.ATConsoleDir=function(e){console.dir(e),window.ApplicationInterface&&window.ApplicationInterface.consoleLog&&window.ApplicationInterface.consoleLog(window.timelineDocumentId,JSON.stringify(e))},window.onerror=function(e,n,o,i,r){var t="Error: "+e+"\nScript: "+n+" Line: "+o+" Column: "+i+"\nStackTrace: "+r;window.ApplicationInterface&&window.ApplicationInterface.javaScriptErrorOccurred&&window.ApplicationInterface.javaScriptErrorOccurred(t)},Opentip.styles.eventDragTooltipStyle={"extends":"dark",delay:0,removeElementsOnHide:!0,stem:!1,offset:[0,0],tipJoint:"left"},Opentip.styles.welcomeTooltipStyle={"extends":"glass",background:"#fff",borderColor:"#038ED9",delay:0,target:!0,removeElementsOnHide:!0},Opentip.styles.laneNodeTooltipStyle={"extends":"dark",delay:0,removeElementsOnHide:!0,target:!0,tipJoint:"right",targetJoint:"left middle"},window.timelineDocumentId=0,window.toolbarCommands=winToolbar,window.menuCommands=winMenu,window.webToolbarCommands=webToolbar,checkApplicationReady();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./lib/bootstrap-iconpicker":2,"./lib/dhtmlxmenu":5,"./lib/dhtmlxslider":6,"./lib/iconset-fontawesome":8,"./lib/jquery.ui.pos":9,"./lib/opentip":11,"./lib/spectrum":12,"./timeline/ATMainTimelineApp":61,"./webToolbar.js":171,"./welcome/ATWelcomeScreen":172,"./winMenu.js":174,"./winToolbar.js":175,"backbone":176,"bootstrap":177,"browserify-shim":190,"bselect":299,"d3":300,"jquery":307,"jstree":308,"lodash":309}],2:[function(require,module,exports){
!function(t){"use strict";var e=function(o,s){this.$element=t(o),this.options=t.extend({},e.DEFAULTS,this.$element.data()),this.options=t.extend({},this.options,s)};e.ICONSET_EMPTY={iconClass:"",iconClassFix:"",icons:[]},e.ICONSET={_custom:null,elusiveicon:t.iconset_elusiveicon||e.ICONSET_EMPTY,fontawesome:t.iconset_fontawesome||e.ICONSET_EMPTY,ionicon:t.iconset_ionicon||e.ICONSET_EMPTY,glyphicon:t.iconset_glyphicon||e.ICONSET_EMPTY,mapicon:t.iconset_mapicon||e.ICONSET_EMPTY,materialdesign:t.iconset_materialdesign||e.ICONSET_EMPTY,octicon:t.iconset_octicon||e.ICONSET_EMPTY,typicon:t.iconset_typicon||e.ICONSET_EMPTY,weathericon:t.iconset_weathericon||e.ICONSET_EMPTY},e.DEFAULTS={align:"center",arrowClass:"btn-primary",arrowNextIconClass:"glyphicon glyphicon-arrow-right",arrowPrevIconClass:"glyphicon glyphicon-arrow-left",cols:4,icon:"",iconset:"glyphicon",header:!0,labelHeader:"{0} / {1}",footer:!0,labelFooter:"{0} - {1} of {2}",placement:"bottom",rows:4,search:!0,searchText:"Search icon",selectedClass:"btn-warning",unselectedClass:"btn-default"},e.prototype.bindEvents=function(){var e=this.options,o=this;e.table.find(".btn-previous, .btn-next").off("click").on("click",function(s){s.preventDefault();var n=parseInt(t(this).val(),10);o.changeList(e.page+n)}),e.table.find(".btn-icon").off("click").on("click",function(s){s.preventDefault(),o.select(t(this).val()),e.inline===!1?o.$element.popover("destroy"):e.table.find("i."+t(this).val()).parent().addClass(e.selectedClass)}),e.table.find(".search-control").off("keyup").on("keyup",function(){o.changeList(1)})},e.prototype.changeList=function(t){this.filterIcons(),this.updateLabels(t),this.updateIcons(t),this.options.page=t,this.bindEvents()},e.prototype.filterIcons=function(){var o=this.options,s=o.table.find(".search-control").val();if(""===s)o.icons=e.ICONSET[o.iconset].icons;else{var n=[];t.each(e.ICONSET[o.iconset].icons,function(t,e){e.indexOf(s)>-1&&n.push(e)}),o.icons=n}},e.prototype.removeAddClass=function(t,e,o){return this.options.table.find(t).removeClass(e).addClass(o),o},e.prototype.reset=function(){this.updatePicker(),this.changeList(1)},e.prototype.select=function(e){var o=this.options,s=this.$element;o.selected=t.inArray(e.replace(o.iconClassFix,""),o.icons),-1===o.selected&&(o.selected=0,e=o.iconClassFix+o.icons[o.selected]),""!==e&&o.selected>=0&&(o.icon=e,o.inline===!1&&(s.find("input").val(e),s.find("i").attr("class","").addClass(o.iconClass).addClass(e)),e===o.iconClassFix?s.trigger({type:"change",icon:"empty"}):s.trigger({type:"change",icon:e}),o.table.find("button."+o.selectedClass).removeClass(o.selectedClass))},e.prototype.switchPage=function(e){var o=this.options;if(o.selected=t.inArray(e.replace(o.iconClassFix,""),o.icons),o.selected>=0){var s=Math.ceil((o.selected+1)/this.totalIconsPerPage());this.changeList(s)}""===e?o.table.find("i."+o.iconClassFix).parent().addClass(o.selectedClass):o.table.find("i."+e).parent().addClass(o.selectedClass)},e.prototype.totalPages=function(){return Math.ceil(this.totalIcons()/this.totalIconsPerPage())},e.prototype.totalIcons=function(){return this.options.icons.length},e.prototype.totalIconsPerPage=function(){return 0===this.options.rows?this.options.icons.length:this.options.cols*this.options.rows},e.prototype.updateArrows=function(t){var e=this.options,o=this.totalPages();1===t?e.table.find(".btn-previous").addClass("disabled"):e.table.find(".btn-previous").removeClass("disabled"),t===o||0===o?e.table.find(".btn-next").addClass("disabled"):e.table.find(".btn-next").removeClass("disabled")},e.prototype.updateIcons=function(e){var o=this.options,s=o.table.find("tbody").empty(),n=(e-1)*this.totalIconsPerPage(),i=o.rows;0===o.rows&&(i=o.icons.length);for(var a=0;i>a;a++){for(var c=t("<tr></tr>"),r=0;r<o.cols;r++){var p=n+a*o.cols+r,l=t('<button class="btn '+o.unselectedClass+' btn-icon"></button>').hide();if(p<o.icons.length){var d=o.iconClassFix+o.icons[p];l.val(d).attr("title",d).append('<i class="'+o.iconClass+" "+d+'"></i>').show(),o.icon===d&&l.addClass(o.selectedClass).addClass("btn-icon-selected")}c.append(t("<td></td>").append(l))}s.append(c)}},e.prototype.updateIconsCount=function(){var t=this.options;if(t.footer===!0){var e=["<tr>",'   <td colspan="'+t.cols+'" class="text-center">','       <span class="icons-count"></span>',"   </td>","</tr>"];t.table.find("tfoot").empty().append(e.join(""))}},e.prototype.updateLabels=function(t){var e=this.options,o=this.totalIcons(),s=this.totalPages();e.table.find(".page-count").html(e.labelHeader.replace("{0}",0===s?0:t).replace("{1}",s));var n=(t-1)*this.totalIconsPerPage(),i=t*this.totalIconsPerPage();e.table.find(".icons-count").html(e.labelFooter.replace("{0}",n+1).replace("{1}",o>i?i:o).replace("{2}",o)),this.updateArrows(t)},e.prototype.updatePagesCount=function(){var e=this.options;if(e.header===!0){for(var o=t("<tr></tr>"),s=0;s<e.cols;s++){var n=t('<td class="text-center"></td>');if(0===s||s===e.cols-1){var i=['<button class="btn btn-arrow '+(0===s?"btn-previous":"btn-next")+" "+e.arrowClass+'" value="'+(0===s?-1:1)+'">','<span class="'+(0===s?e.arrowPrevIconClass:e.arrowNextIconClass)+'"></span>',"</button>"];n.append(i.join("")),o.append(n)}else 0===o.find(".page-count").length&&(n.attr("colspan",e.cols-2).append('<span class="page-count"></span>'),o.append(n))}e.table.find("thead").empty().append(o)}},e.prototype.updatePicker=function(){var t=this.options;if(t.cols<4)throw"Iconpicker => The number of columns must be greater than or equal to 4. [option.cols = "+t.cols+"]";if(t.rows<0)throw"Iconpicker => The number of rows must be greater than or equal to 0. [option.rows = "+t.rows+"]";this.updatePagesCount(),this.updateSearch(),this.updateIconsCount()},e.prototype.updateSearch=function(){var e=this.options,o=["<tr>",'   <td colspan="'+e.cols+'">','       <input type="text" class="form-control search-control" style="width: '+39*e.cols+'px;" placeholder="'+e.searchText+'">',"   </td>","</tr>"];o=t(o.join("")),e.search===!0?o.show():o.hide(),e.table.find("thead").append(o)},e.prototype.setAlign=function(t){this.$element.removeClass(this.options.align).addClass(t),this.options.align=t},e.prototype.setArrowClass=function(t){this.options.arrowClass=this.removeAddClass(".btn-arrow",this.options.arrowClass,t)},e.prototype.setArrowNextIconClass=function(t){this.options.arrowNextIconClass=this.removeAddClass(".btn-next > span",this.options.arrowNextIconClass,t)},e.prototype.setArrowPrevIconClass=function(t){this.options.arrowPrevIconClass=this.removeAddClass(".btn-previous > span",this.options.arrowPrevIconClass,t)},e.prototype.setCols=function(t){this.options.cols=t,this.reset()},e.prototype.setFooter=function(t){var e=this.options.table.find("tfoot");t===!0?e.show():e.hide(),this.options.footer=t},e.prototype.setHeader=function(t){var e=this.options.table.find("thead");t===!0?e.show():e.hide(),this.options.header=t},e.prototype.setIcon=function(t){this.select(t)},e.prototype.setIconset=function(o){var s=this.options;t.isPlainObject(o)?(e.ICONSET._custom=t.extend(e.ICONSET_EMPTY,o),s.iconset="_custom"):e.ICONSET.hasOwnProperty(o)?s.iconset=o:s.iconset=e.DEFAULTS.iconset,s=t.extend(s,e.ICONSET[s.iconset]),this.reset(),this.select(s.icon)},e.prototype.setLabelHeader=function(t){this.options.labelHeader=t,this.updateLabels(this.options.page)},e.prototype.setLabelFooter=function(t){this.options.labelFooter=t,this.updateLabels(this.options.page)},e.prototype.setPlacement=function(t){this.options.placement=t},e.prototype.setRows=function(t){this.options.rows=t,this.reset()},e.prototype.setSearch=function(t){var e=this.options.table.find(".search-control");t===!0?e.show():e.hide(),e.val(""),this.changeList(1),this.options.search=t},e.prototype.setSearchText=function(t){this.options.table.find(".search-control").attr("placeholder",t),this.options.searchText=t},e.prototype.setSelectedClass=function(t){this.options.selectedClass=this.removeAddClass(".btn-icon-selected",this.options.selectedClass,t)},e.prototype.setUnselectedClass=function(t){this.options.unselectedClass=this.removeAddClass(".btn-icon",this.options.unselectedClass,t)},e.prototype.closePicker=function(t){this.$element.popover("destroy")};var o=t.fn.iconpicker;t.fn.iconpicker=function(o,s){return this.each(function(){var n=t(this),i=n.data("bs.iconpicker"),a="object"==typeof o&&o;if(i||n.data("bs.iconpicker",i=new e(this,a)),"string"==typeof o){if("undefined"==typeof i[o])throw'Iconpicker => The "'+o+'" method does not exists.';i[o](s)}else{var c=i.options;c=t.extend(c,{inline:!1,page:1,selected:-1,table:t('<table class="table-icons"><thead></thead><tbody></tbody><tfoot></tfoot></table>')});var r="undefined"!=typeof n.attr("name")?'name="'+n.attr("name")+'"':"";"BUTTON"===n.prop("tagName")?(n.empty().append("<i></i>").append('<input type="hidden" '+r+"></input>").append('<span class="caret"></span>').addClass("iconpicker"),i.setIconset(c.iconset),n.on("click",function(t){t.preventDefault(),n.popover({animation:!1,trigger:"manual",html:!0,content:c.table,container:c.container?c.container:"body",placement:c.placement}).on("shown.bs.popover",function(){i.switchPage(c.icon),i.bindEvents()}),n.data("bs.popover").tip().addClass("iconpicker-popover"),n.popover("show")})):(c.inline=!0,i.setIconset(c.iconset),n.empty().append('<input type="hidden" '+r+"></input>").append(c.table).addClass("iconpicker").addClass(c.align),i.switchPage(c.icon),i.bindEvents())}})},t.fn.iconpicker.Constructor=e,t.fn.iconpicker.noConflict=function(){return t.fn.iconpicker=o,this},t(document).on("click","body",function(e){t(".iconpicker").each(function(){t(this).is(e.target)||0!==t(this).has(e.target).length||0!==t(".popover").has(e.target).length||t(this).popover("destroy")})}),t('button[role="iconpicker"],div[role="iconpicker"]').iconpicker()}(jQuery);
},{}],3:[function(require,module,exports){
(function (global){
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=global.window&&global.window.$?t(global.window.$):function(e){if(!e.$&&!e.fn)throw new Error("Tokenfield requires a window object with jQuery or a jQuery instance");return t(e.$||e)}:t(jQuery,window)}(function(t,e){"use strict";var i=function(i,n){var s=this;this.$element=t(i),this.textDirection=this.$element.css("direction"),this.options=t.extend(!0,{},t.fn.tokenfield.defaults,{tokens:this.$element.val()},this.$element.data(),n),this._delimiters="string"==typeof this.options.delimiter?[this.options.delimiter]:this.options.delimiter,this._triggerKeys=t.map(this._delimiters,function(t){return t.charCodeAt(0)}),this._firstDelimiter=this._delimiters[0];var r=t.inArray(" ",this._delimiters),a=t.inArray("-",this._delimiters);r>=0&&(this._delimiters[r]="\\s"),a>=0&&(delete this._delimiters[a],this._delimiters.unshift("-"));var o=["\\","$","[","{","^",".","|","?","*","+","(",")"];t.each(this._delimiters,function(e,i){var n=t.inArray(i,o);n>=0&&(s._delimiters[e]="\\"+i)});var h,p=e&&"function"==typeof e.getMatchedCSSRules?e.getMatchedCSSRules(i):null,l=i.style.width,u=this.$element.width();p&&t.each(p,function(t,e){e.style.width&&(h=e.style.width)});var d="rtl"===t("body").css("direction")?"right":"left",c={position:this.$element.css("position")};c[d]=this.$element.css(d),this.$element.data("original-styles",c).data("original-tabindex",this.$element.prop("tabindex")).css("position","absolute").css(d,"-10000px").prop("tabindex",-1),this.$wrapper=t('<div class="tokenfield form-control" />'),this.$element.hasClass("input-lg")&&this.$wrapper.addClass("input-lg"),this.$element.hasClass("input-sm")&&this.$wrapper.addClass("input-sm"),"rtl"===this.textDirection&&this.$wrapper.addClass("rtl");var f=this.$element.prop("id")||(new Date).getTime()+""+Math.floor(100*(1+Math.random()));this.$input=t('<input type="'+this.options.inputType+'" class="token-input" autocomplete="off" />').appendTo(this.$wrapper).prop("placeholder",this.$element.prop("placeholder")).prop("id",f+"-tokenfield").prop("tabindex",this.$element.data("original-tabindex"));var v=t('label[for="'+this.$element.prop("id")+'"]');if(v.length&&v.prop("for",this.$input.prop("id")),this.$copyHelper=t('<input type="text" />').css("position","absolute").css(d,"-10000px").prop("tabindex",-1).prependTo(this.$wrapper),l?this.$wrapper.css("width",l):h?this.$wrapper.css("width",h):this.$element.parents(".form-inline").length&&this.$wrapper.width(u),(this.$element.prop("disabled")||this.$element.parents("fieldset[disabled]").length)&&this.disable(),this.$element.prop("readonly")&&this.readonly(),this.$mirror=t('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),this.$input.css("min-width",this.options.minWidth+"px"),t.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(t,e){s.$mirror[0].style[e]=s.$input.css(e)}),this.$mirror.appendTo("body"),this.$wrapper.insertBefore(this.$element),this.$element.prependTo(this.$wrapper),this.update(),this.setTokens(this.options.tokens,!1,!this.$element.val()&&this.options.tokens),this.listen(),!t.isEmptyObject(this.options.autocomplete)){var $="rtl"===this.textDirection?"right":"left",m=t.extend({minLength:this.options.showAutocompleteOnFocus?0:null,position:{my:$+" top",at:$+" bottom",of:this.$wrapper}},this.options.autocomplete);this.$input.autocomplete(m)}if(!t.isEmptyObject(this.options.typeahead)){var g=this.options.typeahead,k={minLength:this.options.showAutocompleteOnFocus?0:null},y=t.isArray(g)?g:[g,g];y[0]=t.extend({},k,y[0]),this.$input.typeahead.apply(this.$input,y),this.$hint=this.$input.prev(".tt-hint"),this.typeahead=!0}};i.prototype={constructor:i,createToken:function(e,i){var n=this;if(e="string"==typeof e?{value:e,label:e}:t.extend({},e),"undefined"==typeof i&&(i=!0),e.value=t.trim(e.value.toString()),e.label=e.label&&e.label.length?t.trim(e.label):e.value,e.value.length&&e.label.length&&!(e.label.length<=this.options.minLength)&&!(this.options.limit&&this.getTokens().length>=this.options.limit)){var s=t.Event("tokenfield:createtoken",{attrs:e});if(this.$element.trigger(s),s.attrs&&!s.isDefaultPrevented()){var r=t('<div class="token" />').append('<span class="token-label" />').append('<a href="#" class="close" tabindex="-1">&times;</a>').data("attrs",e);this.$input.hasClass("tt-input")?this.$input.parent().before(r):this.$input.before(r),this.$input.css("width",this.options.minWidth+"px");var a=r.find(".token-label"),o=r.find(".close");return this.maxTokenWidth||(this.maxTokenWidth=this.$wrapper.width()-o.outerWidth()-parseInt(o.css("margin-left"),10)-parseInt(o.css("margin-right"),10)-parseInt(r.css("border-left-width"),10)-parseInt(r.css("border-right-width"),10)-parseInt(r.css("padding-left"),10)-parseInt(r.css("padding-right"),10),parseInt(a.css("border-left-width"),10)-parseInt(a.css("border-right-width"),10)-parseInt(a.css("padding-left"),10)-parseInt(a.css("padding-right"),10),parseInt(a.css("margin-left"),10)-parseInt(a.css("margin-right"),10)),a.text(e.label).css("max-width",this.maxTokenWidth),r.on("mousedown",function(t){return n._disabled||n._readonly?!1:void(n.preventDeactivation=!0)}).on("click",function(t){return n._disabled||n._readonly?!1:(n.preventDeactivation=!1,t.ctrlKey||t.metaKey?(t.preventDefault(),n.toggle(r)):void n.activate(r,t.shiftKey,t.shiftKey))}).on("dblclick",function(t){return n._disabled||n._readonly||!n.options.allowEditing?!1:void n.edit(r)}),o.on("click",t.proxy(this.remove,this)),this.$element.trigger(t.Event("tokenfield:createdtoken",{attrs:e,relatedTarget:r.get(0)})),i&&this.$element.val(this.getTokensList()).trigger(t.Event("change",{initiator:"tokenfield"})),this.update(),this.$element.get(0)}}},setTokens:function(e,i,n){if(e){i||this.$wrapper.find(".token").remove(),"undefined"==typeof n&&(n=!0),"string"==typeof e&&(e=this._delimiters.length?e.split(new RegExp("["+this._delimiters.join("")+"]")):[e]);var s=this;return t.each(e,function(t,e){s.createToken(e,n)}),this.$element.get(0)}},getTokenData:function(e){var i=e.map(function(){var e=t(this);return e.data("attrs")}).get();return 1==i.length&&(i=i[0]),i},getTokens:function(e){var i=this,n=[],s=e?".active":"";return this.$wrapper.find(".token"+s).each(function(){n.push(i.getTokenData(t(this)))}),n},getTokensList:function(e,i,n){e=e||this._firstDelimiter,i="undefined"!=typeof i&&null!==i?i:this.options.beautify;var s=e+(i&&" "!==e?" ":"");return t.map(this.getTokens(n),function(t){return t.value}).join(s)},getInput:function(){return this.$input.val()},listen:function(){var i=this;this.$element.on("change",t.proxy(this.change,this)),this.$wrapper.on("mousedown",t.proxy(this.focusInput,this)),this.$input.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("paste",t.proxy(this.paste,this)).on("keydown",t.proxy(this.keydown,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.$copyHelper.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keydown",t.proxy(this.keydown,this)).on("keyup",t.proxy(this.keyup,this)),this.$input.on("keypress",t.proxy(this.update,this)).on("keyup",t.proxy(this.update,this)),this.$input.on("autocompletecreate",function(){var e=t(this).data("ui-autocomplete").menu.element,n=i.$wrapper.outerWidth()-parseInt(e.css("border-left-width"),10)-parseInt(e.css("border-right-width"),10);e.css("min-width",n+"px")}).on("autocompleteselect",function(t,e){return i.createToken(e.item)&&(i.$input.val(""),i.$input.data("edit")&&i.unedit(!0)),!1}).on("typeahead:selected typeahead:autocompleted",function(t,e,n){i.createToken(e)&&(i.$input.typeahead("val",""),i.$input.data("edit")&&i.unedit(!0))}),t(e).on("resize",t.proxy(this.update,this))},keydown:function(e){function i(t){if(s.$input.is(document.activeElement)){if(s.$input.val().length>0)return;t+="All";var i=s.$input.hasClass("tt-input")?s.$input.parent()[t](".token:first"):s.$input[t](".token:first");if(!i.length)return;s.preventInputFocus=!0,s.preventDeactivation=!0,s.activate(i),e.preventDefault()}else s[t](e.shiftKey),e.preventDefault()}function n(i){if(e.shiftKey){if(s.$input.is(document.activeElement)){if(s.$input.val().length>0)return;var n=s.$input.hasClass("tt-input")?s.$input.parent()[i+"All"](".token:first"):s.$input[i+"All"](".token:first");if(!n.length)return;s.activate(n)}var r="prev"===i?"next":"prev",a="prev"===i?"first":"last";s.$firstActiveToken[r+"All"](".token").each(function(){s.deactivate(t(this))}),s.activate(s.$wrapper.find(".token:"+a),!0,!0),e.preventDefault()}}if(this.focused){var s=this;switch(e.keyCode){case 8:if(!this.$input.is(document.activeElement))break;this.lastInputValue=this.$input.val();break;case 37:i("rtl"===this.textDirection?"next":"prev");break;case 38:n("prev");break;case 39:i("rtl"===this.textDirection?"prev":"next");break;case 40:n("next");break;case 65:if(this.$input.val().length>0||!e.ctrlKey&&!e.metaKey)break;this.activateAll(),e.preventDefault();break;case 9:case 13:if(this.$input.data("ui-autocomplete")&&this.$input.data("ui-autocomplete").menu.element.find("li:has(a.ui-state-focus), li.ui-state-focus").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-cursor").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-hint").val()&&this.$wrapper.find(".tt-hint").val().length)break;if(this.$input.is(document.activeElement)&&this.$input.val().length||this.$input.data("edit"))return this.createTokensFromInput(e,this.$input.data("edit"));if(13===e.keyCode){if(!this.$copyHelper.is(document.activeElement)||1!==this.$wrapper.find(".token.active").length)break;if(!s.options.allowEditing)break;this.edit(this.$wrapper.find(".token.active"))}}this.lastKeyDown=e.keyCode}},keypress:function(e){return-1!==t.inArray(e.which,this._triggerKeys)&&this.$input.is(document.activeElement)?(this.$input.val()&&this.createTokensFromInput(e),!1):void 0},keyup:function(t){if(this.preventInputFocus=!1,this.focused){switch(t.keyCode){case 8:if(this.$input.is(document.activeElement)){if(this.$input.val().length||this.lastInputValue.length&&8===this.lastKeyDown)break;this.preventDeactivation=!0;var e=this.$input.hasClass("tt-input")?this.$input.parent().prevAll(".token:first"):this.$input.prevAll(".token:first");if(!e.length)break;this.activate(e)}else this.remove(t);break;case 46:this.remove(t,"next")}this.lastKeyUp=t.keyCode}},focus:function(t){this.focused=!0,this.$wrapper.addClass("focus"),this.$input.is(document.activeElement)&&(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null,this.options.showAutocompleteOnFocus&&this.search())},blur:function(t){this.focused=!1,this.$wrapper.removeClass("focus"),this.preventDeactivation||this.$element.is(document.activeElement)||(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null),!this.preventCreateTokens&&(this.$input.data("edit")&&!this.$input.is(document.activeElement)||this.options.createTokensOnBlur)&&this.createTokensFromInput(t),this.preventDeactivation=!1,this.preventCreateTokens=!1},paste:function(t){var e=this;e.options.allowPasting&&setTimeout(function(){e.createTokensFromInput(t)},1)},change:function(t){"tokenfield"!==t.initiator&&this.setTokens(this.$element.val())},createTokensFromInput:function(t,e){if(!(this.$input.val().length<this.options.minLength)){var i=this.getTokensList();return this.setTokens(this.$input.val(),!0),i==this.getTokensList()&&this.$input.val().length?!1:(this.$input.hasClass("tt-input")?this.$input.typeahead("val",""):this.$input.val(""),this.$input.data("edit")&&this.unedit(e),!1)}},next:function(t){if(t){var e=this.$wrapper.find(".active:first"),i=e&&this.$firstActiveToken?e.index()<this.$firstActiveToken.index():!1;if(i)return this.deactivate(e)}var n=this.$wrapper.find(".active:last"),s=n.nextAll(".token:first");return s.length?void this.activate(s,t):void this.$input.focus()},prev:function(t){if(t){var e=this.$wrapper.find(".active:last"),i=e&&this.$firstActiveToken?e.index()>this.$firstActiveToken.index():!1;if(i)return this.deactivate(e)}var n=this.$wrapper.find(".active:first"),s=n.prevAll(".token:first");return s.length||(s=this.$wrapper.find(".token:first")),s.length||t?void this.activate(s,t):void this.$input.focus()},activate:function(e,i,n,s){if(e){if("undefined"==typeof s)var s=!0;if(n)var i=!0;if(this.$copyHelper.focus(),i||(this.$wrapper.find(".active").removeClass("active"),s?this.$firstActiveToken=e:delete this.$firstActiveToken),n&&this.$firstActiveToken){var r=this.$firstActiveToken.index()-2,a=e.index()-2,o=this;this.$wrapper.find(".token").slice(Math.min(r,a)+1,Math.max(r,a)).each(function(){o.activate(t(this),!0)})}e.addClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select()}},activateAll:function(){var e=this;this.$wrapper.find(".token").each(function(i){e.activate(t(this),0!==i,!1,!1)})},deactivate:function(t){t&&(t.removeClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},toggle:function(t){t&&(t.toggleClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},edit:function(e){if(e){var i=e.data("attrs"),n={attrs:i,relatedTarget:e.get(0)},s=t.Event("tokenfield:edittoken",n);if(this.$element.trigger(s),!s.isDefaultPrevented()){e.find(".token-label").text(i.value);var r=e.outerWidth(),a=this.$input.hasClass("tt-input")?this.$input.parent():this.$input;e.replaceWith(a),this.preventCreateTokens=!0,this.$input.val(i.value).select().data("edit",!0).width(r),this.update(),this.$element.trigger(t.Event("tokenfield:editedtoken",n))}}},unedit:function(t){var e=this.$input.hasClass("tt-input")?this.$input.parent():this.$input;if(e.appendTo(this.$wrapper),this.$input.data("edit",!1),this.$mirror.text(""),this.update(),t){var i=this;setTimeout(function(){i.$input.focus()},1)}},remove:function(e,i){if(!(this.$input.is(document.activeElement)||this._disabled||this._readonly)){var n="click"===e.type?t(e.target).closest(".token"):this.$wrapper.find(".token.active");if("click"!==e.type){if(!i)var i="prev";if(this[i](),"prev"===i)var s=0===n.first().prevAll(".token:first").length}var r={attrs:this.getTokenData(n),relatedTarget:n.get(0)},a=t.Event("tokenfield:removetoken",r);if(this.$element.trigger(a),!a.isDefaultPrevented()){var o=t.Event("tokenfield:removedtoken",r),h=t.Event("change",{initiator:"tokenfield"});n.remove(),this.$element.val(this.getTokensList()).trigger(o).trigger(h),this.$wrapper.find(".token").length&&"click"!==e.type&&!s||this.$input.focus(),this.$input.css("width",this.options.minWidth+"px"),this.update(),e.preventDefault(),e.stopPropagation()}}},update:function(t){var e=this.$input.val(),i=parseInt(this.$input.css("padding-left"),10),n=parseInt(this.$input.css("padding-right"),10),s=i+n;if(this.$input.data("edit")){if(e||(e=this.$input.prop("placeholder")),e===this.$mirror.text())return;this.$mirror.text(e);var r=this.$mirror.width()+10;if(r>this.$wrapper.width())return this.$input.width(this.$wrapper.width());this.$input.width(r),this.$hint&&this.$hint.width(r)}else{var a="rtl"===this.textDirection?this.$input.offset().left+this.$input.outerWidth()-this.$wrapper.offset().left-parseInt(this.$wrapper.css("padding-left"),10)-s-1:this.$wrapper.offset().left+this.$wrapper.width()+parseInt(this.$wrapper.css("padding-left"),10)-this.$input.offset().left-s;isNaN(a)?this.$input.width("100%"):this.$input.width(a),this.$hint&&(isNaN(a)?this.$hint.width("100%"):this.$hint.width(a))}},focusInput:function(e){if(!(t(e.target).closest(".token").length||t(e.target).closest(".token-input").length||t(e.target).closest(".tt-dropdown-menu").length)){var i=this;setTimeout(function(){i.$input.focus()},0)}},search:function(){this.$input.data("ui-autocomplete")&&this.$input.autocomplete("search")},disable:function(){this.setProperty("disabled",!0)},enable:function(){this.setProperty("disabled",!1)},readonly:function(){this.setProperty("readonly",!0)},writeable:function(){this.setProperty("readonly",!1)},setProperty:function(t,e){this["_"+t]=e,this.$input.prop(t,e),this.$element.prop(t,e),this.$wrapper[e?"addClass":"removeClass"](t)},destroy:function(){this.$element.val(this.getTokensList()),this.$element.css(this.$element.data("original-styles")),this.$element.prop("tabindex",this.$element.data("original-tabindex"));var e=t('label[for="'+this.$input.prop("id")+'"]');e.length&&e.prop("for",this.$element.prop("id")),this.$element.insertBefore(this.$wrapper),this.$element.removeData("original-styles").removeData("original-tabindex").removeData("bs.tokenfield"),this.$wrapper.remove(),this.$mirror.remove();var i=this.$element;return i}};var n=t.fn.tokenfield;return t.fn.tokenfield=function(e,n){var s,r=[];Array.prototype.push.apply(r,arguments);var a=this.each(function(){var a=t(this),o=a.data("bs.tokenfield"),h="object"==typeof e&&e;"string"==typeof e&&o&&o[e]?(r.shift(),s=o[e].apply(o,r)):o||"string"==typeof e||n||(a.data("bs.tokenfield",o=new i(this,h)),a.trigger("tokenfield:initialize"))});return"undefined"!=typeof s?s:a},t.fn.tokenfield.defaults={minWidth:60,minLength:0,allowEditing:!0,allowPasting:!0,limit:0,autocomplete:{},typeahead:{},showAutocompleteOnFocus:!1,createTokensOnBlur:!1,delimiter:",",beautify:!0,inputType:"text"},t.fn.tokenfield.Constructor=i,t.fn.tokenfield.noConflict=function(){return t.fn.tokenfield=n,this},i});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],4:[function(require,module,exports){
function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlxEvent(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function dhtmlXToolbarObject(t,e){var n=this;for(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtoolbar")||"dhx_skyblue",align:"left",align_autostart:"left",icons_path:"",iconSize:18,sel_ofs_x:0,sel_ofs_y:0,xml_autoload:null,items_autoload:null},"object"==typeof t&&null!=t&&"undefined"==typeof t.tagName&&(null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.icons_size&&(this.conf.icons_size_autoload=t.icons_size),null!=t.json&&(this.conf.json_autoload=t.json),null!=t.xml&&(this.conf.xml_autoload=t.xml),null!=t.onload&&(this.conf.onload_autoload=t.onload),null==t.onclick&&null==t.onClick||(this.conf.auto_onclick=t.onclick||t.onClick),null!=t.items&&(this.conf.items_autoload=t.items),null!=t.skin&&(this.conf.skin=t.skin),null!=t.align&&(this.conf.align_autostart=t.align),t=t.parent),this.cont="object"!=typeof t?document.getElementById(t):t;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);return t=null,this.cont.dir="ltr",this.base=document.createElement("DIV"),this.base.className="dhxtoolbar_float_left",this.cont.appendChild(this.base),window.dhx4.isIPad&&(this.cont.ontouchstart=function(t){return t=t||event,"input"==String(t.target.tagName||"").toLowerCase()?!0:(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1)}),this.setSkin(this.conf.skin),this.objPull={},this.anyUsed="none",this._genStr=function(t){for(var e="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=0;t>i;i++)e+=n.charAt(Math.round(Math.random()*(n.length-1)));return e},this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput"),this.idPrefix=this._genStr(12),window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson","toolbar",{struct:!0}),window.dhx4._eventable(this),this._getObj=function(t,e){for(var n=null,i=0;i<t.childNodes.length;i++)null!=t.childNodes[i].tagName&&String(t.childNodes[i].tagName).toLowerCase()==String(e).toLowerCase()&&(n=t.childNodes[i]);return n},this._addImgObj=function(t){var e=document.createElement("IMG");return t.childNodes.length>0?t.insertBefore(e,t.childNodes[0]):t.appendChild(e),e},this._setItemImage=function(t,e,n){if(1==n?t.imgEn=e:t.imgDis=e,!(!t.state&&1==n||t.state&&0==n)){var i=this._getObj(t.obj,"img");null==i&&(i=this._addImgObj(t.obj)),i.src=this.conf.icons_path+e}},this._clearItemImage=function(t,e){if(1==e?t.imgEn="":t.imgDis="",!(!t.state&&1==e||t.state&&0==e)){var n=this._getObj(t.obj,"img");null!=n&&n.parentNode.removeChild(n)}},this._setItemText=function(t,e){var n=this._getObj(t.obj,"div");return null==e||0==e.length?void(null!=n&&n.parentNode.removeChild(n)):(null==n&&(n=document.createElement("DIV"),n.className="dhxtoolbar_text",t.obj.appendChild(n)),void(n.innerHTML=e))},this._getItemText=function(t){var e=this._getObj(t.obj,"div");return null!=e?e.innerHTML:""},this._enableItem=function(t){if(!t.state){t.state=!0,"buttonTwoState"==this.objPull[t.id].type&&1==this.objPull[t.id].obj.pressed?(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",t.obj.renderAs=t.obj.className),t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgEn?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgEn):null!=e&&e.parentNode.removeChild(e)}},this._disableItem=function(t){if(t.state){t.state=!1,t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+("buttonTwoState"==this.objPull[t.id].type&&t.obj.pressed?"pres_":"")+"dis",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgDis?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgDis):null!=e&&e.parentNode.removeChild(e),null!=t.polygon&&"none"!=t.polygon.style.display&&(window.dhx4.zim.clear(t.polygon._idd),t.polygon.style.display="none",t.polygon._ie6cover&&(t.polygon._ie6cover.style.display="none"),"dhx_terrace"==this.conf.skin&&this._improveTerraceButtonSelect(t.id,!0)),this.anyUsed="none"}},this.clearAll=function(){for(var t in this.objPull)this._removeItem(String(t).replace(this.idPrefix,""))},this._doOnClick=function(t){n&&n.forEachItem&&n.forEachItem(function(t){if("buttonSelect"==n.objPull[n.idPrefix+t].type){var e=n.objPull[n.idPrefix+t];e.arw._skip===!0?e.arw._skip=!1:"none"!=e.polygon.style.display&&(e.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",e.obj.className=e.obj.renderAs,e.arw.className=String(e.obj.renderAs).replace("btn","arw"),n.anyUsed="none",window.dhx4.zim.clear(e.polygon._idd),e.polygon.style.display="none",e.polygon._ie6cover&&(e.polygon._ie6cover.style.display="none"),"dhx_terrace"==n.conf.skin&&n._improveTerraceButtonSelect(e.id,!0))}})},window.dhx4.isIPad?document.addEventListener("touchstart",this._doOnClick,!1):"undefined"!=typeof window.addEventListener?window.addEventListener("mousedown",this._doOnClick,!1):document.body.attachEvent("onmousedown",this._doOnClick),null!=this.conf.icons_size_autoload&&(this.setIconSize(this.conf.icons_size_autoload),this.conf.icons_size_autoload=null),null!=this.conf.items_autoload?(this.loadStruct(this.conf.items_autoload,this.conf.onload_autoload),this.conf.items_autoload=null):null!=this.conf.json_autoload?(this.loadStruct(this.conf.json_autoload,this.conf.onload_autoload),this.conf.json_autoload=null):null!=this.conf.xml_autoload&&(this.loadStruct(this.conf.xml_autoload,this.conf.onload_autoload),this.conf.xml_autoload=null),this.conf.align_autostart!=this.conf.align&&(this.setAlign(this.conf.align_autostart),this.conf.align_autostart=null),"function"==typeof this.conf.auto_onclick?this.attachEvent("onClick",this.conf.auto_onclick):"string"==typeof this.conf.auto_onclick&&"function"==typeof window[this.conf.auto_onclick]&&this.attachEvent("onClick",window[this.conf.auto_onclick]),this}"undefined"==typeof window.dhx4&&(window.dhx4={version:"4.2",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var n=document.createElement("DIV");n.className=t,null!=document.body.firstChild?document.body.insertBefore(n,document.body.firstChild):document.body.appendChild(n);var i=n[e||"offsetWidth"];return n.parentNode.removeChild(n),n=null,i},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(e){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,n=0;t;)e+=parseInt(t.offsetTop),n+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:n}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,l=window.pageXOffset||i.scrollLeft||n.scrollLeft,s=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,r=e.top+o-s,d=e.left+l-a;return{top:Math.round(r),left:Math.round(d)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&"undefined"==typeof t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var n in t)"object"==typeof t[n]&&null!=t[n]?e[n]=this._copyObj(t[n]):e[n]=t[n]}else for(var e=[],n=0;n<t.length;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=this._copyObj(t[n]):e[n]=t[n];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,n){t="string"==typeof t?document.getElementById(t):t;var i=t.value.length;if(e=Math.max(Math.min(e,i),0),n=Math.min(n,i),t.setSelectionRange)try{t.setSelectionRange(e,n)}catch(o){}else if(t.createTextRange){var l=t.createTextRange();l.moveStart("character",e),l.moveEnd("character",n-i);try{l.select()}catch(o){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",n=0;n<t.childNodes.length;n++)e+=null!=t.childNodes[n].nodeValue?t.childNodes[n].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),"undefined"==typeof window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,n){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],i=window.dhx4.trim(arguments[3]),o=null,l=[e[t]];if(i.length>0){i=i.split(":");for(var s=[],a=0;a<i.length;a++)a>0&&null!=s[s.length-1].match(/\\$/)?s[s.length-1]=s[s.length-1].replace(/\\$/,"")+":"+i[a]:s.push(i[a]);o=s[0];for(var a=1;a<s.length;a++)l.push(s[a])}return"string"==typeof o&&"function"==typeof window.dhx4.template[o]?window.dhx4.template[o].apply(window.dhx4.template,l):t.length>0&&"undefined"!=typeof e[t]?1==n?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):(t=t.toString(),null!=t.match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t):""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,n,i){var o=window.dhx4.template._parseFmt(e,n,i);return 0==o?t:window.dhx4.template._getFmtValue(t,o)},window.dhx4.template.lowercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,n){var i=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==i||4!=i.length)return!1;var o={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof n?n:".",s_bef:"string"==typeof i[1]?i[1]:"",s_aft:"string"==typeof i[3]?i[3]:""},l=i[2].split(".");null!=l[1]&&(o.d_len=l[1].length);var s=l[0].split(",");return s.length>1&&(o.i_len=s[s.length-1].length),o},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,fmt.i_len!==!1){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(fmt.d_len!==!1){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),"undefined"==typeof window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,n){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=n&&"undefnied"!=typeof n||(n=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var i=function(t){return 1==String(t).length?"0"+String(t):t},o=function(e){switch(e){case"%d":return i(t.getDate());case"%j":return t.getDate();case"%D":return n.dayShortName[t.getDay()];case"%l":return n.dayFullName[t.getDay()];case"%m":return i(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return n.monthShortName[t.getMonth()];case"%F":return n.monthFullName[t.getMonth()];case"%y":return i(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return i((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return i(t.getHours());case"%i":return i(t.getMinutes());case"%s":return i(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var o=t.getTimezoneOffset(),l=Math.abs(Math.floor(o/60)),s=Math.abs(o)-60*l;return(o>0?"-":"+")+i(l)+":"+i(s);default:return e}},l=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,o);return l||String(t)},window.dhx4.str2date=function(t,e,n){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=n&&"undefnied"!=typeof n||(n=window.dhx4.dateStrings[window.dhx4.dateLang]),e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var i=[],o=[];e=e.replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return o.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return o.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return o.push(t),"(\\d{1,2})";case"%Y":return o.push(t),"(\\d{4})";case"%a":return o.push(t),"([am|pm])";case"%A":return o.push(t),"([AM|PM])";case"%u":return o.push(t),"(\\d{1,6})";case"%P":return o.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var l=new RegExp(e,"i"),s=t.match(l);if(null==s||s.length-1!=o.length)return"Invalid Date";for(var a=1;a<s.length;a++)i.push(s[a]);for(var r={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},d={},h={},a=0;a<o.length;a++)if("undefined"!=typeof r[o[a]]){var u=r[o[a]];d[u]||(d[u]=[],h[u]=[]),d[u].push(i[a]),h[u].push(o[a])}i=[],o=[];for(var a=1;7>=a;a++)if(null!=d[a])for(var c=0;c<d[a].length;c++)i.push(d[a][c]),o.push(h[a][c]);var p=new Date;p.setDate(1),p.setHours(0),p.setMinutes(0),p.setSeconds(0),p.setMilliseconds(0);for(var b=function(t,e){for(var n=0;n<e.length;n++)if(e[n].toLowerCase()==t)return n;return-1},a=0;a<i.length;a++)switch(o[a]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(i[a])||p[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[o[a]]](Number(i[a])+("%m"==o[a]||"%n"==o[a]?-1:0));break;case"%M":case"%F":var m=b(i[a].toLowerCase(),n[{"%M":"monthShortName","%F":"monthFullName"}[o[a]]]);m>=0&&p.setMonth(m);break;case"%y":if(!isNaN(i[a])){var f=Number(i[a]);p.setFullYear(f+(f>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(i[a])){var f=Number(i[a]);12>=f&&f>=0&&p.setHours(f+(b("pm",i)>=0?12==f?0:12:12==f?-12:0))}break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=i[a])}return p}),"undefined"==typeof window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){var e=new window.ActiveXObject("Microsoft.XMLDOM");e.async="false",e.loadXML(t)}return e},xmltop:function(t,e,n){if(("undefined"==typeof e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(i){}return-1!==n&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],n]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var n,i=[],o=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);n=o.iterateNext();)i.push(n);return i}try{return e.selectNodes(t)||[]}catch(l){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,n){return this._call("PUT",t,e,!0,n)},del:function(t,e,n){return this._call("DELETE",t,e,!0,n)},post:function(t,e,n){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(n=e,e=""),this._call("POST",t,e,!0,n)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,n){2==arguments.length&&(n=e,e=""),this._call("POST",t,e,!0,n,{url:t,postData:e})},_call:function(t,e,n,i,o,l,s){var a=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==i&&(a.onreadystatechange=function(){if(4==a.readyState||1==r&&3==a.readyState){if((200!=a.status||""==a.responseText)&&!dhx4.callEvent("onAjaxError",[a]))return;window.setTimeout(function(){"function"==typeof o&&o.apply(window,[{xmlDoc:a,filePath:e,async:i}]),null!=l&&("undefined"!=typeof l.postData?dhx4.ajax.postLong(l.url,l.postData,o):dhx4.ajax.getLong(l.url,o)),o=null,a=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),a.open(t,e,i),null!=s)for(var d in s)a.setRequestHeader(d,s[d]);else"POST"==t||"PUT"==t||"DELETE"==t?a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(n=null);return a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(n),{xmlDoc:a,filePath:e,async:i}}}),"undefined"==typeof window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,n,i,o){if("clear"==o){for(var l in t._dhxdataload)t._dhxdataload[l]=null,delete t._dhxdataload[l];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:n,xmlRootTag:i,onBeforeXLS:null},t._loadData=function(t,e,n){2==arguments.length&&(n=e,e=null);var i=null;if(3==arguments.length&&(n=arguments[2]),"string"==typeof t){var o=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,""),l=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(l.test(o.replace(/^<\?xml[^\?]*\?>\s*/,""))&&(i=dhx4.ajax.parse(t),null!=i&&(i=this[this._dhxdataload.xmlToJson].apply(this,[i]))),null!=i||null==o.match(/^\{.*\}$/)&&null==o.match(/^\[.*\]$/)||(i=dhx4.s2j(o)),null==i){this.callEvent("onXLS",[]);var s=[];if("function"==typeof this._dhxdataload.onBeforeXLS){var o=this._dhxdataload.onBeforeXLS.apply(this,[t]);if(null!=o&&"object"==typeof o&&(null!=o.url&&(t=o.url),null!=o.params))for(var a in o.params)s.push(a+"="+encodeURIComponent(o.params[a]))}var r=this,d=function(e){var i=null;i=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?r[r._dhxdataload.xmlToJson].apply(r,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText),null!=i&&r[r._dhxdataload.initObj].apply(r,[i,t]),r.callEvent("onXLE",[]),null!=n&&("function"==typeof n?n.apply(r,[]):"function"==typeof window[n]&&window[n].apply(r,[])),d=n=null,i=e=r=null};return s=s.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,s,d):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(s.length>0?(t.indexOf("?")>0?"&":"?")+s:""),d))}}else i="object"==typeof t.documentElement||"undefined"!=typeof t.tagName&&"undefined"!=typeof t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=i&&this[this._dhxdataload.initObj].apply(this,[i]),null!=n&&("function"==typeof n?n.apply(this,[]):"function"==typeof window[n]&&window[n].apply(this,[]),n=null)},null!=o){var s={struct:"loadStruct",data:"load"};for(var l in o)1==o[l]&&(t[s[l]]=function(){return this._loadData.apply(this,arguments)})}t=null}),"undefined"==typeof window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){return"clear"==e?(t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null)):(t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var n=window.dhx4.newId();return this.dhxevs.data[t][n]=e,n},t.detachEvent=function(t){for(var e in this.dhxevs.data){var n=0;for(var i in this.dhxevs.data[e])i==t?(this.dhxevs.data[e][i]=null,delete this.dhxevs.data[e][i]):n++;0==n&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var n=!0;for(var i in this.dhxevs.data[t])n=this.dhxevs.data[t][i].apply(this,e)&&n;return n},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},void(t=null))},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&!0||!1},isValidSSN:function(t){return t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&!0||!1},isValidSIN:function(t){return t.toString().match(/^\d{9}$/)&&!0||!1}},dhtmlxValidation=new dhtmlxValidation),"undefined"==typeof window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var n in e)t[n]||(t[n]=e[n]);return t},extend_api:function(t,e,n){var i=window[t];i&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var n=i.apply(this,e._init?e._init(t):arguments);for(var o in dhtmlx)e[o]&&this[e[o]](dhtmlx[o]);for(var o in t)e[o]?this[e[o]](t[o]):0===o.indexOf("on")&&this.attachEvent(o,t[o])}else var n=i.apply(this,arguments);return e._patch&&e._patch(this),n||this},window[t].prototype=i.prototype,n&&dhtmlx.extend(window[t].prototype,n))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){return!t&&!window.event||2!=(t||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),t&&t.preventDefault?(t.preventDefault(),!1):!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var n=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var i=document.createElement("Div");i.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=i.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),n.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)o=t.srcElement;else var o=t.target;dragger.checkLanding(o,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,n=0,i=0;e;)n+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var o=parent.dhtmlDragAndDrop.calculateFramePosition(1);n+=1*o.split("_")[0],i+=1*o.split("_")[1]}if(t)return n+"_"+i;this.fx=n,this.fy=i}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var n=dragger.lastLanding;dragger.lastLanding=null,n&&n.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,n,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(n){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(n){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(n){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(n){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,
_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),"undefined"==typeof window.dhtmlxEvent,null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),"undefined"==typeof dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function t(){if(n){var t=document.createEvent("HTMLEvents");t.initEvent("dblclick",!0,!0),n.dispatchEvent(t),e=n=null}}var e,n,i,o;dhtmlxEvent(document.body,"touchstart",function(l){n=l.touches[0].target,i=l.touches[0].clientX,o=l.touches[0].clientY,e=window.setTimeout(t,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(t){e&&(Math.abs(t.touches[0].clientX-i)>50||Math.abs(t.touches[0].clientY-o)>50)&&(window.clearTimeout(e),e=n=!1)}),dhtmlxEvent(document.body,"touchend",function(t){e&&(window.clearTimeout(e),e=n=!1)}),dhtmlxEvent.initTouch=function(){}}),dhtmlXToolbarObject.prototype.addSpacer=function(t){var e=this.idPrefix+t;if(null!=this._spacer){if(this._spacer.idd==t)return;if(this._spacer==this.objPull[e].obj.parentNode){for(var n=!0;n;){var i=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]),i!=t&&0!=this._spacer.childNodes.length||(null!=this.objPull[e].arw&&this.base.appendChild(this.objPull[e].arw),n=!1)}return this._spacer.idd=t,void this._fixSpacer()}if(this.base==this.objPull[e].obj.parentNode){for(var n=!0,o=null!=this.objPull[e].arw;n;){var l=this.base.childNodes.length-1;1==o&&this.base.childNodes[l]==this.objPull[e].arw&&(n=!1),this.base.childNodes[l].idd==t&&(n=!1),n&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[l],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[l]))}return this._spacer.idd=t,void this._fixSpacer()}}else{for(var s=null,l=0;l<this.base.childNodes.length;l++)this.base.childNodes[l]==this.objPull[this.idPrefix+t].obj&&(s=l,null!=this.objPull[this.idPrefix+t].arw&&(s=l+1));if(null!=s){for(this._spacer=document.createElement("DIV"),this._spacer.className="right"==this.conf.align?" dhxtoolbar_float_left":" dhxtoolbar_float_right",this._spacer.dir="ltr",this._spacer.idd=t;this.base.childNodes.length>s+1;)this._spacer.appendChild(this.base.childNodes[s+1]);this.cont.appendChild(this._spacer),this._fixSpacer()}}"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer),this._spacer=null,"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()}},dhtmlXToolbarObject.prototype._fixSpacer=function(){if("undefined"==typeof window.addEventListener&&null!=this._spacer){this._spacer.style.borderLeft="1px solid #a4bed4";var t=this._spacer;window.setTimeout(function(){t.style.borderLeft="0px solid #a4bed4",t=null},1)}},dhtmlXToolbarObject.prototype.getType=function(t){var e=this.getParentId(t);if(null!=e){var n=null,i=this.objPull[this.idPrefix+e]._listOptions[t];return null!=i&&(n=null!=i.sep?"buttonSelectSeparator":"buttonSelectButton"),n}return null==this.objPull[this.idPrefix+t]?null:this.objPull[this.idPrefix+t].type},dhtmlXToolbarObject.prototype.getTypeExt=function(t){var e=this.getType(t);return"buttonSelectButton"==e||"buttonSelectSeparator"==e?e="buttonSelectButton"==e?"button":"separator":null},dhtmlXToolbarObject.prototype.inArray=function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},dhtmlXToolbarObject.prototype.getParentId=function(t){var e=null;for(var n in this.objPull)if(this.objPull[n]._listOptions)for(var i in this.objPull[n]._listOptions)i==t&&(e=String(n).replace(this.idPrefix,""));return e},dhtmlXToolbarObject.prototype._addItem=function(t,e){"string"==typeof t.text&&(t.text=window.dhx4.trim(t.text),0==t.text.length&&(t.text=null)),this._addItemToStorage(t,e),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.addButton=function(t,e,n,i,o){this._addItem({id:t,type:"button",text:n,img:i,imgdis:o},e)},dhtmlXToolbarObject.prototype.addText=function(t,e,n){this._addItem({id:t,type:"text",text:n},e)},dhtmlXToolbarObject.prototype.addButtonSelect=function(t,e,n,i,o,l,s,a,r,d){for(var h=[],u=0;u<i.length;u++){var c={};i[u]instanceof Array?(c.id=i[u][0],c.type="obj"==i[u][1]?"button":"separator",c.text=i[u][2]||null,c.img=i[u][3]||null):i[u]instanceof Object&&null!=i[u]&&"undefined"!=typeof i[u].id&&"undefined"!=typeof i[u].type&&(c.id=i[u].id,c.type="obj"==i[u].type?"button":"separator",c.text=i[u].text,c.img=i[u].img),h.push(c)}this._addItem({id:t,type:"buttonSelect",text:n,img:o,imgdis:l,renderSelect:s,openAll:a,options:h,maxOpen:r,mode:d},e)},dhtmlXToolbarObject.prototype.addButtonTwoState=function(t,e,n,i,o){this._addItem({id:t,type:"buttonTwoState",img:i,imgdis:o,text:n},e)},dhtmlXToolbarObject.prototype.addSeparator=function(t,e){this._addItem({id:t,type:"separator"},e)},dhtmlXToolbarObject.prototype.addSlider=function(t,e,n,i,o,l,s,a,r){this._addItem({id:t,type:"slider",length:n,valueMin:i,valueMax:o,valueNow:l,textMin:s,textMax:a,toolTip:r},e)},dhtmlXToolbarObject.prototype.addInput=function(t,e,n,i){this._addItem({id:t,type:"buttonInput",value:n,width:i},e)},dhtmlXToolbarObject.prototype.forEachItem=function(t){for(var e in this.objPull)this.inArray(this.rootTypes,this.objPull[e].type)&&t(this.objPull[e].id.replace(this.idPrefix,""))},function(){for(var t="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),e=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],n=function(t,e){return function(n,i,o){return n=this.idPrefix+n,null!=this.objPull[n][t]?this.objPull[n][t].call(this.objPull[n],i,o):e}},i=0;i<t.length;i++){var o=t[i],l=e[i];dhtmlXToolbarObject.prototype[o]=n(o,l)}}(),dhtmlXToolbarObject.prototype.showItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].showItem&&(this.objPull[t].showItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.hideItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].hideItem&&(this.objPull[t].hideItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.getPosition=function(t){return this._getPosition(t)},dhtmlXToolbarObject.prototype._getPosition=function(t,e){if(null==this.objPull[this.idPrefix+t])return null;for(var n=null,i=0,o=0;o<this.base.childNodes.length;o++)null!=this.base.childNodes[o].idd&&(this.base.childNodes[o].idd==t&&(n=i),i++);if(!n&&null!=this._spacer)for(var o=0;o<this._spacer.childNodes.length;o++)null!=this._spacer.childNodes[o].idd&&(this._spacer.childNodes[o].idd==t&&(n=i),i++);return n},dhtmlXToolbarObject.prototype.setPosition=function(t,e){this._setPosition(t,e)},dhtmlXToolbarObject.prototype._setPosition=function(t,e){if(null!=this.objPull[this.idPrefix+t]){isNaN(e)&&(e=this.base.childNodes.length),0>e&&(e=0);var n=null;this._spacer&&(n=this._spacer.idd,this.removeSpacer());var i=this.objPull[this.idPrefix+t];this.base.removeChild(i.obj),i.arw&&this.base.removeChild(i.arw);var o=this._getIdByPosition(e,!0);null==o[0]?(this.base.appendChild(i.obj),i.arw&&this.base.appendChild(i.arw)):(this.base.insertBefore(i.obj,this.base.childNodes[o[1]]),i.arw&&this.base.insertBefore(i.arw,this.base.childNodes[o[1]+1])),null!=n&&this.addSpacer(n)}},dhtmlXToolbarObject.prototype._getIdByPosition=function(t,e){for(var n=null,i=0,o=0,l=0;l<this.base.childNodes.length;l++)null!=this.base.childNodes[l].idd&&null==n&&i++==t&&(n=this.base.childNodes[l].idd),null==n&&o++;return o=null==n?null:o,1==e?new Array(n,o):n},dhtmlXToolbarObject.prototype.removeItem=function(t){this._removeItem(t),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._removeItem=function(t){var e=this.getType(t);t=this.idPrefix+t;var n=this.objPull[t];if("button"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj._doOnMouseUp=null,n.obj._doOnMouseUpOnceAnywhere=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null),"buttonTwoState"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setItemState=null,n.getItemState=null),"buttonSelect"==e){for(var i in n._listOptions)this.removeListOption(t,i);n._listOptions=null,n.polygon._ie6cover&&(document.body.removeChild(n.polygon._ie6cover),n.polygon._ie6cover=null),n.p_tbl.removeChild(n.p_tbody),n.polygon.removeChild(n.p_tbl),n.polygon.onselectstart=null,document.body.removeChild(n.polygon),n.p_tbody=null,n.p_tbl=null,n.polygon=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.idd=null,n.obj.iddPrefix=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.arw.onclick=null,n.arw.onmouseover=null,n.arw.onmouseout=null,n.arw.onmouseup=null,n.arw.onmousedown=null,n.arw.onselectstart=null,n.arw.parentNode.removeChild(n.arw),n.arw=null,n.renderSelect=null,n.state=null,n.type=null,n.id=null,n.img=null,n.imgEn=null,n.imgDis=null,n.openAll=null,n._isListButton=null,n._separatorButtonSelectObject=null,n._buttonButtonSelectObject=null,n.setWidth=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.addListOption=null,n.removeListOption=null,n.showListOption=null,n.hideListOption=null,n.isListOptionVisible=null,n.enableListOption=null,n.disableListOption=null,n.isListOptionEnabled=null,n.setListOptionPosition=null,n.getListOptionPosition=null,n.setListOptionImage=null,n.getListOptionImage=null,n.clearListOptionImage=null,n.setListOptionText=null,n.getListOptionText=null,n.setListOptionToolTip=null,n.getListOptionToolTip=null,n.forEachListOption=null,n.getAllListOptions=null,n.setListOptionSelected=null,n.getListOptionSelected=null}if("buttonInput"==e&&(n.obj.childNodes[0].onkeydown=null,n.obj.removeChild(n.obj.childNodes[0]),n.obj.w=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setWidth=null,n.getWidth=null,n.setValue=null,n.getValue=null,n.setItemText=null,n.getItemText=null),"slider"==e){for(window.dhx4.isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",n.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",n.pen._doOnMouseMoveEnd,!1)):(document.body.detachEvent("onmousemove",n.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",n.pen._doOnMouseMoveEnd)),n.pen.allowMove=null,n.pen.initXY=null,n.pen.maxX=null,n.pen.minX=null,n.pen.nowX=null,n.pen.newNowX=null,n.pen.valueMax=null,n.pen.valueMin=null,n.pen.valueNow=null,n.pen._definePos=null,n.pen._detectLimits=null,n.pen._doOnMouseMoveStart=null,n.pen._doOnMouseMoveEnd=null,n.pen.onmousedown=null,n.obj.removeChild(n.pen),n.pen=null,n.label.tip=null,document.body.removeChild(n.label),n.label=null,n.obj.onselectstart=null,n.obj.idd=null;n.obj.childNodes.length>0;)n.obj.removeChild(n.obj.childNodes[0]);n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.state=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.setItemToolTipTemplate=null,n.getItemToolTipTemplate=null,n.setMaxValue=null,n.setMinValue=null,n.getMaxValue=null,n.getMinValue=null,n.setValue=null,n.getValue=null,n.showItem=null,n.hideItem=null,n.isVisible=null}"separator"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null),"text"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setWidth=null,n.setItemText=null,n.getItemText=null),e=null,n=null,this.objPull[this.idPrefix+t]=null,delete this.objPull[this.idPrefix+t]},function(){for(var t="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),e=function(t){return function(e,n,i,o,l,s){return e=this.idPrefix+e,null!=this.objPull[e]&&"buttonSelect"==this.objPull[e].type?this.objPull[e][t].call(this.objPull[e],n,i,o,l,s):void 0}},n=0;n<t.length;n++){var i=t[n];dhtmlXToolbarObject.prototype[i]=e(i)}}(),dhtmlXToolbarObject.prototype._rtlParseBtn=function(t,e){return t+e},dhtmlXToolbarObject.prototype._separatorObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_sep",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this},dhtmlXToolbarObject.prototype._textObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_text",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.obj.innerHTML=n.text||"",t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(t){this.obj.innerHTML=t},this.getItemText=function(){return this.obj.innerHTML},this.setWidth=function(t){this.obj.style.width=t+"px"},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":"");var i=this;return this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){this.allowClick=!0,0!=i.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className)},this.obj._doOnMouseOut=function(){this.allowClick=!1,0!=i.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.renderAs)},this.obj.onclick=function(e){if(0!=i.state&&0!=this.allowClick){e=e||event;var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(e){}t&&t.callEvent&&t.callEvent("onClick",[n])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if(0==i.state)return e=e||event,e.preventDefault?e.preventDefault():e.returnValue=!1,e.cancelBubble=!0,!1;if("none"==t.anyUsed)return t.anyUsed=this.idd,this.className="dhx_toolbar_btn dhxtoolbar_btn_pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){t.anyUsed="none",this._doOnMouseOut()},!1},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(0!=i.state&&("none"==t.anyUsed||t.anyUsed==this.idd)){var n=t.anyUsed;this._doOnMouseUp(),window.dhx4.isIPad&&"none"!=n&&t.callEvent("onClick",[this.idd.replace(t.idPrefix,"")])}},window.dhx4.isIPad&&(this.obj.ontouchmove=function(t){this._doOnMouseUp()}),this.obj._doOnMouseUp=function(){t.anyUsed="none",this.className=this.renderAs,this.pressed=!1},this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp(),this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){this._doOnMouseOut()}},t.base.appendChild(this.obj),this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonSelectObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?"true"==n.enabled:!0,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.mode=n.mode||"button","select"==this.mode?(this.openAll=!0,this.renderSelect=!1,n.text&&0!=n.text.length||(n.text="&nbsp;")):(this.openAll=1==window.dhx4.s2b(n.openAll),this.renderSelect=null==n.renderSelect?!0:window.dhx4.s2b(n.renderSelect)),this.maxOpen=isNaN(n.maxOpen?n.maxOpen:"")?null:n.maxOpen,this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!t._sbw){var e=document.createElement("DIV");e.className="dhxtoolbar_maxopen_test",document.body.appendChild(e);var n=document.createElement("DIV");n.className="dhxtoolbar_maxopen_test2",e.appendChild(n),t._sbw=e.offsetWidth-n.offsetWidth,e.removeChild(n),n=null,document.body.removeChild(e),e=null}},this._maxOpenTest(),this.obj=document.createElement("DIV"),this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed=!1,this.callEvent=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":""),t.base.appendChild(this.obj),this.arw=document.createElement("DIV"),this.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(this.state?"def":"dis"),this.arw.style.display=this.obj.style.display,this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>",this.arw.title=this.obj.title,this.arw.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},t.base.appendChild(this.arw);var i=this;if(this.obj.onmouseover=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"))},this.obj.onmouseout=function(){i.obj.allowClick=!1,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),i.callEvent=!1)},this.arw.onmouseover=this.obj.onmouseover,this.arw.onmouseout=this.obj.onmouseout,1==this.openAll||(this.obj.onclick=function(e){if(e=e||event,i.obj.allowClick&&i.state&&"none"==t.anyUsed){var n=i.obj.idd.replace(t.idPrefix,"");if(i.obj.extAction)try{window[i.obj.extAction](n)}catch(e){}t.callEvent("onClick",[n])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.allowClick=!0,i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",i.callEvent=!0)},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(e=e||event,e.cancelBubble=!0,"none"==t.anyUsed&&i.state&&(i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.isIPad&&i.callEvent)){var n=i.obj.idd.replace(t.idPrefix,"");t.callEvent("onClick",[n])}}),window.dhx4.isIPad&&(this.obj.ontouchmove=this.obj.onmouseout),this.arw[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event;var n=0===this.className.indexOf("dhx_toolbar_arw")?this:this.nextSibling;if(n._skip?(e=e||event,e.cancelBubble=!0):n._skip=!0,n=null,i.state){if(t.anyUsed==i.obj.idd)i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),t.anyUsed="none",window.dhx4.zim.clear(i.polygon._idd),i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!0);else{if("none"!=t.anyUsed&&"buttonSelect"==t.objPull[t.idPrefix+t.anyUsed].type){var o=t.objPull[t.idPrefix+t.anyUsed];"none"!=o.polygon.style.display&&(o.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",o.obj.className=o.obj.renderAs,o.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(o.polygon._idd),o.polygon.style.display="none",o.polygon._ie6cover&&(o.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(o.id,!0))}i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over",i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",t.anyUsed=i.obj.idd,i.polygon.style.top="0px",i.polygon.style.visibility="hidden",i.polygon.style.zIndex=window.dhx4.zim.reserve(i.polygon._idd),i.polygon.style.display="","dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!1),i._fixMaxOpenHeight(i.maxOpen||null),t._autoDetectVisibleArea();var l=window.dhx4.absTop(i.obj)+i.obj.offsetHeight+t.conf.sel_ofs_y,s=i.polygon.offsetHeight;if(l+s>t.tY2){var a=null!=i.maxOpen?Math.floor((t.tY2-l)/22):0;a>=1?i._fixMaxOpenHeight(a):(l=window.dhx4.absTop(i.obj)-s-t.conf.sel_ofs_y,0>l&&(l=0))}if(i.polygon.style.top=l+"px",t.rtl)i.polygon.style.left=window.dhx4.absLeft(i.obj)+i.obj.offsetWidth-i.polygon.offsetWidth+t.conf.sel_ofs_x+"px";else{var r=document.body.scrollLeft,d=r+(window.innerWidth||document.body.clientWidth),h=window.dhx4.absLeft(i.obj)+t.conf.sel_ofs_x;h+i.polygon.offsetWidth>d&&(h=window.dhx4.absLeft(i.arw)+i.arw.offsetWidth-i.polygon.offsetWidth),i.polygon.style.left=Math.max(h,5)+"px"}i.polygon.style.visibility="visible",i.polygon._ie6cover&&(i.polygon._ie6cover.style.left=i.polygon.style.left,i.polygon._ie6cover.style.top=i.polygon.style.top,i.polygon._ie6cover.style.width=i.polygon.offsetWidth+"px",i.polygon._ie6cover.style.height=i.polygon.offsetHeight+"px",i.polygon._ie6cover.style.display="")}return!1}},this.arw.onclick=function(t){t=t||event,t.cancelBubble=!0},this.arw[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(t){t=t||event,t.cancelBubble=!0},this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,window.dhx4.isIPad&&(this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend)),this.obj.iddPrefix=t.idPrefix,this._listOptions={},this._fixMaxOpenHeight=function(e){var n="auto",o=!1;if(null!==e){var l=0;for(var s in this._listOptions)l++;l>e?(this._ph=22*e,n=this._ph+"px"):o=!0}this.polygon.style.width="auto",this.polygon.style.height="auto",o||null==i.maxOpen||(this.polygon.style.width=this.p_tbl.offsetWidth+t._sbw+"px",this.polygon.style.height=n)},this._separatorButtonSelectObject=function(t,e,n){return this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.className="tr_sep",this.obj.tr.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td=document.createElement("TD"),this.obj.td.colSpan="2",this.obj.td.className="td_btn_sep",this.obj.td.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},isNaN(n)?n=i.p_tbody.childNodes.length+1:1>n&&(n=1),n>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[n-1]),this.obj.tr.appendChild(this.obj.td),this.obj.sep=document.createElement("DIV"),this.obj.sep.className="btn_sep",this.obj.sep.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td.appendChild(this.obj.sep),i._listOptions[t]=this.obj,this},this._buttonButtonSelectObject=function(e,n,o){var l=!0;"undefined"!=typeof n.enabled?l=window.dhx4.s2b(n.enabled):"undefined"!=typeof n.disabled&&(l=window.dhx4.s2b(n.disabled)),this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.en=l,this.obj.tr.extAction=n.action||null,this.obj.tr._selected=null!=n.selected,this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&i.renderSelect?" tr_btn_selected":"":" tr_btn_disabled"),this.obj.tr.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.tr.idd=String(e),isNaN(o)?o=i.p_tbody.childNodes.length+1:1>o&&(o=1),o>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[o-1]),this.obj.td_a=document.createElement("TD"),this.obj.td_a.className="td_btn_img",this.obj.td_a.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td_b=document.createElement("TD"),this.obj.td_b.className="td_btn_txt",this.obj.td_b.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},t.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b)),null!=n.img?(this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+t.conf.icons_path+n.img+"' border='0'>",this.obj.tr._img=n.img):this.obj.td_a.innerHTML="&nbsp;";var s=null!=n.text?n.text:n.itemText||"";return this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+s+"</div>",this.obj.tr[window.dhx4.isIPad?"ontouchstart":"onmouseover"]=function(){!this.en||this._selected&&i.renderSelect||(this.className="tr_btn tr_btn_over")},this.obj.tr.onmouseout=function(){this.en&&(this._selected&&i.renderSelect?-1==String(this.className).search("tr_btn_selected")&&(this.className="tr_btn tr_btn_selected"):this.className="tr_btn")},this.obj.tr.onclick=function(t){return t=t||event,t.cancelBubble=!0,t.preventDefault&&t.preventDefault(),!1},this.obj.tr[window.dhx4.isIPad?"ontouchend":"onmousedown"]=function(e){if(e=e||event,e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),this.en){i.setListOptionSelected(this.idd.replace(t.idPrefix,"")),i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(i.polygon._idd),i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!0),t.anyUsed="none";var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(e){}return t.callEvent("onClick",[n]),!1}},i._listOptions[e]=this.obj,this},this.polygon=document.createElement("DIV"),this.polygon.dir="ltr",this.polygon.style.display="none",this.polygon.className="dhx_toolbar_poly_"+t.conf.skin+" dhxtoolbar_icons_"+t.conf.iconSize,this.polygon.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.polygon.onmousedown=function(t){t=t||event,t.cancelBubble=!0},this.polygon.style.overflowY="auto",this.polygon._idd=window.dhx4.newId(),window.dhx4.isIPad&&(this.polygon.ontouchstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.p_tbl=document.createElement("TABLE"),this.p_tbl.className="buttons_cont",this.p_tbl.cellSpacing="0",this.p_tbl.cellPadding="0",this.p_tbl.border="0",this.polygon.appendChild(this.p_tbl),this.p_tbody=document.createElement("TBODY"),this.p_tbl.appendChild(this.p_tbody),null!=n.options)for(var o=0;o<n.options.length;o++){var l="_"+(n.options[o].type||"")+"ButtonSelectObject";null==n.options[o].id&&(n.options[o].id=t._genStr(24)),"function"==typeof this[l]&&new this[l](n.options[o].id,n.options[o])}return document.body.appendChild(this.polygon),window.dhx4.isIE6&&(this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)),this.setWidth=function(t){this.obj.style.width=t-this.arw.offsetWidth+"px",this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px",this.p_tbl.style.width=this.polygon.style.width},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display="",this.arw.style.display=""},this.hideItem=function(){this.obj.style.display="none",this.arw.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){
t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t,this.arw.title=t},this.getItemToolTip=function(){return this.obj.title},this.addListOption=function(t,e,n,i,o){if("button"==n||"separator"==n){var l={id:t,type:n,text:i,img:o};new this["_"+n+"ButtonSelectObject"](t,l,e)}},this.removeListOption=function(t){if(this._isListButton(t,!0)){var e=this._listOptions[t];if(null!=e.td_a&&null!=e.td_b){for(e.td_a.onselectstart=null,e.td_b.onselectstart=null;e.td_a.childNodes.length>0;)e.td_a.removeChild(e.td_a.childNodes[0]);for(;e.td_b.childNodes.length>0;)e.td_b.removeChild(e.td_b.childNodes[0]);for(e.tr.onselectstart=null,e.tr.onmouseover=null,e.tr.onmouseout=null,e.tr.onclick=null;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.td_a=null,e.td_b=null,e.tr=null}else{for(e.sep.onselectstart=null,e.td.onselectstart=null,e.tr.onselectstart=null;e.td.childNodes.length>0;)e.td.removeChild(e.td.childNodes[0]);for(;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.sep=null,e.td=null,e.tr=null}e=null,this._listOptions[t]=null;try{delete this._listOptions[t]}catch(n){}}},this.showListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="")},this.hideListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="none")},this.isListOptionVisible=function(t){return this._isListButton(t,!0)?"none"!=this._listOptions[t].tr.style.display:void 0},this.enableListOption=function(e){this._isListButton(e)&&(this._listOptions[e].tr.en=!0,this._listOptions[e].tr.className="tr_btn"+(this._listOptions[e].tr._selected&&t.renderSelect?" tr_btn_selected":""))},this.disableListOption=function(t){this._isListButton(t)&&(this._listOptions[t].tr.en=!1,this._listOptions[t].tr.className="tr_btn tr_btn_disabled")},this.isListOptionEnabled=function(t){return this._isListButton(t)?this._listOptions[t].tr.en:void 0},this.setListOptionPosition=function(t,e){if(this._listOptions[t]&&this.getListOptionPosition(t)!=e&&!isNaN(e)){1>e&&(e=1);var n=this._listOptions[t].tr;this.p_tbody.removeChild(n),e>this.p_tbody.childNodes.length?this.p_tbody.appendChild(n):this.p_tbody.insertBefore(n,this.p_tbody.childNodes[e-1]),n=null}},this.getListOptionPosition=function(t){var e=-1;if(!this._listOptions[t])return e;for(var n=0;n<this.p_tbody.childNodes.length;n++)this.p_tbody.childNodes[n]==this._listOptions[t].tr&&(e=n+1);return e},this.setListOptionImage=function(e,n){if(this._isListButton(e)){var i=this._listOptions[e].tr.childNodes[t.rtl?1:0];if(i.childNodes.length>0)i.childNodes[0].src=t.conf.icons_path+n;else{var o=document.createElement("IMG");o.className="btn_sel_img",o.src=t.conf.icons_path+n,i.appendChild(o)}i=null}},this.getListOptionImage=function(e){if(this._isListButton(e)){var n=this._listOptions[e].tr.childNodes[t.rtl?1:0],i=null;return n.childNodes.length>0&&(i=n.childNodes[0].src),n=null,i}},this.clearListOptionImage=function(e){if(this._isListButton(e)){for(var n=this._listOptions[e].tr.childNodes[t.rtl?1:0];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.innerHTML="&nbsp;",n=null}},this.setListOptionText=function(e,n){this._isListButton(e)&&(this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML=n)},this.getListOptionText=function(e){return this._isListButton(e)?this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML:void 0},this.setListOptionToolTip=function(t,e){this._isListButton(t)&&(this._listOptions[t].tr.title=e)},this.getListOptionToolTip=function(t){return this._isListButton(t)?this._listOptions[t].tr.title:void 0},this.forEachListOption=function(t){for(var e in this._listOptions)t(e)},this.getAllListOptions=function(){var t=new Array;for(var e in this._listOptions)t[t.length]=e;return t},this.setListOptionSelected=function(t){for(var e in this._listOptions){var n=this._listOptions[e];null!=n.td_a&&null!=n.td_b&&n.tr.en&&(e==t?(n.tr._selected=!0,n.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),"select"==this.mode&&(n.tr._img?this.setItemImage(n.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(t)))):(n.tr._selected=!1,n.tr.className="tr_btn")),n=null}},this.getListOptionSelected=function(){var t=null;for(var e in this._listOptions)1==this._listOptions[e].tr._selected&&(t=e);return t},this._isListButton=function(t,e){return null==this._listOptions[t]?!1:!(!e&&"tr_sep"==this._listOptions[t].tr.className)},this.setMaxOpen=function(t){return this._ph=null,"number"==typeof t?(this.maxOpen=t,void this._maxOpenTest()):void(this.maxOpen=null)},n.width&&this.setWidth(n.width),"select"==this.mode&&"undefined"!=typeof n.selected&&this.setListOptionSelected(n.selected),this},dhtmlXToolbarObject.prototype._buttonInputObject=function(t,e,n){this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.w=null!=n.width?n.width:100,this.obj.title=null!=n.title?n.title:"",this.obj.innerHTML="<input class='dhxtoolbar_input' type='text' style='width:"+this.obj.w+"px;'"+(null!=n.value?" value='"+n.value+"'":"")+">";var i=t,o=this;return this.obj.childNodes[0].onkeydown=function(t){t=t||event,13==t.keyCode&&i.callEvent("onEnter",[o.obj.idd,this.value])},t.base.appendChild(this.obj),this.enableItem=function(){this.obj.childNodes[0].disabled=!1},this.disableItem=function(){this.obj.childNodes[0].disabled=!0},this.isEnabled=function(){return!this.obj.childNodes[0].disabled},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return"none"!=this.obj.style.display},this.setValue=function(t){this.obj.childNodes[0].value=t},this.getValue=function(){return this.obj.childNodes[0].value},this.setWidth=function(t){this.obj.w=t,this.obj.childNodes[0].style.width=this.obj.w+"px"},this.getWidth=function(){return this.obj.w},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this.getInput=function(){return this.obj.firstChild},"undefined"!=typeof n.enabled&&0==window.dhx4.s2b(n.enabled)&&this.disableItem(),this},dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled,this.imgEn=null!=n.img?n.img:"",this.imgDis=null!=n.imgdis?n.imgdis:"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.pressed=null!=n.selected,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed&&(this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"),this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":""),t.base.appendChild(this.obj);var i=this;return this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){if(0!=i.state&&"none"==t.anyUsed){if(this.pressed)return void(this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over");this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className}},this.obj._doOnMouseOut=function(){if(0!=i.state&&"none"==t.anyUsed){if(this.pressed)return void(this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def");this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.className}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if((!t.checkEvent("onBeforeStateChange")||t.callEvent("onBeforeStateChange",[this.idd.replace(t.idPrefix,""),this.pressed]))&&0!=i.state&&"none"==t.anyUsed){this.pressed=!this.pressed,this.className=this.pressed?"dhx_toolbar_btn dhxtoolbar_btn_pres":this.renderAs;var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n,this.pressed)}catch(e){}return t.callEvent("onStateChange",[n,this.pressed]),!1}},this.setItemState=function(e,n){if(this.obj.pressed!=e&&(1==e?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(this.obj.pressed=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),1==n)){var i=this.obj.idd.replace(t.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](i,this.obj.pressed)}catch(o){}t.callEvent("onStateChange",[i,this.obj.pressed])}},this.getItemState=function(){return this.obj.pressed},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._sliderObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?"true"==n.enabled:!0,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.len=null!=n.length?Number(n.length):50,this.obj.innerHTML="<div class='dhxtoolbar_text'>"+(n.textMin||"")+"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>"+(n.textMax||"")+"</div>",t.base.appendChild(this.obj);var i=this;this.pen=document.createElement("DIV"),this.pen.className="dhxtoolbar_sl_pen",this.obj.appendChild(this.pen);var o=this.pen;this.label=document.createElement("DIV"),this.label.dir="ltr",this.label.className="dhx_toolbar_slider_label_"+t.conf.skin+(t.rtl?"_rtl":""),this.label.style.display="none",this.label.tip=n.toolTip||"%v",this.label._zi=window.dhx4.newId(),document.body.appendChild(this.label);var l=this.label;return this.pen.valueMin=null!=n.valueMin?Number(n.valueMin):0,this.pen.valueMax=null!=n.valueMax?Number(n.valueMax):100,this.pen.valueMin>this.pen.valueMax&&(this.pen.valueMin=this.pen.valueMax),this.pen.valueNow=null!=n.valueNow?Number(n.valueNow):this.pen.valueMax,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits=function(){this.minX=i.obj.childNodes[1].offsetLeft+2,this.maxX=i.obj.childNodes[3].offsetLeft-this.offsetWidth+1},this.pen._detectLimits(),this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX),this.style.left=this.nowX+"px",this.newNowX=this.nowX},this.pen._definePos(),this.pen.initXY=0,this.pen.allowMove=!1,this.pen[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(t){0!=i.state&&(t=t||event,this.initXY=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className="dhxtoolbar_sl_pen dhxtoolbar_over",""!=l.tip&&(l.style.visibility="hidden",l.style.display="",l.innerHTML=l.tip.replace("%v",this.valueNow),l.style.left=Math.round(window.dhx4.absLeft(this)+this.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(this)-l.offsetHeight-3+"px",l.style.visibility="",l.style.zIndex=window.dhx4.zim.reserve(l._zi)))},this.pen._doOnMouseMoveStart=function(t){if(t=t||event,o.allowMove){var e=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,n=e-o.initXY;if(!(e<window.dhx4.absLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.minX||e>window.dhx4.absLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.maxX))return o.newNowX=o.nowX+n,o.newNowX<o.minX&&(o.newNowX=o.minX),o.newNowX>o.maxX&&(o.newNowX=o.maxX),o.nowX=o.newNowX,o.style.left=o.nowX+"px",o.initXY=e,o.newValueNow=Math.round((o.valueMax-o.valueMin)*(o.newNowX-o.minX)/(o.maxX-o.minX)+o.valueMin),""!=l.tip&&(l.innerHTML=l.tip.replace(/%v/gi,o.newValueNow),l.style.left=Math.round(window.dhx4.absLeft(o)+o.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(o)-l.offsetHeight-3+"px"),t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}},this.pen._doOnMouseMoveEnd=function(){o.allowMove&&(o.className="dhxtoolbar_sl_pen",o.allowMove=!1,o.nowX=o.newNowX,o.valueNow=o.newValueNow,""!=l.tip&&(l.style.display="none",window.dhx4.zim.clear(l._zi)),t.callEvent("onValueChange",[i.obj.idd.replace(t.idPrefix,""),o.valueNow]))},window.dhx4.isIPad?(document.addEventListener("touchmove",o._doOnMouseMoveStart,!1),document.addEventListener("touchend",o._doOnMouseMoveEnd,!1)):"undefined"!=typeof window.addEventListener?(window.addEventListener("mousemove",o._doOnMouseMoveStart,!1),window.addEventListener("mouseup",o._doOnMouseMoveEnd,!1)):(document.body.attachEvent("onmousemove",o._doOnMouseMoveStart),document.body.attachEvent("onmouseup",o._doOnMouseMoveEnd)),this.enableItem=function(){this.state||(this.state=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def")},this.disableItem=function(){this.state&&(this.state=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_dis")},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setValue=function(e,n){e=Number(e),e<this.pen.valueMin&&(e=this.pen.valueMin),e>this.pen.valueMax&&(e=this.pen.valueMax),this.pen.valueNow=e,this.pen._definePos(),1==n&&t.callEvent("onValueChange",[this.obj.idd.replace(t.idPrefix,""),this.pen.valueNow])},this.getValue=function(){return this.pen.valueNow},this.setMinValue=function(t,e){t=Number(t),t>this.pen.valueMax||(this.obj.childNodes[0].innerHTML=e,this.obj.childNodes[0].style.display=e.length>0?"":"none",this.pen.valueMin=t,this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits(),this.pen._definePos())},this.setMaxValue=function(t,e){t=Number(t),t<this.pen.valueMin||(this.obj.childNodes[4].innerHTML=e,this.obj.childNodes[4].style.display=e.length>0?"":"none",this.pen.valueMax=t,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen._detectLimits(),this.pen._definePos())},this.getMinValue=function(){var t=this.obj.childNodes[0].innerHTML,e=this.pen.valueMin;return new Array(e,t)},this.getMaxValue=function(){var t=this.obj.childNodes[4].innerHTML,e=this.pen.valueMax;return new Array(e,t)},this.setItemToolTipTemplate=function(t){this.label.tip=t},this.getItemToolTipTemplate=function(){return this.label.tip},this},dhtmlXToolbarObject.prototype.unload=function(){for(this.conf.isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):"function"==typeof window.addEventListener?window.removeEventListener("mousedown",this._doOnClick,!1):document.body.detachEvent("onmousedown",this._doOnClick),this._doOnClick=null,this.clearAll(),this.objPull=null,this._xmlLoader&&(this._xmlLoader.destructor(),this._xmlLoader=null);this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);for(this.cont.removeChild(this.base),this.base=null;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="",this.cont=null,window.dhx4._enableDataLoading(this,null,null,null,"clear"),window.dhx4._eventable(this,"clear"),this.tX1=null,this.tX2=null,this.tY1=null,this.tY2=null,this.anyUsed=null,this.idPrefix=null,this.rootTypes=null,this._rtl=null,this._rtlParseBtn=null,this.setRTL=null,this._sbw=null,this._getObj=null,this._addImgObj=null,this._setItemImage=null,this._clearItemImage=null,this._setItemText=null,this._getItemText=null,this._enableItem=null,this._disableItem=null,this._xmlParser=null,this._addItemToStorage=null,this._genStr=null,this._addItem=null,this._getPosition=null,this._setPosition=null,this._getIdByPosition=null,this._separatorObject=null,this._textObject=null,this._buttonObject=null,this._buttonSelectObject=null,this._buttonInputObject=null,this._buttonTwoStateObject=null,this._sliderObject=null,this._autoDetectVisibleArea=null,this._removeItem=null,this.setAlign=null,this.setSkin=null,this.setIconsPath=null,this.setIconPath=null,this.loadXML=null,this.loadXMLString=null,this.clearAll=null,this.addSpacer=null,this.removeSpacer=null,this.getType=null,this.getTypeExt=null,this.inArray=null,this.getParentId=null,this.addButton=null,this.addText=null,this.addButtonSelect=null,this.addButtonTwoState=null,this.addSeparator=null,this.addSlider=null,this.addInput=null,this.forEachItem=null,this.showItem=null,this.hideItem=null,this.isVisible=null,this.enableItem=null,this.disableItem=null,this.isEnabled=null,this.setItemText=null,this.getItemText=null,this.setItemToolTip=null,this.getItemToolTip=null,this.setItemImage=null,this.setItemImageDis=null,this.clearItemImage=null,this.clearItemImageDis=null,this.setItemState=null,this.getItemState=null,this.setItemToolTipTemplate=null,this.getItemToolTipTemplate=null,this.setValue=null,this.getValue=null,this.setMinValue=null,this.getMinValue=null,this.setMaxValue=null,this.getMaxValue=null,this.setWidth=null,this.getWidth=null,this.getPosition=null,this.setPosition=null,this.removeItem=null,this.addListOption=null,this.removeListOption=null,this.showListOption=null,this.hideListOption=null,this.isListOptionVisible=null,this.enableListOption=null,this.disableListOption=null,this.isListOptionEnabled=null,this.setListOptionPosition=null,this.getListOptionPosition=null,this.setListOptionText=null,this.getListOptionText=null,this.setListOptionToolTip=null,this.getListOptionToolTip=null,this.setListOptionImage=null,this.getListOptionImage=null,this.clearListOptionImage=null,this.forEachListOption=null,this.getAllListOptions=null,this.setListOptionSelected=null,this.getListOptionSelected=null,this.unload=null,this.setUserData=null,this.getUserData=null,this.setMaxOpen=null,this.items=null,this.conf=null},dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){var t=window.dhx4.screenDim();this.tX1=t.left,this.tX2=t.right,this.tY1=t.top,this.tY2=t.bottom},dhtmlXToolbarObject.prototype._initObj=function(t){for(var e=0;e<t.length;e++)this._addItemToStorage(t[e]);"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._xmlToJson=function(t){var e=[],n=t.getElementsByTagName("toolbar");if(null!=n&&null!=n[0]){n=n[0];for(var i=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"],o=["id","type","enabled","disabled","action","selected","img","text"],l=0;l<n.childNodes.length;l++)if("item"==n.childNodes[l].tagName){for(var s={},a=0;a<i.length;a++){var r=n.childNodes[l].getAttribute(i[a]);null!=r&&(s[i[a]]=r)}for(var d=0;d<n.childNodes[l].childNodes.length;d++){if("item"==n.childNodes[l].childNodes[d].tagName&&"buttonSelect"==s.type){for(var h={},a=0;a<o.length;a++){var r=n.childNodes[l].childNodes[d].getAttribute(o[a]);null!=r&&(h[o[a]]=r)}var u=n.childNodes[l].childNodes[d].getElementsByTagName("itemText");null!=u&&null!=u[0]&&(h.itemText=u[0].firstChild.nodeValue);for(var c=n.childNodes[l].childNodes[d].getElementsByTagName("userdata"),a=0;a<c.length;a++){h.userdata||(h.userdata={});var p={};try{p.name=c[a].getAttribute("name")}catch(b){p.name=null}try{p.value=c[a].firstChild.nodeValue}catch(b){p.value=""}null!=p.name&&(h.userdata[p.name]=p.value)}null==s.options&&(s.options=[]),s.options.push(h)}if("userdata"==n.childNodes[l].childNodes[d].tagName){null==s.userdata&&(s.userdata={});var h={};try{h.name=n.childNodes[l].childNodes[d].getAttribute("name")}catch(b){h.name=null}try{h.value=n.childNodes[l].childNodes[d].firstChild.nodeValue}catch(b){h.value=""}null!=h.name&&(s.userdata[h.name]=h.value)}}e.push(s)}}return e},dhtmlXToolbarObject.prototype._addItemToStorage=function(t,e){var n=t.id||this._genStr(24),i=t.type||"";if("spacer"==i?this.addSpacer(this._lastId):this._lastId=n,""!=i&&null!=this["_"+i+"Object"]){if("buttonSelect"==i&&null!=t.options)for(var o=0;o<t.options.length;o++)"obj"==t.options[o].type&&(t.options[o].type="button"),"sep"==t.options[o].type&&(t.options[o].type="separator");if("slider"==i){var l={tip_template:"toolTip",value_min:"valueMin",value_max:"valueMax",value_now:"valueNow",text_min:"textMin",text_max:"textMax"};for(var s in l)null==t[l[s]]&&null!=t[s]&&(t[l[s]]=t[s])}"buttonInput"==i&&null==t.value&&null!=t.text&&(t.value=t.text),"buttonTwoState"==i&&"undefined"==typeof t.selected&&"undefined"!=typeof t.pressed&&window.dhx4.s2b(t.pressed)&&(t.selected=!0),"undefined"==typeof t.enabled&&"undefined"!=typeof t.disabled&&window.dhx4.s2b(t.disabled)&&(t.enabled=!1),null==t.imgDis&&null!=t.img_disabled&&(t.imgdis=t.img_disabled),"undefined"!=typeof t.openAll&&null!=t.openAll||"dhx_terrace"!=this.conf.skin||(t.openAll=!0),this.objPull[this.idPrefix+n]=new this["_"+i+"Object"](this,n,t),this.objPull[this.idPrefix+n].type=i,this.setPosition(n,e)}if(null!=t.userdata)for(var s in t.userdata)this.setUserData(n,s,t.userdata[s]);if(null!=t.options)for(var o=0;o<t.options.length;o++)if(null!=t.options[o].userdata)for(var s in t.options[o].userdata)this.setListOptionUserData(t.id,t.options[o].id,s,t.options[o].userdata[s])},dhtmlXToolbarObject.prototype.setSkin=function(t,e){e===!0?this.cont.className=this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/,"dhxtoolbar_icons_"+this.conf.iconSize):(this.conf.skin=t,"dhx_skyblue"==this.conf.skin&&(this.conf.sel_ofs_y=1),"dhx_web"==this.conf.skin&&(this.conf.sel_ofs_y=1,this.conf.sel_ofs_x=1),"dhx_terrace"==this.conf.skin&&(this.conf.sel_ofs_y=-1,this.conf.sel_ofs_x=0),this.cont.className="dhx_toolbar_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize);for(var n in this.objPull){var i=this.objPull[n];"slider"==i.type&&(i.pen._detectLimits(),i.pen._definePos(),i.label.className="dhx_toolbar_slider_label_"+this.conf.skin),"buttonSelect"==i.type&&(i.polygon.className="dhx_toolbar_poly_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize)}"dhx_terrace"==t&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.setAlign=function(t){this.conf.align="right"==t?"right":"left",this.base.className="right"==t?"dhxtoolbar_float_right":"dhxtoolbar_float_left",this._spacer&&(this._spacer.className="right"==t?" dhxtoolbar_float_left":" dhxtoolbar_float_right")},dhtmlXToolbarObject.prototype.setIconSize=function(t){this.conf.iconSize={18:!0,24:!0,32:!0,48:!0}[t]?t:18,this.setSkin(this.conf.skin,!0),this.callEvent("_onIconSizeChange",[this.conf.iconSize])},dhtmlXToolbarObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXToolbarObject.prototype.setUserData=function(t,e,n){t=this.idPrefix+t,null!=this.objPull[t]&&(null==this.objPull[t].userData&&(this.objPull[t].userData={}),this.objPull[t].userData[e]=n)},dhtmlXToolbarObject.prototype.getUserData=function(t,e){return t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].userData?this.objPull[t].userData[e]||null:null},dhtmlXToolbarObject.prototype._isListOptionExists=function(t,e){if(null==this.objPull[this.idPrefix+t])return!1;var n=this.objPull[this.idPrefix+t];return"buttonSelect"!=n.type?!1:null!=n._listOptions[e]},dhtmlXToolbarObject.prototype.setListOptionUserData=function(t,e,n,i){if(this._isListOptionExists(t,e)){var o=this.objPull[this.idPrefix+t]._listOptions[e];null==o.userData&&(o.userData={}),o.userData[n]=i}},dhtmlXToolbarObject.prototype.getListOptionUserData=function(t,e,n){if(!this._isListOptionExists(t,e))return null;var i=this.objPull[this.idPrefix+t]._listOptions[e];return i.userData&&i.userData[n]?i.userData[n]:null},dhtmlXToolbarObject.prototype._improveTerraceSkin=function(){null==this.conf.terrace_radius&&(this.conf.terrace_radius="3px");var t=[],e={separator:!0,text:!0},n=[this.base];null!=this._spacer&&n.push(this._spacer);for(var i=0;i<n.length;i++){t[i]=[];for(var o=0;o<n[i].childNodes.length;o++)if(null!=n[i].childNodes[o].idd&&"none"!=n[i].childNodes[o].style.display){var l=this.idPrefix+n[i].childNodes[o].idd;null!=this.objPull[l]&&this.objPull[l].obj==n[i].childNodes[o]&&t[i].push({a:l,type:this.objPull[l].type,node:this.objPull[l]["buttonSelect"==this.objPull[l].type?"arw":"obj"]})}n[i]=null}for(var i=0;i<t.length;i++)for(var o=0;o<t[i].length;o++){var s=t[i][o],a=!1,r=!1;e[s.type]||((o==t[i].length-1||null!=t[i][o+1]&&e[t[i][o+1].type])&&(a=!0),(0==o||o-1>=0&&null!=t[i][o-1]&&e[t[i][o-1].type])&&(r=!0)),s.node.style.borderRightWidth=a?"1px":"0px",s.node.style.borderTopRightRadius=s.node.style.borderBottomRightRadius=a?this.conf.terrace_radius:"0px","buttonSelect"==s.type?(s.node.previousSibling.style.borderTopLeftRadius=s.node.previousSibling.style.borderBottomLeftRadius=r?this.conf.terrace_radius:"0px",s.node.previousSibling._br=a,s.node.previousSibling._bl=r):s.node.style.borderTopLeftRadius=s.node.style.borderBottomLeftRadius=r?this.conf.terrace_radius:"0px",s.node._br=a,s.node._bl=r}for(var i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++){for(var l in t[i][o])t[i][o][l]=null;t[i][o]=null}t[i]=null}t=n=null},dhtmlXToolbarObject.prototype._improveTerraceButtonSelect=function(t,e){var n=this.objPull[t];1==e?(n.obj.style.borderBottomLeftRadius=n.obj._bl?this.conf.terrace_radius:"0px",n.arw.style.borderBottomRightRadius=n.obj._br?this.conf.terrace_radius:"0px"):(n.obj.style.borderBottomLeftRadius="0px",n.arw.style.borderBottomRightRadius="0px"),n=null},"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_toolbar=function(t,e,n,i,o){return"undefined"!=typeof o?t=o:(t=document.createElement("DIV"),t.className="dhx_cell_toolbar_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV")),t.firstChild.className="dhx_toolbar_base_18_dhx_skyblue"),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.cont]),this.conf.ofs_nodes.t.toolbar=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachToolbar=function(t){return null==this.dataNodes.ribbon&&null==this.dataNodes.toolbar?(this.callEvent("_onBeforeContentAttach",["toolbar"]),"undefined"==typeof t?t={}:"string"==typeof t&&(t={skin:t}),"undefined"==typeof t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("toolbar").firstChild,this.dataNodes.toolbar=new dhtmlXToolbarObject(t),this._adjustCont(this._idd),this.dataNodes.toolbar._masterCell=this,this.dataNodes.toolbar.attachEvent("_onIconSizeChange",function(){this._masterCell._adjustCont()}),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.toolbar):void 0},dhtmlXCellObject.prototype.detachToolbar=function(){this.dataNodes.toolbar&&(this.dataNodes.toolbar._masterCell=null,this.dataNodes.toolbar.unload(),this.dataNodes.toolbar=null,delete this.dataNodes.toolbar,this._detachObject("toolbar"))},dhtmlXCellObject.prototype.showToolbar=function(){this._mtbShowHide("toolbar","")},dhtmlXCellObject.prototype.hideToolbar=function(){this._mtbShowHide("toolbar","none")},dhtmlXCellObject.prototype.getAttachedToolbar=function(){return this.dataNodes.toolbar}),module.exports=dhtmlXToolbarObject;
},{}],5:[function(require,module,exports){
function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlxEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}function dhtmlXMenuObject(t,e){var i=this;if(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"dhx_skyblue",mode:"web",align:"left",is_touched:!1,selected:-1,last_click:-1,fixed_pos:!1,rtl:!1,icons_path:"",arrow_ff_fix:navigator.userAgent.indexOf("MSIE")>=0&&"BackCompat"==document.compatMode,live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:!0,top_tmtime:200,v_enabled:!1,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:!1,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,of_ah:{dhx_skyblue:24,dhx_web:25,dhx_terrace:27},of_ih:{dhx_skyblue:24,dhx_web:24,dhx_terrace:24},tm_sec:400,tm_handler:null,dload:!1,dload_url:"",dload_icon:!1,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:!1,ctx_zoneid:!1,ctx_autoshow:!0,ctx_autohide:!0,ctx_hideall:!0,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]},"object"==typeof t&&null!=t&&"undefined"==typeof t.tagName){null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.skin&&(this.conf.skin=t.skin),t.visible_area&&(this.conf.v_enabled=!0,this.conf.v={x1:t.visible_area.x1,x2:t.visible_area.x2,y1:t.visible_area.y1,y2:t.visible_area.y2});for(var l in{json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1})null!=t[l]&&(this.conf.autoload[l]=t[l]);t=t.parent}if(null==t)this.base=document.body;else{var n="string"==typeof t?document.getElementById(t):t;null!=n?(this.base=n,this.base.id||(this.base.id=(new Date).valueOf()),this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left",this.base._autoSkinUpdate=!0,this.base.oncontextmenu&&(this.base._oldContextMenuHandler=this.base.oncontextmenu),this.conf.ctx_baseid=this.base.id,this.base.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}):this.base=document.body}this.idPrefix="",this.topId="dhxWebMenuTopId",this.idPull={},this.itemPull={},this.userData={},this.radio={},this.setSkin=function(t){var e=this.conf.skin;switch(this.conf.skin=t,this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2,this.conf.tl_rmarg=1,this.conf.tl_ofsleft=1;break;case"dhx_terrace":this.conf.tl_botmarg=0,this.conf.tl_rmarg=0,this.conf.tl_ofsleft=0}this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+e+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle");for(var i in this.idPull)this.idPull[i].className=String(this.idPull[i].className).replace(e,this.conf.skin)},this.setSkin(this.conf.skin),this._addSubItemToSelected=function(t,e){for(var i=!0,l=0;l<this.conf.selected_sub.length;l++)this.conf.selected_sub[l][0]==t&&this.conf.selected_sub[l][1]==e&&(i=!1);return 1==i&&this.conf.selected_sub.push(new Array(t,e)),i},this._removeSubItemFromSelected=function(t,e){for(var i=new Array,l=!1,n=0;n<this.conf.selected_sub.length;n++)this.conf.selected_sub[n][0]==t&&this.conf.selected_sub[n][1]==e?l=!0:i[i.length]=this.conf.selected_sub[n];return 1==l&&(this.conf.selected_sub=i),l},this._getSubItemToDeselectByPolygon=function(t){for(var e=new Array,i=0;i<this.conf.selected_sub.length;i++)if(this.conf.selected_sub[i][1]==t){e[e.length]=this.conf.selected_sub[i][0],e=e.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[i][0]));for(var l=!0,n=0;n<this.conf.opened_poly.length;n++)this.conf.opened_poly[n]==this.conf.selected_sub[i][0]&&(l=!1);1==l&&(this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[i][0]),this.conf.selected_sub[i][0]=-1,this.conf.selected_sub[i][1]=-1}return e},this._hidePolygon=function(t){if(null!=this.idPull["polygon_"+t]){if(null!=this.idPull["polygon_"+t]._zId&&window.dhx4.zim.clear(this.idPull["polygon_"+t]._zId),"undefined"!=typeof this._menuEffect&&this._menuEffect!==!1)this._hidePolygonEffect("polygon_"+t);else{if("none"==this.idPull["polygon_"+t].style.display)return;this.idPull["polygon_"+t].style.display="none",null!=this.idPull["arrowup_"+t]&&(this.idPull["arrowup_"+t].style.display="none"),null!=this.idPull["arrowdown_"+t]&&(this.idPull["arrowdown_"+t].style.display="none"),this._updateItemComplexState(t,!0,!1),window.dhx4.isIE6&&null!=this.idPull["polygon_"+t+"_ie6cover"]&&(this.idPull["polygon_"+t+"_ie6cover"].style.display="none")}t=String(t).replace(this.idPrefix,""),t==this.topId&&(t=null),this.callEvent("onHide",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!0)}},this._showPolygon=function(t,e){var i=this._countVisiblePolygonItems(t);if(0!=i){var l="polygon_"+t;if(null!=this.idPull[l]&&null!=this.idPull[t]){if(this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&!this.idPull[t]._mouseOver&&e==this.conf.dir_toplv)return;this.conf.fixed_pos||this._autoDetectVisibleArea();var n=0,o=0,d=null,s=null;if(null==this.idPull[l]._zId&&(this.idPull[l]._zId=window.dhx4.newId()),this.idPull[l]._zInd=window.dhx4.zim.reserve(this.idPull[l]._zId),this.idPull[l].style.visibility="hidden",this.idPull[l].style.left="0px",this.idPull[l].style.top="0px",this.idPull[l].style.display="",this.idPull[l].style.zIndex=this.idPull[l]._zInd,this.conf.auto_overflow)if(this.idPull[l].childNodes[1].childNodes[0].offsetHeight>this.conf.v.y1+this.conf.v.y2){var r=Math.floor((this.conf.v.y2-this.conf.v.y1-2*this.conf.of_ah[this.conf.skin])/this.conf.of_ih[this.conf.skin]);this.conf.overflow_limit=r}else this.conf.overflow_limit=0,null!=this.idPull["arrowup_"+t]&&this._removeUpArrow(String(t).replace(this.idPrefix,"")),null!=this.idPull["arrowdown_"+t]&&this._removeDownArrow(String(t).replace(this.idPrefix,""));if(this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(null==this.idPull["arrowup_"+t]&&this._addUpArrow(String(t).replace(this.idPrefix,"")),null==this.idPull["arrowdown_"+t]&&this._addDownArrow(String(t).replace(this.idPrefix,"")),d=this.idPull["arrowup_"+t],d.style.display="none",s=this.idPull["arrowdown_"+t],s.style.display="none"),this.conf.overflow_limit>0&&(this.conf.overflow_limit<i?(this.idPull[l].childNodes[1].style.height=24*this.conf.overflow_limit+"px",d.style.width=s.style.width=this.idPull[l].childNodes[1].style.width=this.idPull[l].childNodes[1].childNodes[0].offsetWidth+"px",this.idPull[l].childNodes[1].scrollTop=0,d.style.display="",n=d.offsetHeight,s.style.display="",o=s.offsetHeight):(this.idPull[l].childNodes[1].style.height="",this.idPull[l].childNodes[1].style.width="")),null!=this.itemPull[t]){"polygon_"+this.itemPull[t].parent}else if(this.conf.context){this.idPull[this.idPrefix+this.topId]}var a=null!=this.idPull[t].tagName?window.dhx4.absLeft(this.idPull[t]):this.idPull[t][0],h=null!=this.idPull[t].tagName?window.dhx4.absTop(this.idPull[t]):this.idPull[t][1],u=null!=this.idPull[t].tagName?this.idPull[t].offsetWidth:0,c=null!=this.idPull[t].tagName?this.idPull[t].offsetHeight:0,f=0,m=0,p=this.idPull[l].offsetWidth,_=this.idPull[l].childNodes[1].offsetHeight+n+o;if("bottom"==e&&(f=this.conf.rtl?a+(null!=u?u:0)-p:"right"==this.conf.align?a+u-p:a-1+(e==this.conf.dir_toplv?this.conf.tl_rmarg:0),m=h-1+c+this.conf.tl_botmarg),"right"==e&&(f=a+u-1,m=h+2),"left"==e&&(f=a-this.idPull[l].offsetWidth+2,m=h+2),"top"==e&&(f=a-1,m=h-_+2),this.conf.fixed_pos)var g=65536,x=65536;else{var g=null!=this.conf.v.x2?this.conf.v.x2:0,x=null!=this.conf.v.y2?this.conf.v.y2:0;0==g&&(window.innerWidth?(g=window.innerWidth,x=window.innerHeight):(g=document.body.offsetWidth,x=document.body.scrollHeight))}if(f+p>g&&!this.conf.rtl&&(f=a-p+2),f<this.conf.v.x1&&this.conf.rtl&&(f=a+u-2),0>f&&(f=0),m+_>x&&null!=this.conf.v.y2&&(m=Math.max(h+c-_+2,this.conf.v_enabled?this.conf.v.y1+2:2),this.conf.context&&this.idPrefix+this.topId==t&&null!=s&&(m-=2),null==this.itemPull[t]||this.conf.context||this.itemPull[t].parent==this.idPrefix+this.topId&&(m-=this.base.offsetHeight)),this.idPull[l].style.left=f+"px",this.idPull[l].style.top=m+"px","undefined"!=typeof this._menuEffect&&this._menuEffect!==!1)this._showPolygonEffect(l);else if(this.idPull[l].style.visibility="",this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(this.idPull[l].childNodes[1].scrollTop=0,this._checkArrowsState(t)),window.dhx4.isIE6){var v=l+"_ie6cover";if(null==this.idPull[v]){var P=document.createElement("IFRAME");P.className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin,P.frameBorder=0,P.setAttribute("src","javascript:false;"),document.body.insertBefore(P,document.body.firstChild),this.idPull[v]=P}this.idPull[v].style.left=f+"px",this.idPull[v].style.top=m+"px",this.idPull[v].style.width=this.idPull[l].offsetWidth+"px",this.idPull[v].style.height=this.idPull[l].offsetHeight+"px",this.idPull[v].style.zIndex=this.idPull[l].style.zIndex-1,this.idPull[v].style.display=""}t=String(t).replace(this.idPrefix,""),t==this.topId&&(t=null),this.callEvent("onShow",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!1)}}},this._redistribSubLevelSelection=function(t,e){for(;this.conf.opened_poly.length>0;)this.conf.opened_poly.pop();var i=this._getSubItemToDeselectByPolygon(e);this._removeSubItemFromSelected(-1,-1);for(var l=0;l<i.length;l++)null!=this.idPull[i[l]]&&i[l]!=t&&"enabled"==this.itemPull[i[l]].state&&(this.idPull[i[l]].className="sub_item");for(var l=0;l<this.conf.opened_poly.length;l++)this.conf.opened_poly[l]!=e&&this._hidePolygon(this.conf.opened_poly[l]);if("enabled"==this.itemPull[t].state){if(this.idPull[t].className="sub_item_selected",this.itemPull[t].complex&&this.conf.dload&&"no"==this.itemPull[t].loaded){1==this.conf.dload_icon&&this._updateLoaderIcon(t,!0),this.itemPull[t].loaded="get";var n=t.replace(this.idPrefix,"");this._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=n;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)}(this.itemPull[t].complex||this.conf.dload&&"yes"==this.itemPull[t].loaded)&&this.itemPull[t].complex&&null!=this.idPull["polygon_"+t]&&(this._updateItemComplexState(t,!0,!0),this._showPolygon(t,this.conf.dir_sublv)),this._addSubItemToSelected(t,e),this.conf.selected=t}},this._doOnClick=function(t,e,i){if(this.conf.last_click=t,null!=this.itemPull[this.idPrefix+t].href_link&&"enabled"==this.itemPull[this.idPrefix+t].state){var l=document.createElement("FORM"),n=String(this.itemPull[this.idPrefix+t].href_link).split("?");if(l.action=n[0],null!=n[1])for(var o=String(n[1]).split("&"),d=0;d<o.length;d++){var s=String(o[d]).split("="),r=document.createElement("INPUT");r.type="hidden",r.name=s[0]||"",r.value=s[1]||"",l.appendChild(r)}return null!=this.itemPull[this.idPrefix+t].href_target&&(l.target=this.itemPull[this.idPrefix+t].href_target),l.style.display="none",document.body.appendChild(l),l.submit(),void(null!=l&&(document.body.removeChild(l),l=null))}if("c"!=e.charAt(0)&&"d"!=e.charAt(1)&&"s"!=e.charAt(2)){if(this.checkEvent("onClick"))this.callEvent("onClick",[t,this.conf.ctx_zoneid,i]);else if("d"==e.charAt(1)||"win"==this.conf.mode&&"t"==e.charAt(2))return;this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide?this._hideContextMenu():this._clearAndHide&&this._clearAndHide()}},this._doOnTouchMenu=function(t){0==this.conf.is_touched&&(this.conf.is_touched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[t]))},this._searchMenuNode=function(t,e){for(var i=new Array,l=0;l<e.length;l++)if("object"==typeof e[l]){5==e[l].length&&"object"!=typeof e[l][0]&&e[l][0].replace(this.idPrefix,"")==t&&0==l&&(i=e);var n=this._searchMenuNode(t,e[l]);n.length>0&&(i=n)}return i},this._getMenuNodes=function(t){var e=new Array;for(var i in this.itemPull)this.itemPull[i].parent==t&&(e[e.length]=i);return e},this._genStr=function(t){for(var e="",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",l=0;t>l;l++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.getItemType=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:this.itemPull[t].type},this.forEachItem=function(t){for(var e in this.itemPull)t(String(e).replace(this.idPrefix,""))},this._clearAndHide=function(){for(i.conf.selected=-1,i.conf.last_click=-1;i.conf.opened_poly.length>0;)i.conf.opened_poly.pop();for(var t=0;t<i.conf.selected_sub.length;t++){var e=i.conf.selected_sub[t][0];null!=i.idPull[e]&&"enabled"==i.itemPull[e].state&&("sub_item_selected"==i.idPull[e].className&&(i.idPull[e].className="sub_item"),i.idPull[e].className=="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected"&&(null!=i.itemPull[e].cssNormal?i.idPull[e].className=i.itemPull[e].cssNormal:i.idPull[e].className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal")),i._hidePolygon(e)}i.conf.is_touched=!1,i.conf.context&&i.conf.ctx_hideall&&i._hidePolygon(i.idPrefix+i.topId)},this._showSubLevelItem=function(t,e){null!=document.getElementById("arrow_"+this.idPrefix+t)&&(document.getElementById("arrow_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById("image_"+this.idPrefix+t)&&(document.getElementById("image_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById(this.idPrefix+t)&&(document.getElementById(this.idPrefix+t).style.display=e?"":"none")},this._hideSubLevelItem=function(t){this._showSubLevelItem(t,!0)},this.idPrefix=this._genStr(12)+"_",this._bodyClick=function(t){t=t||event,2==t.button||window.dhx4.isOpera&&1==t.ctrlKey||(i.conf.context?i.conf.ctx_autohide&&(!window.dhx4.isOpera||i._isContextMenuVisible()&&window.dhx4.isOpera)&&i._hideContextMenu():i._clearAndHide&&i._clearAndHide())},this._bodyContext=function(t){t=t||event;var e=String((t.srcElement||t.target).className);if(-1==e.search("dhtmlxMenu")||-1==e.search("SubLevelArea")){for(var l=!0,n=t.target||t.srcElement;null!=n;)null!=n.id&&i.isContextZone(n.id)&&(l=!1),n==document.body&&(l=!1),n=n.parentNode;l&&i.hideContextMenu()}},"undefined"!=typeof window.addEventListener?(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1)):(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)),this.unload=function(){window.dhx4._eventable(this,"clear"),dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(t){}if(this.conf.live_id=null,"function"==typeof window.addEventListener?(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1)):(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)),this._bodyClick=null,this._bodyContext=null,this.removeItem(this.idPrefix+this.topId,!0),this.itemPull=null,this.idPull=null,this.conf.context)for(var e in this.conf.ctx_zones)this.removeContextZone(e);null!=this.cont&&(this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null),null!=this.base&&(this.conf.context||(this.base.className=""),this.conf.context||(this.base.oncontextmenu=this.base._oldContextMenuHandler||null),this.base.onselectstart=null,this.base=null);for(var e in this)this[e]=null;i=null},dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this,window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:!0}),window.dhx4._eventable(this),1==window.dhx4.s2b(this.conf.autoload.context)&&this.renderAsContextMenu(),null!=this.conf.autoload.dynamic?this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon)):null!=this.conf.autoload.items?this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload):null!=this.conf.autoload.json?this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload):null!=this.conf.autoload.xml&&this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload);for(var l in{onclick:1,oncheckboxclick:1,onradioclick:1})null!=this.conf.autoload[l]&&("function"==typeof this.conf.autoload[l]?this.attachEvent(l,this.conf.autoload[l]):"function"==typeof window[this.conf.autoload[l]]&&this.attachEvent(l,window[this.conf.autoload[l]]));null!=this.conf.autoload.top_text&&this.setTopText(this.conf.autoload.top_text),null!=this.conf.autoload.align&&this.setAlign(this.conf.autoload.align),null!=this.conf.autoload.open_mode&&this.setOpenMode(this.conf.autoload.open_mode),null!=this.conf.autoload.overflow&&this.setOverflowHeight(this.conf.autoload.overflow);for(var l in this.conf.autoload)this.conf.autoload[l]=null,delete this.conf.autoload[l];return this.conf.autoload=null,this}"undefined"==typeof window.dhx4&&(window.dhx4={version:"4.2.1",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var i=document.createElement("DIV");i.className=t,null!=document.body.firstChild?document.body.insertBefore(i,document.body.firstChild):document.body.appendChild(i);var l=i[e||"offsetWidth"];return i.parentNode.removeChild(i),i=null,l},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(e){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),i=document.body,l=document.documentElement,n=window.pageYOffset||l.scrollTop||i.scrollTop,o=window.pageXOffset||l.scrollLeft||i.scrollLeft,d=l.clientTop||i.clientTop||0,s=l.clientLeft||i.clientLeft||0,r=e.top+n-d,a=e.left+o-s;return{top:Math.round(r),left:Math.round(a)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&"undefined"==typeof t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var i in t)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i]}else for(var e=[],i=0;i<t.length;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,i){t="string"==typeof t?document.getElementById(t):t;var l=t.value.length;if(e=Math.max(Math.min(e,l),0),i=Math.min(i,l),t.setSelectionRange)try{t.setSelectionRange(e,i)}catch(n){}else if(t.createTextRange){var o=t.createTextRange();o.moveStart("character",e),o.moveEnd("character",i-l);try{o.select()}catch(n){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=null!=t.childNodes[i].nodeValue?t.childNodes[i].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),"undefined"==typeof window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,i){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],l=window.dhx4.trim(arguments[3]),n=null,o=[e[t]];if(l.length>0){l=l.split(":");for(var d=[],s=0;s<l.length;s++)s>0&&null!=d[d.length-1].match(/\\$/)?d[d.length-1]=d[d.length-1].replace(/\\$/,"")+":"+l[s]:d.push(l[s]);n=d[0];for(var s=1;s<d.length;s++)o.push(d[s])}return"string"==typeof n&&"function"==typeof window.dhx4.template[n]?window.dhx4.template[n].apply(window.dhx4.template,o):t.length>0&&"undefined"!=typeof e[t]?1==i?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):(t=t.toString(),null!=t.match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t):""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,i,l){var n=window.dhx4.template._parseFmt(e,i,l);return 0==n?t:window.dhx4.template._getFmtValue(t,n)},window.dhx4.template.lowercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,i){var l=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==l||4!=l.length)return!1;var n={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof i?i:".",s_bef:"string"==typeof l[1]?l[1]:"",s_aft:"string"==typeof l[3]?l[3]:""},o=l[2].split(".");null!=o[1]&&(n.d_len=o[1].length);var d=o[0].split(",");return d.length>1&&(n.i_len=d[d.length-1].length),n},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,fmt.i_len!==!1){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(fmt.d_len!==!1){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),"undefined"==typeof window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,i){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var l=function(t){return 1==String(t).length?"0"+String(t):t},n=function(e){switch(e){case"%d":return l(t.getDate());case"%j":return t.getDate();case"%D":return i.dayShortName[t.getDay()];case"%l":return i.dayFullName[t.getDay()];case"%m":return l(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return i.monthShortName[t.getMonth()];case"%F":return i.monthFullName[t.getMonth()];case"%y":return l(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return l((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return l(t.getHours());case"%i":return l(t.getMinutes());case"%s":return l(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var n=t.getTimezoneOffset(),o=Math.abs(Math.floor(n/60)),d=Math.abs(n)-60*o;return(n>0?"-":"+")+l(o)+":"+l(d);default:return e}},o=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,n);return o||String(t)},window.dhx4.str2date=function(t,e,i){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var l=[],n=[];e=e.replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return n.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return n.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return n.push(t),"(\\d{1,2})";case"%Y":return n.push(t),"(\\d{4})";case"%a":return n.push(t),"([am|pm])";case"%A":return n.push(t),"([AM|PM])";case"%u":return n.push(t),"(\\d{1,6})";case"%P":return n.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var o=new RegExp(e,"i"),d=t.match(o);if(null==d||d.length-1!=n.length)return"Invalid Date";for(var s=1;s<d.length;s++)l.push(d[s]);for(var r={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},a={},h={},s=0;s<n.length;s++)if("undefined"!=typeof r[n[s]]){var u=r[n[s]];a[u]||(a[u]=[],h[u]=[]),a[u].push(l[s]),h[u].push(n[s])}l=[],n=[];for(var s=1;7>=s;s++)if(null!=a[s])for(var c=0;c<a[s].length;c++)l.push(a[s][c]),n.push(h[s][c]);var f=new Date;f.setDate(1),f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0);for(var m=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()==t)return i;return-1},s=0;s<l.length;s++)switch(n[s]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(l[s])||f[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[n[s]]](Number(l[s])+("%m"==n[s]||"%n"==n[s]?-1:0));break;case"%M":case"%F":var p=m(l[s].toLowerCase(),i[{"%M":"monthShortName","%F":"monthFullName"}[n[s]]]);p>=0&&f.setMonth(p);break;case"%y":if(!isNaN(l[s])){var _=Number(l[s]);f.setFullYear(_+(_>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(l[s])){var _=Number(l[s]);12>=_&&_>=0&&f.setHours(_+(m("pm",l)>=0?12==_?0:12:12==_?-12:0))}break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=l[s])}return f}),"undefined"==typeof window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){var e=new window.ActiveXObject("Microsoft.XMLDOM");e.async="false",e.loadXML(t)}return e},xmltop:function(t,e,i){if(("undefined"==typeof e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(l){}return-1!==i&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var i,l=[],n=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=n.iterateNext();)l.push(i);return l}try{return e.selectNodes(t)||[]}catch(o){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,i){return this._call("PUT",t,e,!0,i)},del:function(t,e,i){return this._call("DELETE",t,e,!0,i)},post:function(t,e,i){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(i=e,e=""),this._call("POST",t,e,!0,i)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,i){2==arguments.length&&(i=e,e=""),this._call("POST",t,e,!0,i,{url:t,postData:e})},_call:function(t,e,i,l,n,o,d){var s=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==l&&(s.onreadystatechange=function(){if(4==s.readyState||1==r&&3==s.readyState){if((200!=s.status||""==s.responseText)&&!dhx4.callEvent("onAjaxError",[s]))return;window.setTimeout(function(){"function"==typeof n&&n.apply(window,[{xmlDoc:s,filePath:e,async:l}]),null!=o&&("undefined"!=typeof o.postData?dhx4.ajax.postLong(o.url,o.postData,n):dhx4.ajax.getLong(o.url,n)),n=null,s=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),s.open(t,e,l),null!=d)for(var a in d)s.setRequestHeader(a,d[a]);else"POST"==t||"PUT"==t||"DELETE"==t?s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(i=null);return s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.send(i),{xmlDoc:s,filePath:e,async:l}}}),"undefined"==typeof window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,i,l,n){if("clear"==n){for(var o in t._dhxdataload)t._dhxdataload[o]=null,delete t._dhxdataload[o];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:i,xmlRootTag:l,onBeforeXLS:null},t._loadData=function(t,e,i){2==arguments.length&&(i=e,e=null);var l=null;if(3==arguments.length&&(i=arguments[2]),"string"==typeof t){var n=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,""),o=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(o.test(n.replace(/^<\?xml[^\?]*\?>\s*/,""))&&(l=dhx4.ajax.parse(t),null!=l&&(l=this[this._dhxdataload.xmlToJson].apply(this,[l]))),null!=l||null==n.match(/^\{.*\}$/)&&null==n.match(/^\[.*\]$/)||(l=dhx4.s2j(n)),null==l){this.callEvent("onXLS",[]);var d=[];if("function"==typeof this._dhxdataload.onBeforeXLS){var n=this._dhxdataload.onBeforeXLS.apply(this,[t]);if(null!=n&&"object"==typeof n&&(null!=n.url&&(t=n.url),null!=n.params))for(var s in n.params)d.push(s+"="+encodeURIComponent(n.params[s]));
}var r=this,a=function(e){var l=null;l=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?r[r._dhxdataload.xmlToJson].apply(r,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText),null!=l&&r[r._dhxdataload.initObj].apply(r,[l,t]),r.callEvent("onXLE",[]),null!=i&&("function"==typeof i?i.apply(r,[]):"function"==typeof window[i]&&window[i].apply(r,[])),a=i=null,l=e=r=null};return d=d.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,d,a):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(d.length>0?(t.indexOf("?")>0?"&":"?")+d:""),a))}}else l="object"==typeof t.documentElement||"undefined"!=typeof t.tagName&&"undefined"!=typeof t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=l&&this[this._dhxdataload.initObj].apply(this,[l]),null!=i&&("function"==typeof i?i.apply(this,[]):"function"==typeof window[i]&&window[i].apply(this,[]),i=null)},null!=n){var d={struct:"loadStruct",data:"load"};for(var o in n)1==n[o]&&(t[d[o]]=function(){return this._loadData.apply(this,arguments)})}t=null}),"undefined"==typeof window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){return"clear"==e?(t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null)):(t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var i=window.dhx4.newId();return this.dhxevs.data[t][i]=e,i},t.detachEvent=function(t){for(var e in this.dhxevs.data){var i=0;for(var l in this.dhxevs.data[e])l==t?(this.dhxevs.data[e][l]=null,delete this.dhxevs.data[e][l]):i++;0==i&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var i=!0;for(var l in this.dhxevs.data[t])i=this.dhxevs.data[t][l].apply(this,e)&&i;return i},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},void(t=null))},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&!0||!1},isValidSSN:function(t){return t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&!0||!1},isValidSIN:function(t){return t.toString().match(/^\d{9}$/)&&!0||!1}},dhtmlxValidation=new dhtmlxValidation),"undefined"==typeof window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var i in e)t[i]||(t[i]=e[i]);return t},extend_api:function(t,e,i){var l=window[t];l&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var i=l.apply(this,e._init?e._init(t):arguments);for(var n in dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(var n in t)e[n]?this[e[n]](t[n]):0===n.indexOf("on")&&this.attachEvent(n,t[n])}else var i=l.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=l.prototype,i&&dhtmlx.extend(window[t].prototype,i))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){return!t&&!window.event||2!=(t||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),t&&t.preventDefault?(t.preventDefault(),!1):!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var i=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var l=document.createElement("Div");l.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=l.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)n=t.srcElement;else var n=t.target;dragger.checkLanding(n,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,l=0;e;)i+=e.offsetLeft,l+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var n=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*n.split("_")[0],l+=1*n.split("_")[1]}if(t)return i+"_"+l;this.fx=i,this.fy=l}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var i=dragger.lastLanding;dragger.lastLanding=null,i&&i.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,i,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(i){}for(var l=0;l<window.frames.length;l++)try{window.frames[l]!=t&&window.frames[l].dhtmlDragAndDrop&&window.frames[l].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(i){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),"undefined"==typeof window.dhtmlxEvent,null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),"undefined"==typeof dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function t(){if(i){var t=document.createEvent("HTMLEvents");t.initEvent("dblclick",!0,!0),i.dispatchEvent(t),e=i=null}}var e,i,l,n;dhtmlxEvent(document.body,"touchstart",function(o){i=o.touches[0].target,l=o.touches[0].clientX,n=o.touches[0].clientY,e=window.setTimeout(t,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(t){e&&(Math.abs(t.touches[0].clientX-l)>50||Math.abs(t.touches[0].clientY-n)>50)&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent(document.body,"touchend",function(t){e&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent.initTouch=function(){}}),dhtmlXMenuObject.prototype._init=function(){1!=this._isInited&&(this.conf.dload?(this._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)):(this._initTopLevelMenu(),this._isInited=!0))},dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(t){var e=0;for(var i in this.itemPull){var l=this.itemPull[i].parent,n=this.itemPull[i].type;null!=this.idPull[i]&&(l!=t||"item"!=n&&"radio"!=n&&"checkbox"!=n||"none"==this.idPull[i].style.display||e++)}return e},dhtmlXMenuObject.prototype._redefineComplexState=function(t){if(this.idPrefix+this.topId!=t&&null!=this.idPull["polygon_"+t]&&null!=this.idPull[t]){var e=this._countVisiblePolygonItems(t);e>0&&!this.itemPull[t].complex&&this._updateItemComplexState(t,!0,!1),0==e&&this.itemPull[t].complex&&this._updateItemComplexState(t,!1,!1)}},dhtmlXMenuObject.prototype._updateItemComplexState=function(t,e,i){if(!this.conf.context&&"TopLevel"==this._getItemLevelType(t.replace(this.idPrefix,"")))return void(this.itemPull[t].complex=e);if(null!=this.idPull[t]&&null!=this.itemPull[t]&&(this.itemPull[t].complex=e,t!=this.idPrefix+this.topId)){var l=null,n=this.idPull[t].childNodes[this.conf.rtl?0:2];if(n.childNodes[0]&&0===String(n.childNodes[0].className).search("complex_arrow")&&(l=n.childNodes[0]),this.itemPull[t].complex){if(null==l){for(l=document.createElement("DIV"),l.className="complex_arrow",l.id="arrow_"+t;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.appendChild(l)}return void(this.conf.dload&&"get"==this.itemPull[t].loaded&&this.conf.dload_icon?"complex_arrow_loading"!=l.className&&(l.className="complex_arrow_loading"):l.className="complex_arrow")}this.itemPull[t].complex||null==l||(n.removeChild(l),null!=this.itemPull[t].hotkey_backup&&this.setHotKey&&this.setHotKey(t.replace(this.idPrefix,""),this.itemPull[t].hotkey_backup))}},dhtmlXMenuObject.prototype._getItemLevelType=function(t){return this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"},dhtmlXMenuObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXMenuObject.prototype._updateItemImage=function(t,e){t=this.idPrefix+t;var i=this.itemPull[t].type;if("checkbox"!=i&&"radio"!=i){var l=this.itemPull[t].parent==this.idPrefix+this.topId&&!this.conf.context,n=null;if(l)for(var o=0;o<this.idPull[t].childNodes.length;o++)try{"dhtmlxMenu_TopLevel_Item_Icon"==this.idPull[t].childNodes[o].className&&(n=this.idPull[t].childNodes[o])}catch(d){}else{try{var n=this.idPull[t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(d){}null!=n&&"undefined"!=typeof n.className&&"sub_icon"==n.className||(n=null)}var s=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(s.length>0)if(null!=n)n.src=this.conf.icons_path+s;else if(l){var n=document.createElement("IMG");n.className="dhtmlxMenu_TopLevel_Item_Icon",n.src=this.conf.icons_path+s,n.border="0",n.id="image_"+t,!this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(n,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(n)}else{var n=document.createElement("IMG");n.className="sub_icon",n.src=this.conf.icons_path+s,n.border="0",n.id="image_"+t;for(var r=this.idPull[t].childNodes[this.conf.rtl?2:0];r.childNodes.length>0;)r.removeChild(r.childNodes[0]);r.appendChild(n)}else if(null!=n){var a=n.parentNode;a.removeChild(n),a.innerHTML="&nbsp;",a=n=null}}},dhtmlXMenuObject.prototype._getAllParents=function(t){var e=new Array;for(var i in this.itemPull)if(this.itemPull[i].parent==t&&(e[e.length]=this.itemPull[i].id,this.itemPull[i].complex))for(var l=this._getAllParents(this.itemPull[i].id),n=0;n<l.length;n++)e[e.length]=l[n];return e},dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(!this.conf.v_enabled){var t=window.dhx4.screenDim();this.conf.v.x1=t.left,this.conf.v.x2=t.right,this.conf.v.y1=t.top,this.conf.v.y2=t.bottom}},dhtmlXMenuObject.prototype.getItemPosition=function(t){t=this.idPrefix+t;var e=-1;if(null==this.itemPull[t])return e;for(var i=this.itemPull[t].parent,l=null!=this.idPull["polygon_"+i]?this.idPull["polygon_"+i].tbd:this.cont,n=0;n<l.childNodes.length;n++)l.childNodes[n]!=this.idPull["separator_"+t]&&l.childNodes[n]!=this.idPull[t]||(e=n);return e},dhtmlXMenuObject.prototype.setItemPosition=function(t,e){if(t=this.idPrefix+t,null!=this.idPull[t]){var i=this.itemPull[t].parent==this.idPrefix+this.topId,l=this.idPull[t],n=this.getItemPosition(t.replace(this.idPrefix,"")),o=this.itemPull[t].parent,d=null!=this.idPull["polygon_"+o]?this.idPull["polygon_"+o].tbd:this.cont;d.removeChild(d.childNodes[n]),0>e&&(e=0),i&&1>e&&(e=1),e<d.childNodes.length?d.insertBefore(l,d.childNodes[e]):d.appendChild(l)}},dhtmlXMenuObject.prototype.getParentId=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:(null!=this.itemPull[t].parent?this.itemPull[t].parent:this.topId).replace(this.idPrefix,"")},dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()},dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0),this._isInited=!1,this.idPrefix=this._genStr(12)+"_",this.itemPull={}},"undefined"==typeof dhtmlXMenuObject.prototype.liveInst&&(dhtmlXMenuObject.prototype.liveInst={}),dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(t,e){var i=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var l=0;l<i.length;l++)i[l]!=t&&this._hidePolygon(i[l]),null!=this.idPull[i[l]]&&i[l]!=t&&(this.idPull[i[l]].className=this.idPull[i[l]].className.replace(/Selected/g,"Normal"));"enabled"==this.itemPull[this.idPrefix+t].state&&(this.idPull[this.idPrefix+t].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+t,"parent"),this.conf.selected="win"==this.conf.mode?-1!=this.conf.selected?t:this.conf.selected:t,this.itemPull[this.idPrefix+t].complex&&-1!=this.conf.selected&&this._showPolygon(this.idPrefix+t,this.conf.dir_toplv))},dhtmlXMenuObject.prototype._initTopLevelMenu=function(){if(this.conf.dir_toplv="bottom",this.conf.dir_sublv=this.conf.rtl?"left":"right",this.conf.context)this.idPull[this.idPrefix+this.topId]=new Array(0,0),this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var t=this._getMenuNodes(this.idPrefix+this.topId),e=0;e<t.length;e++)"item"==this.itemPull[t[e]].type&&this._renderToplevelItem(t[e],null),"separator"==this.itemPull[t[e]].type&&this._renderSeparator(t[e],null)},dhtmlXMenuObject.prototype._renderToplevelItem=function(t,e){var i=this,l=document.createElement("DIV");if(l.id=t,"enabled"==this.itemPull[t].state&&null!=this.itemPull[t].cssNormal?l.className=this.itemPull[t].cssNormal:l.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[t].state?"Normal":"Disabled"),""!=this.itemPull[t].title){var n=document.createElement("DIV");n.className="top_level_text",n.innerHTML=this.itemPull[t].title,l.appendChild(n)}if(this.itemPull[t].tip.length>0&&(l.title=this.itemPull[t].tip),""!=this.itemPull[t].imgen||""!=this.itemPull[t].imgdis){var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(o){var d=document.createElement("IMG");d.border="0",d.id="image_"+t,d.src=this.conf.icons_path+o,d.className="dhtmlxMenu_TopLevel_Item_Icon",l.childNodes.length>0&&!this.conf.rtl?l.insertBefore(d,l.childNodes[0]):l.appendChild(d)}}l.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},l.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.cont||(this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className="right"==this.conf.align?"align_right":"align_left",this.base.appendChild(this.cont)),null!=e&&(e++,0>e&&(e=0),e>this.cont.childNodes.length-1&&(e=null)),null!=e?this.cont.insertBefore(l,this.cont.childNodes[e]):this.cont.appendChild(l),this.idPull[l.id]=l,this.itemPull[t].complex&&!this.conf.dload&&this._addSubMenuPolygon(this.itemPull[t].id,this.itemPull[t].id),l.onmouseover=function(){"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler);var t=i._getSubItemToDeselectByPolygon("parent");i._removeSubItemFromSelected(-1,-1);for(var e=0;e<t.length;e++)t[e]!=this.id&&i._hidePolygon(t[e]),null!=i.idPull[t[e]]&&t[e]!=this.id&&(null!=i.itemPull[t[e]].cssNormal?i.idPull[t[e]].className=i.itemPull[t[e]].cssNormal:("sub_item_selected"==i.idPull[t[e]].className&&(i.idPull[t[e]].className="sub_item"),i.idPull[t[e]].className=i.idPull[t[e]].className.replace(/Selected/g,"Normal")));if("enabled"==i.itemPull[this.id].state){if(this.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected",i._addSubItemToSelected(this.id,"parent"),i.conf.selected="win"==i.conf.mode?-1!=i.conf.selected?this.id:i.conf.selected:this.id,i.conf.dload){if("no"==i.itemPull[this.id].loaded){this._dynLoadTM=(new Date).getTime(),i.itemPull[this.id].loaded="get";var l=this.id.replace(i.idPrefix,"");i._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=l;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},i.loadStruct(i.conf.dload_url)}i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!0)}if((!i.conf.dload||i.conf.dload&&(!i.itemPull[this.id].loaded||"yes"==i.itemPull[this.id].loaded))&&i.itemPull[this.id].complex&&-1!=i.conf.selected)if(i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context){this._mouseOver=!0;var n=this.id;this._menuOpenTM=window.setTimeout(function(){i._showPolygon(n,i.conf.dir_toplv)},i.conf.top_tmtime)}else i._showPolygon(this.id,i.conf.dir_toplv)}i._doOnTouchMenu(this.id.replace(i.idPrefix,""))},l.onmouseout=function(){i.itemPull[this.id].complex&&-1!=i.conf.selected||"enabled"!=i.itemPull[this.id].state||(null!=i.itemPull[this.id].cssNormal?l.className=i.itemPull[this.id].cssNormal:l.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal"),"web"==i.conf.mode&&(window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i._clearAndHide()},i.conf.tm_sec,"JavaScript")),i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!1,window.clearTimeout(this._menuOpenTM))},l.onclick=function(t){if("web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),"web"==i.conf.mode||"disabled"!=i.itemPull[this.id].state){if(t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,"win"==i.conf.mode&&i.itemPull[this.id].complex){if(i.conf.selected==this.id){i.conf.selected=-1;var e=!1}else{i.conf.selected=this.id;var e=!0}e?i._showPolygon(this.id,i.conf.dir_toplv):i._hidePolygon(this.id)}var l=i.itemPull[this.id].complex?"c":"-",n="enabled"!=i.itemPull[this.id].state?"d":"-",o={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};return i._doOnClick(this.id.replace(i.idPrefix,""),l+n+"t",o),!1}},"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addSubMenuPolygon=function(t,e){var i=(this._renderSublevelPolygon(t,e),this._getMenuNodes(e));for(l=0;l<i.length;l++)"separator"==this.itemPull[i[l]].type?this._renderSeparator(i[l],null):this._renderSublevelItem(i[l],null);if(t==e);else;for(var l=0;l<i.length;l++)this.itemPull[i[l]].complex&&this._addSubMenuPolygon(t,this.itemPull[i[l]].id)},dhtmlXMenuObject.prototype._renderSublevelPolygon=function(t,e){var i=document.createElement("DIV");i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":""),i.dir="ltr",i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},i.id="polygon_"+e,i.onclick=function(t){t=t||event,t.cancelBubble=!0},i.style.display="none",document.body.insertBefore(i,document.body.firstChild),i.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var l=document.createElement("TABLE");l.className="dhtmlxMebu_SubLevelArea_Tbl",l.cellSpacing=0,l.cellPadding=0,l.border=0;var n=document.createElement("TBODY");return l.appendChild(n),i.childNodes[1].appendChild(l),i.tbl=l,i.tbd=n,this.idPull[i.id]=i,null!=this.sxDacProc&&(this.idPull["sxDac_"+e]=new this.sxDacProc(i,i.className),window.dhx4.isIE?(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCycles))),i},dhtmlXMenuObject.prototype._renderSublevelItem=function(t,e){var i=this,l=document.createElement("TR");l.className="enabled"==this.itemPull[t].state?"sub_item":"sub_item_dis";var n=document.createElement("TD");n.className="sub_item_icon";var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(""!=o){var d=this.itemPull[t].type;if("checkbox"==d||"radio"==d){var s=document.createElement("DIV");s.id="image_"+this.itemPull[t].id,s.className="sub_icon "+o,n.appendChild(s)}if("checkbox"!=d&&"radio"!=d){var s=document.createElement("IMG");s.id="image_"+this.itemPull[t].id,s.className="sub_icon",s.src=this.conf.icons_path+o,n.appendChild(s)}}else n.innerHTML="&nbsp;";var r=document.createElement("TD");if(r.className="sub_item_text",""!=this.itemPull[t].title){var a=document.createElement("DIV");a.className="sub_item_text",a.innerHTML=this.itemPull[t].title,r.appendChild(a)}else r.innerHTML="&nbsp;";var h=document.createElement("TD");if(h.className="sub_item_hk",this.itemPull[t].complex){var u=document.createElement("DIV");u.className="complex_arrow",u.id="arrow_"+this.itemPull[t].id,h.appendChild(u)}else if(this.itemPull[t].hotkey.length>0&&!this.itemPull[t].complex){var c=document.createElement("DIV");c.className="sub_item_hk",c.innerHTML=this.itemPull[t].hotkey,h.appendChild(c)}else h.innerHTML="&nbsp;";l.appendChild(this.conf.rtl?h:n),l.appendChild(r),l.appendChild(this.conf.rtl?n:h),l.id=this.itemPull[t].id,l.parent=this.itemPull[t].parent,this.itemPull[t].tip.length>0&&(l.title=this.itemPull[t].tip),l.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},l.onmouseover=function(t){i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),this._visible||i._redistribSubLevelSelection(this.id,this.parent),this._visible=!0},l.onmouseout=function(){"web"==i.conf.mode&&(i.conf.tm_handler&&window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i&&i._clearAndHide&&i._clearAndHide()},i.conf.tm_sec,"JavaScript"));var t=this;i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),i.conf.hide_tm[this.id]=window.setTimeout(function(){t._visible=!1},50)},l.onclick=function(t){if(i.checkEvent("onClick")||!i.itemPull[this.id].complex){t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,tc=i.itemPull[this.id].complex?"c":"-",td="enabled"==i.itemPull[this.id].state?"-":"d";var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};switch(i.itemPull[this.id].type){case"checkbox":i._checkboxOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"radio":i._radioOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"item":i._doOnClick(this.id.replace(i.idPrefix,""),tc+td+"n",e)}return!1}};var f=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(e++,0>e&&(e=0),e>f.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=f.tbd.childNodes[e]?f.tbd.insertBefore(l,f.tbd.childNodes[e]):f.tbd.appendChild(l),this.idPull[l.id]=l},dhtmlXMenuObject.prototype._renderSeparator=function(t,e){var i=this.conf.context?"SubLevelArea":this.itemPull[t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";if("TopLevel"!=i||!this.conf.context){var l=this;if("TopLevel"!=i){var n=document.createElement("TR");n.className="sub_sep";var o=document.createElement("TD");o.colSpan="3",n.appendChild(o)}var d=document.createElement("DIV");if(d.id="separator_"+t,d.className="TopLevel"==i?"top_sep":"sub_sep",d.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},d.onclick=function(t){t=t||event,t.cancelBubble=!0;var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};l._doOnClick(this.id.replace("separator_"+l.idPrefix,""),"--s",e)},"TopLevel"==i){if(null!=e)e++,0>e&&(e=0),null!=this.cont.childNodes[e]?this.cont.insertBefore(d,this.cont.childNodes[e]):this.cont.appendChild(d);else{var s=this.cont.childNodes[this.cont.childNodes.length-1];-1==String(s).search("TopLevel_Text")?this.cont.appendChild(d):this.cont.insertBefore(d,s)}this.idPull[d.id]=d}else{var r=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(e++,0>e&&(e=0),e>r.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=r.tbd.childNodes[e]?r.tbd.insertBefore(n,r.tbd.childNodes[e]):r.tbd.appendChild(n),o.appendChild(d),this.idPull[d.id]=n}}},dhtmlXMenuObject.prototype.addNewSeparator=function(t,e){e=this.idPrefix+(null!=e?e:this._genStr(24));var i=this.idPrefix+this.getParentId(t);this._addItemIntoGlobalStrorage(e,i,"","separator",!1,"",""),this._renderSeparator(e,this.getItemPosition(t))},dhtmlXMenuObject.prototype._initObj=function(t,e,i){t instanceof Array||(i=t.parentId,null!=i&&0!==String(i).indexOf(this.idPrefix)&&(i=this.idPrefix+String(i)),t=t.items);for(var l=0;l<t.length;l++){"undefined"!=typeof t[l].id&&null!=t[l].id||(t[l].id=this._genStr(24)),null==t[l].text&&(t[l].text=""),0!==String(t[l].id).indexOf(this.idPrefix)&&(t[l].id=this.idPrefix+String(t[l].id));var n={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(var o in n)"undefined"==typeof t[l][o]&&(t[l][o]=n[o]);if(""==t[l].imgen&&null!=t[l].img&&(t[l].imgen=t[l].img),""==t[l].imgdis&&null!=t[l].img_disabled&&(t[l].imgdis=t[l].img_disabled),null==t[l].title&&null!=t[l].text&&(t[l].title=t[l].text),null!=t[l].href&&(null!=t[l].href.link&&(t[l].href_link=t[l].href.link),null!=t[l].href.target&&(t[l].href_target=t[l].href.target)),null!=t[l].userdata)for(var o in t[l].userdata)this.userData[t[l].id+"_"+o]=t[l].userdata[o];"undefined"!=typeof t[l].enabled&&0==window.dhx4.s2b(t[l].enabled)?t[l].state="disabled":"undefined"!=typeof t[l].disabled&&1==window.dhx4.s2b(t[l].disabled)&&(t[l].state="disabled"),"undefined"==typeof t[l].parent&&(t[l].parent=null!=i?i:this.idPrefix+this.topId),"checkbox"==t[l].type&&(t[l].checked=window.dhx4.s2b(t[l].checked),t[l].imgen=t[l].imgdis="chbx_"+(t[l].checked?"1":"0")),"radio"==t[l].type&&(t[l].checked=window.dhx4.s2b(t[l].checked),t[l].imgen=t[l].imgdis="rdbt_"+(t[l].checked?"1":"0"),"undefined"!=typeof t[l].group&&null!=t[l].group||(t[l].group=this._genStr(24)),null==this.radio[t[l].group]&&(this.radio[t[l].group]=[]),this.radio[t[l].group].push(t[l].id)),this.itemPull[t[l].id]=t[l],null!=t[l].items&&t[l].items.length>0?(this.itemPull[t[l].id].complex=!0,this._initObj(t[l].items,!0,t[l].id)):this.conf.dload&&1==t[l].complex&&(this.itemPull[t[l].id].loaded="no"),this.itemPull[t[l].id].items=null}if(e!==!0)if(1==this.conf.dload)if(null==i)this._initTopLevelMenu();else{if(this._addSubMenuPolygon(i,i),this.conf.selected==i){var d=this.itemPull[i].parent==this.idPrefix+this.topId,s=d&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv,r=!1;if(d&&this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context){var a=this.idPull[i];if(1==a._mouseOver){var h=this.conf.top_tmtime-((new Date).getTime()-a._dynLoadTM);if(h>1){var u=i,c=this;a._menuOpenTM=window.setTimeout(function(){c._showPolygon(u,s),c=u=null},h),r=!0}}}r||this._showPolygon(i,s)}this.itemPull[i].loaded="yes",1==this.conf.dload_icon&&this._updateLoaderIcon(i,!1)}else this._init()},dhtmlXMenuObject.prototype._xmlToJson=function(t,e){var i=[];if(null==e){var l=t.getElementsByTagName(this.conf.tags.root);if(null==l||null!=l&&0==l.length)return{items:[]};l=l[0]}else l=t;null!=l.getAttribute("parentId")&&(e=this.idPrefix+l.getAttribute("parentId"));
for(var n=0;n<l.childNodes.length;n++)if("undefined"!=typeof l.childNodes[n].tagName&&String(l.childNodes[n].tagName).toLowerCase()==this.conf.tags.item){var o=l.childNodes[n],d={id:this.idPrefix+(o.getAttribute("id")||this._genStr(24)),title:o.getAttribute("text")||"",imgen:o.getAttribute("img")||"",imgdis:o.getAttribute("imgdis")||"",tip:"",hotkey:"",type:o.getAttribute("type")||"item"};if(null!=o.getAttribute("cssNormal")&&(d.cssNormal=o.getAttribute("cssNormal")),"checkbox"==d.type&&(d.checked=o.getAttribute("checked")),"radio"==d.type&&(d.checked=o.getAttribute("checked"),d.group=o.getAttribute("group")),d.state="enabled",null!=o.getAttribute("enabled")&&0==window.dhx4.s2b(o.getAttribute("enabled"))?d.state="disabled":null!=o.getAttribute("disabled")&&1==window.dhx4.s2b(o.getAttribute("disabled"))&&(d.state="disabled"),d.parent=null!=e?e:this.idPrefix+this.topId,this.conf.dload)d.complex=null!=o.getAttribute("complex"),d.complex&&(d.loaded="no");else{var s=this._xmlToJson(o,d.id);d.items=s.items,d.complex=d.items.length>0}for(var r=0;r<o.childNodes.length;r++)if("undefined"!=typeof o.childNodes[r].tagName){var a=String(o.childNodes[r].tagName||"").toLowerCase();if(a==this.conf.tags.userdata){var h=o.childNodes[r];null!=h.getAttribute("name")&&(this.userData[d.id+"_"+h.getAttribute("name")]=null!=h.firstChild&&null!=h.firstChild.nodeValue?h.firstChild.nodeValue:"")}a==this.conf.tags.text_ext&&(d.title=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.tooltip&&(d.tip=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.hotkey&&(d.hotkey=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.href&&"item"==d.type&&(d.href_link=o.childNodes[r].firstChild.nodeValue,null!=o.childNodes[r].getAttribute("target")&&(d.href_target=o.childNodes[r].getAttribute("target")))}i.push(d)}var o={parentId:e,items:i};return o},dhtmlXMenuObject.prototype.enableDynamicLoading=function(t,e){this.conf.dload=!0,this.conf.dload_url=t,this.conf.dload_sign=-1==String(this.conf.dload_url).search(/\?/)?"?":"&",this.conf.dload_icon=e,this._init()},dhtmlXMenuObject.prototype._updateLoaderIcon=function(t,e){if(null!=this.idPull[t]&&!(String(this.idPull[t].className).search("TopLevel_Item")>=0)){var i=this.conf.rtl?0:2;if(this.idPull[t].childNodes[i]&&this.idPull[t].childNodes[i].childNodes[0]){var l=this.idPull[t].childNodes[i].childNodes[0];0===String(l.className).search("complex_arrow")&&(l.className="complex_arrow"+(e?"_loading":""))}}},dhtmlXMenuObject.prototype.addNewSibling=function(t,e,i,l,n,o){var d=this.idPrefix+(null!=e?e:this._genStr(24)),s=this.idPrefix+(null!=t?this.getParentId(t):this.topId);this._addItemIntoGlobalStrorage(d,s,i,"item",l,n,o),s!=this.idPrefix+this.topId||this.conf.context?this._renderSublevelItem(d,this.getItemPosition(t)):this._renderToplevelItem(d,this.getItemPosition(t))},dhtmlXMenuObject.prototype.addNewChild=function(t,e,i,l,n,o,d){if(null==t){if(!this.conf.context)return this.addNewSibling(t,i,l,n,o,d),void(null!=e&&this.setItemPosition(i,e));t=this.topId}i=this.idPrefix+(null!=i?i:this._genStr(24)),this.setHotKey&&this.setHotKey(t,""),t=this.idPrefix+t,this._addItemIntoGlobalStrorage(i,t,l,"item",n,o,d),null==this.idPull["polygon_"+t]&&this._renderSublevelPolygon(t,t),this._renderSublevelItem(i,e-1),this._redefineComplexState(t)},dhtmlXMenuObject.prototype.removeItem=function(t,e,i){e||(t=this.idPrefix+t);var l=null;if(t!=this.idPrefix+this.topId){if(null==this.itemPull[t])return;this.idPull["polygon_"+t]&&this.idPull["polygon_"+t]._tmShow&&window.clearTimeout(this.idPull["polygon_"+t]._tmShow);var n=this.itemPull[t].type;if("separator"==n){var o=this.idPull["separator_"+t];this.itemPull[t].parent==this.idPrefix+this.topId?(o.onclick=null,o.onselectstart=null,o.id=null,o.parentNode.removeChild(o)):(o.childNodes[0].childNodes[0].onclick=null,o.childNodes[0].childNodes[0].onselectstart=null,o.childNodes[0].childNodes[0].id=null,o.childNodes[0].removeChild(o.childNodes[0].childNodes[0]),o.removeChild(o.childNodes[0]),o.parentNode.removeChild(o)),this.idPull["separator_"+t]=null,this.itemPull[t]=null,delete this.idPull["separator_"+t],delete this.itemPull[t],o=null}else{l=this.itemPull[t].parent;var o=this.idPull[t];for(o.onclick=null,o.oncontextmenu=null,o.onmouseover=null,o.onmouseout=null,o.onselectstart=null,o.id=null;o.childNodes.length>0;)o.removeChild(o.childNodes[0]);o.parentNode.removeChild(o),this.idPull[t]=null,this.itemPull[t]=null,delete this.idPull[t],delete this.itemPull[t],o=null}n=null}for(var d in this.itemPull)this.itemPull[d].parent==t&&this.removeItem(d,!0,!0);var s=new Array(t);null==l||i||null!=this.idPull["polygon_"+l]&&0==this.idPull["polygon_"+l].tbd.childNodes.length&&(s.push(l),this._updateItemComplexState(l,!1,!1));for(var r=0;r<s.length;r++)if(this.idPull["polygon_"+s[r]]){var a=this.idPull["polygon_"+s[r]];if(a.onclick=null,a.oncontextmenu=null,a.tbl.removeChild(a.tbd),a.tbd=null,a.childNodes[1].removeChild(a.tbl),a.tbl=null,a.id=null,a.parentNode.removeChild(a),a=null,window.dhx4.isIE6){var h="polygon_"+s[r]+"_ie6cover";null!=this.idPull[h]&&(document.body.removeChild(this.idPull[h]),delete this.idPull[h])}null!=this.idPull["arrowup_"+t]&&this._removeArrow&&this._removeArrow("arrowup_"+t),null!=this.idPull["arrowdown_"+t]&&this._removeArrow&&this._removeArrow("arrowdown_"+t),this.idPull["polygon_"+s[r]]=null,delete this.idPull["polygon_"+s[r]]}s=null,"dhx_terrace"==this.conf.skin&&1==arguments.length&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(t,e,i,l,n,o,d){var s={id:t,title:i,imgen:null!=o?o:"",imgdis:null!=d?d:"",type:l,state:1==n?"disabled":"enabled",parent:e,complex:!1,hotkey:"",tip:""};this.itemPull[s.id]=s},dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=!0,1==this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle",""),this.base._autoSkinUpdate=!1),null!=this.conf.ctx_baseid&&this.addContextZone(this.conf.ctx_baseid)},dhtmlXMenuObject.prototype.addContextZone=function(t){if(t==document.body){t="document.body."+this.idPrefix;var e=document.body}else if("string"==typeof t)var e=document.getElementById(t);else var e=t;var i=!1;for(var l in this.conf.ctx_zones)i=i||l==t||this.conf.ctx_zones[l]==e;if(1==i)return!1;this.conf.ctx_zones[t]=e;var n=this;window.dhx4.isOpera?(this.operaContext=function(t){n._doOnContextMenuOpera(t,n)},e.addEventListener("mouseup",this.operaContext,!1)):(null==e.oncontextmenu||e._oldContextMenuHandler||(e._oldContextMenuHandler=e.oncontextmenu),e.oncontextmenu=function(t){for(var e in dhtmlXMenuObject.prototype.liveInst)e!=n.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[e].context&&dhtmlXMenuObject.prototype.liveInst[e]._hideContextMenu();return t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,n._doOnContextBeforeCall(t,this),!1})},dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(t,e){for(var i in dhtmlXMenuObject.prototype.liveInst)i!=e.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[i].context&&dhtmlXMenuObject.prototype.liveInst[i]._hideContextMenu();return t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,0==t.button&&1==t.ctrlKey&&e._doOnContextBeforeCall(t,this),!1},dhtmlXMenuObject.prototype.removeContextZone=function(t){if(!this.isContextZone(t))return!1;t==document.body&&(t="document.body."+this.idPrefix);var e=this.conf.ctx_zones[t];window.dhx4.isOpera?e.removeEventListener("mouseup",this.operaContext,!1):(e.oncontextmenu=null!=e._oldContextMenuHandler?e._oldContextMenuHandler:null,e._oldContextMenuHandler=null);try{this.conf.ctx_zones[t]=null,delete this.conf.ctx_zones[t]}catch(i){}return!0},dhtmlXMenuObject.prototype.isContextZone=function(t){if(t==document.body&&null!=this.conf.ctx_zones["document.body."+this.idPrefix])return!0;var e=!1;return null!=this.conf.ctx_zones[t]&&this.conf.ctx_zones[t]==document.getElementById(t)&&(e=!0),e},dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return null==this.idPull["polygon_"+this.idPrefix+this.topId]?!1:""==this.idPull["polygon_"+this.idPrefix+this.topId].style.display},dhtmlXMenuObject.prototype._showContextMenu=function(t,e,i){return this._clearAndHide(),null==this.idPull["polygon_"+this.idPrefix+this.topId]?!1:(window.clearTimeout(this.conf.tm_handler),this.idPull[this.idPrefix+this.topId]=new Array(t,e),this._showPolygon(this.idPrefix+this.topId,"bottom"),void this.callEvent("onContextMenu",[i]))},dhtmlXMenuObject.prototype._hideContextMenu=function(){return null==this.idPull["polygon_"+this.idPrefix+this.topId]?!1:(this._clearAndHide(),void this._hidePolygon(this.idPrefix+this.topId))},dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(t,e){this.conf.ctx_zoneid=e.id,this._clearAndHide(),this._hideContextMenu();var i=t.srcElement||t.target,l=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetX:t.layerX,n=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetY:t.layerY,o=window.dhx4.absLeft(i)+l,d=window.dhx4.absTop(i)+n;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[e.id,t])&&this.conf.ctx_autoshow&&(this._showContextMenu(o,d,e.id),this.callEvent("onAfterContextMenu",[e.id,t])):this.conf.ctx_autoshow&&(this._showContextMenu(o,d,e.id),this.callEvent("onAfterContextMenu",[e.id]))},dhtmlXMenuObject.prototype.showContextMenu=function(t,e){this._showContextMenu(t,e,!1)},dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()},dhtmlXMenuObject.prototype.setAutoShowMode=function(t){this.conf.ctx_autoshow=1==t},dhtmlXMenuObject.prototype.setAutoHideMode=function(t){this.conf.ctx_autohide=1==t},dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(t){this.conf.ctx_hideall=1==t},dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall},dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var t in this.itemPull)if(this.itemPull[t].parent==this.idPrefix+this.topId&&null!=this.idPull[t]){var e=!1,i=!1;this.idPull[t].parentNode.firstChild==this.idPull[t]&&(e=!0),this.idPull[t].parentNode.lastChild==this.idPull[t]&&(i=!0);for(var l in this.itemPull)"separator"==this.itemPull[l].type&&this.itemPull[l].parent==this.idPrefix+this.topId&&(this.idPull[t].nextSibling==this.idPull["separator_"+l]&&(i=!0),this.idPull[t].previousSibling==this.idPull["separator_"+l]&&(e=!0));this.idPull[t].style.borderLeftWidth=e?"1px":"0px",this.idPull[t].style.borderTopLeftRadius=this.idPull[t].style.borderBottomLeftRadius=e?"3px":"0px",this.idPull[t].style.borderTopRightRadius=this.idPull[t].style.borderBottomRightRadius=i?"3px":"0px",this.idPull[t]._bl=e,this.idPull[t]._br=i}},dhtmlXMenuObject.prototype._improveTerraceButton=function(t,e){e?(this.idPull[t].style.borderBottomLeftRadius=this.idPull[t]._bl?"3px":"0px",this.idPull[t].style.borderBottomRightRadius=this.idPull[t]._br?"3px":"0px"):(this.idPull[t].style.borderBottomLeftRadius="0px",this.idPull[t].style.borderBottomRightRadius="0px")},"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_menu=function(t,e,i,l,n){return"undefined"!=typeof n?t=n:(t=document.createElement("DIV"),t.className="dhx_cell_menu_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV"))),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont]),this.conf.ofs_nodes.t.menu=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachMenu=function(t){return this.dataNodes.menu?void 0:(this.callEvent("_onBeforeContentAttach",["menu"]),"undefined"==typeof t&&(t={}),"undefined"==typeof t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("menu").firstChild,this.dataNodes.menu=new dhtmlXMenuObject(t),this._adjustCont(this._idd),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.menu)},dhtmlXCellObject.prototype.detachMenu=function(){this.dataNodes.menu&&(this.dataNodes.menu.unload(),this.dataNodes.menu=null,delete this.dataNodes.menu,this._detachObject("menu"))},dhtmlXCellObject.prototype.showMenu=function(){this._mtbShowHide("menu","")},dhtmlXCellObject.prototype.hideMenu=function(){this._mtbShowHide("menu","none")},dhtmlXCellObject.prototype.getAttachedMenu=function(){return this.dataNodes.menu}),dhtmlXMenuObject.prototype.setItemEnabled=function(t){this._changeItemState(t,"enabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.setItemDisabled=function(t){this._changeItemState(t,"disabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.isItemEnabled=function(t){return null!=this.itemPull[this.idPrefix+t]?"enabled"==this.itemPull[this.idPrefix+t].state:!1},dhtmlXMenuObject.prototype._changeItemState=function(t,e,i){var l=!1,n=this.idPrefix+t;return null!=this.itemPull[n]&&null!=this.idPull[n]&&this.itemPull[n].state!=e&&(this.itemPull[n].state=e,this.itemPull[n].parent!=this.idPrefix+this.topId||this.conf.context?this.idPull[n].className="sub_item"+("enabled"==this.itemPull[n].state?"":"_dis"):this.idPull[n].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[n].state?"Normal":"Disabled"),this._updateItemComplexState(this.idPrefix+t,this.itemPull[this.idPrefix+t].complex,!1),this._updateItemImage(t,i),this.idPrefix+this.conf.last_click==n&&"TopLevel"!=i&&this._redistribSubLevelSelection(n,this.itemPull[n].parent),"TopLevel"==i&&!this.conf.context),l},dhtmlXMenuObject.prototype.getItemText=function(t){return null!=this.itemPull[this.idPrefix+t]?this.itemPull[this.idPrefix+t].title:""},dhtmlXMenuObject.prototype.setItemText=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t])if(this._clearAndHide(),this.itemPull[t].title=e,this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context){for(var i=null,l=0;l<this.idPull[t].childNodes[1].childNodes.length;l++)"sub_item_text"==String(this.idPull[t].childNodes[1].childNodes[l].className||"")&&(i=this.idPull[t].childNodes[1].childNodes[l]);""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?i&&(i.parentNode.removeChild(i),i=null,this.idPull[t].childNodes[1].innerHTML="&nbsp;"):(i||(i=document.createElement("DIV"),i.className="sub_item_text",this.idPull[t].childNodes[1].innerHTML="",this.idPull[t].childNodes[1].appendChild(i)),i.innerHTML=this.itemPull[t].title)}else{for(var i=null,l=0;l<this.idPull[t].childNodes.length;l++)try{"top_level_text"==this.idPull[t].childNodes[l].className&&(i=this.idPull[t].childNodes[l])}catch(n){}""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?null!=i&&i.parentNode.removeChild(i):(i||(i=document.createElement("DIV"),i.className="top_level_text",this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(i,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(i)),i.innerHTML=this.itemPull[t].title)}},dhtmlXMenuObject.prototype.loadFromHTML=function(t,e,i){var l=this.conf.tags.item;this.conf.tags.item="div";var n="string"==typeof t?document.getElementById(t):t,o=this._xmlToJson(n,this.idPrefix+this.topId);this._initObj(o),this.conf.tags.item=l,e&&n.parentNode.removeChild(n),n=objOd=null,null!=onload&&("function"==typeof i?i():"function"==typeof window[i]&&window[i]())},dhtmlXMenuObject.prototype.hideItem=function(t){this._changeItemVisible(t,!1)},dhtmlXMenuObject.prototype.showItem=function(t){this._changeItemVisible(t,!0)},dhtmlXMenuObject.prototype.isItemHidden=function(t){var e=null;return null!=this.idPull[this.idPrefix+t]&&(e="none"==this.idPull[this.idPrefix+t].style.display),e},dhtmlXMenuObject.prototype._changeItemVisible=function(t,e){var i=this.idPrefix+t;null!=this.itemPull[i]&&("separator"==this.itemPull[i].type&&(i="separator_"+i),null!=this.idPull[i]&&(this.idPull[i].style.display=e?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+t].parent)))},dhtmlXMenuObject.prototype.setUserData=function(t,e,i){this.userData[this.idPrefix+t+"_"+e]=i},dhtmlXMenuObject.prototype.getUserData=function(t,e){return null!=this.userData[this.idPrefix+t+"_"+e]?this.userData[this.idPrefix+t+"_"+e]:null},dhtmlXMenuObject.prototype.setOpenMode=function(t){this.conf.mode="win"==t?"win":"web"},dhtmlXMenuObject.prototype.setWebModeTimeout=function(t){this.conf.tm_sec=isNaN(t)?400:t},dhtmlXMenuObject.prototype.getItemImage=function(t){var e=new Array(null,null);return t=this.idPrefix+t,"item"==this.itemPull[t].type&&(e[0]=this.itemPull[t].imgen,e[1]=this.itemPull[t].imgdis),e},dhtmlXMenuObject.prototype.setItemImage=function(t,e,i){"item"==this.itemPull[this.idPrefix+t].type&&(this.itemPull[this.idPrefix+t].imgen=e,this.itemPull[this.idPrefix+t].imgdis=i,this._updateItemImage(t,this._getItemLevelType(t)))},dhtmlXMenuObject.prototype.clearItemImage=function(t){this.setItemImage(t,"","")},dhtmlXMenuObject.prototype.setVisibleArea=function(t,e,i,l){this.conf.v_enabled=!0,this.conf.v.x1=t,this.conf.v.x2=e,this.conf.v.y1=i,this.conf.v.y2=l},dhtmlXMenuObject.prototype.setTooltip=function(t,e){t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.idPull[t].title=e.length>0?e:null,this.itemPull[t].tip=e)},dhtmlXMenuObject.prototype.getTooltip=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].tip},dhtmlXMenuObject.prototype.setTopText=function(t){this.conf.context||(null==this._topText&&(this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.rtl?"left":"left"==this.conf.align?"right":"left"),this.base.appendChild(this._topText)),this._topText.innerHTML=t)},dhtmlXMenuObject.prototype.setAlign=function(t){this.conf.align!=t&&("left"!=t&&"right"!=t||(this.conf.align=t,this.cont&&(this.cont.className="right"==this.conf.align?"align_right":"align_left"),null!=this._topText&&(this._topText.className="dhtmlxMenu_TopLevel_Text_"+("left"==this.conf.align?"right":"left"))))},dhtmlXMenuObject.prototype.setHref=function(t,e,i){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].href_link=e,null!=i&&(this.itemPull[this.idPrefix+t].href_target=i))},dhtmlXMenuObject.prototype.clearHref=function(t){null!=this.itemPull[this.idPrefix+t]&&(delete this.itemPull[this.idPrefix+t].href_link,delete this.itemPull[this.idPrefix+t].href_target)},dhtmlXMenuObject.prototype.getCircuit=function(t){for(var e=new Array(t);this.getParentId(t)!=this.topId;)t=this.getParentId(t),e[e.length]=t;return e.reverse()},dhtmlXMenuObject.prototype._getCheckboxState=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].checked},dhtmlXMenuObject.prototype._setCheckboxState=function(t,e){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].checked=e)},dhtmlXMenuObject.prototype._updateCheckboxImage=function(t){if(null!=this.idPull[this.idPrefix+t]){this.itemPull[this.idPrefix+t].imgen="chbx_"+(this._getCheckboxState(t)?"1":"0"),this.itemPull[this.idPrefix+t].imgdis=this.itemPull[this.idPrefix+t].imgen;try{this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+t].imgen}catch(e){}}},dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t]){var l=this._getCheckboxState(t);this.checkEvent("onCheckboxClick")?this.callEvent("onCheckboxClick",[t,l,this.conf.ctx_zoneid,i])&&this.setCheckboxState(t,!l):this.setCheckboxState(t,!l),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.setCheckboxState=function(t,e){this._setCheckboxState(t,e),this._updateCheckboxImage(t)},dhtmlXMenuObject.prototype.getCheckboxState=function(t){return this._getCheckboxState(t)},dhtmlXMenuObject.prototype.addCheckbox=function(t,e,i,l,n,o,d){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var s="chbx_"+(o?"1":"0"),r=s;if("sibling"==t){var a=this.idPrefix+(null!=l?l:this._genStr(24)),h=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(a,h,n,"checkbox",d,s,r),this.itemPull[a].checked=o,this._renderSublevelItem(a,this.getItemPosition(e))}else{var a=this.idPrefix+(null!=l?l:this._genStr(24)),h=this.idPrefix+e;this._addItemIntoGlobalStrorage(a,h,n,"checkbox",d,s,r),this.itemPull[a].checked=o,null==this.idPull["polygon_"+h]&&this._renderSublevelPolygon(h,h),this._renderSublevelItem(a,i-1),this._redefineComplexState(h)}},dhtmlXMenuObject.prototype.setHotKey=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context)&&!this.itemPull[t].complex){var i=this.itemPull[t].type;if("item"==i||"checkbox"==i||"radio"==i){var l=null;try{"sub_item_hk"==this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0].className&&(l=this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0])}catch(n){}if(0==e.length)this.itemPull[t].hotkey_backup=this.itemPull[t].hotkey,this.itemPull[t].hotkey="",null!=l&&l.parentNode.removeChild(l);else{if(this.itemPull[t].hotkey=e,this.itemPull[t].hotkey_backup=null,null==l){l=document.createElement("DIV"),l.className="sub_item_hk";for(var o=this.idPull[t].childNodes[this.conf.rtl?0:2];o.childNodes.length>0;)o.removeChild(o.childNodes[0]);o.appendChild(l)}l.innerHTML=e}}}},dhtmlXMenuObject.prototype.getHotKey=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].hotkey},dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(t){for(var e=this._getSubItemToDeselectByPolygon(t),i=0;i<this.conf.opened_poly.length;i++)this.conf.opened_poly[i]!=t&&this._hidePolygon(this.conf.opened_poly[i]);for(var i=0;i<e.length;i++)null!=this.idPull[e[i]]&&"enabled"==this.itemPull[e[i]].state&&(this.idPull[e[i]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal")},dhtmlXMenuObject.prototype._checkArrowsState=function(t){var e=this.idPull["polygon_"+t].childNodes[1],i=this.idPull["arrowup_"+t],l=this.idPull["arrowdown_"+t];0==e.scrollTop?i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled":i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(i.over?"_Over":""),e.scrollTop+e.offsetHeight<e.scrollHeight?l.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(l.over?"_Over":""):l.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled",e=i=l=null},dhtmlXMenuObject.prototype._addUpArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowup_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp",i.over=!1,i.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,e._canScrollUp=!0,e._doScrollUp(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollUp=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(e.conf.of_utm))},i.onclick=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var l=this.idPull["polygon_"+this.idPrefix+t];l.childNodes[0].appendChild(i),this.idPull[i.id]=i,l=i=null},dhtmlXMenuObject.prototype._addDownArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowdown_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown",i.over=!1,i.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,e._canScrollDown=!0,e._doScrollDown(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollDown=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(e.conf.of_dtm))},i.onclick=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var l=this.idPull["polygon_"+this.idPrefix+t];l.childNodes[2].appendChild(i),this.idPull[i.id]=i,l=i=null},dhtmlXMenuObject.prototype._removeUpArrow=function(t){var e="arrowup_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeDownArrow=function(t){var e="arrowdown_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeArrow=function(t){var e=this.idPull[t];e.onselectstart=null,e.oncontextmenu=null,e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.parentNode&&e.parentNode.removeChild(e),e=null,this.idPull[t]=null;try{delete this.idPull[t]}catch(i){}},dhtmlXMenuObject.prototype._isArrowExists=function(t){return null!=this.idPull["arrowup_"+t]&&null!=this.idPull["arrowdown_"+t]},dhtmlXMenuObject.prototype._doScrollUp=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollUp&&i.scrollTop>0){var l=!1,n=i.scrollTop-this.conf.of_ustep;if(0>n&&(l=!0,n=0),i.scrollTop=n,l)e=!0;else{var o=this;this.conf.of_utm=window.setTimeout(function(){o._doScrollUp(t,!1),o=null},this.conf.of_utime)}}else this._canScrollUp=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._doScrollDown=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollDown&&i.scrollTop+i.offsetHeight<=i.scrollHeight){var l=!1,n=i.scrollTop+this.conf.of_dstep;if(n+i.offsetHeight>=i.scrollHeight&&(l=!0,n=i.scrollHeight-i.offsetHeight),i.scrollTop=n,l)e=!0;else{var o=this;this.conf.of_dtm=window.setTimeout(function(){o._doScrollDown(t,!1),o=null},this.conf.of_dtime)}}else this._canScrollDown=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._countPolygonItems=function(t){var e=0;for(var i in this.itemPull){var l=this.itemPull[i].parent,n=this.itemPull[i].type;l!=this.idPrefix+t||"item"!=n&&"radio"!=n&&"checkbox"!=n||e++}return e},dhtmlXMenuObject.prototype.setOverflowHeight=function(t){if("auto"===t)return this.conf.overflow_limit=0,void(this.conf.auto_overflow=!0);if(!(0==this.conf.overflow_limit&&0>=t)){if(this._clearAndHide(),this.conf.overflow_limit>=0&&t>0)return void(this.conf.overflow_limit=t);if(this.conf.overflow_limit>0&&0>=t){for(var e in this.itemPull)if(this._isArrowExists(e)){var i=String(e).replace(this.idPrefix,"");this._removeUpArrow(i),this._removeDownArrow(i),this.idPull["polygon_"+e].childNodes[1].style.height=""}return void(this.conf.overflow_limit=0)}}},dhtmlXMenuObject.prototype._getRadioImgObj=function(t){try{var e=this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(i){var e=null}return e},dhtmlXMenuObject.prototype._setRadioState=function(t,e){var i=this._getRadioImgObj(t);if(null!=i){var l=this.itemPull[this.idPrefix+t];l.checked=e,l.imgen="rdbt_"+(l.checked?"1":"0"),l.imgdis=l.imgen,i.className="sub_icon "+l.imgen}},dhtmlXMenuObject.prototype._radioOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t].group){var l=this.itemPull[this.idPrefix+t].group;this.checkEvent("onRadioClick")?this.callEvent("onRadioClick",[l,this.getRadioChecked(l),t,this.conf.ctx_zoneid,i])&&this.setRadioChecked(l,t):this.setRadioChecked(l,t),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.getRadioChecked=function(t){for(var e=null,i=0;i<this.radio[t].length;i++){var l=this.radio[t][i].replace(this.idPrefix,""),n=this._getRadioImgObj(l);if(null!=n){var o=n.className.match(/rdbt_1$/gi);null!=o&&(e=l)}}return e},dhtmlXMenuObject.prototype.setRadioChecked=function(t,e){if(null!=this.radio[t])for(var i=0;i<this.radio[t].length;i++){var l=this.radio[t][i].replace(this.idPrefix,"");this._setRadioState(l,l==e)}},dhtmlXMenuObject.prototype.addRadioButton=function(t,e,i,l,n,o,d,s){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var r=this.idPrefix+(null!=l?l:this._genStr(24)),a="rdbt_"+(d?"1":"0"),h=a;if("sibling"==t){var u=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(r,u,n,"radio",s,a,h),this._renderSublevelItem(r,this.getItemPosition(e))}else{var u=this.idPrefix+e;this._addItemIntoGlobalStrorage(r,u,n,"radio",s,a,h),null==this.idPull["polygon_"+u]&&this._renderSublevelPolygon(u,u),this._renderSublevelItem(r,i-1),this._redefineComplexState(u)}var c=null!=o?o:this._genStr(24);this.itemPull[r].group=c,null==this.radio[c]&&(this.radio[c]=new Array),this.radio[c][this.radio[c].length]=r,1==d&&this.setRadioChecked(c,String(r).replace(this.idPrefix,""))},dhtmlXMenuObject.prototype.serialize=function(){var t="<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>";return t},dhtmlXMenuObject.prototype._readLevel=function(t){var e="";for(var i in this.itemPull)if(this.itemPull[i].parent==t){var l="",n="",o="",d=String(this.itemPull[i].id).replace(this.idPrefix,""),s="",r=""!=this.itemPull[i].title?' text="'+this.itemPull[i].title+'"':"",a="";"item"==this.itemPull[i].type&&(""!=this.itemPull[i].imgen&&(l=' img="'+this.itemPull[i].imgen+'"'),""!=this.itemPull[i].imgdis&&(n=' imgdis="'+this.itemPull[i].imgdis+'"'),""!=this.itemPull[i].hotkey&&(o="<hotkey>"+this.itemPull[i].hotkey+"</hotkey>")),"separator"==this.itemPull[i].type?s=' type="separator"':"disabled"==this.itemPull[i].state&&(a=' enabled="false"'),"checkbox"==this.itemPull[i].type&&(s=' type="checkbox"'+(this.itemPull[i].checked?' checked="true"':"")),"radio"==this.itemPull[i].type&&(s=' type="radio" group="'+this.itemPull[i].group+'" '+(this.itemPull[i].checked?' checked="true"':"")),e+="<item id='"+d+"'"+r+s+l+n+a+">",e+=o,this.itemPull[i].complex&&(e+=this._readLevel(i)),e+="</item>"}return e},dhtmlXMenuObject.prototype.enableEffect=function(t,e,i){this._menuEffect="opacity"==t||"slide"==t||"slide+"==t?t:!1,this._pOpStyleIE=navigator.userAgent.search(/MSIE\s[678]\.0/gi)>=0;for(var l in this.idPull)0===l.search(/polygon/)&&(this._pOpacityApply(l,this._pOpStyleIE?100:1),this.idPull[l].style.height="");this._pOpMax=("undefined"==typeof e?100:e)/(this._pOpStyleIE?1:100),this._pOpStyleName=this._pOpStyleIE?"filter":"opacity",this._pOpStyleValue=this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#",this._pSlSteps=this._pOpStyleIE?10:20,this._pSlTMTimeMax=i||50},dhtmlXMenuObject.prototype._showPolygonEffect=function(t){this._pShowHide(t,!0)},dhtmlXMenuObject.prototype._hidePolygonEffect=function(t){this._pShowHide(t,!1)},dhtmlXMenuObject.prototype._pOpacityApply=function(t,e){this.idPull[t].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",e||this.idPull[t]._op)},dhtmlXMenuObject.prototype._pShowHide=function(t,e){if(this.idPull){if(null!=this.idPull[t]._tmShow){if(this.idPull[t]._step_h>0&&1==e||this.idPull[t]._step_h<0&&0==e)return;window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._tmShow=null,this.idPull[t]._max_h=null;
}if(0!=e||"hidden"!=this.idPull[t].style.visibility&&"none"!=this.idPull[t].style.display){if(1==e&&"none"==this.idPull[t].style.display&&(this.idPull[t].style.visibility="hidden",this.idPull[t].style.display=""),null==this.idPull[t]._max_h){if(this.idPull[t]._max_h=parseInt(this.idPull[t].offsetHeight),this.idPull[t]._h=1==e?0:this.idPull[t]._max_h,this.idPull[t]._step_h=Math.round(this.idPull[t]._max_h/this._pSlSteps)*(1==e?1:-1),0==this.idPull[t]._step_h)return;this.idPull[t]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps),"slide+"==this._menuEffect||"opacity"==this._menuEffect?(this.idPull[t].op_tm=this.idPull[t]._step_tm,this.idPull[t].op_step=this._pOpMax/this._pSlSteps*(1==e?1:-1),this._pOpStyleIE&&(this.idPull[t].op_step=Math.round(this.idPull[t].op_step)),this.idPull[t]._op=1==e?0:this._pOpMax,this._pOpacityApply(t)):(this.idPull[t]._op=this._pOpStyleIE?100:1,this._pOpacityApply(t)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height="0px"),this.idPull[t].style.visibility="visible"}this._pEffectSet(t,this.idPull[t]._h+this.idPull[t]._step_h)}}},dhtmlXMenuObject.prototype._pEffectSet=function(t,e){if(this.idPull)if(this.idPull[t]._tmShow&&window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._h=Math.max(0,Math.min(e,this.idPull[t]._max_h)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=this.idPull[t]._h+"px"),e+=this.idPull[t]._step_h,"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[t]._op+this.idPull[t].op_step)),this._pOpacityApply(t)),this.idPull[t]._step_h>0&&e<=this.idPull[t]._max_h||this.idPull[t]._step_h<0&&e>=0){var i=this;this.idPull[t]._tmShow=window.setTimeout(function(){i._pEffectSet(t,e)},this.idPull[t]._step_tm)}else 0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=""),this.idPull[t]._step_h<0&&(this.idPull[t].style.visibility="hidden"),"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=this.idPull[t]._step_h<0?this._pOpStyleIE?100:1:this._pOpMax,this._pOpacityApply(t)),this.idPull[t]._tmShow=null,this.idPull[t]._h=null,this.idPull[t]._max_h=null,this.idPull[t]._step_tm=null},module.exports=dhtmlXMenuObject;
},{}],6:[function(require,module,exports){
function dhtmlXSlider(e){var t=this;if(this.conf={size:null,skin:null,vertical:!1,min:0,max:99,value:0,step:1,decimals:0,margin:2,border:1,inverse:!1,disabled:!1,tooltip:!1,visible:!0,linkTo:void 0},this._attachedNode={},this._movingInitialValues=null,this.base=null,arguments.length>1)return new dhtmlXSlider(this._renderArgumets(arguments));if("string"==typeof e||"object"==typeof e&&e.tagName)return new dhtmlXSlider({parent:e});"string"==typeof e.parent?this.base=document.getElementById(e.parent):this.base=e.parent,this._mergeConfig(this._readAttFormNode(this.base)),this._mergeConfig(e),this._detectDecimals(),null!=this.conf.size&&void 0!=this.conf.size||(this.conf.vertical?this.conf.size=this.base.offsetHeight:this.conf.size=this.base.offsetWidth);var n=this.conf.skin||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxslider")||"dhx_skyblue";return this.setSkin(n),this.base.innerHTML="<div class='dhxsl_container'><div class='dhxsl_track'></div><div class='dhxsl_runner'></div></div>",this._nodes={cont:this.base.firstChild,track:this.base.firstChild.firstChild,runner:this.base.firstChild.childNodes[1]},this._nodes.cont.onmousedown=this._nodes.track.onmousedown=this._nodes.cont.onselectstart=this._nodes.track.onselectstart=function(e){return e=e||event,"function"==typeof e.preventDefault?e.preventDefault():e.returnValue=!1,!1},this.conf.value=this._normalize(this.conf.value),this._setOrient(this.conf.vertical),this.setSize(this.conf.size),this._initMover=function(e){e=e||event,"function"==typeof e.preventDefault&&e.preventDefault(),t._nodes.runner.className="dhxsl_runner dhxsl_runner_actv";var n=("mousedown"==e.type?"client":"page")+(t.conf.vertical?"Y":"X");return t._movingInitialValues={},t._movingInitialValues.value=t.conf.value,t._movingInitialValues.coord="undefined"!=typeof e[n]?e[n]:e.touches[0][n],0==t.conf.disabled&&("function"==typeof window.addEventListener?(window.addEventListener("mousemove",t._move,!1),window.addEventListener("mouseup",t._cleanMove,!1),window.addEventListener("touchmove",t._move,!1),window.addEventListener("touchend",t._cleanMove,!1)):(document.body.attachEvent("onmousemove",t._move),document.body.attachEvent("onmouseup",t._cleanMove))),t.callEvent("_onRunnerMouseDown",[]),!1},this._move=function(e){e=e||event,"function"==typeof e.preventDefault&&e.preventDefault();var n=("mousemove"==e.type?"client":"page")+(t.conf.vertical?"Y":"X"),s=t.conf.vertical?t._nodes.runner.offsetHeight:t._nodes.runner.offsetWidth,i=t.conf.max-t.conf.min,o="undefined"!=typeof e[n]?e[n]:e.touches[0][n],a=t._movingInitialValues.value+(o-t._movingInitialValues.coord)*i/(t.conf.size-s)*(t.conf.inverse?-1:1);t.setValue(a,!0)},this._cleanMove=function(e){"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",t._move,!1),window.removeEventListener("mouseup",t._cleanMove,!1),window.removeEventListener("touchmove",t._move,!1),window.removeEventListener("touchend",t._cleanMove,!1)):(document.body.detachEvent("onmousemove",t._move),document.body.detachEvent("onmouseup",t._cleanMove)),t._movingInitialValues=null,t._nodes.runner.className=t._nodes.runner.className.replace(/\s{0,}dhxsl_runner_actv/gi,""),t.callEvent("onSlideEnd",[t.conf.value]),t.callEvent("_onRunnerMouseUp",[])},this._doOnSetValue=function(e){if(null!=t._movingInitialValues)return!1;e=e||event,"function"==typeof e.preventDefault&&e.preventDefault();var n=t.conf.vertical?e.offsetY||e.layerY:e.offsetX||e.layerX,s=(t.conf.vertical?t._nodes.runner.offoffsetHeightsetHe:t._nodes.runner.offsetWidth,t.conf.max-t.conf.min),i=n*s/t.conf.size+t.conf.min;return t.setValue(i,!0),null==t._movingInitialValues&&t._initMover(e),!1},this._doOnChangeInput=function(e){e=e||event;var n=e.target||e.srcElement;t.setValue(n.value)},this._doOnKeyDown=function(e){e=e||event;var n=e.target||e.srcElement;13==e.keyCode&&t.setValue(n.value)},this._attachEvents(this._nodes),this.unload=function(){dhx4._eventable(this,"clear"),this._detachNode(),this._detachEvents(this._nodes),this.base.removeChild(this._nodes.cont),this._nodes.cont.onmousedown=this._nodes.track.onmousedown=this._nodes.cont.onselectstart=this._nodes.track.onselectstart=null,delete this._nodes.cont,delete this._nodes.track,delete this._nodes.max,delete this._nodes.min,delete this._nodes.runner,/\s?dhtmlxslider_\S*/.test(this.base.className)&&(this.base.className=this.base.className.replace(/\s?dhtmlxslider_\S*/,""));for(var e in this)this[e]=null;t=null},dhx4._eventable(this),this.conf.disabled&&this.disable(),this.conf.tooltip&&this.enableTooltip(),this.conf.visible||this.hide(),this.conf.linkTo&&this.linkTo(this.conf.linkTo),this}dhtmlXSlider.prototype._setOrient=function(e){e=e||!1,/\s?dhxsl_cont_hr/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_cont_hr/i,"")),/\s?dhxsl_cont_vr/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_cont_vr/i,"")),e?this._nodes.cont.className+=" dhxsl_cont_vr":this._nodes.cont.className+=" dhxsl_cont_hr"},dhtmlXSlider.prototype._attachEvents=function(e){"function"==typeof window.addEventListener?(e.runner.addEventListener("mousedown",this._initMover,!1),e.runner.addEventListener("touchstart",this._initMover,!1),e.cont.addEventListener("mousedown",this._doOnSetValue,!1),e.cont.addEventListener("touchstart",this._doOnSetValue,!1)):(e.runner.attachEvent("onmousedown",this._initMover),e.cont.attachEvent("onmousedown",this._doOnSetValue))},dhtmlXSlider.prototype._detachEvents=function(e){"function"==typeof window.addEventListener?(e.runner.removeEventListener("mousedown",this._initMover,!1),e.runner.removeEventListener("touchstart",this._initMover,!1),e.cont.removeEventListener("mousedown",this._doOnSetValue,!1),e.cont.removeEventListener("touchstart",this._doOnSetValue,!1)):(e.runner.detachEvent("onmousedown",this._initMover),e.cont.detachEvent("onmousedown",this._doOnSetValue))},dhtmlXSlider.prototype._mergeConfig=function(e){for(var t in e)switch(t.toLowerCase()){case"min":case"max":case"size":case"step":case"value":case"inverse":this.conf[t]=e[t];break;case"tooltip":case"visible":case"vertical":case"disabled":this.conf[t]=dhx4.s2b(e[t]);break;case"parent":continue;default:this.conf[t]=e[t]}},dhtmlXSlider.prototype._readAttFormNode=function(e){var t,n,s=e.attributes,i=s.length,o={};for(t=0;i>t;t++)switch(n=s[t],n.name.toLowerCase()){case"size":case"min":case"max":case"value":case"step":o[n.name]=n.value;break;case"skin":o.skin=n.value;break;case"vertical":case"disabled":case"visible":o[n.name]=dhx4.s2b(n.value);break;case"linkto":o.linkTo=n.value;break;case"tooltip":o.tooltip=dhx4.s2b(n.value)}return o},dhtmlXSlider.prototype._renderArgumets=function(e){var t,n,s={};for(n=e.length,t=0;n>t;t++)switch(t){case 0:s.parent=e[t];break;case 1:s.size=e[t];break;case 2:s.skin=e[t];break;case 3:s.vertical=e[t];break;case 4:s.min=e[t];break;case 5:s.max=e[t];break;case 6:s.value=e[t];break;case 7:s.step=e[t]}return s},dhtmlXSlider.prototype._skinCollection={dhx_skyblue:!0,dhx_web:!0,dhx_terrace:!0},dhtmlXSlider.prototype._indexOf=function(e,t){var n,s,i=-1;for(s=e.length,n=s;n>=0;n--)if(e[n]==t){i=n;break}return i},dhtmlXSlider.prototype._refreshRunner=function(){var e,t;this.conf.vertical?(e=this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight,t=this._getCoord(e),this._nodes.runner.style.top=t+this.conf.border+"px",this._nodes.runner.style.left=Math.round((this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth)/2)+"px"):(e=this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth,t=this._getCoord(e),this._nodes.runner.style.left=t+this.conf.border+"px",this._nodes.runner.style.top=Math.round((this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight)/2)+"px")},dhtmlXSlider.prototype._setValueByCoord=function(e){var t,n,s=dhx4.absLeft(this._nodes.cont),i=dhx4.absTop(this._nodes.cont);n=this.conf.vertical?(e.y-i-this._nodes.runner.offsetHeight/2)/(this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight):(e.x-s-this._nodes.runner.offsetWidth/2)/(this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth),t=(this.conf.max-this.conf.min)*n+this.conf.min,this.setValue(t,!0)},dhtmlXSlider.prototype._getCoord=function(e){var t=this.conf.inverse?this._inverseValue(this.conf.value):this.conf.value,n=(t-this.conf.min)/(this.conf.max-this.conf.min);return Math.round(e*n)},dhtmlXSlider.prototype._normalize=function(e){e=Number(e),e=Math.round(e/this.conf.step)*this.conf.step;var t=Math.pow(10,this.conf.decimals);return e=Math.round(e*t)/t,e=Math.max(this.conf.min,Math.min(this.conf.max,e))},dhtmlXSlider.prototype._attachNode=function(e){var t=e.tagName.toLowerCase();if(t){switch(this._attachedNode.node=e,t){case"input":case"select":"function"==typeof window.addEventListener?(e.addEventListener("change",this._doOnChangeInput,!1),e.addEventListener("keydown",this._doOnKeyDown,!1)):(e.attachEvent("onchange",this._doOnChangeInput),e.attachEvent("onkeydown",this._doOnKeyDown)),this._attachedNode.setValue=function(e,t){if(e=String(e),t>0){var n=e.match(/\.\d{1,}$/);null!=n&&(t=Math.max(t-n[0].length+1)),e+=e.indexOf(".")<0?".":"";for(var s=0;t>s;s++)e+="0"}this.node.value=e};break;default:this._attachedNode.setValue=function(e){this.node.innerHTML=e}}this._attachedNode.setValue(this.conf.value,this.conf.decimals)}},dhtmlXSlider.prototype._detachNode=function(){var e=this._attachedNode.node;if(e){var t=e.tagName;switch(t){case"input":case"select":"function"==typeof window.addEventListener?(e.removeEventListener("change",this._doOnChangeInput,!1),e.removeEventListener("keydown",this._doOnChangeInput,!1)):(e.detachEvent("change",this._doOnChangeInput),e.detachEvent("keydown",this._doOnChangeInput))}delete this._attachedNode.node,delete this._attachedNode.setValue}},dhtmlXSlider.prototype._detectDecimals=function(){var e=this.conf.step.toString().match(/\.(\d*)$/);this.conf.decimals=null!=e?e[1].length:0},dhtmlXSlider.prototype.setSize=function(e){isNaN(e)||(this.conf.vertical?(this._nodes.cont.style.width&&delete this._nodes.cont.style.width,this._nodes.cont.style.height=e-this.conf.margin+"px"):(this._nodes.cont.style.height&&delete this._nodes.cont.style.height,this._nodes.cont.style.width=e-this.conf.margin+"px"),this._refreshRunner())},dhtmlXSlider.prototype.setSkin=function(e){e=e.toLowerCase();var t,n,s=-1,i="dhtmlxslider";if(t=this.base.className.match(/\S\w+/gi),t instanceof Array){for(n in this._skinCollection){if(-1!=s)break;s=this._indexOf(t,i+"_"+n)}s=-1==s?t.length:s}else t=[],s=0;t[s]=i+"_"+e,this.base.className=t.join(" "),this.conf.skin=e,this._nodes&&this._refreshRunner()},dhtmlXSlider.prototype.setValue=function(e,t){t=t||!1,isNaN(e)||(e=this._normalize(e),this.conf.value!=e&&(this.conf.value=e,this._refreshRunner(),this.conf.tooltip&&(this._nodes.cont.title=e),t&&this.callEvent("onChange",[e,this]))),"function"==typeof this._attachedNode.setValue&&this._attachedNode.setValue(this.conf.value,this.conf.decimals)},dhtmlXSlider.prototype.getValue=function(){return this.conf.value},dhtmlXSlider.prototype._inverseValue=function(){return this.conf.max+this.conf.min-this.conf.value},dhtmlXSlider.prototype.disable=function(e){e=0!=e;var t=null;if(e){for(var n in this._nodes)"cont"!=n&&(t=new RegExp("\\s?dhxsl_"+n+"_dis","i"),t.test(this._nodes[n].className)||(this._nodes[n].className+=" dhxsl_"+n+"_dis"));this.conf.disabled=!0}else this.enable()},dhtmlXSlider.prototype.enable=function(){var e;for(var t in this._nodes)"cont"!=t&&(e=new RegExp("\\s?dhxsl_"+t+"_dis","i"),e.test(this._nodes[t].className)&&(this._nodes[t].className=this._nodes[t].className.replace(e,"")));this.conf.disabled=!1},dhtmlXSlider.prototype.isEnabled=function(){return!this.conf.disabled},dhtmlXSlider.prototype.disableTooltip=function(){this._nodes.cont.removeAttribute("title"),this.conf.tooltip=!1},dhtmlXSlider.prototype.enableTooltip=function(e){e="undefined"==typeof e?!0:dhx4.s2b(e),e?(this._nodes.cont.title=this.conf.value,this.conf.tooltip=!0):this.disableTooltip()},dhtmlXSlider.prototype.setMax=function(e){!isNaN(e)&&this.conf.min<e&&(this.conf.max=e,this.setValue(this.conf.value))},dhtmlXSlider.prototype.getMax=function(){return this.conf.max},dhtmlXSlider.prototype.setMin=function(e){!isNaN(e)&&this.conf.max>e&&(this.conf.min=e,this.setValue(this.conf.value))},dhtmlXSlider.prototype.getMin=function(){return this.conf.min},dhtmlXSlider.prototype.setStep=function(e){var t=this.conf.max-this.conf.min;!isNaN(e)&&t>e&&(this.conf.step=e,this._detectDecimals(),this.setValue(this.conf.value))},dhtmlXSlider.prototype.getStep=function(){return this.conf.step},dhtmlXSlider.prototype.show=function(){/\s?dhxsl_hidden/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_hidden/i,"")),this.conf.visible=!0},dhtmlXSlider.prototype.hide=function(){/\s?dhxsl_hidden/i.test(this._nodes.cont.className)||(this._nodes.cont.className+=" dhxsl_hidden"),this.conf.visible=!1},dhtmlXSlider.prototype.isVisible=function(){return this.conf.visible},dhtmlXSlider.prototype.linkTo=function(e){"string"==typeof e&&(e=document.getElementById(e)),this._attachedNode.node&&this._detachNode(),this._attachNode(e)},module.exports=dhtmlXSlider;
},{}],7:[function(require,module,exports){
var Hilitor2=function(e,t){function r(e){return retval=e,retval=retval.replace(/([ao])e/gi,"$1"),retval=retval.replace(/\\u00E[024]/gi,"a"),retval=retval.replace(/\\u00E[89AB]/gi,"e"),retval=retval.replace(/\\u00E[EF]/gi,"i"),retval=retval.replace(/\\u00F[46]/gi,"o"),retval=retval.replace(/\\u00F[9BC]/gi,"u"),retval=retval.replace(/\\u00FF/gi,"y"),retval=retval.replace(/\\u00DF/gi,"s"),retval=retval.replace(/a/gi,"([aàâä]|ae)"),retval=retval.replace(/e/gi,"[eèéêë]"),retval=retval.replace(/i/gi,"[iîï]"),retval=retval.replace(/o/gi,"([oôö]|oe)"),retval=retval.replace(/u/gi,"[uùûü]"),retval=retval.replace(/y/gi,"[yÿ]"),retval=retval.replace(/s/gi,"(ss|[sß])"),retval}function a(e){var t=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");return t[e>>12&15]+t[e>>8&15]+t[e>>4&15]+t[15&e]}function i(e,t){for(var r,i,l=0,o="",s=0;s<e.length;s++){var n=e.charCodeAt(s);if((0>n||n>65535)&&(o+="!Error in convertCharStr2UTF16: unexpected charCodeAt result, cc="+n+"!"),0!=l){if(n>=56320&&57343>=n){if(r=65536+(l-55296<<10)+(n-56320),t){for(i=r.toString(16);i.length<8;)i="0"+i;o+="\\U"+i}else r-=65536,o+="\\u"+a(55296|r>>10)+"\\u"+a(56320|1023&r);l=0;continue}o+="Error in convertCharStr2UTF16: low surrogate expected, cc="+n+"!",l=0}if(n>=55296&&56319>=n)l=n;else switch(n){case 0:o+="\\0";break;case 8:o+="\\b";break;case 9:o+="\\t";break;case 10:o+="\\n";break;case 13:o+="\\r";break;case 11:o+="\\v";break;case 12:o+="\\f";break;case 34:o+='\\"';break;case 39:o+="\\'";break;case 92:o+="\\\\";break;default:if(n>31&&127>n)o+=String.fromCharCode(n);else{for(i=n.toString(16).toUpperCase();i.length<4;)i="0"+i;o+="\\u"+i}}}return o}var l=document.getElementById(e)||document.body,o=t||"EM",s=new RegExp("^(?:"+o+"|SCRIPT|FORM)$"),n=["#ff6","#a0ffff","#9f9","#f99","#f6f"],c=[],g=0,h="";this.setMatchType=function(e){switch(e){case"left":this.openLeft=!1,this.openRight=!0;break;case"right":this.openLeft=!0,this.openRight=!1;break;case"open":this.openLeft=this.openRight=!0;break;default:this.openLeft=this.openRight=!1}},this.setRegex=function(e){e=e.replace(/\\([^u]|$)/g,"$1"),e=r(e);var t="("+e+")";this.openLeft||(t="(?:^|[\\b\\s])"+t),this.openRight||(t+="(?:[\\b\\s]|$)"),h=new RegExp(t,"i")},this.getRegex=function(){var e=h.toString();return e=e.replace(/(^\/|\(\?:[^\)]+\)|\/i$)/g,"")},this.hiliteWords=function(e){if(void 0!==e&&e&&h&&!s.test(e.nodeName)){if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)this.hiliteWords(e.childNodes[t]);if(3==e.nodeType&&(nv=e.nodeValue)&&(regs=h.exec(nv))){c[regs[1].toLowerCase()]||(c[regs[1].toLowerCase()]=n[g++%n.length]);var r=document.createElement(o);r.appendChild(document.createTextNode(regs[1])),r.style.backgroundColor=c[regs[1].toLowerCase()],r.style.fontStyle="inherit",r.style.color="#000";var a;a=regs[0].match(/^\s/)?e.splitText(regs.index+1):e.splitText(regs.index),a.nodeValue=a.nodeValue.substring(regs[1].length),e.parentNode.insertBefore(r,a)}}},this.remove=function(){for(var e=document.getElementsByTagName(o);e.length&&(el=e[0]);){var t=el.parentNode;t.replaceChild(el.firstChild,el),t.normalize()}},this.apply=function(e){this.remove(),void 0!==e&&(e=e.replace(/(^\s+|\s+$)/g,""))&&(e=i(e),this.setRegex(e),this.hiliteWords(l))}};module.exports=Hilitor2;
},{}],8:[function(require,module,exports){
!function(e){e.iconset_fontawesome={iconClass:"fa",iconClassFix:"fa-",icons:["circle","circle-o","square","square-o","stop","play","heart","heart-o","star","star-half","star-half-o","star-o","asterisk","certificate","diamond","bell","bell-o","bolt","lightbulb-o","flag","flag-checkered","flag-o","comment","comment-o","comments","comments-o","check","check-circle","check-circle-o","check-square","check-square-o","plus-circle","plus-square","plus-square-o","minus-circle","minus-square","minus-square-o","exclamation","exclamation-circle","exclamation-triangle","question-circle","info-circle","times-circle","times-circle-o","dot-circle-o","bullseye","ban","crosshairs","hashtag","thumbs-up","thumbs-o-up","thumbs-down","thumbs-o-down","life-ring","bomb","user","users","male","female","blind","child","user-secret","mars","venus","graduation-cap","gavel","trophy","user-md","medkit","smile-o","frown-o","meh-o","paw","calendar","calendar-o","clock-o","sun-o","moon-o","cloud","umbrella","car","cab","truck","ambulance","motorcycle","road","subway","train","plane","fighter-jet","rocket","space-shuttle","paper-plane","paper-plane-o","ship","anchor","home","bank","building","building-o","hospital-o","industry","bed","globe","map","map-o","map-marker","map-pin","map-signs","location-arrow","compass","leaf","tree","television","desktop","laptop","tablet","mobile","phone","phone-square","fax","camera","camera-retro","photo","video-camera","film","music","headphones","microphone","microphone-slash","bullhorn","book","bookmark","bookmark-o","envelope","envelope-o","paperclip","thumb-tack","tag","tags","ticket","pencil","pencil-square","pencil-square-o","puzzle-piece","chain","chain-broken","key","lock","unlock","coffee","beer","glass","spoon","cutlery","gift","money","credit-card","dollar","euro","gbp","briefcase","suitcase","shopping-bag","shopping-basket","archive","folder","file","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-text","file-text-o","file-video-o","file-word-o","file-zip-o","shield","balance-scale","bug","cog","cogs","external-link","external-link-square","cube","cubes","eye","eye-slash","fire","fire-extinguisher","flask","magnet","magic","search"]}}(jQuery);
},{}],9:[function(require,module,exports){
!function(t,e){function i(t,e,i){return[parseFloat(t[0])*(a.test(t[0])?e/100:1),parseFloat(t[1])*(a.test(t[1])?i/100:1)]}function o(e,i){return parseInt(t.css(e,i),10)||0}function l(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var n,s=Math.max,f=Math.abs,r=Math.round,p=/left|center|right/,h=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,a=/%$/,g=t.fn.pos;t.pos={scrollbarWidth:function(){if(n!==e)return n;var i,o,l=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=l.children()[0];return t("body").append(l),i=s.offsetWidth,l.css("overflow","scroll"),o=s.offsetWidth,i===o&&(o=l[0].clientWidth),l.remove(),n=i-o},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),o=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),l="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,n="scroll"===o||"auto"===o&&e.height<e.element[0].scrollHeight;return{width:n?t.pos.scrollbarWidth():0,height:l?t.pos.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),o=t.isWindow(i[0]),l=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:o,isDocument:l,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:o?i.width():i.outerWidth(),height:o?i.height():i.outerHeight()}}},t.fn.pos=function(e){if(!e||!e.of)return g.apply(this,arguments);e=t.extend({},e);var n,a,u,m,w,W,v=t(e.of),y=t.pos.getWithinInfo(e.within),b=t.pos.getScrollInfo(y),T=(e.collision||"flip").split(" "),H={};return W=l(v),v[0].preventDefault&&(e.at="left top"),a=W.width,u=W.height,m=W.offset,w=t.extend({},m),t.each(["my","at"],function(){var t,i,o=(e[this]||"").split(" ");1===o.length&&(o=p.test(o[0])?o.concat(["center"]):h.test(o[0])?["center"].concat(o):["center","center"]),o[0]=p.test(o[0])?o[0]:"center",o[1]=h.test(o[1])?o[1]:"center",t=c.exec(o[0]),i=c.exec(o[1]),H[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(o[0])[0],d.exec(o[1])[0]]}),1===T.length&&(T[1]=T[0]),"right"===e.at[0]?w.left+=a:"center"===e.at[0]&&(w.left+=a/2),"bottom"===e.at[1]?w.top+=u:"center"===e.at[1]&&(w.top+=u/2),n=i(H.at,a,u),w.left+=n[0],w.top+=n[1],this.each(function(){var l,p,h=t(this),c=h.outerWidth(),d=h.outerHeight(),g=o(this,"marginLeft"),W=o(this,"marginTop"),x=c+g+o(this,"marginRight")+b.width,L=d+W+o(this,"marginBottom")+b.height,C=t.extend({},w),_=i(H.my,h.outerWidth(),h.outerHeight());"right"===e.my[0]?C.left-=c:"center"===e.my[0]&&(C.left-=c/2),"bottom"===e.my[1]?C.top-=d:"center"===e.my[1]&&(C.top-=d/2),C.left+=_[0],C.top+=_[1],t.support.offsetFractions||(C.left=r(C.left),C.top=r(C.top)),l={marginLeft:g,marginTop:W},t.each(["left","top"],function(i,o){t.ui.pos[T[i]]&&t.ui.pos[T[i]][o](C,{targetWidth:a,targetHeight:u,elemWidth:c,elemHeight:d,collisionPosition:l,collisionWidth:x,collisionHeight:L,offset:[n[0]+_[0],n[1]+_[1]],my:e.my,at:e.at,within:y,elem:h})}),e.using&&(p=function(t){var i=m.left-C.left,o=i+a-c,l=m.top-C.top,n=l+u-d,r={target:{element:v,left:m.left,top:m.top,width:a,height:u},element:{element:h,left:C.left,top:C.top,width:c,height:d},horizontal:0>o?"left":i>0?"right":"center",vertical:0>n?"top":l>0?"bottom":"middle"};c>a&&f(i+o)<a&&(r.horizontal="center"),d>u&&f(l+n)<u&&(r.vertical="middle"),s(f(i),f(o))>s(f(l),f(n))?r.important="horizontal":r.important="vertical",e.using.call(this,t,r)}),h.offset(t.extend(C,{using:p}))})},t.ui.pos={_trigger:function(t,e,i,o){e.elem&&e.elem.trigger({type:i,position:t,positionData:e,triggered:o})},fit:{left:function(e,i){t.ui.pos._trigger(e,i,"posCollide","fitLeft");var o,l=i.within,n=l.isWindow?l.scrollLeft:l.offset.left,f=l.width,r=e.left-i.collisionPosition.marginLeft,p=n-r,h=r+i.collisionWidth-f-n;i.collisionWidth>f?p>0&&0>=h?(o=e.left+p+i.collisionWidth-f-n,e.left+=p-o):h>0&&0>=p?e.left=n:p>h?e.left=n+f-i.collisionWidth:e.left=n:p>0?e.left+=p:h>0?e.left-=h:e.left=s(e.left-r,e.left),t.ui.pos._trigger(e,i,"posCollided","fitLeft")},top:function(e,i){t.ui.pos._trigger(e,i,"posCollide","fitTop");var o,l=i.within,n=l.isWindow?l.scrollTop:l.offset.top,f=i.within.height,r=e.top-i.collisionPosition.marginTop,p=n-r,h=r+i.collisionHeight-f-n;i.collisionHeight>f?p>0&&0>=h?(o=e.top+p+i.collisionHeight-f-n,e.top+=p-o):h>0&&0>=p?e.top=n:p>h?e.top=n+f-i.collisionHeight:e.top=n:p>0?e.top+=p:h>0?e.top-=h:e.top=s(e.top-r,e.top),t.ui.pos._trigger(e,i,"posCollided","fitTop")}},flip:{left:function(e,i){t.ui.pos._trigger(e,i,"posCollide","flipLeft");var o,l,n=i.within,s=n.offset.left+n.scrollLeft,r=n.width,p=n.isWindow?n.scrollLeft:n.offset.left,h=e.left-i.collisionPosition.marginLeft,c=h-p,d=h+i.collisionWidth-r-p,a="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,g="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,u=-2*i.offset[0];0>c?(o=e.left+a+g+u+i.collisionWidth-r-s,(0>o||o<f(c))&&(e.left+=a+g+u)):d>0&&(l=e.left-i.collisionPosition.marginLeft+a+g+u-p,(l>0||f(l)<d)&&(e.left+=a+g+u)),t.ui.pos._trigger(e,i,"posCollided","flipLeft")},top:function(e,i){t.ui.pos._trigger(e,i,"posCollide","flipTop");var o,l,n=i.within,s=n.offset.top+n.scrollTop,r=n.height,p=n.isWindow?n.scrollTop:n.offset.top,h=e.top-i.collisionPosition.marginTop,c=h-p,d=h+i.collisionHeight-r-p,a="top"===i.my[1],g=a?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,u="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,m=-2*i.offset[1];0>c?(l=e.top+g+u+m+i.collisionHeight-r-s,e.top+g+u+m>c&&(0>l||l<f(c))&&(e.top+=g+u+m)):d>0&&(o=e.top-i.collisionPosition.marginTop+g+u+m-p,e.top+g+u+m>d&&(o>0||f(o)<d)&&(e.top+=g+u+m)),t.ui.pos._trigger(e,i,"posCollided","flipTop")}},flipfit:{left:function(){t.ui.pos.flip.left.apply(this,arguments),t.ui.pos.fit.left.apply(this,arguments)},top:function(){t.ui.pos.flip.top.apply(this,arguments),t.ui.pos.fit.top.apply(this,arguments)}}},function(){var e,i,o,l,n,s=document.getElementsByTagName("body")[0],f=document.createElement("div");e=document.createElement(s?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"});for(n in o)e.style[n]=o[n];e.appendChild(f),i=s||document.documentElement,i.insertBefore(e,i.firstChild),f.style.cssText="position: absolute; left: 10.7432222px;",l=t(f).offset().left,t.support.offsetFractions=l>10&&11>l,e.innerHTML="",i.removeChild(e)}()}(jQuery);
},{}],10:[function(require,module,exports){
!function(t){var o={},n=t.prototype.stopCallback;t.prototype.stopCallback=function(t,i,a,e){return this.paused?!0:o[a]||o[e]?!1:n.call(this,t,i,a)},t.prototype.bindGlobal=function(t,n,i){if(this.bind(t,n,i),t instanceof Array)for(n=0;n<t.length;n++)o[t[n]]=!0;else o[t]=!0},t.init()}(Mousetrap);
},{}],11:[function(require,module,exports){
var Opentip,firstAdapter,i,mouseMoved,mousePosition,mousePositionObservers,position,vendors,_i,_len,_ref,__slice=[].slice,__indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},__hasProp={}.hasOwnProperty;for(Opentip=function(){function t(e,i,o,s){var n,r,a,h,p,d,l,u,c,g,f,m,v,b,w=this;if(this.id=++t.lastId,this.debug("Creating Opentip."),t.tips.push(this),this.adapter=t.adapter,n=this.adapter.data(e,"opentips")||[],n.push(this),this.adapter.data(e,"opentips",n),this.triggerElement=this.adapter.wrap(e),this.triggerElement.length>1)throw Error("You can't call Opentip on multiple elements.");if(1>this.triggerElement.length)throw Error("Invalid element.");for(this.loaded=!1,this.loading=!1,this.visible=!1,this.waitingToShow=!1,this.waitingToHide=!1,this.currentPosition={left:0,top:0},this.dimensions={width:100,height:50},this.content="",this.redraw=!0,this.currentObservers={showing:!1,visible:!1,hiding:!1,hidden:!1},s=this.adapter.clone(s),"object"==typeof i?(s=i,i=o=void 0):"object"==typeof o&&(s=o,o=void 0),null!=o&&(s.title=o),null!=i&&this.setContent(i),null==s["extends"]&&(s["extends"]=null!=s.style?s.style:t.defaultStyle),h=[s],b=s;b["extends"];){if(d=b["extends"],b=t.styles[d],null==b)throw Error("Invalid style: "+d);h.unshift(b),null==b["extends"]&&"standard"!==d&&(b["extends"]="standard")}for(s=(f=this.adapter).extend.apply(f,[{}].concat(__slice.call(h))),s.hideTriggers=function(){var t,e,i,o;for(i=s.hideTriggers,o=[],t=0,e=i.length;e>t;t++)r=i[t],o.push(r);return o}(),s.hideTrigger&&0===s.hideTriggers.length&&s.hideTriggers.push(s.hideTrigger),m=["tipJoint","targetJoint","stem"],l=0,c=m.length;c>l;l++)p=m[l],s[p]&&"string"==typeof s[p]&&(s[p]=new t.Joint(s[p]));for(!s.ajax||s.ajax!==!0&&s.ajax||(s.ajax="A"===this.adapter.tagName(this.triggerElement)?this.adapter.attr(this.triggerElement,"href"):!1),"click"===s.showOn&&"A"===this.adapter.tagName(this.triggerElement)&&this.adapter.observe(this.triggerElement,"click",function(t){return t.preventDefault(),t.stopPropagation(),t.stopped=!0}),s.target&&(s.fixed=!0),s.stem===!0&&(s.stem=new t.Joint(s.tipJoint)),s.target===!0?s.target=this.triggerElement:s.target&&(s.target=this.adapter.wrap(s.target)),this.currentStem=s.stem,null==s.delay&&(s.delay="mouseover"===s.showOn?.2:0),null==s.targetJoint&&(s.targetJoint=new t.Joint(s.tipJoint).flip()),this.showTriggers=[],this.showTriggersWhenVisible=[],this.hideTriggers=[],s.showOn&&"creation"!==s.showOn&&this.showTriggers.push({element:this.triggerElement,event:s.showOn}),null!=s.ajaxCache&&(s.cache=s.ajaxCache,delete s.ajaxCache),this.options=s,this.bound={},v=["prepareToShow","prepareToHide","show","hide","reposition"],u=0,g=v.length;g>u;u++)a=v[u],this.bound[a]=function(t){return function(){return w[t].apply(w,arguments)}}(a);this.adapter.domReady(function(){return w.activate(),"creation"===w.options.showOn?w.prepareToShow():void 0})}return t.prototype.STICKS_OUT_TOP=1,t.prototype.STICKS_OUT_BOTTOM=2,t.prototype.STICKS_OUT_LEFT=1,t.prototype.STICKS_OUT_RIGHT=2,t.prototype["class"]={container:"opentip-container",opentip:"opentip",header:"ot-header",content:"ot-content",loadingIndicator:"ot-loading-indicator",close:"ot-close",goingToHide:"ot-going-to-hide",hidden:"ot-hidden",hiding:"ot-hiding",goingToShow:"ot-going-to-show",showing:"ot-showing",visible:"ot-visible",loading:"ot-loading",ajaxError:"ot-ajax-error",fixed:"ot-fixed",showEffectPrefix:"ot-show-effect-",hideEffectPrefix:"ot-hide-effect-",stylePrefix:"style-"},t.prototype._setup=function(){var t,e,i,o,s,n,r,a,h,p,d;for(this.debug("Setting up the tooltip."),this._buildContainer(),this.hideTriggers=[],h=this.options.hideTriggers,o=s=0,r=h.length;r>s;o=++s){if(e=h[o],i=null,t=this.options.hideOn instanceof Array?this.options.hideOn[o]:this.options.hideOn,"string"==typeof e)switch(e){case"trigger":t=t||"mouseout",i=this.triggerElement;break;case"tip":t=t||"mouseover",i=this.container;break;case"target":t=t||"mouseover",i=this.options.target;break;case"closeButton":break;default:throw Error("Unknown hide trigger: "+e+".")}else t=t||"mouseover",i=this.adapter.wrap(e);i&&this.hideTriggers.push({element:i,event:t,original:e})}for(p=this.hideTriggers,d=[],n=0,a=p.length;a>n;n++)e=p[n],d.push(this.showTriggersWhenVisible.push({element:e.element,event:"mouseover"}));return d},t.prototype._buildContainer=function(){return this.container=this.adapter.create('<div id="opentip-'+this.id+'" class="'+this["class"].container+" "+this["class"].hidden+" "+this["class"].stylePrefix+this.options.className+'"></div>'),this.adapter.css(this.container,{position:"absolute"}),this.options.ajax&&this.adapter.addClass(this.container,this["class"].loading),this.options.fixed&&this.adapter.addClass(this.container,this["class"].fixed),this.options.showEffect&&this.adapter.addClass(this.container,""+this["class"].showEffectPrefix+this.options.showEffect),this.options.hideEffect?this.adapter.addClass(this.container,""+this["class"].hideEffectPrefix+this.options.hideEffect):void 0},t.prototype._buildElements=function(){var t,e;return this.tooltipElement=this.adapter.create('<div class="'+this["class"].opentip+'"><div class="'+this["class"].header+'"></div><div class="'+this["class"].content+'"></div></div>'),this.backgroundCanvas=this.adapter.wrap(document.createElement("canvas")),this.adapter.css(this.backgroundCanvas,{position:"absolute"}),"undefined"!=typeof G_vmlCanvasManager&&null!==G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.adapter.unwrap(this.backgroundCanvas)),t=this.adapter.find(this.tooltipElement,"."+this["class"].header),this.options.title&&(e=this.adapter.create("<h1></h1>"),this.adapter.update(e,this.options.title,this.options.escapeTitle),this.adapter.append(t,e)),this.options.ajax&&!this.loaded&&this.adapter.append(this.tooltipElement,this.adapter.create('<div class="'+this["class"].loadingIndicator+'"><span>↻</span></div>')),__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(this.closeButtonElement=this.adapter.create('<a href="javascript:undefined;" class="'+this["class"].close+'"><span>Close</span></a>'),this.adapter.append(t,this.closeButtonElement)),this.adapter.append(this.container,this.backgroundCanvas),this.adapter.append(this.container,this.tooltipElement),this.adapter.append(document.body,this.container),this._newContent=!0,this.redraw=!0},t.prototype.setContent=function(t){return this.content=t,this._newContent=!0,"function"==typeof this.content?(this._contentFunction=this.content,this.content=""):this._contentFunction=null,this.visible?this._updateElementContent():void 0},t.prototype._updateElementContent=function(){var t;return(this._newContent||!this.options.cache&&this._contentFunction)&&(t=this.adapter.find(this.container,"."+this["class"].content),null!=t&&(this._contentFunction&&(this.debug("Executing content function."),this.content=this._contentFunction(this)),this.adapter.update(t,this.content,this.options.escapeContent)),this._newContent=!1),this._storeAndLockDimensions(),this.reposition()},t.prototype._storeAndLockDimensions=function(){var t;return this.container?(t=this.dimensions,this.adapter.css(this.container,{width:"auto",left:"0px",top:"0px"}),this.dimensions=this.adapter.dimensions(this.container),this.dimensions.width+=1,this.adapter.css(this.container,{width:""+this.dimensions.width+"px",top:""+this.currentPosition.top+"px",left:""+this.currentPosition.left+"px"}),this._dimensionsEqual(this.dimensions,t)?void 0:(this.redraw=!0,this._draw())):void 0},t.prototype.activate=function(){return this._setupObservers("hidden","hiding")},t.prototype.deactivate=function(){return this.debug("Deactivating tooltip."),this.hide(),this._setupObservers("-showing","-visible","-hidden","-hiding")},t.prototype._setupObservers=function(){var t,e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m=this;for(o=arguments.length>=1?__slice.call(arguments,0):[],n=0,p=o.length;p>n;n++)if(i=o[n],e=!1,"-"===i.charAt(0)&&(e=!0,i=i.substr(1)),this.currentObservers[i]!==!e)switch(this.currentObservers[i]=!e,t=function(){var t,i,o;return t=arguments.length>=1?__slice.call(arguments,0):[],e?(i=m.adapter).stopObserving.apply(i,t):(o=m.adapter).observe.apply(o,t)},i){case"showing":for(c=this.hideTriggers,r=0,d=c.length;d>r;r++)s=c[r],t(s.element,s.event,this.bound.prepareToHide);t(null!=document.onresize?document:window,"resize",this.bound.reposition),t(window,"scroll",this.bound.reposition);break;case"visible":for(g=this.showTriggersWhenVisible,a=0,l=g.length;l>a;a++)s=g[a],t(s.element,s.event,this.bound.prepareToShow);break;case"hiding":for(f=this.showTriggers,h=0,u=f.length;u>h;h++)s=f[h],t(s.element,s.event,this.bound.prepareToShow);break;case"hidden":break;default:throw Error("Unknown state: "+i)}return null},t.prototype.prepareToShow=function(){return this._abortHiding(),this._abortShowing(),this.visible?void 0:(this.debug("Showing in "+this.options.delay+"s."),null==this.container&&this._setup(),this.options.group&&t._abortShowingGroup(this.options.group,this),this.preparingToShow=!0,this._setupObservers("-hidden","-hiding","showing"),this._followMousePosition(),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this._showTimeoutId=this.setTimeout(this.bound.show,this.options.delay||0))},t.prototype.show=function(){var e=this;return this._abortHiding(),this.visible?void 0:(this._clearTimeouts(),this._triggerElementExists()?(this.debug("Showing now."),null==this.container&&this._setup(),this.options.group&&t._hideGroup(this.options.group,this),this.visible=!0,this.preparingToShow=!1,null==this.tooltipElement&&this._buildElements(),this._updateElementContent(),!this.options.ajax||this.loaded&&this.options.cache||this._loadAjax(),this._searchAndActivateCloseButtons(),this._startEnsureTriggerElement(),this.adapter.css(this.container,{zIndex:t.lastZIndex++}),this._setupObservers("-hidden","-hiding","-showing","-visible","showing","visible"),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this.adapter.removeClass(this.container,this["class"].hiding),this.adapter.removeClass(this.container,this["class"].hidden),this.adapter.addClass(this.container,this["class"].goingToShow),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var t;return e.visible&&!e.preparingToHide?(e.adapter.removeClass(e.container,e["class"].goingToShow),e.adapter.addClass(e.container,e["class"].showing),t=0,e.options.showEffect&&e.options.showEffectDuration&&(t=e.options.showEffectDuration),e.setCss3Style(e.container,{transitionDuration:""+t+"s"}),e._visibilityStateTimeoutId=e.setTimeout(function(){return e.adapter.removeClass(e.container,e["class"].showing),e.adapter.addClass(e.container,e["class"].visible)},t),e._activateFirstInput()):void 0}),this._draw()):this.deactivate())},t.prototype._abortShowing=function(){return this.preparingToShow?(this.debug("Aborting showing."),this._clearTimeouts(),this._stopFollowingMousePosition(),this.preparingToShow=!1,this._setupObservers("-showing","-visible","hiding","hidden")):void 0},t.prototype.prepareToHide=function(){return this._abortShowing(),this._abortHiding(),this.visible?(this.debug("Hiding in "+this.options.hideDelay+"s"),this.preparingToHide=!0,this._setupObservers("-showing","visible","-hidden","hiding"),this._hideTimeoutId=this.setTimeout(this.bound.hide,this.options.hideDelay)):void 0},t.prototype.hide=function(){var t=this;return this._abortShowing(),this.visible&&(this._clearTimeouts(),this.debug("Hiding!"),this.visible=!1,this.preparingToHide=!1,this._stopEnsureTriggerElement(),this._setupObservers("-showing","-visible","-hiding","-hidden","hiding","hidden"),this.options.fixed||this._stopFollowingMousePosition(),this.container)?(this.adapter.removeClass(this.container,this["class"].visible),this.adapter.removeClass(this.container,this["class"].showing),this.adapter.addClass(this.container,this["class"].goingToHide),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var e;return t.adapter.removeClass(t.container,t["class"].goingToHide),t.adapter.addClass(t.container,t["class"].hiding),e=0,t.options.hideEffect&&t.options.hideEffectDuration&&(e=t.options.hideEffectDuration),t.setCss3Style(t.container,{transitionDuration:""+e+"s"}),t._visibilityStateTimeoutId=t.setTimeout(function(){return t.adapter.removeClass(t.container,t["class"].hiding),t.adapter.addClass(t.container,t["class"].hidden),t.setCss3Style(t.container,{transitionDuration:"0s"}),t.options.removeElementsOnHide?(t.debug("Removing HTML elements."),t.adapter.remove(t.container),delete t.container,delete t.tooltipElement):void 0},e)})):void 0},t.prototype._abortHiding=function(){return this.preparingToHide?(this.debug("Aborting hiding."),this._clearTimeouts(),this.preparingToHide=!1,this._setupObservers("-hiding","showing","visible")):void 0},t.prototype.reposition=function(){var t,e,i,o=this;return t=this.getPosition(),null==t||(e=this.options.stem,this.options.containInViewport&&(i=this._ensureViewportContainment(t),t=i.position,e=i.stem),this._positionsEqual(t,this.currentPosition))?void 0:(this.options.stem&&!e.eql(this.currentStem)&&(this.redraw=!0),this.currentPosition=t,this.currentStem=e,this._draw(),this.adapter.css(this.container,{left:""+t.left+"px",top:""+t.top+"px"}),this.defer(function(){var t,e;return t=o.adapter.unwrap(o.container),t.style.visibility="hidden",e=t.offsetHeight,t.style.visibility="visible"}))},t.prototype.getPosition=function(t,e,i){var o,s,n,r,a,h,p,d,l;return this.container?(null==t&&(t=this.options.tipJoint),null==e&&(e=this.options.targetJoint),r={},this.options.target?(p=this.adapter.offset(this.options.target),h=this.adapter.dimensions(this.options.target),r=p,e.right?(d=this.adapter.unwrap(this.options.target),null!=d.getBoundingClientRect?r.left=d.getBoundingClientRect().right+(null!=(l=window.pageXOffset)?l:document.body.scrollLeft):r.left+=h.width):e.center&&(r.left+=Math.round(h.width/2)),e.bottom?r.top+=h.height:e.middle&&(r.top+=Math.round(h.height/2)),this.options.borderWidth&&(this.options.tipJoint.left&&(r.left+=this.options.borderWidth),this.options.tipJoint.right&&(r.left-=this.options.borderWidth),this.options.tipJoint.top?r.top+=this.options.borderWidth:this.options.tipJoint.bottom&&(r.top-=this.options.borderWidth))):r=this.initialMousePosition?{top:this.initialMousePosition.y,left:this.initialMousePosition.x}:{top:mousePosition.y,left:mousePosition.x},this.options.autoOffset&&(a=this.options.stem?this.options.stemLength:0,n=a&&this.options.fixed?2:10,o=t.middle&&!this.options.fixed?15:0,s=t.center&&!this.options.fixed?15:0,t.right?r.left-=n+o:t.left&&(r.left+=n+o),t.bottom?r.top-=n+s:t.top&&(r.top+=n+s),a&&(null==i&&(i=this.options.stem),i.right?r.left-=a:i.left&&(r.left+=a),i.bottom?r.top-=a:i.top&&(r.top+=a))),r.left+=this.options.offset[0],r.top+=this.options.offset[1],t.right?r.left-=this.dimensions.width:t.center&&(r.left-=Math.round(this.dimensions.width/2)),t.bottom?r.top-=this.dimensions.height:t.middle&&(r.top-=Math.round(this.dimensions.height/2)),r):void 0},t.prototype._ensureViewportContainment=function(e){var i,o,s,n,r,a,h,p,d,l,u,c;if(h=this.options.stem,s={position:e,stem:h},!this.visible||!e)return s;if(p=this._sticksOut(e),!p[0]&&!p[1])return s;if(l=new t.Joint(this.options.tipJoint),this.options.targetJoint&&(d=new t.Joint(this.options.targetJoint)),a=this.adapter.scrollOffset(),u=this.adapter.viewportDimensions(),c=[e.left-a[0],e.top-a[1]],i=!1,u.width>=this.dimensions.width&&p[0])switch(i=!0,p[0]){case this.STICKS_OUT_LEFT:l.setHorizontal("left"),this.options.targetJoint&&d.setHorizontal("right");break;case this.STICKS_OUT_RIGHT:l.setHorizontal("right"),this.options.targetJoint&&d.setHorizontal("left")}if(u.height>=this.dimensions.height&&p[1])switch(i=!0,p[1]){case this.STICKS_OUT_TOP:l.setVertical("top"),this.options.targetJoint&&d.setVertical("bottom");break;case this.STICKS_OUT_BOTTOM:l.setVertical("bottom"),this.options.targetJoint&&d.setVertical("top")}return i?(this.options.stem&&(h=l),e=this.getPosition(l,d,h),o=this._sticksOut(e),n=!1,r=!1,o[0]&&o[0]!==p[0]&&(n=!0,l.setHorizontal(this.options.tipJoint.horizontal),this.options.targetJoint&&d.setHorizontal(this.options.targetJoint.horizontal)),o[1]&&o[1]!==p[1]&&(r=!0,l.setVertical(this.options.tipJoint.vertical),this.options.targetJoint&&d.setVertical(this.options.targetJoint.vertical)),n&&r?s:((n||r)&&(this.options.stem&&(h=l),e=this.getPosition(l,d,h)),{position:e,stem:h})):s},t.prototype._sticksOut=function(t){var e,i,o,s;return i=this.adapter.scrollOffset(),s=this.adapter.viewportDimensions(),e=[t.left-i[0],t.top-i[1]],o=[!1,!1],0>e[0]?o[0]=this.STICKS_OUT_LEFT:e[0]+this.dimensions.width>s.width&&(o[0]=this.STICKS_OUT_RIGHT),0>e[1]?o[1]=this.STICKS_OUT_TOP:e[1]+this.dimensions.height>s.height&&(o[1]=this.STICKS_OUT_BOTTOM),o},t.prototype._draw=function(){var e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m,v,b,w,_=this;if(this.backgroundCanvas&&this.redraw){if(this.debug("Drawing background."),this.redraw=!1,this.currentStem){for(v=["top","right","bottom","left"],f=0,m=v.length;m>f;f++)u=v[f],this.adapter.removeClass(this.container,"stem-"+u);this.adapter.addClass(this.container,"stem-"+this.currentStem.horizontal),this.adapter.addClass(this.container,"stem-"+this.currentStem.vertical)}return r=[0,0],a=[0,0],__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(n=new t.Joint("top right"===(null!=(b=this.currentStem)?b+"":void 0)?"top left":"top right"),r=[this.options.closeButtonRadius+this.options.closeButtonOffset[0],this.options.closeButtonRadius+this.options.closeButtonOffset[1]],a=[this.options.closeButtonRadius-this.options.closeButtonOffset[0],this.options.closeButtonRadius-this.options.closeButtonOffset[1]]),o=this.adapter.clone(this.dimensions),s=[0,0],this.options.borderWidth&&(o.width+=2*this.options.borderWidth,o.height+=2*this.options.borderWidth,s[0]-=this.options.borderWidth,s[1]-=this.options.borderWidth),this.options.shadow&&(o.width+=2*this.options.shadowBlur,o.width+=Math.max(0,this.options.shadowOffset[0]-2*this.options.shadowBlur),o.height+=2*this.options.shadowBlur,o.height+=Math.max(0,this.options.shadowOffset[1]-2*this.options.shadowBlur),s[0]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[0]),s[1]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[1])),i={left:0,right:0,top:0,bottom:0},this.currentStem&&(this.currentStem.left?i.left=this.options.stemLength:this.currentStem.right&&(i.right=this.options.stemLength),this.currentStem.top?i.top=this.options.stemLength:this.currentStem.bottom&&(i.bottom=this.options.stemLength)),n&&(n.left?i.left=Math.max(i.left,a[0]):n.right&&(i.right=Math.max(i.right,a[0])),n.top?i.top=Math.max(i.top,a[1]):n.bottom&&(i.bottom=Math.max(i.bottom,a[1]))),o.width+=i.left+i.right,o.height+=i.top+i.bottom,s[0]-=i.left,s[1]-=i.top,this.currentStem&&this.options.borderWidth&&(w=this._getPathStemMeasures(this.options.stemBase,this.options.stemLength,this.options.borderWidth),g=w.stemLength,c=w.stemBase),e=this.adapter.unwrap(this.backgroundCanvas),e.width=o.width,e.height=o.height,this.adapter.css(this.backgroundCanvas,{width:""+e.width+"px",height:""+e.height+"px",left:""+s[0]+"px",top:""+s[1]+"px"}),h=e.getContext("2d"),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,e.width,e.height),h.beginPath(),h.fillStyle=this._getColor(h,this.dimensions,this.options.background,this.options.backgroundGradientHorizontal),h.lineJoin="miter",h.miterLimit=500,l=this.options.borderWidth/2,this.options.borderWidth?(h.strokeStyle=this.options.borderColor,h.lineWidth=this.options.borderWidth):(g=this.options.stemLength,c=this.options.stemBase),null==c&&(c=0),d=function(t,e,i){return i&&h.moveTo(Math.max(c,_.options.borderRadius,r[0])+1-l,-l),e?(h.lineTo(t/2-c/2,-l),h.lineTo(t/2,-g-l),h.lineTo(t/2+c/2,-l)):void 0},p=function(t,e,i){var o,s,n,a;return t?(h.lineTo(-c+l,0-l),h.lineTo(g+l,-g-l),h.lineTo(l,c-l)):e?(a=_.options.closeButtonOffset,n=r[0],i%2!==0&&(a=[a[1],a[0]],n=r[1]),o=Math.acos(a[1]/_.options.closeButtonRadius),s=Math.acos(a[0]/_.options.closeButtonRadius),h.lineTo(-n+l,-l),h.arc(l-a[0],-l+a[1],_.options.closeButtonRadius,-(Math.PI/2+o),s,!1)):(h.lineTo(-_.options.borderRadius+l,-l),h.quadraticCurveTo(l,-l,l,_.options.borderRadius-l))},h.translate(-s[0],-s[1]),h.save(),function(){var e,i,o,s,r,a,l,u,c,g,f;for(f=[],i=c=0,g=t.positions.length/2;g>=0?g>c:c>g;i=g>=0?++c:--c)r=2*i,a=0===i||3===i?0:_.dimensions.width,l=2>i?0:_.dimensions.height,u=Math.PI/2*i,o=i%2===0?_.dimensions.width:_.dimensions.height,s=new t.Joint(t.positions[r]),e=new t.Joint(t.positions[r+1]),h.save(),h.translate(a,l),h.rotate(u),d(o,s.eql(_.currentStem),0===i),h.translate(o,0),p(e.eql(_.currentStem),e.eql(n),i),f.push(h.restore());return f}(),h.closePath(),h.save(),this.options.shadow&&(h.shadowColor=this.options.shadowColor,h.shadowBlur=this.options.shadowBlur,h.shadowOffsetX=this.options.shadowOffset[0],h.shadowOffsetY=this.options.shadowOffset[1]),h.fill(),h.restore(),this.options.borderWidth&&h.stroke(),h.restore(),n?function(){var t,e,i,o,s;return i=e=2*_.options.closeButtonRadius,n+""=="top right"?(s=[_.dimensions.width-_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[s[0]+l,s[1]-l]):(s=[_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[s[0]-l,s[1]-l]),h.translate(t[0],t[1]),o=_.options.closeButtonCrossSize/2,h.save(),h.beginPath(),h.strokeStyle=_.options.closeButtonCrossColor,h.lineWidth=_.options.closeButtonCrossLineWidth,h.lineCap="round",h.moveTo(-o,-o),h.lineTo(o,o),h.stroke(),h.beginPath(),h.moveTo(o,-o),h.lineTo(-o,o),h.stroke(),h.restore(),_.adapter.css(_.closeButtonElement,{left:""+(s[0]-o-_.options.closeButtonLinkOverscan)+"px",top:""+(s[1]-o-_.options.closeButtonLinkOverscan)+"px",width:""+(_.options.closeButtonCrossSize+2*_.options.closeButtonLinkOverscan)+"px",height:""+(_.options.closeButtonCrossSize+2*_.options.closeButtonLinkOverscan)+"px"})}():void 0}},t.prototype._getPathStemMeasures=function(t,e,i){var o,s,n,r,a,h,p;if(r=i/2,n=Math.atan(t/2/e),o=2*n,a=r/Math.sin(o),s=2*a*Math.cos(n),p=r+e-s,0>p)throw Error("Sorry but your stemLength / stemBase ratio is strange.");return h=Math.tan(n)*p*2,{stemLength:p,stemBase:h}},t.prototype._getColor=function(t,e,i,o){var s,n,r,a,h;if(null==o&&(o=!1),"string"==typeof i)return i;for(n=o?t.createLinearGradient(0,0,e.width,0):t.createLinearGradient(0,0,0,e.height),r=a=0,h=i.length;h>a;r=++a)s=i[r],n.addColorStop(s[0],s[1]);return n},t.prototype._searchAndActivateCloseButtons=function(){var t,e,i,o;for(o=this.adapter.findAll(this.container,"."+this["class"].close),e=0,i=o.length;i>e;e++)t=o[e],this.hideTriggers.push({element:this.adapter.wrap(t),event:"click"});return this.currentObservers.showing&&this._setupObservers("-showing","showing"),this.currentObservers.visible?this._setupObservers("-visible","visible"):void 0},t.prototype._activateFirstInput=function(){var t;return t=this.adapter.unwrap(this.adapter.find(this.container,"input, textarea")),null!=t&&"function"==typeof t.focus?t.focus():void 0},t.prototype._followMousePosition=function(){return this.options.fixed?void 0:t._observeMousePosition(this.bound.reposition)},t.prototype._stopFollowingMousePosition=function(){return this.options.fixed?void 0:t._stopObservingMousePosition(this.bound.reposition)},t.prototype._clearShowTimeout=function(){return clearTimeout(this._showTimeoutId)},t.prototype._clearHideTimeout=function(){return clearTimeout(this._hideTimeoutId)},t.prototype._clearTimeouts=function(){return clearTimeout(this._visibilityStateTimeoutId),this._clearShowTimeout(),this._clearHideTimeout()},t.prototype._triggerElementExists=function(){var t;for(t=this.adapter.unwrap(this.triggerElement);t.parentNode;){if("BODY"===t.parentNode.tagName)return!0;t=t.parentNode}return!1},t.prototype._loadAjax=function(){var t=this;return this.loading?void 0:(this.loaded=!1,this.loading=!0,this.adapter.addClass(this.container,this["class"].loading),this.setContent(""),this.debug("Loading content from "+this.options.ajax),this.adapter.ajax({url:this.options.ajax,method:this.options.ajaxMethod,onSuccess:function(e){return t.debug("Loading successful."),t.adapter.removeClass(t.container,t["class"].loading),t.setContent(e)},onError:function(e){var i;return i=t.options.ajaxErrorMessage,t.debug(i,e),t.setContent(i),t.adapter.addClass(t.container,t["class"].ajaxError)},onComplete:function(){return t.adapter.removeClass(t.container,t["class"].loading),t.loading=!1,t.loaded=!0,t._searchAndActivateCloseButtons(),t._activateFirstInput(),t.reposition()}}))},t.prototype._ensureTriggerElement=function(){return this._triggerElementExists()?void 0:(this.deactivate(),this._stopEnsureTriggerElement())},t.prototype._ensureTriggerElementInterval=1e3,t.prototype._startEnsureTriggerElement=function(){var t=this;return this._ensureTriggerElementTimeoutId=setInterval(function(){return t._ensureTriggerElement()},this._ensureTriggerElementInterval)},t.prototype._stopEnsureTriggerElement=function(){return clearInterval(this._ensureTriggerElementTimeoutId)},t}(),vendors=["khtml","ms","o","moz","webkit"],Opentip.prototype.setCss3Style=function(t,e){var i,o,s,n,r;t=this.adapter.unwrap(t),r=[];for(i in e)__hasProp.call(e,i)&&(o=e[i],null!=t.style[i]?r.push(t.style[i]=o):r.push(function(){var e,r,a;for(a=[],e=0,r=vendors.length;r>e;e++)s=vendors[e],n=""+this.ucfirst(s)+this.ucfirst(i),null!=t.style[n]?a.push(t.style[n]=o):a.push(void 0);return a}.call(this)));return r},Opentip.prototype.defer=function(t){return setTimeout(t,0)},Opentip.prototype.setTimeout=function(t,e){return setTimeout(t,e?1e3*e:0)},Opentip.prototype.ucfirst=function(t){return null==t?"":t.charAt(0).toUpperCase()+t.slice(1)},Opentip.prototype.dasherize=function(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})},mousePositionObservers=[],mousePosition={x:0,y:0},mouseMoved=function(t){var e,i,o,s;for(mousePosition=Opentip.adapter.mousePosition(t),s=[],i=0,o=mousePositionObservers.length;o>i;i++)e=mousePositionObservers[i],s.push(e());return s},Opentip.followMousePosition=function(){return Opentip.adapter.observe(document.body,"mousemove",mouseMoved)},Opentip._observeMousePosition=function(t){return mousePositionObservers.push(t)},Opentip._stopObservingMousePosition=function(t){var e;return mousePositionObservers=function(){var i,o,s;for(s=[],i=0,o=mousePositionObservers.length;o>i;i++)e=mousePositionObservers[i],e!==t&&s.push(e);return s}()},Opentip.Joint=function(){function t(t){null!=t&&(t instanceof Opentip.Joint&&(t+=""),this.set(t))}return t.prototype.set=function(t){return t=t.toLowerCase(),this.setHorizontal(t),this.setVertical(t),this},t.prototype.setHorizontal=function(t){var e,i,o,s,n,r,a;for(i=["left","center","right"],o=0,n=i.length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.horizontal=e.toLowerCase());for(null==this.horizontal&&(this.horizontal="center"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.horizontal===e?e:void 0);return a},t.prototype.setVertical=function(t){var e,i,o,s,n,r,a;for(i=["top","middle","bottom"],o=0,n=i.length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.vertical=e.toLowerCase());for(null==this.vertical&&(this.vertical="middle"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.vertical===e?e:void 0);return a},t.prototype.eql=function(t){return null!=t&&this.horizontal===t.horizontal&&this.vertical===t.vertical},t.prototype.flip=function(){var t,e;return e=Opentip.position[this.toString(!0)],t=(e+4)%8,this.set(Opentip.positions[t]),this},t.prototype.toString=function(t){var e,i;return null==t&&(t=!1),i="middle"===this.vertical?"":this.vertical,e="center"===this.horizontal?"":this.horizontal,i&&e&&(e=t?Opentip.prototype.ucfirst(e):" "+e),""+i+e},t}(),Opentip.prototype._positionsEqual=function(t,e){return null!=t&&null!=e&&t.left===e.left&&t.top===e.top},Opentip.prototype._dimensionsEqual=function(t,e){return null!=t&&null!=e&&t.width===e.width&&t.height===e.height},Opentip.prototype.debug=function(){var t;return t=arguments.length>=1?__slice.call(arguments,0):[],Opentip.debug&&null!=("undefined"!=typeof console&&null!==console?console.debug:void 0)?(t.unshift("#"+this.id+" |"),console.debug.apply(console,t)):void 0},Opentip.findElements=function(){var t,e,i,o,s,n,r,a,h,p;for(t=Opentip.adapter,h=t.findAll(document.body,"[data-ot]"),p=[],r=0,a=h.length;a>r;r++){i=h[r],n={},e=t.data(i,"ot"),(""===e||"true"===e||"yes"===e)&&(e=t.attr(i,"title"),t.attr(i,"title","")),e=e||"";for(o in Opentip.styles.standard)s=t.data(i,"ot"+Opentip.prototype.ucfirst(o)),null!=s&&("yes"===s||"true"===s||"on"===s?s=!0:("no"===s||"false"===s||"off"===s)&&(s=!1),n[o]=s);p.push(new Opentip(i,e,n))}return p},Opentip.version="2.4.6",Opentip.debug=!1,Opentip.lastId=0,Opentip.lastZIndex=100,Opentip.tips=[],Opentip._abortShowingGroup=function(t,e){var i,o,s,n,r;for(n=Opentip.tips,r=[],o=0,s=n.length;s>o;o++)i=n[o],i!==e&&i.options.group===t?r.push(i._abortShowing()):r.push(void 0);return r},Opentip._hideGroup=function(t,e){var i,o,s,n,r;for(n=Opentip.tips,r=[],o=0,s=n.length;s>o;o++)i=n[o],i!==e&&i.options.group===t?r.push(i.hide()):r.push(void 0);return r},Opentip.adapters={},Opentip.adapter=null,firstAdapter=!0,Opentip.addAdapter=function(t){return Opentip.adapters[t.name]=t,firstAdapter?(Opentip.adapter=t,t.domReady(Opentip.findElements),t.domReady(Opentip.followMousePosition),firstAdapter=!1):void 0},Opentip.positions=["top","topRight","right","bottomRight","bottom","bottomLeft","left","topLeft"],Opentip.position={},_ref=Opentip.positions,i=_i=0,_len=_ref.length;_len>_i;i=++_i)position=_ref[i],Opentip.position[position]=i;Opentip.styles={standard:{"extends":null,title:void 0,escapeTitle:!0,escapeContent:!1,className:"standard",stem:!0,delay:null,hideDelay:.1,fixed:!1,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,removeElementsOnHide:!1,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemLength:5,stemBase:8,tipJoint:"top left",target:null,targetJoint:null,cache:!0,ajax:!1,ajaxMethod:"GET",ajaxErrorMessage:"There was a problem downloading the content.",group:null,style:null,background:"#fff18f",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:5,borderWidth:1,borderColor:"#f2e37b",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.1)"},glass:{"extends":"standard",className:"glass",background:[[0,"rgba(252, 252, 252, 0.8)"],[.5,"rgba(255, 255, 255, 0.8)"],[.5,"rgba(250, 250, 250, 0.9)"],[1,"rgba(245, 245, 245, 0.9)"]],borderColor:"#eee",closeButtonCrossColor:"rgba(0, 0, 0, 0.2)",borderRadius:15,closeButtonRadius:10,closeButtonOffset:[8,8]},dark:{"extends":"standard",className:"dark",borderRadius:13,borderColor:"#444",closeButtonCrossColor:"rgba(240, 240, 240, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(30, 30, 30, 0.7)"],[.5,"rgba(30, 30, 30, 0.8)"],[.5,"rgba(10, 10, 10, 0.8)"],[1,"rgba(10, 10, 10, 0.9)"]]},alert:{"extends":"standard",className:"alert",borderRadius:1,borderColor:"#AE0D11",closeButtonCrossColor:"rgba(255, 255, 255, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(203, 15, 19, 0.7)"],[.5,"rgba(203, 15, 19, 0.8)"],[.5,"rgba(189, 14, 18, 0.8)"],[1,"rgba(179, 14, 17, 0.9)"]]}},Opentip.defaultStyle="standard","undefined"!=typeof module&&null!==module?module.exports=Opentip:window.Opentip=Opentip;var __slice=[].slice;!function(t){var e;return t.fn.opentip=function(t,e,i){return new Opentip(this,t,e,i)},e=function(){function e(){}return e.prototype.name="jquery",e.prototype.domReady=function(e){return t(e)},e.prototype.create=function(e){return t(e)},e.prototype.wrap=function(e){if(e=t(e),e.length>1)throw Error("Multiple elements provided.");return e},e.prototype.unwrap=function(e){
return t(e)[0]},e.prototype.tagName=function(t){return this.unwrap(t).tagName},e.prototype.attr=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).attr.apply(o,e)},e.prototype.data=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).data.apply(o,e)},e.prototype.find=function(e,i){return t(e).find(i).get(0)},e.prototype.findAll=function(e,i){return t(e).find(i)},e.prototype.update=function(e,i,o){return e=t(e),o?e.text(i):e.html(i)},e.prototype.append=function(e,i){return t(e).append(i)},e.prototype.remove=function(e){return t(e).remove()},e.prototype.addClass=function(e,i){return t(e).addClass(i)},e.prototype.removeClass=function(e,i){return t(e).removeClass(i)},e.prototype.css=function(e,i){return t(e).css(i)},e.prototype.dimensions=function(e){return{width:t(e).outerWidth(),height:t(e).outerHeight()}},e.prototype.scrollOffset=function(){return[window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop]},e.prototype.viewportDimensions=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},e.prototype.mousePosition=function(t){return null==t?null:{x:t.pageX,y:t.pageY}},e.prototype.offset=function(e){var i;return i=t(e).offset(),{left:i.left,top:i.top}},e.prototype.observe=function(e,i,o){return t(e).bind(i,o)},e.prototype.stopObserving=function(e,i,o){return t(e).unbind(i,o)},e.prototype.ajax=function(e){var i,o;if(null==e.url)throw Error("No url provided");return t.ajax({url:e.url,type:null!=(i=null!=(o=e.method)?o.toUpperCase():void 0)?i:"GET"}).done(function(t){return"function"==typeof e.onSuccess?e.onSuccess(t):void 0}).fail(function(t){return"function"==typeof e.onError?e.onError("Server responded with status "+t.status):void 0}).always(function(){return"function"==typeof e.onComplete?e.onComplete():void 0})},e.prototype.clone=function(e){return t.extend({},e)},e.prototype.extend=function(){var e,i;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],t.extend.apply(t,[i].concat(__slice.call(e)))},e}(),Opentip.addAdapter(new e)}(jQuery);
},{}],12:[function(require,module,exports){
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t,e){"use strict";function r(e,r,a,n){for(var i=[],s=0;s<e.length;s++){var o=e[s];if(o){var l=tinycolor(o),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(r,o)?" sp-thumb-active":"";var f=l.toString(n.preferredFormat||"rgb"),u=g?"background-color:"+l.toRgbString():"filter:"+l.toFilter();i.push('<span title="'+f+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+u+';" /></span>')}else{var h="sp-clear-display";i.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+h+'"></span>').attr("title",n.noColorSelectedText)).html())}}return"<div class='sp-cf "+a+"'>"+i.join("")+"</div>"}function a(){for(var t=0;t<d.length;t++)d[t]&&d[t].hide()}function n(e,r){var a=t.extend({},h,e);return a.callbacks={move:c(a.move,r),change:c(a.change,r),show:c(a.show,r),hide:c(a.hide,r),beforeShow:c(a.beforeShow,r)},a}function i(i,o){function c(){if($.showPaletteOnly&&($.showPalette=!0),Dt.text($.showPaletteOnly?$.togglePaletteMoreText:$.togglePaletteLessText),$.palette){ut=$.palette.slice(0),ht=t.isArray(ut[0])?ut:[ut],dt={};for(var e=0;e<ht.length;e++)for(var r=0;r<ht[e].length;r++){var a=tinycolor(ht[e][r]).toRgbString();dt[a]=!0}}_t.toggleClass("sp-flat",W),_t.toggleClass("sp-input-disabled",!$.showInput),_t.toggleClass("sp-alpha-enabled",$.showAlpha),_t.toggleClass("sp-clear-enabled",Gt),_t.toggleClass("sp-buttons-disabled",!$.showButtons),_t.toggleClass("sp-palette-buttons-disabled",!$.togglePaletteOnly),_t.toggleClass("sp-palette-disabled",!$.showPalette),_t.toggleClass("sp-palette-only",$.showPaletteOnly),_t.toggleClass("sp-initial-disabled",!$.showInitial),_t.addClass($.className).addClass($.containerClassName),j()}function h(){function e(e){return e.data&&e.data.ignore?(T(t(e.target).closest(".sp-thumb-el").data("color")),N()):(T(t(e.target).closest(".sp-thumb-el").data("color")),N(),I(!0),$.hideAfterPaletteSelect&&R()),!1}if(p&&_t.find("*:not(input)").attr("unselectable","on"),c(),jt&&yt.after(zt).hide(),Gt||qt.hide(),W)yt.after(_t).hide();else{var r="parent"===$.appendTo?yt.parent():t($.appendTo);1!==r.length&&(r=t("body")),r.append(_t)}y(),Bt.bind("click.spectrum touchstart.spectrum",function(e){wt||A(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(yt.is(":disabled")||$.disabled===!0)&&K(),_t.click(l),Rt.change(P),Rt.bind("paste",function(){setTimeout(P,1)}),Rt.keydown(function(t){13==t.keyCode&&P()}),Ot.text($.cancelText),Ot.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),F(),R()}),qt.attr("title",$.clearText),qt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Yt=!0,N(),W&&I(!0)}),Nt.text($.chooseText),Nt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),q()&&(I(!0),R())}),Dt.text($.showPaletteOnly?$.togglePaletteMoreText:$.togglePaletteLessText),Dt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),$.showPaletteOnly=!$.showPaletteOnly,$.showPaletteOnly||W||_t.css("left","-="+(xt.outerWidth(!0)+5)),c()}),f(Mt,function(t,e,r){ft=t/nt,Yt=!1,r.shiftKey&&(ft=Math.round(10*ft)/10),N()},S,C),f(Ct,function(t,e){ot=parseFloat(e/rt),Yt=!1,$.showAlpha||(ft=1),N()},S,C),f(kt,function(t,e,r){if(r.shiftKey){if(!vt){var a=lt*Z,n=tt-ct*tt,i=Math.abs(t-a)>Math.abs(e-n);vt=i?"x":"y"}}else vt=null;var s=!vt||"x"===vt,o=!vt||"y"===vt;s&&(lt=parseFloat(t/Z)),o&&(ct=parseFloat((tt-e)/tt)),Yt=!1,$.showAlpha||(ft=1),N()},S,C),Kt?(T(Kt),D(),Wt=$t||tinycolor(Kt).format,w(Kt)):D(),W&&M();var a=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Ft.delegate(".sp-thumb-el",a,e),Tt.delegate(".sp-thumb-el:nth-child(1)",a,{ignore:!0},e)}function y(){if(Y&&window.localStorage){try{var e=window.localStorage[Y].split(",#");e.length>1&&(delete window.localStorage[Y],t.each(e,function(t,e){w(e)}))}catch(r){}try{pt=window.localStorage[Y].split(";")}catch(r){}}}function w(e){if(X){var r=tinycolor(e).toRgbString();if(!dt[r]&&-1===t.inArray(r,pt))for(pt.push(r);pt.length>gt;)pt.shift();if(Y&&window.localStorage)try{window.localStorage[Y]=pt.join(";")}catch(a){}}}function _(){var t=[];if($.showPalette)for(var e=0;e<pt.length;e++){var r=tinycolor(pt[e]).toRgbString();dt[r]||t.push(pt[e])}return t.reverse().slice(0,$.maxSelectionSize)}function x(){var e=O(),a=t.map(ht,function(t,a){return r(t,e,"sp-palette-row sp-palette-row-"+a,$)});y(),pt&&a.push(r(_(),e,"sp-palette-row sp-palette-row-selection",$)),Ft.html(a.join(""))}function k(){if($.showInitial){var t=Vt,e=O();Tt.html(r([t,e],e,"sp-palette-row-initial",$))}}function S(){(0>=tt||0>=Z||0>=rt)&&j(),_t.addClass(bt),vt=null,yt.trigger("dragstart.spectrum",[O()])}function C(){_t.removeClass(bt),yt.trigger("dragstop.spectrum",[O()])}function P(){var t=Rt.val();if(null!==t&&""!==t||!Gt){var e=tinycolor(t);e.isValid()?(T(e),I(!0)):Rt.addClass("sp-validation-error")}else T(null),I(!0)}function A(){U?R():M()}function M(){var e=t.Event("beforeShow.spectrum");return U?void j():(yt.trigger(e,[O()]),void(Q.beforeShow(O())===!1||e.isDefaultPrevented()||(a(),U=!0,t(mt).bind("click.spectrum",H),t(window).bind("resize.spectrum",J),zt.addClass("sp-active"),_t.removeClass("sp-hidden"),j(),D(),Vt=O(),k(),Q.show(Vt),yt.trigger("show.spectrum",[Vt]))))}function H(t){2!=t.button&&(Xt?I(!0):F(),R())}function R(){U&&!W&&(U=!1,t(mt).unbind("click.spectrum",H),t(window).unbind("resize.spectrum",J),zt.removeClass("sp-active"),_t.addClass("sp-hidden"),Q.hide(O()),yt.trigger("hide.spectrum",[O()]))}function F(){T(Vt,!0)}function T(t,e){if(tinycolor.equals(t,O()))return void D();var r,a;!t&&Gt?Yt=!0:(Yt=!1,r=tinycolor(t),a=r.toHsv(),ot=a.h%360/360,lt=a.s,ct=a.v,ft=a.a),D(),r&&r.isValid()&&!e&&(Wt=$t||r.getFormat())}function O(t){return t=t||{},Gt&&Yt?null:tinycolor.fromRatio({h:ot,s:lt,v:ct,a:Math.round(100*ft)/100},{format:t.format||Wt})}function q(){return!Rt.hasClass("sp-validation-error")}function N(){D(),Q.move(O()),yt.trigger("move.spectrum",[O()])}function D(){Rt.removeClass("sp-validation-error"),E();var t=tinycolor.fromRatio({h:ot,s:1,v:1});kt.css("background-color",t.toHexString());var e=Wt;1>ft&&(0!==ft||"name"!==e)&&("hex"!==e&&"hex3"!==e&&"hex6"!==e&&"name"!==e||(e="rgb"));var r=O({format:e}),a="";if(Lt.removeClass("sp-clear-display"),Lt.css("background-color","transparent"),!r&&Gt)Lt.addClass("sp-clear-display");else{var n=r.toHexString(),i=r.toRgbString();if(g||1===r.alpha?Lt.css("background-color",i):(Lt.css("background-color","transparent"),Lt.css("filter",r.toFilter())),$.showAlpha){var s=r.toRgb();s.a=0;var o=tinycolor(s).toRgbString(),l="linear-gradient(left, "+o+", "+n+")";p?At.css("filter",tinycolor(o).toFilter({gradientType:1},n)):(At.css("background","-webkit-"+l),At.css("background","-moz-"+l),At.css("background","-ms-"+l),At.css("background","linear-gradient(to right, "+o+", "+n+")"))}a=r.toString(e)}$.showInput&&Rt.val(a),$.showPalette&&x(),k()}function E(){var t=lt,e=ct;if(Gt&&Yt)Ht.hide(),Pt.hide(),St.hide();else{Ht.show(),Pt.show(),St.show();var r=t*Z,a=tt-e*tt;r=Math.max(-et,Math.min(Z-et,r-et)),a=Math.max(-et,Math.min(tt-et,a-et)),St.css({top:a+"px",left:r+"px"});var n=ft*nt;Ht.css({left:n-it/2+"px"});var i=ot*rt;Pt.css({top:i-st+"px"})}}function I(t){var e=O(),r="",a=!tinycolor.equals(e,Vt);e&&(r=e.toString(Wt),w(e)),Et&&yt.val(r),t&&a&&(Q.change(e),yt.trigger("change",[e]))}function j(){Z=kt.width(),tt=kt.height(),et=St.height(),at=Ct.width(),rt=Ct.height(),st=Pt.height(),nt=Mt.width(),it=Ht.width(),W||(_t.css("position","absolute"),$.offset?_t.offset($.offset):_t.offset(s(_t,Bt))),E(),$.showPalette&&x(),yt.trigger("reflow.spectrum")}function z(){yt.show(),Bt.unbind("click.spectrum touchstart.spectrum"),_t.remove(),zt.remove(),d[Qt.id]=null}function B(r,a){return r===e?t.extend({},$):a===e?$[r]:($[r]=a,void c())}function L(){wt=!1,yt.attr("disabled",!1),Bt.removeClass("sp-disabled")}function K(){R(),wt=!0,yt.attr("disabled",!0),Bt.addClass("sp-disabled")}function V(t){$.offset=t,j()}var $=n(o,i),W=$.flat,X=$.showSelectionPalette,Y=$.localStorageKey,G=$.theme,Q=$.callbacks,J=u(j,10),U=!1,Z=0,tt=0,et=0,rt=0,at=0,nt=0,it=0,st=0,ot=0,lt=0,ct=0,ft=1,ut=[],ht=[],dt={},pt=$.selectionPalette.slice(0),gt=$.maxSelectionSize,bt="sp-dragging",vt=null,mt=i.ownerDocument,yt=(mt.body,t(i)),wt=!1,_t=t(m,mt).addClass(G),xt=_t.find(".sp-picker-container"),kt=_t.find(".sp-color"),St=_t.find(".sp-dragger"),Ct=_t.find(".sp-hue"),Pt=_t.find(".sp-slider"),At=_t.find(".sp-alpha-inner"),Mt=_t.find(".sp-alpha"),Ht=_t.find(".sp-alpha-handle"),Rt=_t.find(".sp-input"),Ft=_t.find(".sp-palette"),Tt=_t.find(".sp-initial"),Ot=_t.find(".sp-cancel"),qt=_t.find(".sp-clear"),Nt=_t.find(".sp-choose"),Dt=_t.find(".sp-palette-toggle"),Et=yt.is("input"),It=Et&&b&&"color"===yt.attr("type"),jt=Et&&!W,zt=jt?t(v).addClass(G).addClass($.className).addClass($.replacerClassName):t([]),Bt=jt?zt:yt,Lt=zt.find(".sp-preview-inner"),Kt=$.color||Et&&yt.val(),Vt=!1,$t=$.preferredFormat,Wt=$t,Xt=!$.showButtons||$.clickoutFiresChange,Yt=!Kt,Gt=$.allowEmpty&&!It;h();var Qt={show:M,hide:R,toggle:A,reflow:j,option:B,enable:L,disable:K,offset:V,set:function(t){T(t),I()},get:O,destroy:z,container:_t};return Qt.id=d.push(Qt)-1,Qt}function s(e,r){var a=0,n=e.outerWidth(),i=e.outerHeight(),s=r.outerHeight(),o=e[0].ownerDocument,l=o.documentElement,c=l.clientWidth+t(o).scrollLeft(),f=l.clientHeight+t(o).scrollTop(),u=r.offset();return u.top+=s,u.left-=Math.min(u.left,u.left+n>c&&c>n?Math.abs(u.left+n-c):0),u.top-=Math.min(u.top,u.top+i>f&&f>i?Math.abs(i+s-a):a),u}function o(){}function l(t){t.stopPropagation()}function c(t,e){var r=Array.prototype.slice,a=r.call(arguments,2);return function(){return t.apply(e,a.concat(r.call(arguments)))}}function f(e,r,a,n){function i(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function s(t){if(f){if(p&&c.documentMode<9&&!t.button)return l();var a=t.originalEvent&&t.originalEvent.touches,n=a?a[0].pageX:t.pageX,s=a?a[0].pageY:t.pageY,o=Math.max(0,Math.min(n-u.left,d)),b=Math.max(0,Math.min(s-u.top,h));g&&i(t),r.apply(e,[o,b,t])}}function o(r){var n=r.which?3==r.which:2==r.button;n||f||a.apply(e,arguments)!==!1&&(f=!0,h=t(e).height(),d=t(e).width(),u=t(e).offset(),t(c).bind(b),t(c.body).addClass("sp-dragging"),g||s(r),i(r))}function l(){f&&(t(c).unbind(b),t(c.body).removeClass("sp-dragging"),n.apply(e,arguments)),f=!1}r=r||function(){},a=a||function(){},n=n||function(){};var c=document,f=!1,u={},h=0,d=0,g="ontouchstart"in window,b={};b.selectstart=i,b.dragstart=i,b["touchmove mousemove"]=s,b["touchend mouseup"]=l,t(e).bind("touchstart mousedown",o)}function u(t,e,r){var a;return function(){var n=this,i=arguments,s=function(){a=null,t.apply(n,i)};r&&clearTimeout(a),!r&&a||(a=setTimeout(s,e))}}var h={beforeShow:o,move:o,change:o,show:o,hide:o,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},d=[],p=!!/msie/i.exec(window.navigator.userAgent),g=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div"),r=e.style;return r.cssText="background-color:rgba(0,0,0,.5)",t(r.backgroundColor,"rgba")||t(r.backgroundColor,"hsla")}(),b=function(){var e=t("<input type='color' value='!' />")[0];return"color"===e.type&&"!"!==e.value}(),v=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),m=function(){var t="";if(p)for(var e=1;6>=e;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),y="spectrum.id";t.fn.spectrum=function(e,r){if("string"==typeof e){var a=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=d[t(this).data(y)];if(r){var i=r[e];if(!i)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?a=r.get():"container"==e?a=r.container:"option"==e?a=r.option.apply(r,n):"destroy"==e?(r.destroy(),t(this).removeData(y)):i.apply(r,n)}}),a}return this.spectrum("destroy").each(function(){var r=t.extend({},e,t(this).data()),a=i(this,r);t(this).data(y,a.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=f,t.fn.spectrum.defaults=h,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){b||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function t(t){var r={r:0,g:0,b:0},n=1,s=!1,o=!1;return"string"==typeof t&&(t=T(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(r=e(t.r,t.g,t.b),s=!0,o="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=H(t.s),t.v=H(t.v),r=i(t.h,t.s,t.v),s=!0,o="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=H(t.s),t.l=H(t.l),r=a(t.h,t.s,t.l),s=!0,o="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=x(n),{ok:s,format:t.format||o,r:I(255,j(r.r,0)),g:I(255,j(r.g,0)),b:I(255,j(r.b,0)),a:n}}function e(t,e,r){return{r:255*k(t,255),g:255*k(e,255),b:255*k(r,255)}}function r(t,e,r){t=k(t,255),e=k(e,255),r=k(r,255);var a,n,i=j(t,e,r),s=I(t,e,r),o=(i+s)/2;if(i==s)a=n=0;else{var l=i-s;switch(n=o>.5?l/(2-i-s):l/(i+s),i){case t:a=(e-r)/l+(r>e?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4}a/=6}return{h:a,s:n,l:o}}function a(t,e,r){function a(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+(e-t)*(2/3-r)*6:t}var n,i,s;if(t=k(t,360),e=k(e,100),r=k(r,100),0===e)n=i=s=r;else{var o=.5>r?r*(1+e):r+e-r*e,l=2*r-o;n=a(l,o,t+1/3),i=a(l,o,t),s=a(l,o,t-1/3)}return{r:255*n,g:255*i,b:255*s}}function n(t,e,r){t=k(t,255),e=k(e,255),r=k(r,255);var a,n,i=j(t,e,r),s=I(t,e,r),o=i,l=i-s;if(n=0===i?0:l/i,i==s)a=0;else{switch(i){case t:a=(e-r)/l+(r>e?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4}a/=6}return{h:a,s:n,v:o}}function i(t,e,r){t=6*k(t,360),e=k(e,100),r=k(r,100);var a=D.floor(t),n=t-a,i=r*(1-e),s=r*(1-n*e),o=r*(1-(1-n)*e),l=a%6,c=[r,s,i,i,o,r][l],f=[o,r,r,s,i,i][l],u=[i,i,o,r,r,s][l];return{r:255*c,g:255*f,b:255*u}}function s(t,e,r,a){var n=[M(E(t).toString(16)),M(E(e).toString(16)),M(E(r).toString(16))];return a&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function o(t,e,r,a){var n=[M(R(a)),M(E(t).toString(16)),M(E(e).toString(16)),M(E(r).toString(16))];return n.join("")}function l(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.s-=e/100,r.s=S(r.s),B(r)}function c(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.s+=e/100,r.s=S(r.s),B(r)}function f(t){return B(t).desaturate(100)}function u(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.l+=e/100,r.l=S(r.l),B(r)}function h(t,e){e=0===e?0:e||10;var r=B(t).toRgb();return r.r=j(0,I(255,r.r-E(255*-(e/100)))),r.g=j(0,I(255,r.g-E(255*-(e/100)))),r.b=j(0,I(255,r.b-E(255*-(e/100)))),B(r)}function d(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.l-=e/100,r.l=S(r.l),B(r)}function p(t,e){var r=B(t).toHsl(),a=(E(r.h)+e)%360;return r.h=0>a?360+a:a,B(r)}function g(t){var e=B(t).toHsl();return e.h=(e.h+180)%360,B(e)}function b(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+120)%360,s:e.s,l:e.l}),B({h:(r+240)%360,s:e.s,l:e.l})]}function v(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+90)%360,s:e.s,l:e.l}),B({h:(r+180)%360,s:e.s,l:e.l}),B({h:(r+270)%360,s:e.s,l:e.l})]}function m(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+72)%360,s:e.s,l:e.l}),B({h:(r+216)%360,s:e.s,l:e.l})]}function y(t,e,r){e=e||6,r=r||30;var a=B(t).toHsl(),n=360/r,i=[B(t)];for(a.h=(a.h-(n*e>>1)+720)%360;--e;)a.h=(a.h+n)%360,i.push(B(a));return i}function w(t,e){e=e||6;for(var r=B(t).toHsv(),a=r.h,n=r.s,i=r.v,s=[],o=1/e;e--;)s.push(B({h:a,s:n,v:i})),i=(i+o)%1;return s}function _(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function x(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function k(t,e){P(t)&&(t="100%");var r=A(t);return t=I(e,j(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),D.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return I(1,j(0,t))}function C(t){return parseInt(t,16)}function P(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function A(t){return"string"==typeof t&&-1!=t.indexOf("%")}function M(t){return 1==t.length?"0"+t:""+t}function H(t){return 1>=t&&(t=100*t+"%"),t}function R(t){return Math.round(255*parseFloat(t)).toString(16)}function F(t){return C(t)/255}function T(t){t=t.replace(O,"").replace(q,"").toLowerCase();var e=!1;if(L[t])t=L[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=V.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=V.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=V.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=V.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=V.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=V.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=V.hex8.exec(t))?{a:F(r[1]),r:C(r[2]),g:C(r[3]),b:C(r[4]),format:e?"name":"hex8"}:(r=V.hex6.exec(t))?{r:C(r[1]),g:C(r[2]),b:C(r[3]),format:e?"name":"hex"}:(r=V.hex3.exec(t))?{r:C(r[1]+""+r[1]),g:C(r[2]+""+r[2]),b:C(r[3]+""+r[3]),format:e?"name":"hex"}:!1}var O=/^[\s,#]+/,q=/\s+$/,N=0,D=Math,E=D.round,I=D.min,j=D.max,z=D.random,B=function $(e,r){if(e=e?e:"",r=r||{},e instanceof $)return e;if(!(this instanceof $))return new $(e,r);var a=t(e);this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=E(100*this._a)/100,this._format=r.format||a.format,this._gradientType=r.gradientType,this._r<1&&(this._r=E(this._r)),this._g<1&&(this._g=E(this._g)),this._b<1&&(this._b=E(this._b)),this._ok=a.ok,this._tc_id=N++};B.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=x(t),this._roundA=E(100*this._a)/100,this},toHsv:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=n(this._r,this._g,this._b),e=E(360*t.h),r=E(100*t.s),a=E(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+a+"%)":"hsva("+e+", "+r+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=r(this._r,this._g,this._b),e=E(360*t.h),a=E(100*t.s),n=E(100*t.l);return 1==this._a?"hsl("+e+", "+a+"%, "+n+"%)":"hsla("+e+", "+a+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return s(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return o(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:E(this._r),g:E(this._g),b:E(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+E(this._r)+", "+E(this._g)+", "+E(this._b)+")":"rgba("+E(this._r)+", "+E(this._g)+", "+E(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:E(100*k(this._r,255))+"%",g:E(100*k(this._g,255))+"%",b:E(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+E(100*k(this._r,255))+"%, "+E(100*k(this._g,255))+"%, "+E(100*k(this._b,255))+"%)":"rgba("+E(100*k(this._r,255))+"%, "+E(100*k(this._g,255))+"%, "+E(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:K[s(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+o(this._r,this._g,this._b,this._a),r=e,a=this._gradientType?"GradientType = 1, ":"";if(t){var n=B(t);r=n.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,a=this._a<1&&this._a>=0,n=!e&&a&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return n?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(h,arguments)},darken:function(){return this._applyModification(d,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(f,arguments)},spin:function(){return this._applyModification(p,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(y,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(m,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(v,arguments)}},B.fromRatio=function(t,e){if("object"==typeof t){var r={};for(var a in t)t.hasOwnProperty(a)&&("a"===a?r[a]=t[a]:r[a]=H(t[a]));t=r}return B(t,e)},B.equals=function(t,e){return t&&e?B(t).toRgbString()==B(e).toRgbString():!1},B.random=function(){return B.fromRatio({r:z(),g:z(),b:z()})},B.mix=function(t,e,r){r=0===r?0:r||50;var a,n=B(t).toRgb(),i=B(e).toRgb(),s=r/100,o=2*s-1,l=i.a-n.a;a=o*l==-1?o:(o+l)/(1+o*l),a=(a+1)/2;var c=1-a,f={r:i.r*a+n.r*c,g:i.g*a+n.g*c,b:i.b*a+n.b*c,a:i.a*s+n.a*(1-s)};return B(f)},B.readability=function(t,e){var r=B(t),a=B(e),n=r.toRgb(),i=a.toRgb(),s=r.getBrightness(),o=a.getBrightness(),l=Math.max(n.r,i.r)-Math.min(n.r,i.r)+Math.max(n.g,i.g)-Math.min(n.g,i.g)+Math.max(n.b,i.b)-Math.min(n.b,i.b);return{brightness:Math.abs(s-o),color:l}},B.isReadable=function(t,e){var r=B.readability(t,e);return r.brightness>125&&r.color>500},B.mostReadable=function(t,e){for(var r=null,a=0,n=!1,i=0;i<e.length;i++){var s=B.readability(t,e[i]),o=s.brightness>125&&s.color>500,l=3*(s.brightness/125)+s.color/500;(o&&!n||o&&n&&l>a||!o&&!n&&l>a)&&(n=o,a=l,r=B(e[i]))}return r};var L=B.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=B.hexNames=_(L),V=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{rgb:new RegExp("rgb"+a),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+a),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+a),hsva:new RegExp("hsva"+n),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=B}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})});
},{"jquery":307}],13:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATDropdown=require("./ATDropDown"),ATSearchDropdown=require("./ATSearchDropDown"),templateHtml=require("./templates/addEntityTemplate.html"),ATAddEntityView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Enter Name"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.typeId=null,this.isPersistent=!1,this.$windowTitle=$("#addEntityWindowTitle"),this.d3WindowBelowMsg=d3.select("#addEntityWindowBelowMessage"),this.$nameInput=$("#addEntityInput"),this.$nameInput.on("input",this.validateNameInput.bind(this)),this.$submitButton=$("#addEntitySubmit"),this.$earlyInputCatcher=$("#modalInputCatcher"),this.createOffsetFromDropdown=new ATDropdown({el:"#addEntityCreateOffsetFrom"}),this.createEventSearchDropdown=new ATSearchDropdown({el:"#addEntityCreateEvent"}),this.createEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.createEventSearchDropdown.setSearchWordByWord(!0),this.d3CreateDate=this.d3El.select("#manageEntitiesCreateDate"),this.createDatePickerView=new ATDatePicker({el:"#addEntityCreateDate"}),this.createDatePickerView.setResetCallback(function(){window.setTimeout(t.resetCreateDateField.bind(t),0)}),this.createOffsetPickerView=new ATDurationPicker({el:"#addEntityCreateOffset"}),this.listenTo(this.createEventSearchDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.createOffsetFromDropdown,"change",this.createEventChangeHandler.bind(this)),this.createOffsetPickerView.setChangeCallback(this.createEventChangeHandler.bind(this)),$("#addEntityForm").on("submit",this.addClickHandler.bind(this))},setTypeId:function(e){this.typeId=e;var t=this.model.get("template"),i=t.types,n=!1;_.each(i,function(t){t.typeId==e&&(n=t.persistent)}),this.isPersistent=n,d3.select("#addEntityBirthInput").style("display",this.isPersistent?"none":null)},setRangeConversion:function(e){this.rangeConversion=e,this.createDatePickerView.setRangeConversion(e),this.createOffsetPickerView.setRangeConversion(e)},setCallback:function(e){this.callbackFunction=e},setValidatorFunction:function(e){this.validatorFunction=e},setWindowTitle:function(e){this.$windowTitle.text(e)},setWindowBelowMessage:function(e){this.d3WindowBelowMsg.text(e).style("display",e?null:"none")},resetForm:function(){this.$nameInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("active").val("").focus(),this.formSubmitted=!1,this.updateEventDropdowns(),this.createEventSearchDropdown.setValue(-1),this.createDatePickerView.setValue(null),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0),window.setTimeout(this.focusAndSelectNameIfUnfocused.bind(this),500)},resetCreateDateField:function(){this.createDatePickerView.setValue(null)},focusAndSelectNameIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$nameInput.val(e),this.$nameInput.focus(),this.$nameInput[0].setSelectionRange(t,t),this.validateNameInput(),this.$earlyInputCatcher.removeClass("active")},validateNameInput:function(){var e=this.$nameInput.val(),t=this.validatorFunction?this.validatorFunction(e):e.length>0;return this.$submitButton.prop("disabled",!t),t},createEventChangeHandler:function(){var e=this.createEventSearchDropdown.getValue();e>0?(0==this.createOffsetPickerView.text().length&&(this.createOffsetPickerView.setText("0 seconds"),this.createOffsetFromDropdown.setValue("start")),this.createDatePickerView.setDisabled(!0),this.createOffsetPickerView.setDisabled(!1),this.createOffsetFromDropdown.setDisabled(!1)):(this.createEventSearchDropdown.setValue(-1),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0))},updateEventDropdowns:function(){var e=this.model.get("timeline").get("events").models,t=[{value:-1,sortValue:"-1",label:"(No Event)"}];_.each(e,function(e){t.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),this.addChildrenOfEventsToOptions(t,e)},this),t.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),a=Math.min(i.length,n.length),s=0;for(s=0;a>s;s++)if(i[s]!=n[s])return i[s]-n[s];return i.length-n.length}),this.createEventSearchDropdown.setOptions(t)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},addClickHandler:function(e){var t=this.$nameInput.val(),i=this.typeId;if(n=-1,a="",s=!1,r="",this.formSubmitted===!0)return window.mainApp.removeExistingModal(),e.preventDefault(),!1;if(this.formSubmitted=!0,this.isPersistent===!1)var n=this.createEventSearchDropdown.getValue(),a=this.createOffsetPickerView.text(),s="start"===this.createOffsetFromDropdown.getValue(),r=this.createDatePickerView.text();return this.validateNameInput()?(window.ApplicationInterface&&window.ApplicationInterface.addEntity(window.timelineDocumentId,t,i,n,a,s,r),window.mainApp.removeExistingModal(),e.preventDefault(),!1):void e.preventDefault()}});module.exports=ATAddEntityView;
},{"./ATDatePicker":23,"./ATDropDown":28,"./ATDurationPicker":30,"./ATSearchDropDown":76,"./templates/addEntityTemplate.html":95,"backbone":176,"d3":300,"jquery":307,"lodash":309}],14:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATRangeControlManager=require("./ATRangeControlManager"),ATInspectorListView=require("./ATInspectorListView"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/addEventTemplate.html"),rolesDivHtml=require("./templates/addEventRolesDivTemplate.html"),ATAddEventView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.rolesDivTemplate=_.template(rolesDivHtml),this.d3RoleElements={},this.roleListViews={},this.relationshipLists={},this.roleDropdowns={},this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template",this.renderTemplate),this.$titleInput=$("#addEventTitle"),this.$titleInput.on("input",this.titleInput.bind(this)),this.colorDropdown=new ATColorDropdown({el:"#addEventColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#addEventParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),this.d3StartDate=this.d3El.select("#addEventStartDate"),this.startDatePickerView=new ATDatePicker({el:"#addEventStartDate"}),this.startDatePickerView.setValidCallback(this.validateForm.bind(this)),this.d3EndDate=this.d3El.select("#addEventEndDate"),this.endDatePickerView=new ATDatePicker({el:"#addEventEndDate"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.endDatePickerView.setValidCallback(this.validateForm.bind(this)),this.startDatePickerView.setAllowEmptyValues(!1),this.endDatePickerView.setAllowEmptyValues(!1),this.durationPickerView=new ATDurationPicker({el:"#addEventDuration"}),this.d3RoleDiv=this.d3El.select("#addEventRoleDiv"),this.entitySearchContextMenu=new ATSearchableContextMenu({el:"#addEventEntitySearch"}),this.entitySearchContextMenu.setAllowNewItems(!1),this.listenTo(this.entitySearchContextMenu,"change",this.contextEntityClick.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.rangeControlManager=new ATRangeControlManager(this.startDatePickerView,this.durationPickerView,this.endDatePickerView),this.rangeControlManager.setRangeConversion(this.rangeConversion),$("#addEventForm").on("submit",this.addClickHandler.bind(this)),this.renderTemplate()},renderTemplate:function(){var e=this.model.get("template"),t=e.colors,i=[];this.d3Elements={},this.listViews={},this.relationshipLists={},this.dropdowns={},_.each(e.types,function(e){_.each(e.roles,function(e){e.roleId||(e.roleId=e.id),i.push(e)},this)},this),this.d3RoleDiv.html(this.rolesDivTemplate({roles:i})),_.each(i,function(e){this.d3RoleElements[e.roleId]=this.d3El.select("#addEvent-"+e.roleId),e.multiplePerEvent?(this.roleListViews[e.roleId]=new ATInspectorListView({el:"#addEvent-"+e.roleId}),this.roleListViews[e.roleId].setListId(e.roleId),this.roleListViews[e.roleId].setAddCallback(this.roleAddClicked.bind(this)),this.roleListViews[e.roleId].setRemoveCallback(this.roleRemoveClicked.bind(this))):this.roleDropdowns[e.roleId]=new ATDropdown({el:"#addEvent-"+e.roleId})},this),this.colorDropdown.setOptions(t),this.$titleInput.val(""),this.colorDropdown.setValue(t[0].name)},setRangeConversion:function(e){this.rangeConversion=e,this.rangeControlManager.setRangeConversion(e)},resetForm:function(e,t,i){var n=this.model.get("template"),s=n.colors;this.$titleInput.val("New Event"),this.colorDropdown.setValue(s[0].name),this.formSubmitted=!1,this.startDatePickerView.setDate(e),this.durationPickerView.setText("0"),this.endDatePickerView.setDate(e),this.updateParentDropdown(t),_.each(n.types,function(e){var t=!0;_.each(e.roles,function(n){n.multiplePerEvent?t?this.updateRoleList(n.roleId,e.name,i):this.updateRoleList(n.roleId,e.name,-1):this.updateRoleDropdown(n.roleId,e.name,i),t=!1},this)},this),$("#addEventSubmit").prop("disabled",!0),this.setTitleFieldIsInvalid(!1),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectTitleIfUnfocused.bind(this),500)},focusAndSelectTitleIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$titleInput.val(e),this.$titleInput.focus(),this.$titleInput[0].setSelectionRange(t,t),this.$earlyInputCatcher.removeClass("activeCatcher"),t>0&&this.titleInput()},updateParentDropdown:function(e){var t=this.model.get("timeline").get("events").models,i=(this.model.get("eventData").eventIds,[{value:-1,sortValue:"-1",label:"(No Parent)"}]);_.each(t,function(e){i.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),this.addChildrenOfEventsToOptions(i,e)},this),i.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(i.length,n.length),r=0;for(r=0;s>r;r++)if(i[r]!=n[r])return i[r]-n[r];return i.length-n.length}),this.parentSearchDropdown.setOptions(i),this.parentSearchDropdown.setValue(e)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},roleAddClicked:function(e,t){var i=this.model.get("template").types,n=_.find(i,function(t){return _.find(t.roles,function(t){return t.roleId==e})});_.find(n.roles,function(t){return t.roleId==e});this.sourceElement=t,this.editingRoleId=e,this.updateEntitySearchDropdown(e),this.entitySearchContextMenu.show(t)},updateEntitySearchDropdown:function(e){var t=this.model.get("template").types,i=_.find(t,function(t){return _.find(t.roles,function(t){return t.roleId==e})}),n=(_.find(i.roles,function(t){return t.roleId==e}),this.model.get("entitiesByType")),s=(this.model.get("eventData"),this.relationshipLists[e]),r=_.reject(n[i.name],function(e){return _.find(s,function(t){return t.id==e.entityId})});options=[],_.each(r,function(e){options.push({value:e.entityId,label:e.name})}),this.entitySearchContextMenu.setOptions(options)},contextEntityClick:function(){var e=this.entitySearchContextMenu.getValue(),t=this.model.get("timeline"),i=(t.get("laneIds"),t.get("entities")),n=i.get(e);n&&(this.relationshipLists[this.editingRoleId].push({id:n.id,title:n.get("name")}),this.renderRoleList(this.editingRoleId))},roleRemoveClicked:function(e,t,i){this.relationshipLists[e]=_.filter(this.relationshipLists[e],function(e){return e.id!=t}),this.renderRoleList(e)},updateRoleList:function(e,t,i){var n=this.model.get("timeline"),s=(n.get("laneIds"),n.get("entities"));this.relationshipLists[e]=[],s.each(function(n){n.get("type")==t&&n.id==i&&this.relationshipLists[e].push({id:n.id,title:n.get("name")})},this),this.renderRoleList(e)},renderRoleList:function(e){var t=[];_.each(this.relationshipLists[e],function(e){t.push({actionIcon:"",id:e.id,title:e.title,extra:""})}),this.roleListViews[e].render(t)},updateRoleDropdown:function(e,t,i){var n=this.model.get("timeline"),s=(n.get("laneIds"),n.get("entities")),r=[{name:"None",value:-1}],o=!1;s.each(function(e){e.get("type")==t&&(r.push({value:e.id,name:e.get("name")}),e.id==i&&(o=!0))}),this.roleDropdowns[e].setOptions(r),o?this.roleDropdowns[e].setValue(i):this.roleDropdowns[e].setValue(-1)},titleInput:function(){this.validateForm()},setTitleFieldIsInvalid:function(e){this.$titleInput[0].setCustomValidity(e?"Error":"")},validateForm:function(){var e=!0,t=this.$titleInput.val();this.setTitleFieldIsInvalid(!t),t||(e=!1);var i=this.startDatePickerView.getValid();i===!1&&(e=!1);var n=this.endDatePickerView.getValid();n===!1&&(e=!1),$("#addEventSubmit").prop("disabled",!e)},addClickHandler:function(e){var t=this.model.get("template"),i=this.$titleInput.val(),n=this.colorDropdown.getValue(),s=parseInt(this.parentSearchDropdown.getValue()),r=this.startDatePickerView.text(),o=this.durationPickerView.text(),a=(this.endDatePickerView.text(),{});return this.formSubmitted===!0?(e.preventDefault(),!1):(this.formSubmitted=!0,_.each(t.types,function(e){_.each(e.roles,function(e){var t,i=e.roleId;e.multiplePerEvent?(t=this.relationshipLists[i],t&&t.length>0&&(a[i]=[],_.each(t,function(e){a[i].push(e.id)}))):(t=this.roleDropdowns[i].getValue(),t>0&&(a[i]=[t]))},this)},this),window.mainApp.removeExistingModal(),window.mainApp.showNewParentPromptIfNeeded(s,function(e){window.ApplicationInterface.addEvent(window.timelineDocumentId,i,n,s,e,r,o,JSON.stringify(a))}),e.preventDefault(),!1)}});module.exports=ATAddEventView;
},{"./ATColorDropdown":20,"./ATDatePicker":23,"./ATDropdown":29,"./ATDurationPicker":30,"./ATInspectorListView":54,"./ATRangeControlManager":70,"./ATSearchDropdown":77,"./ATSearchableContextMenu":78,"./templates/addEventRolesDivTemplate.html":96,"./templates/addEventTemplate.html":97,"backbone":176,"d3":300,"jquery":307,"lodash":309}],15:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),templateHtml=require("./templates/autoSuggestFieldTemplate.html"),ATAutoSuggestField=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),i=t+"-dropdown",s=t+"-list",e=this,n=_.template(templateHtml);this.allOptions=[],this.matchingOptions=[],this.hasFocus=!1,this.d3El=d3.select("#"+t),this.d3El.html(n({placeholder:""})),this.d3El.classed("autosuggestDiv",!0),this.d3Placeholder=this.d3El.select(".autosuggestPlaceholder"),this.d3Behind=this.d3El.select(".autosuggestBehind"),this.d3Front=this.d3El.select(".autosuggestFront"),this.$placeholder=$(this.d3Placeholder[0]),this.$front=$(this.d3Front[0]),this.$behind=$(this.d3Behind[0]),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",i),this.$dropdown=$("#"+i),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",s),this.$list=$("#"+s),this.$overflowHelper=this.buildOverflowHelper(this.$front),this.d3Placeholder.on("click",this.focusClickHandler.bind(this)),this.d3Front.on("click",this.focusClickHandler.bind(this)),this.d3Behind.on("click",this.focusClickHandler.bind(this)),this.d3Front.on("focus",this.focusHandler.bind(this)),this.d3Front.on("blur",this.blurHandler.bind(this)),this.$front.on("keydown",function(t){e.keyDownHandler(t)}),this.d3Front.on("input",this.inputHandler.bind(this))},buildOverflowHelper:function(t){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform")}).insertAfter(t)},hasOverflow:function(){var t=this.$front.width()-2;return this.$overflowHelper.text(this.$front.val()),this.$overflowHelper.width()>=t},setPlaceholderText:function(t,i){this.d3Front.attr("placeholder",t),this.d3Placeholder.attr("placeholder",i)},setOptions:function(t){this.allOptions=t,this.filterOptions(),this.renderOptions(),this.hasFocus&&this.showListIfAvailable()},setLookupFunction:function(t){this.lookupFunction=t},setOnFocus:function(t){this.onFocus=t},setOnBlur:function(t){this.onBlur=t},setOnGoToNextField:function(t){this.onGoToNextField=t},clear:function(){this.$front.val(""),this.$behind.val(""),this.$placeholder.val(""),this.inputValid=!1,this.filterOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},selectIndex:function(t){var i=this.matchingOptions[t];this.highlightIndex=t,this.$front.val(i),this.$behind.val(i),this.inputValid=!0,this.renderOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},focusClickHandler:function(t){this.onFocus(),this.$front.focus(),this.$front.select()},focusHandler:function(t){this.hasFocus=!0,this.renderOptions(),this.showListIfAvailable(),this.onFocus&&this.onFocus()},blurHandler:function(t){this.hasFocus=!1,this.$behind.val().length?this.$front.val(this.$behind.val()):this.highlightIndex>=0&&this.optionClick(this.highlightIndex),this.onBlur&&this.onBlur()},keyDownHandler:function(t){var i=t.keyCode||t.which,s=!1,e=0;switch(i){case 27:this.$front.blur(),s=!0,t.preventDefault();break;case 13:this.highlightIndex>=0&&(this.optionClick(this.highlightIndex),s=!0);break;case 38:-1==this.highlightIndex&&this.matchingOptions.length?e=this.matchingOptions.length-1:this.highlightIndex>0&&(e=this.highlightIndex-1),this.selectIndex(e),s=!0;break;case 40:-1==this.highlightIndex&&this.matchingOptions.length?e=0:this.highlightIndex<this.matchingOptions.length-1&&(e=this.highlightIndex+1),this.selectIndex(e),this.renderOptions(),s=!0}return!s},inputHandler:function(t){var i=this.$front.val(),s=this.lookupFunction?this.lookupFunction(i):{match:null,list:[]},e=s.match,n=e?e.substr(0,i.length):"";i.length?this.lookupFunction?e?(this.$behind.val(e),this.$front.val(n),this.d3Front.classed("error",!1),this.inputValid=!0):(this.$behind.val(""),this.d3Front.classed("error",!0),this.inputValid=!1):(this.$behind.val(""),this.d3Front.classed("error",!1),this.inputValid=!0):(this.$behind.val(""),this.d3Front.classed("error",!1),this.inputValid=!1),this.filterOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},filterOptions:function(){var t=this.$front.val(),i=this.$front.get(0).selectionStart,s=(this.$front.get(0).selectionEnd,t.substr(0,i));s?this.matchingOptions=_.filter(this.allOptions,function(t){var i=ATUtilities.caseInsensitiveStartsWith(t,s);return i},this):this.matchingOptions=this.allOptions,this.highlightIndex=_.indexOf(this.matchingOptions,t),-1==this.highlightIndex&&this.matchingOptions.length&&(this.highlightIndex=0),this.renderOptions()},isInputValid:function(){return this.inputValid},values:function(){return{valid:this.inputValid,original:this.$front.val(),suggestion:this.$behind.val()}},showListIfAvailable:function(){var t=this;if(!this.disabled){if(!this.matchingOptions.length)return void this.hideList();this.renderOptions(),this.slideOpenTimeout=window.setTimeout(function(){t.d3El.classed("open",!0),t.$dropdown.slideDown(250),t.highlightIndex>=0&&t.scrollItemIntoView(),this.open=!0},50)}},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=t+"-list",s=$("#"+i+"-"+this.highlightIndex),e=this.$list.scrollTop(),n=this.$list.height(),h=s.position()?s.position().top:0,o=s.height();(0>h||h+o>n)&&this.$list.scrollTop(e+h-n/2+o/2)},hideList:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1,window.clearTimeout(this.slideOpenTimeout),this.slideOpenTimeout=null},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.matchingOptions),s=this.$el.attr("id"),e=s+"-list";i.attr("id",function(t,i){return e+"-"+i}).classed("active",function(i){return t.selectedOption?i==t.selectedOption:!1}).classed("highlight",function(i,s){return s==t.highlightIndex}).select("span").text(function(t,i){return t});i.enter().append("li").attr("id",function(t,i){return e+"-"+i}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return t.selectedOption?i==t.selectedOption:!1}).classed("highlight",function(i,s){return s==t.highlightIndex}).on("mousedown",function(i,s){return d3.event.stopPropagation(),t.optionClick(s)}).append("span").text(function(t,i){return t});i.exit().remove(),this.scrollItemIntoView()},optionClick:function(t){return this.selectIndex(t),this.hideList(),this.onGoToNextField&&this.onGoToNextField(),!1}});module.exports=ATAutoSuggestField;
},{"./ATUtilities":91,"./templates/autoSuggestFieldTemplate.html":100,"backbone":176,"d3":300,"jquery":307,"lodash":309}],16:[function(require,module,exports){
var ATBounds=function(n,t){this.min=n,this.max=t};ATBounds.prototype.constrain=function(n){return n>this.min?n<this.max?n:this.max:this.min},ATBounds.prototype.debugAsString=function(){return"[ATBounds min: "+this.min+", max: "+this.max+"]"},module.exports=ATBounds;
},{}],17:[function(require,module,exports){
var _=require("lodash"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=require("./ATTimeSpan"),ATUtilities=require("./ATUtilities"),ATEra=require("./ATEra"),ATMonth=require("./ATMonth"),ATWeekday=require("./ATWeekday"),ATDate=require("./ATDate"),ATRange=require("./ATRange"),ATDateStringMatchResult=require("./ATDateStringMatchResult"),ATCalendarType=require("./ATCalendarType"),ATDateOrder=require("./ATDateOrder");ATStringSelection=require("./ATStringSelection");var ATCalendar=function(e,t,a,n,i,o){var r=0,s=0,h=[],l=[],m=[],g=[];this.eras=e,this.months=t,this.weekdays=a,this.weekdayIndexAtZero=i,this.hoursInDay=n,this.maximumDaysInAnyMonth=0;var d;for(d=0;d<this.months.length;d++)this.months[d].normalDuration>this.maximumDaysInAnyMonth&&(this.maximumDaysInAnyMonth=this.months[d].normalDuration),this.months[d].leapDuration>this.maximumDaysInAnyMonth&&(this.maximumDaysInAnyMonth=this.months[d].leapDuration);_.each(this.months,function(e){h.push(r),l.push(s),r+=e.normalDuration,s+=e.leapDuration}),this.daysInNormalYear=r,this.daysInLeapYear=s,this.monthStartsInNormalYear=h,this.monthStartsInLeapYear=l,this.isStandardMonths=this._isStandardMonths(),this.daysIn400Years=303*r+97*s,this.daysIn100Years=76*r+24*s,this.daysIn4Years=3*r+s,this.secondsInDay=3600*n,this.secondsInWeek=this.secondsInDay*this.weekdays.length,this.avgDaysInYear=ATUtilities.floatToInt(this.daysIn400Years/400),this.avgDaysInMonth=ATUtilities.floatToInt(this.avgDaysInYear/this.months.length),this.avgSecondsInYear=this.avgDaysInYear*this.secondsInDay,this.avgSecondsInMonth=this.avgDaysInMonth*this.secondsInDay,_.each(this.eras,function(e){var t,a=e.duration*r;e.hasLeap&&(t=ATUtilities.floatToInt(e.duration/4)-ATUtilities.floatToInt(e.duration/100)+ATUtilities.floatToInt(e.duration/400),a+=t*(s-r)),m.push(a),g.push(a*n*3600)}),this.daysInEra=m,this.secondsInEra=g,o?this.setZeroDate(this.dateWithTimestamp(o)):this.setZeroDate(this.dateWithTimestamp(0)),this.calendarType=ATCalendarType.CALENDAR_TYPE_DATE_TIME,this.dayNameFormat="%A",this.dateOrder="%d/%m/%Y",this.dateFormat="%d %B %Y",this.timeFormat="%H:%M:%S",this.monthFormat="%B %Y",this.buildRegularExpressions()};ATCalendar.prototype.DefaultCalendar=function(){var e=[],t=[],a=[],n=Math.pow(2,53)-1;e.push(new ATEra(0,"BC","BC",n,!0,!1)),e.push(new ATEra(1,"AD","AD",n,!1,!0)),t.push(new ATMonth(0,"January","Jan",31,31)),t.push(new ATMonth(1,"February","Feb",28,29)),t.push(new ATMonth(2,"March","Mar",31,31)),t.push(new ATMonth(3,"April","Apr",30,30)),t.push(new ATMonth(4,"May","May",31,31)),t.push(new ATMonth(5,"June","Jun",30,30)),t.push(new ATMonth(6,"July","Jul",31,31)),t.push(new ATMonth(7,"August","Aug",31,31)),t.push(new ATMonth(8,"September","Sep",30,30)),t.push(new ATMonth(9,"October","Oct",31,31)),t.push(new ATMonth(10,"November","Nov",30,30)),t.push(new ATMonth(11,"December","Dec",31,31)),a.push(new ATWeekday(0,"Sunday","Sun")),a.push(new ATWeekday(1,"Monday","Mon")),a.push(new ATWeekday(2,"Tuesday","Tue")),a.push(new ATWeekday(3,"Wednesday","Wed")),a.push(new ATWeekday(4,"Thursday","Thu")),a.push(new ATWeekday(5,"Friday","Fri")),a.push(new ATWeekday(6,"Saturday","Sat"));var i=new ATCalendar(e,t,a,24,1),o=i.dateWithComponents(1,2006,1,1,0,0,0);return i.setZeroDate(o),i},ATCalendar.prototype.setZeroDate=function(e){this.zeroDate=e.copy(),this.zeroDateTS=this.zeroDate.timestamp},ATCalendar.prototype.setCalendarType=function(e){this.calendarType=e},ATCalendar.prototype.dateWithComponents=function(e,t,a,n,i,o,r,s){var n=new ATDate(0,e,t,a,n,i,o,r,0,s);return this.calculateTimestampForDate(n),this.calculateWeekdayForDate(n),s||(0!=n.second?n.precision=ATTimeUnit.SECOND:0!=n.minute?n.precision=ATTimeUnit.MINUTE:0!=n.hour?n.precision=ATTimeUnit.HOUR:1!=n.day?n.precision=ATTimeUnit.DAY:1!=n.month?n.precision=ATTimeUnit.MONTH:n.precision=ATTimeUnit.YEAR),n},ATCalendar.prototype.dateWithTimestamp=function(e,t){var a=new ATDate(e,0,0,0,0,0,0,0,0,t);return this.calculateComponentsForDate(a),this.calculateWeekdayForDate(a),t||(0!=a.second?a.precision=ATTimeUnit.SECOND:0!=a.minute?a.precision=ATTimeUnit.MINUTE:0!=a.hour?a.precision=ATTimeUnit.HOUR:1!=a.day?a.precision=ATTimeUnit.DAY:1!=a.month?a.precision=ATTimeUnit.MONTH:a.precision=ATTimeUnit.YEAR),a},ATCalendar.prototype.dateByAddingTimespanToDate=function(e,t){var a=e.copy(),n=this.months.length,i=t.years+ATUtilities.floatToInt(t.months/n),o=t.months%n,r=60*(60*((t.weeks*this.weekdays.length+t.days)*this.hoursInDay+t.hours)+t.minutes)+t.seconds,s=t.toPrecision();if(0!=i||0!=o){a.month=a.month+o,a.month<=0?(--i,a.month+=n):a.month>n&&(++i,a.month=(a.month-1)%n+1),0!=i&&this._addYearsToDate(a,i);var h=this.isLeapYearInEra(a.year,a.eraIndex);1==h?a.day>this.months[a.month-1].leapDuration&&(a.day=1,a.month++):a.day>this.months[a.month-1].normalDuration&&(a.day=1,a.month++),a.month>this.months.length&&(a.month=1,1==this.eras[a.eraIndex].isBackwards?a.year--:a.year++,(a.year>this.eras[a.eraIndex].duration||a.year<=0)&&(a.eraIndex++,1==this.eras[a.eraIndex].isBackwards?a.year=this.eras[a.eraIndex].duration:a.year=1)),this.calculateTimestampForDate(a)}return a.timestamp+=r,this.calculateComponentsForDate(a),this.calculateWeekdayForDate(a),a.precision=Math.max(e.precision,s),a},ATCalendar.prototype.dateByAddingTimespanToDateWithPrecision=function(e,t,a){var n=e.copy(),i=this.months.length,o=t.years+ATUtilities.floatToInt(t.months/i),r=t.months%i,s=60*(60*((t.weeks*this.weekdays.length+t.days)*this.hoursInDay+t.hours)+t.minutes)+t.seconds;if(0!=o||0!=r){n.month=n.month+r,n.month<=0?(--o,n.month+=i):n.month>i&&(++o,n.month=(n.month-1)%i+1),0!=o&&this._addYearsToDate(n,o);var h=this.isLeapYearInEra(n.year,n.eraIndex);1==h?n.day>this.months[n.month-1].leapDuration&&(n.day=1,n.month++):n.day>this.months[n.month-1].normalDuration&&(n.day=1,n.month++),n.month>this.months.length&&(n.month=1,1==this.eras[n.eraIndex].isBackwards?n.year--:n.year++,(n.year>this.eras[n.eraIndex].duration||n.year<=0)&&(n.eraIndex++,1==this.eras[n.eraIndex].isBackwards?n.year=this.eras[n.eraIndex].duration:n.year=1)),this.calculateTimestampForDate(n)}return n.timestamp+=s,this.calculateComponentsForDate(n),this.calculateWeekdayForDate(n),n.precision=a,n},ATCalendar.prototype.dateAtEvenTimespanBeforeDate=function(e,t){var a,n,i=0;if(0!=t.years&&++i,0!=t.months&&++i,0!=t.weeks&&++i,0!=t.days&&++i,0!=t.hours&&++i,0!=t.minutes&&++i,0!=t.seconds&&++i,1!=i&&console.log("Error: finding even timestamp with more than one component!"),this.calendarType!==ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(t.weeks>0){if(a=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-e.weekdayIndex,-e.hour,-e.minute,-e.second)),this.zeroDate){var o;this.zeroDate.timestamp<=a.timestamp?(o=this.weeksBetweenDates(this.zeroDate,a),o=ATUtilities.floatToInt(o/t.weeks)*t.weeks):(o=this.weeksBetweenDates(this.zeroDate,a)-1,o=ATUtilities.floatToInt(o/t.weeks)*t.weeks-t.weeks),a=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,o,0,0,0,0))}return a.precision=ATTimeUnit.WEEK,a}if(t.days>0){if(a=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,0,-e.hour,-e.minute,-e.second)),this.zeroDate){var r;this.zeroDate.timestamp<=a.timestamp?(r=this.daysBetweenDates(this.zeroDate,a),r=ATUtilities.floatToInt(r/t.days)*t.days):(r=this.daysBetweenDates(this.zeroDate,a)-1,r=ATUtilities.floatToInt(r/t.days)*t.days-t.days),a=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,0,r,0,0,0))}return a.precision=ATTimeUnit.DAY,a}if(t.hours>0){if(a=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,0,0,-e.minute,-e.second)),this.calendarType!=ATCalendarType.CALENDAR_TYPE_HOUR_TIME)return a.hour=ATUtilities.floatToInt(a.hour/t.hours)*t.hours,a.minute=0,a.second=0,a.precision=ATTimeUnit.HOUR,this.calculateTimestampForDate(a),this.calculateWeekdayForDate(a),a;if(this.zeroDate){var s;return this.zeroDate.timestamp<=a.timestamp?(s=this.hoursBetweenDates(this.zeroDate,a),s=ATUtilities.floatToInt(s/t.hours)*t.hours):(s=this.hoursBetweenDates(this.zeroDate,a)-1,s=ATUtilities.floatToInt(s/t.hours)*t.hours-t.hours),a=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,0,0,s,0,0)),a.precision=ATTimeUnit.HOUR,a}}}return t.weeks>0?(a=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-e.weekdayIndex,-e.hour,-e.minute,-e.second)),a.precision=ATTimeUnit.WEEK,a):(a=e.copy(),t.seconds>0?(a.second=ATUtilities.floatToInt(a.second/t.seconds)*t.seconds,n=ATTimeUnit.SECOND):t.minutes>0?(a.minute=ATUtilities.floatToInt(a.minute/t.minutes)*t.minutes,a.second=0,n=ATTimeUnit.MINUTE):t.hours>0?(a.hour=ATUtilities.floatToInt(a.hour/t.hours)*t.hours,a.minute=0,a.second=0,n=ATTimeUnit.HOUR):t.days>0?(a.day=ATUtilities.floatToInt((a.day-1)/t.days)*t.days+1,a.hour=0,a.minute=0,a.second=0,n=ATTimeUnit.DAY):t.months>0?(a.month=ATUtilities.floatToInt((a.month-1)/t.months)*t.months+1,a.day=1,a.hour=0,a.minute=0,a.second=0,n=ATTimeUnit.MONTH):t.years>0&&(this.eras[a.eraIndex].isBackwards?a.year=Math.ceil(a.year/t.years)*t.years:a.year=ATUtilities.floatToInt((a.year-1)/t.years)*t.years+1,a.month=1,a.day=1,a.hour=0,a.minute=0,a.second=0,n=ATTimeUnit.YEAR),this.calculateTimestampForDate(a),this.calculateWeekdayForDate(a),a.precision=n,a)},ATCalendar.prototype.dateBeforeDateAtTimespanFromStart=function(e,t,a){var n,i=t.copy(),o=0;return 0!=i.years&&++o,0!=i.months&&++o,0!=i.weeks&&++o,0!=i.days&&++o,0!=i.hours&&++o,0!=i.minutes&&++o,0!=i.seconds&&++o,1!=o&&console.log("Error: finding even timestamp with more than one component!"),0!=i.years?(n=this.yearsBetweenDates(a,e),i.years=ATUtilities.floatToInt(n/i.years)*i.years):0!=i.months?(n=this.monthsBetweenDates(a,e),i.months=ATUtilities.floatToInt(n/i.months)*i.months):0!=i.weeks?(n=this.weeksBetweenDates(a,e),i.weeks=ATUtilities.floatToInt(n/i.weeks)*i.weeks):0!=i.days?(n=this.daysBetweenDates(a,e),i.days=ATUtilities.floatToInt(n/i.days)*i.days):0!=i.hours?(n=this.hoursBetweenDates(a,e),i.hours=ATUtilities.floatToInt(n/i.hours)*i.hours):0!=i.minutes?(n=this.minutesBetweenDates(a,e),i.minutes=ATUtilities.floatToInt(n/i.minutes)*i.minutes):0!=i.seconds&&(n=this.secondsBetweenDates(a,e),i.seconds=ATUtilities.floatToInt(n/i.seconds)*i.seconds),this.dateByAddingTimespanToDate(a,i)},ATCalendar.prototype.isValidDate=function(e){var t,a,n,i;return e.eraIndex<0||e.eraIndex>=this.eras.length?!1:(t=this.eras[e.eraIndex],e.year<=0||e.year>t.duration?!1:e.month<=0||e.month>this.months.length?!1:(a=this.months[e.month-1],n=this.isLeapYearInEra(e.year,e.eraIndex),i=n?a.leapDuration:a.normalDuration,e.day<=0||e.day>i?!1:e.hour<0||e.hour>=this.hoursInDay?!1:e.minute<0||e.minute>=60?!1:!(e.second<0||e.second>=60)))},ATCalendar.prototype.isValidDateComponents=function(e,t,a,n,i,o,r){if(0>e||e>this.eras.length)return!1;var s=this.eras[e];if(0>=t||t>s.duration)return!1;if(0>=a||a>this.months.length)return!1;var h=this.months[a-1],l=this.isLeapYearInEra(t,e),m=l?h.leapDuration:h.normalDuration;return 0>=n||n>m?!1:0>i||i>this.hoursInDay?!1:i!=this.hoursInDay||0==o&&0==r?0>o||o>=60?!1:!(0>r||r>=60):!1},ATCalendar.prototype.timespanForPrecision=function(e){var t=e==ATTimeUnit.YEAR?1:0,a=e==ATTimeUnit.MONTH?1:0,n=e==ATTimeUnit.WEEK?1:0,i=e==ATTimeUnit.DAY?1:0,o=e==ATTimeUnit.HOUR?1:0,r=e==ATTimeUnit.MINUTE?1:0,s=e==ATTimeUnit.SECOND?1:0;return new ATTimeSpan(t,a,n,i,o,r,s)},ATCalendar.prototype.roundedTimespanForSecondsAtScale=function(e,t){var a=this.roundedTimespanForScale(t);return 0!=a.years?a.years=Math.round(e/this.avgSecondsInYear/a.years)*a.years:0!=a.months?a.months=Math.round(e/this.avgSecondsInMonth/a.months)*a.months:0!=a.weeks?a.weeks=Math.round(e/this.secondsInWeek/a.weeks)*a.weeks:0!=a.days?a.days=Math.round(e/this.secondsInDay/a.days)*a.days:0!=a.hours?a.hours=Math.round(e/3600/a.hours)*a.hours:0!=a.minutes?a.minutes=Math.round(e/60/a.minutes)*a.minutes:0!=a.seconds&&(a.seconds=Math.round(e/a.seconds)*a.seconds),a},ATCalendar.prototype.roundedTimespanForScale=function(e){var t,a,n=10*e,i=30,o=1800,r=this.hoursInDay/2,s=this.weekdays.length,h=s/2,l=ATUtilities.floatToInt(this.avgDaysInMonth/s)/2,m=this.months.length,g=m/2;if(i>=n)return t=e,a=1>=t?1:2>=t?2:5>=t?5:10>=t?10:15>=t?15:30,new ATTimeSpan(0,0,0,0,0,0,a);if(o>=n)return t=e/60,a=1>=t?1:2>=t?2:5>=t?5:10>=t?10:15>=t?15:30,new ATTimeSpan(0,0,0,0,0,a,0);if(3600*r>=n){for(t=e/3600,a=1;r>a&&!(this.hoursInDay%a==0&&a>t);a++);if(this.hoursInDay%a==0)return new ATTimeSpan(0,0,0,0,a,0,0)}if(n<=h*this.secondsInDay){for(t=e/this.secondsInDay,a=1;r>a&&!(a>t);a++);return new ATTimeSpan(0,0,0,a,0,0,0)}if(n<=l*this.secondsInWeek){for(t=e/this.secondsInWeek,a=1;l>a&&!(a>t);a++);return new ATTimeSpan(0,0,a,0,0,0,0)}if(n<=g*this.avgSecondsInMonth){for(t=e/this.avgSecondsInMonth,a=1;g>a&&!(m%a==0&&a>t);a++);return new ATTimeSpan(0,a,0,0,0,0,0)}for(t=e/this.avgSecondsInYear,a=1;t>a&&(a*=2,!(a>=t))&&(a=5*a/2,!(a>=t));)a*=2;return new ATTimeSpan(a,0,0,0,0,0,0)},ATCalendar.prototype.timespanBetweenDates=function(e,t){var a,n=0,i=0,o=0,r=0,s=0,h=0,l=0,m=e.copy();if(this.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(n=this.yearsBetweenDates(e,t),a=new ATTimeSpan(n,0,0,0,0,0,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp)return a;if(i=this.monthsBetweenDates(m,t),a=new ATTimeSpan(n,i,0,0,0,0,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp)return a}return this.calendarType<=ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&(o=this.weeksBetweenDates(m,t),a=new ATTimeSpan(n,i,o,0,0,0,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp)?a:this.calendarType<=ATCalendarType.CALENDAR_TYPE_DAY_TIME&&(r=this.daysBetweenDates(m,t),a=new ATTimeSpan(n,i,o,r,0,0,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp)?a:(s=this.hoursBetweenDates(m,t),a=new ATTimeSpan(n,i,o,r,s,0,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp?a:(h=this.minutesBetweenDates(m,t),a=new ATTimeSpan(n,i,o,r,s,h,0),m=this.dateByAddingTimespanToDate(e,a),m.timestamp==t.timestamp?a:(l=this.secondsBetweenDates(m,t),new ATTimeSpan(n,i,o,r,s,h,l))))},ATCalendar.prototype.yearsBetweenDates=function(e,t){return ATUtilities.floatToInt(this.monthsBetweenDates(e,t)/this.months.length)},ATCalendar.prototype.monthsBetweenDates=function(e,t){var a,n,i,o,r,s,h=this.months.length;if(t.timestamp<e.timestamp)return-this.monthsBetweenDates(t,e);if(e.eraIndex==t.eraIndex)return a=this.calculateMonthsSinceEraStart(e),n=this.calculateMonthsSinceEraStart(t),i=n-a,0!=i&&(this.eras[e.eraIndex].isBackwards&&(i=-i),t.day<e.day?--i:t.day==e.day&&(t.hour<e.hour?--i:t.hour==t.hour&&(t.minute<e.minute?--i:t.minute==e.minute&&t.second<e.second&&--i))),i;for(i=-(e.month-1),i+=this.eras[e.eraIndex].isBackwards?e.year*h:(this.eras[e.eraIndex].duration-e.year+1)*h,1==e.day&&0==e.hour&&0==e.minute&&0==e.second||--i,o=e.eraIndex+1;o<t.eraIndex;o++)i+=this.eras[o].duration*h;for(i+=this.eras[t.eraIndex].isBackwards?(this.eras[t.eraIndex].duration-t.year)*h:(t.year-1)*h,i+=t.month-1,o=0;2>o&&(r=new ATTimeSpan(0,i+1,0,0,0,0,0),s=this.dateByAddingTimespanToDate(e,r),!(s.timestamp>t.timestamp));o++)i++;return i},ATCalendar.prototype.weeksBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/(this.weekdays.length*this.hoursInDay*3600))},ATCalendar.prototype.daysBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/(3600*this.hoursInDay))},ATCalendar.prototype.hoursBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/3600)},ATCalendar.prototype.minutesBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/60)},ATCalendar.prototype.secondsBetweenDates=function(e,t){return t.timestamp-e.timestamp},ATCalendar.prototype.calculateTimestampForDate=function(e){var t,a,n,i,o=this.eras.length,r=0;if(e.eraIndex==this.eras.length-1)r=this.calculateDaysSinceEraStartForDateComponents(e);else{for(t=o-2;t>e.eraIndex;t--)r-=this.daysInEra[t];0==this.eras[e.eraIndex].isBackwards?(r-=this.daysInEra[e.eraIndex],r+=this.calculateDaysSinceEraStartForDateComponents(e)):r-=this.calculateDaysSinceEraStartForDateComponents(e)}e.timestamp=r*this.hoursInDay*3600,e.eraIndex==o-1?e.timestamp+=3600*e.hour+60*e.minute+e.second:1==this.eras[e.eraIndex].isBackwards?(a=this.hoursInDay-e.hour,0==e.minute&&0==e.second||(a-=1),n=60-e.minute,0!=e.second&&(n-=1),i=60-e.second,a==this.hoursInDay&&(a=0),60==n&&(n=0),60==i&&(i=0),e.timestamp-=3600*a+60*n+i):0==e.hour&&0==e.minute&&0==e.second||(e.timestamp+=3600*e.hour+60*e.minute+e.second)},ATCalendar.prototype.calculateComponentsForDate=function(e){var t,a,n,i,o,r,s,h,l,m,g,d,c,u,T,y,p=3600*this.hoursInDay;if(0==e.timestamp)e.eraIndex=this.eras.length-1,e.year=1,e.month=1,e.day=1,e.hour=0,e.minute=0,e.second=0;else if(e.timestamp>0)e.eraIndex=this.eras.length-1,e.year=1,e.month=1,e.day=1,t=e.timestamp%p,e.hour=ATUtilities.floatToInt(t/3600),t%=3600,e.minute=ATUtilities.floatToInt(t/60),e.second=t%60,a=ATUtilities.floatToInt(e.timestamp/p),n=this.eras[e.eraIndex].hasLeap&&this.daysInNormalYear!=this.daysInLeapYear,0==n?(e.year+=ATUtilities.floatToInt(a/this.daysInNormalYear),i=a%this.daysInNormalYear,i>0&&this._calcMonthAndDayForDaysIntoNormalYear(e,i)):this.isStandardMonths?(o=this._toDaysSinceCalcZero(!0,e.year,e.month,e.day),r=o+a,this._fromDaysSinceCalcZero(r,!0,e)):(e.year+=400*ATUtilities.floatToInt(a/this.daysIn400Years),i=a%this.daysIn400Years,e.year+=100*ATUtilities.floatToInt(i/this.daysIn100Years),i%=this.daysIn100Years,e.year+=4*ATUtilities.floatToInt(i/this.daysIn4Years),i%=this.daysIn4Years,i<3*this.daysInNormalYear?(e.year+=ATUtilities.floatToInt(i/this.daysInNormalYear),i%=this.daysInNormalYear):(e.year+=3,i-=3*this.daysInNormalYear),y=this.isLeapYearInEra(e.year,e.eraIndex),1==y?this._calcMonthAndDayForDaysIntoLeapYear(e,i):this._calcMonthAndDayForDaysIntoNormalYear(e,i));else{for(s=-e.timestamp,h=this.eras.length-2,l=this.secondsInEra[h];h>0&&s>l;)s-=l,h--,l=this.secondsInEra[h];m=l/p,e.eraIndex=h,d=this.eras[e.eraIndex],d.isBackwards?(0==d.hasLeap?(a=ATUtilities.floatToInt(s/p),g=ATUtilities.floatToInt(a/this.daysInNormalYear),e.year=g,s-=g*this.daysInNormalYear*p,0==s?(e.month=1,e.day=1):(e.year+=1,i=ATUtilities.floatToInt(s/p),s-=i*p,this._calcMonthAndDayForDaysIntoNormalYearNegative(e,i))):(a=ATUtilities.floatToInt(s/p),g=0,c=0,a>=this.daysIn400Years&&(u=400*ATUtilities.floatToInt(a/this.daysIn400Years),g+=u,T=ATUtilities.floatToInt(u/400),a-=T*this.daysIn400Years,c+=T*this.daysIn400Years*p),a>=this.daysIn100Years&&(u=100*ATUtilities.floatToInt(a/this.daysIn100Years),g+=u,T=ATUtilities.floatToInt(u/100),a-=T*this.daysIn100Years,c+=T*this.daysIn100Years*p),a>=this.daysIn4Years&&(u=4*ATUtilities.floatToInt(a/this.daysIn4Years),g+=u,T=ATUtilities.floatToInt(u/4),a-=T*this.daysIn4Years,c+=T*this.daysIn4Years*p),a<=3*this.daysInNormalYear?(u=ATUtilities.floatToInt(a/this.daysInNormalYear),g+=u,c+=u*this.daysInNormalYear*p):(g+=3,c+=3*this.daysInNormalYear*p),e.year=g,s-=c,0==s?(e.month=1,e.day=1):(e.year+=1,i=ATUtilities.floatToInt(s/p),y=this.isLeapYearInEra(e.year,e.eraIndex),1==y?this._calcMonthAndDayForDaysIntoLeapYearNegative(e,i):this._calcMonthAndDayForDaysIntoNormalYearNegative(e,i),c=i*p,s-=c)),0==s?(e.hour=0,e.minute=0,e.second=0):(e.day-=1,0==e.day&&(e.month-=1,0==e.month&&(e.year-=1,0==e.year&&(e.eraIndex--,1==this.eras[e.eraIndex].isBackwards()?e.year=1:e.year=this.eras[e.eraIndex].duration()),e.month=this.months.length),y=this.isLeapYearInEra(e.year,e.eraIndex),1==y?e.day=this.months[e.month-1].leapDuration:e.day=this.months[e.month-1].normalDuration),e.hour=this.hoursInDay-ATUtilities.floatToInt(s/3600)-1,s%=3600,0==s?(e.minute=0,e.second=0,e.hour++):(e.minute=60-ATUtilities.floatToInt(s/60)-1,s%=60,0==s?(e.second=0,e.minute++):e.second=60-s))):(a=m-ATUtilities.floatToInt(s/p),s%p!=0&&a--,0==d.hasLeap?(g=ATUtilities.floatToInt(a/this.daysInNormalYear),e.year=g+1,c=g*this.daysInNormalYear*p,c=l-c,s=c-s,0==s?(e.month=1,e.day=1):(i=ATUtilities.floatToInt(s/p),s-=i*p,this._calcMonthAndDayForDaysIntoNormalYear(e,i))):(g=0,c=0,a>=this.daysIn400Years&&(u=400*ATUtilities.floatToInt(a/this.daysIn400Years),g+=u,T=ATUtilities.floatToInt(u/400),a-=T*this.daysIn400Years,c+=T*this.daysIn400Years*p),a>=this.daysIn100Years&&(u=100*ATUtilities.floatToInt(a/this.daysIn100Years),g+=u,T=ATUtilities.floatToInt(u/100),a-=T*this.daysIn100Years,c+=T*this.daysIn100Years*p),a>=this.daysIn4Years&&(u=4*ATUtilities.floatToInt(a/this.daysIn4Years),g+=u,T=ATUtilities.floatToInt(u/4),a-=T*this.daysIn4Years,c+=T*this.daysIn4Years*p),a<=3*this.daysInNormalYear?(u=ATUtilities.floatToInt(a/this.daysInNormalYear),g+=u,c+=u*this.daysInNormalYear*p):(g+=3,c+=3*this.daysInNormalYear*p),e.year=g+1,c=l-c,s=c-s,0==s?(e.month=1,e.day=1):(i=ATUtilities.floatToInt(s/p),y=this.isLeapYearInEra(e.year,e.eraIndex),1==y?this._calcMonthAndDayForDaysIntoLeapYear(e,i):this._calcMonthAndDayForDaysIntoNormalYear(e,i),c=i*p,s-=c)),0==s?(e.hour=0,e.minute=0,e.second=0):(e.hour=ATUtilities.floatToInt(s/3600),s-=3600*e.hour,e.minute=ATUtilities.floatToInt(s/60),s-=60*e.minute,e.second=s))}},ATCalendar.prototype.calculateWeekdayForDate=function(e){var t,a=60*this.hoursInDay*60,n=ATUtilities.floatToInt(e.timestamp/a),i=this.weekdays.length;e.timestamp>=0?e.weekdayIndex=(this.weekdayIndexAtZero+n)%i:(t=Math.abs(n%i),e.weekdayIndex=this.weekdayIndexAtZero-t,e.timestamp%a!=0&&(e.weekdayIndex-=1),e.weekdayIndex<0&&(e.weekdayIndex+=i))},ATCalendar.prototype.calculateMonthsSinceEraStart=function(e){var t,a,n=this.months.length;return this.eras[e.eraIndex].isBackwards?(t=e.year-1,1==e.month&&1==e.day&&0==e.hour&&0==e.minute&&0==e.second?(t++,t*n):(a=n-e.month,1==e.day&&0==e.hour&&0==e.minute&&0==e.second&&a++,t*n+a)):(e.year-1)*n+(e.month-1)},ATCalendar.prototype.calculateDaysSinceEraStartForDateComponents=function(e){var t,a,n=this.eras[e.eraIndex],i=this.months.length,o=e.year-1,r=this.daysInNormalYear*o;if(n.hasLeap&&(t=ATUtilities.floatToInt(o/4)-ATUtilities.floatToInt(o/100)+ATUtilities.floatToInt(o/400),r+=t*(this.daysInLeapYear-this.daysInNormalYear)),n.isBackwards)if(this.isLeapYearInEra(e.year,e.eraIndex)){for(a=i;a>e.month;a--)r+=this.months[a-1].leapDuration;r+=this.months[e.month-1].leapDuration-e.day,0==e.hour&&0==e.minute&&0==e.second&&r++}else{for(a=i;a>e.month;a--)r+=this.months[a-1].normalDuration;r+=this.months[e.month-1].normalDuration-e.day,0==e.hour&&0==e.minute&&0==e.second&&r++}else{if(this.isLeapYearInEra(e.year,e.eraIndex))for(a=1;i>=a&&a!=e.month;a++)r+=this.months[a-1].leapDuration;else for(a=1;i>=a&&a!=e.month;a++)r+=this.months[a-1].normalDuration;r+=e.day-1}return r},ATCalendar.prototype._calcMonthAndDayForDaysIntoNormalYear=function(e,t){var a,n=this.months.length;for(a=n-1;a>=0;a--)if(t>=this.monthStartsInNormalYear[a]){e.month=a+1,e.day=1+t-this.monthStartsInNormalYear[a];break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoNormalYearNegative=function(e,t){var a,n,i=this.months.length;for(a=i-1;a>=0;a--)if(t<=this.daysInNormalYear-this.monthStartsInNormalYear[a]){e.month=a+1,n=this.daysInNormalYear-this.monthStartsInNormalYear[a]-t,e.day=n+1;break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoLeapYear=function(e,t){e.month=0;var a,n=this.months.length;for(a=n-1;a>=0;a--)if(t>=this.monthStartsInLeapYear[a]){e.month=a+1,e.day=1+t-this.monthStartsInLeapYear[a];break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoLeapYearNegative=function(e,t){var a,n,i=this.months.length;for(a=i-1;a>=0;a--)if(t<=this.daysInLeapYear-this.monthStartsInLeapYear[a]){e.month=a+1,n=this.daysInLeapYear-this.monthStartsInLeapYear[a]-t,e.day=n+1;break}},ATCalendar.prototype.isLeapYearInEra=function(e,t){return 0==this.eras[t].hasLeap?!1:e%400==0||e%4==0&&e%100!=0},ATCalendar.prototype._addYearsToDate=function(e,t){for(var a,n,i=e.year,o=e.eraIndex,r=t;0!=r;)if(a=this.eras[o],a.isBackwards)if(i-=r,0>=i)o++,a=this.eras[o],a.isBackwards?(r=-i,i=a.duration):(r=-i,i=1);else{if(!(i>a.duration))return e.year=i,void(e.eraIndex=o);o--,n=a,a=this.eras[o],a.isBackwards?(r=n.duration-i,i=1):(r=n.duration-i,i=a.duration)}else if(i+=r,i>a.duration)o++,n=a,a=this.eras[o],a.isBackwards?(r=i-n.duration-1,i=a.duration):(r=i-n.duration,i=0);else{if(!(0>=i))return e.year=i,void(e.eraIndex=o);o--,a=this.eras[o],a.isBackwards?(r=i,i=1):(r=i,i=a.duration)}e.year=i,e.eraIndex=o},ATCalendar.prototype.getWeeksSinceZeroDate=function(e){return null!=this.zeroDate?this.weeksBetweenDates(this.zeroDate,e):0},ATCalendar.prototype.getDaysSinceZeroDate=function(e){return null!=this.zeroDate?this.daysBetweenDates(this.zeroDate,e):0},ATCalendar.prototype.getSecondsSinceZeroDate=function(e){return null!=this.zeroDate?this.secondsBetweenDates(this.zeroDate,e):0},ATCalendar.prototype.getHoursSinceZeroDate=function(e){return null!=this.zeroDate?this.hoursBetweenDates(this.zeroDate,e):0},ATCalendar.prototype.getMinutesSinceZeroDate=function(e){return null!=this.zeroDate?this.minutesBetweenDates(this.zeroDate,e):0},ATCalendar.prototype.stringFromDate=function(e,t,a,n){var i,o,r,s;if(a&&e.timestamp!==n.timestamp&&0===e.hour&&0===e.minute&&0===e.second&&-1==t.indexOf("%I"))return s=t.replace("%H",""+this.hoursInDay),this.stringFromDate(this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0)),s);e.year>=1e9?(i=(e.year/1e9).toFixed(2),o=" billion",r="b"):e.year>=1e6?(i=(e.year/1e6).toFixed(2),o=" million",r="m"):(i=e.year,o="",r="");var h=e.day;e.day<10&&(h="0"+e.day);var l=e.month;e.month<10&&(l="0"+e.month);var m=e.year%100,g=m;10>m&&(g="0"+m);var d=e.year;e.year<10?d="000"+e.year:e.year<100?d="00"+e.year:e.year<1e3&&(d="0"+e.year);var c=ATUtilities.floatToInt(e.day/this.weekdays.length+1),u=e.weekdayIndex;e.weekdayIndex<10&&(u="0"+e.weekdayIndex);var T,y=0;for(T=0;T<e.month-1;T++)y+=1==this.isLeapYearInEra(e.year,e.eraIndex)?this.months[T].leapDuration:this.months[T].normalDuration;y+=e.day;var p=this.getWeeksSinceZeroDate(e),R=this.getDaysSinceZeroDate(e),D=1,A=this.getSecondsSinceZeroDate(e);0>A&&(D=-1,A=-A);var I=ATUtilities.floatToInt(A/3600),S=ATUtilities.floatToInt(A%3600),f=ATUtilities.floatToInt(S/60),w=ATUtilities.floatToInt(S%60),x=I*D;0==x&&0>D&&(x="-0");var v;v=this.hoursInDay%2==0?e.hour>this.hoursInDay/2-1?"PM":"AM":"";var U;return U=this.hoursInDay%2==0?0==e.hour?(this.hoursInDay/2).toString():e.hour==this.hoursInDay/2?(this.hoursInDay/2).toString():(e.hour%(this.hoursInDay/2)).toString():e.hour.toString(),t.replace("%G",i+o).replace("%g",i+r).replace("%y",g).replace("%Y",d).replace("%i",this.weekdays[e.weekdayIndex].name.charAt(0)).replace("%a",this.weekdays[e.weekdayIndex].shortName).replace("%A",this.weekdays[e.weekdayIndex].name).replace("%b",this.months[e.month-1].shortName).replace("%B",this.months[e.month-1].name).replace("%b",this.months[e.month-1].shortName).replace("%T",this.eras[e.eraIndex].name).replace("%t",this.eras[e.eraIndex].shortName).replace("%E",e.eraIndex<this.eras.length-1?this.eras[e.eraIndex].shortName:"").replace("%d",h).replace("%e",e.day).replace("%m",l).replace("%n",e.month).replace("%H",e.hour).replace("%I",U).replace("%p",v).replace("%M",ATUtilities.numberToTwoDigitString(e.minute)).replace("%S",ATUtilities.numberToTwoDigitString(e.second)).replace("%W",c).replace("%w",u).replace("%j",y).replace("%Z",p).replace("%z",R).replace("%x",x).replace("%v",ATUtilities.numberToTwoDigitString(f)).replace("%u",ATUtilities.numberToTwoDigitString(w))},ATCalendar.prototype.dateWithPartialString=function(e,t,a,n,i){var o=new ATRange(t,0),r=this.dateWithTimestamp(0),s=new ATDateStringMatchResult(!1,!1,"",new ATRange(-1,0),r,new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),"",[],new ATRange(-1,0),new ATRange(-1,0),new ATRange(-1,0),0),h=!1;if(s.validDate=!1,s.text=e,s.selection=o,s.date.eraIndex=this.eras.length-1,s.date.year=1,s.date.month=1,s.date.day=1,s.date.minute=0,s.date.second=0,s.updatedCursorPosition=t,this.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME){var l,m={remainingString:null,foundResult:null};this.extractEraFromPartialString(m,s,e),this.extractTimeFromPartialString(m,s,m.remainingString);var g=s.date.precision,l=this.extractLongDateFromPartialString(m.remainingString,s);0==s.matchFound&&(l=this.extractShortDateFromPartialString(l,s)),0==s.matchFound&&a&&(l=this.extractPartialLongDateFromPartialString(e,t,l,s)),0==s.matchFound&&(l=this.extractYearOnlyDateFromPartialString(l,s));var d={remainingString:null,foundWeekday:null,weekdayIndex:null,useShortName:null};if(l=this.extractWeekdayFromPartialString(d,s,l),1==s.validDate){if(h=s.date.hour==this.hoursInDay&&0==s.date.minute&&0==s.date.second,h&&(s.date.hour=0),1==m.foundResult?s.date=this.dateWithComponents(s.date.eraIndex,s.date.year,s.date.month,s.date.day,s.date.hour,s.date.minute,s.date.second,g):s.date=this.dateWithComponents(s.date.eraIndex,s.date.year,s.date.month,s.date.day,s.date.hour,s.date.minute,s.date.second,s.date.precision),s.cleanText=this.naturalStringFromDate(s.date,!0,!1,null,"%Y"),1==d.foundWeekday){var c=s.weekdayRange;this.modifyWeekdayInMatchResult(s,d.useShortName,t),l=ATUtilities.replaceLocationWithWhitespace(c.location,c.length,l)}var u=l.match(this.remainingErrorContent);if(null!=u)if(1==u.length)s.errorRanges.push(new ATRange(u.index,u[0].length));else for(var T=u.index,y=0;y<u.length;y++)s.errorRanges.push(new ATRange(T,u[y].length)),T+=u[y].length}else s.date=this.dateWithComponents(s.date.eraIndex,s.date.year,s.date.month,s.date.day,s.date.hour,s.date.minute,s.date.second,s.date.precision),s.errorRanges.push(new ATRange(0,e.length));if(s.validDate&&n&&(h||s.date.timestamp!=i.timestamp)){var p=h?ATTimeUnit.DAY:s.date.precision,R=this.timespanForPrecision(p);R.hours=0,R.minutes=0,R.seconds=0,s.date=this.dateByAddingTimespanToDate(s.date,R)}return s}if(this.calendarType==ATCalendarType.CALENDAR_TYPE_HOUR_TIME){var m={remainingString:null,foundResult:null,hour:null,minute:null,second:null,timePrecision:null,negative:null};if(this.extractSignedTimeFromPartialString(m,s,e),1==m.negative&&(m.hour=-m.hour,m.minute=-m.minute,m.second=-m.second),null!=m.remainingString){var u=m.remainingString.match(this.remainingErrorContent);if(null!=u)if(1==u.length)s.errorRanges.push(new ATRange(u.index,u[0].length));else for(var T=u.index,y=0;y<u.length;y++)s.errorRanges.push(new ATRange(T,u[y].length)),T+=u[y].length}if(1==m.foundResult){var D=new ATTimeSpan(0,0,0,0,m.hour,m.minute,m.second);s.validDate=!0,s.matchFound=!0,s.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,D,m.timePrecision),s.cleanText=this.naturalStringFromDate(s.date,!0)}return s.yearRange.location=-1,s.yearRange.length=0,s.monthRange.location=-1,s.monthRange.length=0,s.dayRange.location=-1,s.dayRange.length=0,s.weekdayRange.location=-1,s.weekdayRange.length=0,s.eraRange.location=-1,s.eraRange.length=0,s.weekRange.location=-1,s.weekRange.length=0,s.dayRange.location=-1,s.dayRange.length=0,s}if(this.calendarType==ATCalendarType.CALENDAR_TYPE_DAY_TIME){var m={remainingString:null,foundResult:null};this.extractTimeFromPartialString(m,s,e),h=s.date.hour==this.hoursInDay&&0==s.date.minute&&0==s.date.second,h&&(s.date.hour=0);var A=s.date.hour,I=s.date.minute,S=s.date.second,g=s.date.precision,f={remainingString:null,day:null};if(this.extractDayFromPartialString(f,s,m.remainingString),null!=f.remainingString){var u=f.remainingString.match(this.remainingErrorContent);if(null!=u)if(1==u.length)s.errorRanges.push(new ATRange(u.index,u[0].length));else for(var T=u.index,y=0;y<u.length;y++)s.errorRanges.push(new ATRange(T,u[y].length)),T+=u[y].length}if(1==s.matchFound){var D=new ATTimeSpan(0,0,0,f.day,A,I,S);0==m.foundResult?s.date.precision=ATTimeUnit.DAY:s.date.precision=g,s.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,D,s.date.precision),s.validDate=!0,s.cleanText=this.naturalStringFromDate(s.date,!0)}if(s.yearRange.location=-1,s.yearRange.length=0,s.dayRange.location=-1,s.dayRange.length=0,s.monthRange.location=-1,s.monthRange.length=0,
s.validDate&&n&&(h||s.date.timestamp!=i.timestamp)){var p=h?ATTimeUnit.DAY:s.date.precision,R=this.timespanForPrecision(p);R.hours=0,R.minutes=0,R.seconds=0,s.date=this.dateByAddingTimespanToDate(s.date,R)}return s}var m={remainingString:null,foundResult:null};this.extractTimeFromPartialString(m,s,e),h=s.date.hour==this.hoursInDay&&0==s.date.minute&&0==s.date.second,h&&(s.date.hour=0);var A=s.date.hour,I=s.date.minute,S=s.date.second,g=s.date.precision,w={remainingString:null,week:null};this.extractWeekFromPartialString(w,s,m.remainingString);var d={remainingString:null,foundWeekday:null,weekdayIndex:null,useShortName:null},l=this.extractWeekdayFromPartialString(d,s,w.remainingString);if(null!=l){var u=l.match(this.remainingErrorContent);if(null!=u)if(1==u.length)s.errorRanges.push(new ATRange(u.index,u[0].length));else for(var T=u.index,y=0;y<u.length;y++)s.errorRanges.push(new ATRange(T,u[y].length)),T+=u[y].length}if(1==s.matchFound&&0==d.foundWeekday){var D=new ATTimeSpan(0,0,w.week,0,0,0,0);s.date.precision=ATTimeUnit.WEEK,s.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,D,s.date.precision),s.cleantText=this.naturalStringFromDate(s.date,!0)}else if(1==s.matchFound&&1==d.foundWeekday){var D=new ATTimeSpan(0,0,w.week,d.weekdayIndex,A,I,S);0==m.foundResult?s.date.precision=ATTimeUnit.DAY:s.date.precision=g,s.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,D,s.date.precision),s.cleanText=this.naturalStringFromDate(s.date,!0)}if(s.yearRange.location=-1,s.yearRange.length=0,s.monthRange.location=-1,s.monthRange.length=0,s.dayRange.location=-1,s.dayRange.length=0,s.eraRange.location=-1,s.eraRange.length=0,s.validDate&&n&&(h||s.date.timestamp!=i.timestamp)){var p=h?ATTimeUnit.DAY:s.date.precision,R=this.timespanForPrecision(p);R.hours=0,R.minutes=0,R.seconds=0,s.date=this.dateByAddingTimespanToDate(s.date,R)}return s},ATCalendar.prototype.dateWithString=function(e,t){var a=this.dateWithPartialString(e,e.length,!0);1==a.validDate?(t.foundResult=!0,t.date=a.date):t.foundResult=!1},ATCalendar.prototype.extractEraFromPartialString=function(e,t,a){var n=a.match(this.eraNameWithDigitRegExp);if(null!=n){for(var i=n[1],o=0;o<this.eras.length;o++)if(1==ATUtilities.caseInsensitiveCompare(i,this.eras[o].name)||1==ATUtilities.caseInsensitiveCompare(i,this.eras[o].shortName)){t.date.eraIndex=o;break}var r=n[0],s=r.indexOf(i);t.eraRange.location=n.index+s,t.eraRange.length=n[1].length,e.foundResult=!0,e.remainingString=ATUtilities.replaceLocationWithWhitespace(t.eraRange.location,t.eraRange.length,a)}else e.foundResult=!1,e.remainingString=a,t.eraRange.location=-1,t.eraRange.length=0},ATCalendar.prototype.extractTimeFromPartialString=function(e,t,a){if(this.hoursInDay%2==0){var n=a.match(this.timeRegExp);if(null!=n){e.foundResult=!0,t.date.hour=parseInt(n[1]),t.date.precision=ATTimeUnit.HOUR,t.hourRange.location=n.index,t.hourRange.length=n[1].length;var i=t.hourRange.location+t.hourRange.length+1;return null!=n[3]?(t.date.minute=parseInt(n[3]),t.date.precision=ATTimeUnit.MINUTE,t.minuteRange.location=i,t.minuteRange.length=n[3].length,i=t.minuteRange.location+t.minuteRange.length+1):(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0),null!=n[5]?(t.date.second=parseInt(n[5]),t.date.precision=ATTimeUnit.SECOND,t.secondRange.location=i,t.secondRange.length=n[5].length):(t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0),null!=n[6]?(1==ATUtilities.caseInsensitiveCompare(n[6],"AM")?t.date.hour==this.hoursInDay/2&&(t.date.hour=0):1==ATUtilities.caseInsensitiveCompare(n[6],"PM")&&t.date.hour<this.hoursInDay/2&&(t.date.hour+=this.hoursInDay/2),t.amPmRange.location=a.search(n[6]),t.amPmRange.length=n[6].length):(t.amPmRange.location=-1,t.amPmRange.length=0),t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=a)):void(e.remainingString=ATUtilities.replaceCharactersWithWhitespace(this.timeRegExp,n[0].length,a))}}var o=a.match(this.timeRegExp2);if(null!=o&&(e.foundResult=!0,null!=o[1])){t.date.hour=parseInt(o[1]),t.hourRange.location=o.index,t.hourRange.length=o[1].length;var i=t.hourRange.location+t.hourRange.length+1;return t.date.precision=ATTimeUnit.HOUR,null!=o[2]?(t.date.minute=parseInt(o[2]),t.minuteRange.location=i,t.minuteRange.length=o[2].length,i=t.minuteRange.location+t.minuteRange.length+1,t.date.precision=ATTimeUnit.MINUTE):(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0),null!=o[4]?(t.date.second=parseInt(o[4]),t.secondRange.location=i,t.secondRange.length=o[4].length,i=t.secondRange.location+t.secondRange.length+1,t.date.precision=ATTimeUnit.SECOND):(t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0),t.amPmRange.location=-1,t.amPmRange.length=0,t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=a)):void(e.remainingString=ATUtilities.replaceLocationWithWhitespace(o.index,o[0].length,a))}var r=a.match(this.timeRegExp3);if(null!=r&&null!=r[1]){t.date.hour=parseInt(r[1]),t.hourRange.location=r.index,t.hourRange.length=r[1].length,t.date.precision=ATTimeUnit.HOUR;var i=t.hourRange.location+t.hourRange.length;return null!=r[2]?(t.date.minute=parseInt(r[2]),t.minuteRange.location=i,t.minuteRange.length=r[2].length,t.date.precision=ATTimeUnit.MINUTE):(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0),t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=a)):(e.remainingString=ATUtilities.replaceLocationWithWhitespace(r.index,r[0].length,a),void(e.foundResult=!0))}t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,e.remainingString=a},ATCalendar.prototype.extractLongDateFromPartialString=function(e,t){var a=e.match(this.monthNameRegExp);if(null!=a){for(var n=String(a[0]),i=0;i<this.months.length;i++)if(1==ATUtilities.caseInsensitiveCompare(n,this.months[i].name)||1==ATUtilities.caseInsensitiveCompare(n,this.months[i].shortName)){t.date.month=i+1;break}t.monthRange.location=a.index,t.monthRange.length=a[0].length;var o=ATUtilities.replaceCharactersWithWhitespace(this.monthNameRegExp,t.monthRange.length,e),r=o.match(this.monthNameRemainderRegExp);if(null!=r){var s;return null!=r[3]&&null!=r[1]?(t.date.day=parseInt(r[1]),t.date.year=parseInt(r[3]),t.dayRange.location=r.index,t.dayRange.length=r[1].length,t.yearRange.length=r[3].length,t.yearRange.location=r.index+r[0].length-t.yearRange.length,s=!0):(t.date.day=1,t.date.year=parseInt(r[1]),t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=r.index,t.yearRange.length=r[1].length,s=!1),1==s?t.date.precision=ATTimeUnit.DAY:t.date.precision=ATTimeUnit.MONTH,t.matchFound=!0,t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),ATUtilities.replaceCharactersWithWhitespace(this.monthNameRemainderRegExp,r[0].length,o)}return t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=-1,t.yearRange.length=0,t.matchFound=!1,t.validDate=!1,e}return t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=-1,t.yearRange.length=0,t.monthRange.location=-1,t.monthRange.length=0,t.matchFound=!1,t.validDate=!1,e},ATCalendar.prototype.extractShortDateFromPartialString=function(e,t){var a=e.match(this.formalDateRegExp);if(null!=a&&a.length>3){var n=parseInt(a[1]),i=parseInt(a[2]),o=parseInt(a[3]),r=a[1].length,s=a[2].length,h=a[3].length,l=a.index,m=l+r+1,g=m+s+1;t.date.precision=ATTimeUnit.DAY,this.dateOrder==ATDateOrder.DATE_ORDER_YEAR_MONTH_DAY?(t.date.year=n,t.date.month=i,t.date.day=o,t.yearRange.location=l,t.yearRange.length=r,t.monthRange.location=m,t.monthRange.length=s,t.dayRange.location=g,t.dayRange.length=h):this.dateOrder==ATDateOrder.DATE_ORDER_DAY_MONTH_YEAR?(t.date.day=n,t.date.month=i,t.date.year=o,t.dayRange.location=l,t.dayRange.length=r,t.monthRange.location=m,t.monthRange.length=s,t.yearRange.location=g,t.yearRange.length=h):(t.date.month=n,t.date.day=i,t.date.year=o,t.monthRange.location=l,t.monthRange.length=r,t.dayRange.location=m,t.dayRange.length=s,t.yearRange.location=g,t.yearRange.length=h);var d=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0);d||this.dateOrder==ATDateOrder.DATE_ORDER_YEAR_MONTH_DAY||(t.date.year=n,t.date.month=i,t.date.day=o,d=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),1==d&&(t.yearRange.location=l,t.yearRange.length=r,t.monthRange.location=m,t.monthRange.length=s,t.dayRange.location=g,t.dayRange.length=h)),d||this.dateOrder==ATDateOrder.DATE_ORDER_DAY_MONTH_YEAR||(t.date.day=n,t.date.month=i,t.date.year=o,d=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),1==d&&(t.dayRange.location=l,t.dayRange.length=r,t.monthRange.location=m,t.monthRange.length=m,t.yearRange.location=g,t.yearRange.length=h)),d||this.dateOrder==ATDateOrder.DATE_ORDER_MONTH_DAY_YEAR||(t.date.month=n,t.date.day=i,t.date.year=o,d=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),1==d&&(t.monthRange.location=l,t.monthRange.length=r,t.dayRange.location=m,t.dayRange.length=s,t.yearRange.location=g,t.yearRange.length=h)),t.matchFound=!0,t.validDate=d,1==d&&(t.date.precision=t.date.precision>ATTimeUnit.DAY?t.date.precision:ATTimeUnit.DAY);var c=ATUtilities.replaceCharactersWithWhitespace(this.formalDateRegExp,a[0].length,e);return c}return t.date.year=1,t.date.month=1,t.date.day=1,t.yearRange.location=-1,t.yearRange.length=0,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,e},ATCalendar.prototype.extractYearOnlyDateFromPartialString=function(e,t){t.date.month=1,t.date.day=1;var a=e.match(this.largeYearRegExp);if(null!=a)return 1==ATUtilities.caseInsensitiveCompare(a[4],"billion")?t.date.year=ATUtilities.floatToInt(1e9*parseFloat(a[1])):1==ATUtilities.caseInsensitiveCompare(a[4],"million")&&(t.date.year=ATUtilities.floatToInt(1e6*parseFloat(a[1]))),t.yearRange.location=a.index,t.yearRange.length=a[0].length,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,t.date.precision=ATTimeUnit.YEAR,t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),t.matchFound=!0,ATUtilities.replaceLocationWithWhitespace(a.index,a[0].length,e);var n=e.match(this.yearRegExp);return null!=n?(t.date.year=parseInt(n[1]),t.yearRange.location=n.index,t.yearRange.length=n[0].length,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,t.date.precision=ATTimeUnit.YEAR,t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),t.matchFound=!0,ATUtilities.replaceLocationWithWhitespace(n.index,n[0].length,e)):(t.matchFound=!1,e)},ATCalendar.prototype.extractPartialLongDateFromPartialString=function(e,t,a,n){var i=!1,o=e.substring(0,t),r=o.match(this.matchLastWordRegExp);if(null==r)return a;var s=r.index;o=e.substring(s);var h=o.match(this.matchFirstWordRegExp);if(null!=h)for(var l=h[0].length,m=h[0],g=0;g<this.months.length;g++){var d=this.months[g].name.search(new RegExp(m,"i")),c=this.months[g].shortName.search(new RegExp(m,"i"));if(0==d||0==c){var u,T,y=!1;e.length>s+m.length&&" "!=e.charAt(s+m.length)&&(y=!0),1==y?(u=e.substring(0,s)+this.months[g].name+" "+e.substring(s+l),T=a.substring(0,s)+this.months[g].name+" "+a.substring(s+l)):(u=e.substring(0,s)+this.months[g].name+e.substring(s+l),T=a.substring(0,s)+this.months[g].name+a.substring(s+l)),1==i&&(n.text=u,n.selection.location=t,n.selection.length=this.months[g].name.length+1+s-t,i=!1);var p=this.extractLongDateFromPartialString(T,n);if(1==n.matchFound)return n.text=u,n.selection.location=t,n.selection.length=this.months[g].name.length+1+s-t,p}}return a},ATCalendar.prototype.extractWeekdayFromPartialString=function(e,t,a){var n=a.match(this.weekdayNameRegExp);if(e.foundWeekday=!1,e.weekdayIndex=0,t.weekdayRange.location=-1,t.weekdayRange.length=0,e.useShortName=!1,null!=n){for(var i=n[0],o=0;o<this.weekdays.length;o++){if(1==ATUtilities.caseInsensitiveCompare(i,this.weekdays[o].name)){e.weekdayIndex=o,e.foundWeekday=!0,e.useShortName=!1;break}if(1==ATUtilities.caseInsensitiveCompare(i,this.weekdays[o].shortName)){e.weekdayIndex=o,e.foundWeekday=!0,e.useShortName=!0;break}}return 1==e.foundWeekday&&(t.weekdayRange.location=n.index,t.weekdayRange.length=n[0].length),ATUtilities.replaceCharactersWithWhitespace(n[0],n[0].length,a)}return a},ATCalendar.prototype.extractSignedTimeFromPartialString=function(e,t,a){var n=a.match(this.timeRegExp4);if(null!=n&&null!=n[2]){e.hour=parseInt(n[2]);var i=n[1],o=0;null!=i?1==ATUtilities.caseInsensitiveCompare(i,"-")?(e.negative=!0,t.negationRange.location=n.index,t.negationRange.length=n[1].length,o=t.negationRange.location+t.negationRange.length):1==ATUtilities.caseInsensitiveCompare(i,"+")?(e.negative=!1,t.negationRange.location=n.index,t.negationRange.length=n[1].length,o=t.negationRange.location+t.negationRange.length):(e.negative=!1,t.negationRange.location=-1,t.negationRange.length=0):(e.negative=!1,t.negationRange.location=-1,t.negationRange.length=0),t.hourRange.location=o,t.hourRange.length=n[2].length,o=t.hourRange.location+t.hourRange.length+1,e.timePrecision=ATTimeUnit.HOUR,null!=n[5]?(e.minute=parseInt(n[5]),t.minuteRange.location=o,t.minuteRange.length=n[5].length,o=t.minuteRange.location+t.minuteRange.length+1,e.timePrecision=ATTimeUnit.MINUTE):(e.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0),null!=n[7]?(e.second=parseInt(n[7]),t.secondRange.location=o,t.secondRange.length=n[7].length,o=t.secondRange.location+t.secondRange.length+1,e.timePrecision=ATTimeUnit.SECOND):(e.second=0,t.secondRange.location=-1,t.secondRange.length=0),t.amPmRange.location=-1,t.amPmRange.length=0;var r=ATUtilities.replaceLocationWithWhitespace(n.index,n[0].length,a);return e.foundResult=!0,r}e.foundResult=!1,e.hour=0,e.minute=0,e.second=0},ATCalendar.prototype.extractWeekFromPartialString=function(e,t,a){var n=a.match(this.weekRegExp);null!=n?n.length>4?(t.matchFound=!0,t.validDate=!0,e.week=parseInt(n[4]),t.weekRange.location=n.index+n[1].length,t.weekRange.length=n[4].length,e.remainingString=ATUtilities.replaceLocationWithWhitespace(n.index,n[0].length,a)):(t.matchFound=!1,t.validDate=!1,t.weekRange.location=-1,matchresult.weekRange.length=0,e.remainingString=a):(t.matchFound=!1,t.validDate=!1,t.weekRange.location=-1,t.weekRange.length=0,e.remainingString=a)},ATCalendar.prototype.extractDayFromPartialString=function(e,t,a){var n=a.match(this.dayRegExp);null!=n?null!=n[4]&&null!=n[1]&&(t.validDate=!0,t.matchFound=!0,e.day=parseInt(n[4]),t.floatingDayRange.location=n.index+n[1].length,t.floatingDayRange.length=n[4].length,e.remainingString=ATUtilities.replaceLocationWithWhitespace(n.index,n[0].length,a)):(t.floatingDayRange.location=-1,t.floatingDayRange.length=0,e.remainingString=a,t.validDate=!1,t.matchFound=!1)},ATCalendar.prototype.buildRegularExpressions=function(){var e,t="\\b(";for(e=0;e<this.months.length;e++){var a="("+this.months[e].name+")|("+this.months[e].shortName+")";t+=a,e!=this.months.length-1&&(t+="|")}t+=")\\b",this.monthNameRegExp=new RegExp(t,"i");var n="\\b(";for(e=0;e<this.months.length;e++){var a="("+this.months[e].name+")";n+=a,e!=this.months.length-1&&(n+="|")}n+=")\\b",this.longMonthNameRegExp=new RegExp(n,"i");var i="\\b(";for(e=0;e<this.months.length;e++){var a="("+this.months[e].shortName+")";i+=a,e!=this.months.length-1&&(i+="|")}i+=")\\b",this.shortMonthNameRegExp=new RegExp(i,"i"),this.monthNameRemainderRegExp=new RegExp("\\b(\\d+)([\\s,/-]+(\\d+))?\\b");var o="\\b\\d*(",r="\\b(";for(e=0;e<this.eras.length;e++){var a="("+this.eras[e].name+")|("+this.eras[e].shortName+")";r+=a,o+=a,e!=this.eras.length-1&&(r+="|",o+="|")}r+=")\\s*$",o+=")\\s*$",this.eraNameWithDigitRegExp=new RegExp(o,"i"),this.eraNameRegExp=new RegExp(r,"i");var s="\\b(";for(e=0;e<this.eras.length;e++){var a="("+this.eras[e].name+")";s+=a,e!=this.eras.length-1&&(s+="|")}s+=")\\s*$",this.longEraNameRegExp=new RegExp(s,"i");var h="\\b(";for(e=0;e<this.eras.length;e++){var a="("+this.eras[e].shortName+")";h+=a,e!=this.eras.length-1&&(h+="|")}h+=")\\s*$",this.shortEraNameRegExp=new RegExp(h,"i");var l="\\b(\\d{1,2})(:([0-5][0-9])(:([0-5][0-9]))?)?\\s?([ap][m])\\b";this.timeRegExp=new RegExp(l,"i"),l="\\b(\\d{1,2}):([0-5][0-9])(:([0-5][0-9]))?\\b",this.timeRegExp2=new RegExp(l),l="\\b(\\d{1,2})([0-5][0-9])\\s?hr?s?\\b",this.timeRegExp3=new RegExp(l,"i"),l="^\\s*([-+])?\\s*(\\d{1,2})((:([0-5][0-9]))(:([0-5][0-9]))?)?\\s*$",this.timeRegExp4=new RegExp(l),this.formalDateRegExp=new RegExp("\\b(\\d+)[/.-](\\d+)[/.-](\\d+)\\b"),this.matchLastWordRegExp=new RegExp("\\b([a-zA-z]+)$"),this.matchFirstWordRegExp=new RegExp("^([a-zA-z]+)");var m="\\b(";for(e=0;e<this.weekdays.length;e++){var a="("+this.weekdays[e].name+")|("+this.weekdays[e].shortName+")";m+=a,e!=this.weekdays.length-1&&(m+="|")}m+=")\\b",this.weekdayNameRegExp=new RegExp(m,"i");var g="\\b(";for(e=0;e<this.weekdays.length;e++){var a="("+this.weekdays[e].name+")";g+=a,e!=this.weekdays.length-1&&(g+="|")}g+=")\\b",this.longWeekdayNameRegExp=new RegExp(g,"i");var d="\\b(";for(e=0;e<this.weekdays.length;e++){var a="("+this.weekdays[e].shortName+")";d+=a,e!=this.weekdays.length-1&&(d+="|")}d+=")\\b",this.shortWeekdayNameRegExp=new RegExp(d,"i"),this.remainingErrorContent=new RegExp("(\\S)+");var c="(\\b(w(eek|k)?)\\s*)(-?\\d+)";this.weekRegExp=new RegExp(c,"i"),this.yearRegExp=new RegExp("\\b(\\d+)\\b","i"),this.largeYearRegExp=new RegExp("\\b((\\d+)(.\\d+)?)\\s?(billion|million)\\b","i");var u="(\\b(d(ay)?)\\s*)(-?\\d+)\\b";this.dayRegExp=new RegExp(u,"i")},ATCalendar.prototype.naturalStringFromDate=function(e,t,a,n,i){var o=e.precision,r=this.dateFormat,s=this.monthFormat,h=(this.timeFormat,this.dayNameFormat),l="";if(this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME)return o===ATTimeUnit.YEAR?l=i?i:"%G":o===ATTimeUnit.MONTH?l=s:(l=(t?h+" ":"")+r,o>ATTimeUnit.DAY&&(l+=a&&e.timestamp!=n.timestamp?" %H:%M"+(o>ATTimeUnit.MINUTE?":%S":""):" "+this.timeStringFromDate(e))),e.eraIndex!=this.eras.length-1&&(l+=" %t"),this.stringFromDate(e,l,a,n);if(this.calendarType==ATCalendarType.CALENDAR_TYPE_HOUR_TIME){if(o==ATTimeUnit.HOUR){var m=this.getHoursSinceZeroDate(e);return ATUtilities.numberToTwoDigitString(m)+":00:00"}if(o==ATTimeUnit.MINUTE){var m=this.getHoursSinceZeroDate(e),g=this.getMinutesSinceZeroDate(e),d=g-60*m;return 0>d&&(d*=-1),0==m&&0>g?"-"+ATUtilities.numberToTwoDigitString(m)+":"+ATUtilities.numberToTwoDigitString(d)+":00":ATUtilities.numberToTwoDigitString(m)+":"+ATUtilities.numberToTwoDigitString(d)+":00"}var m=this.getHoursSinceZeroDate(e),g=this.getMinutesSinceZeroDate(e),d=g-60*m,c=this.getSecondsSinceZeroDate(e),u=c-60*g;return 0>d&&(d*=-1),0>u&&(u*=-1),0==m&&0>c?"-"+ATUtilities.numberToTwoDigitString(m)+":"+ATUtilities.numberToTwoDigitString(d)+":"+ATUtilities.numberToTwoDigitString(u):ATUtilities.numberToTwoDigitString(m)+":"+ATUtilities.numberToTwoDigitString(d)+":"+ATUtilities.numberToTwoDigitString(u)}if(this.calendarType==ATCalendarType.CALENDAR_TYPE_DAY_TIME){var T=e.copy();a&&e.timestamp!=n.timestamp&&0==e.hour&&0==e.minute&&0==e.second&&(T=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0)),T.hour=24);var y=this.getDaysSinceZeroDate(T),c=this.getSecondsSinceZeroDate(T),u=c-y*this.hoursInDay*3600;return 0>u&&y--,o==ATTimeUnit.DAY?"Day "+y.toString():this.timeStringFromDate(T)+" Day "+y.toString()}var T=e.copy();a&&e.timestamp!=n.timestamp&&0==e.hour&&0==e.minute&&0==e.second&&(T=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0)),T.hour=24);var p=this.getWeeksSinceZeroDate(T),R=this.weekdays[T.weekdayIndex].name,c=this.getSecondsSinceZeroDate(T),u=c-p*this.weekdays.length*this.hoursInDay*3600;return 0>u&&p--,o==ATTimeUnit.WEEK?"Week "+p.toString():o==ATTimeUnit.DAY?R+" Week "+p.toString():this.timeStringFromDate(T)+" "+R+" Week "+p.toString()},ATCalendar.prototype.naturalStringFromDateRange=function(e,t){var a=this.dateFormat,n=this.monthFormat;this.timeFormat;if(e.timestamp==t.timestamp)return this.naturalStringFromDate(e,!0);if(this.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(Math.max(e.precision,t.precision)==ATTimeUnit.YEAR){var i=new ATTimeSpan(-1,0,0,0,0,0,0),o=this.dateByAddingTimespanToDate(t,i);if(e.timestamp==o.timestamp)return this.naturalStringFromDate(e,!0);var r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),h=this.yearStringFromDate(e),l=this.yearStringFromDate(o);return e.eraIndex!=o.eraIndex?h+" "+r+" - "+l+" "+s:e.eraIndex!=this.eras.length-1?h+" - "+l+" "+r:h+" - "+l}if(Math.max(e.precision,t.precision)==ATTimeUnit.MONTH){var m=new ATTimeSpan(0,-1,0,0,0,0,0),o=this.dateByAddingTimespanToDate(t,m);if(e.timestamp==o.timestamp)return this.naturalStringFromDate(e,!0);var g,d,r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),h=this.yearStringFromDate(e),l=this.yearStringFromDate(o);return"%b %Y"===n?(g=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(o)):(g=this.monthStringFromDate(e),d=this.monthStringFromDate(o)),e.year==o.year&&e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?g+" - "+d+" "+h+" "+r:g+" - "+d+" "+h:e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?g+" "+h+" - "+d+" "+l+" "+r:g+" "+h+" - "+d+" "+l:g+" "+h+" "+r+" - "+d+" "+l+" "+s}if("%d %b %Y"===a||"%d %B %Y"===a){if(Math.max(e.precision,t.precision)==ATTimeUnit.DAY){var c=new ATTimeSpan(0,0,0,-1,0,0,0),o=this.dateByAddingTimespanToDate(t,c);if(e.timestamp==o.timestamp)return this.naturalStringFromDate(e,!0);var g,d,r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),h=this.yearStringFromDate(e),l=this.yearStringFromDate(o);"%d %b %Y"===a?(g=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(o)):(g=this.monthStringFromDate(e),d=this.monthStringFromDate(o));var u=this.dayStringFromDate(e),T=this.dayStringFromDate(o),y=this.weekdays[e.weekdayIndex].name,p=this.weekdays[o.weekdayIndex].name;return e.month==o.month&&e.year==o.year&&e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?y+" "+u+" - "+p+" "+T+" "+g+" "+h+" "+r:y+" "+u+" - "+p+" "+T+" "+g+" "+h:e.year==o.year&&e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?y+" "+u+" "+g+" - "+p+" "+T+" "+d+" "+h+" "+r:y+" "+u+" "+g+" - "+p+" "+T+" "+d+" "+h:e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?y+" "+u+" "+g+" "+h+" - "+p+" "+T+" "+d+" "+l+" "+r:y+" "+u+" "+g+" "+h+" - "+p+" "+T+" "+d+" "+l:y+" "+u+" "+g+" "+h+" "+r+" - "+p+" "+T+" "+d+" "+l+" "+s}var o=t;if(Math.max(e.precision,t.precision)==ATTimeUnit.HOUR&&0==t.hour||Math.max(e.precision,t.precision)==ATTimeUnit.MINUTE&&0==t.hour&&0==t.hour||0==t.hour&&0==t.minute&&0==t.second){var c=new ATTimeSpan(0,0,0,-1,0,0,0);o=this.dateByAddingTimespanToDate(t,c),o.hour=this.hoursInDay}if(e.timestamp==o.timestamp)return this.naturalStringFromDate(e,!0);var g,d,r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),h=this.yearStringFromDate(e),l=this.yearStringFromDate(o);"%d %b %Y"===a?(g=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(o)):(g=this.monthStringFromDate(e),d=this.monthStringFromDate(o));var u=this.dayStringFromDate(e),T=this.dayStringFromDate(o),y=this.weekdays[e.weekdayIndex].name,p=this.weekdays[o.weekdayIndex].name,R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(o,Math.max(e.precision,t.precision)),A=!1;return("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)&&"p"==D.charAt(D.length-2))&&(A=!0),e.eraIndex==o.eraIndex&&e.year==o.year&&e.month==o.month&&e.day==o.day?(1==A&&(R=R.substr(0,R.length-3)),e.eraIndex!=this.eras.length-1?y+" "+u+" "+g+" "+h+" "+R+" - "+D+" "+r:y+" "+u+" "+g+" "+h+" "+R+" - "+D):e.eraIndex==o.eraIndex&&e.year==o.year&&e.month==o.month?e.eraIndex!=this.eras.length-1?S+" "+y+" "+u+" "+g+" - "+D+" "+p+" "+T+" "+d+" "+h+" "+r:R+" "+y+" "+u+" "+g+" - "+D+" "+p+" "+T+" "+d+" "+h:e.eraIndex!=this.eras.length-1||e.eraIndex!=o.eraIndex?y+" "+u+" "+g+" "+h+" "+R+" "+r+" - "+p+" "+T+" "+d+" "+l+" "+D+" "+s:y+" "+u+" "+g+" "+h+" "+R+" - "+p+" "+T+" "+d+" "+l+" "+D}if(Math.max(e.precision,t.precision)==ATTimeUnit.DAY){var c=new ATTimeSpan(0,0,0,-1,0,0,0),o=this.dateByAddingTimespanToDate(t,c),y=this.weekdays[e.weekdayIndex].name,p=this.weekdays[o.weekdayIndex].name,I=!0;if("%Y-%m-%d"===a&&(I=!1),e.timestamp==o.timestamp)return this.naturalStringFromDate(e,I);var r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),S=a,f=a;return S=S.replace("%d",ATUtilities.numberToTwoDigitString(e.day)),S=S.replace("%m",ATUtilities.numberToTwoDigitString(e.month)),S=S.replace("%Y",ATUtilities.numberToTwoDigitString(e.year)),f=f.replace("%d",ATUtilities.numberToTwoDigitString(o.day)),f=f.replace("%m",ATUtilities.numberToTwoDigitString(o.month)),f=f.replace("%Y",ATUtilities.numberToTwoDigitString(o.year)),1==I?e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?y+" "+S+" - "+p+" "+f+" "+r:y+" "+S+" - "+p+" "+f:y+" "+S+" "+r+" - "+p+" "+f+" "+s:e.eraIndex==o.eraIndex?e.eraIndex!=this.eras.length-1?S+" - "+f+" "+r:S+" - "+f:S+" "+r+" - "+f+" "+s}var o=t;if(Math.max(e.precision,t.precision)==ATTimeUnit.HOUR&&0==t.hour||Math.max(e.precision,t.precision)==ATTimeUnit.MINUTE&&0==t.hour&&0==t.hour||0==t.hour&&0==t.minute&&0==t.second){var c=new ATTimeSpan(0,0,0,-1,0,0,0);o=this.dateByAddingTimespanToDate(t,c),o.hour=this.hoursInDay}var y=this.weekdays[e.weekdayIndex].name,p=this.weekdays[o.weekdayIndex].name,I=!0;if("%Y-%m-%d"===a&&(I=!1),e.timestamp==o.timestamp)return this.naturalStringFromDate(e,I);var r=this.eraStringFromDate(e),s=this.eraStringFromDate(o),S=a,f=a;S=S.replace("%d",ATUtilities.numberToTwoDigitString(e.day)),S=S.replace("%m",ATUtilities.numberToTwoDigitString(e.month)),S=S.replace("%Y",ATUtilities.numberToTwoDigitString(e.year)),f=f.replace("%d",ATUtilities.numberToTwoDigitString(o.day)),f=f.replace("%m",ATUtilities.numberToTwoDigitString(o.month)),f=f.replace("%Y",ATUtilities.numberToTwoDigitString(o.year));var R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(o,Math.max(e.precision,t.precision)),A=!1;return("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)&&"p"==D.charAt(D.length-2))&&(A=!0),e.eraIndex==o.eraIndex&&e.year==o.year&&e.month==o.month&&e.day==o.day?(1==A&&(R=R.substr(0,R.length-3)),0==I?e.eraIndex!=this.eras.length-1?S+" "+R+" - "+D+" "+r:S+" "+R+" - "+D:e.eraIndex!=this.eras.length-1?y+" "+S+" "+R+" - "+D+" "+r:y+" "+S+" "+R+" - "+D):0==I?e.eraIndex!=o.eraIndex||e.eraIndex!=this.eras.length-1?S+" "+R+" "+r+" - "+f+" "+D+" "+s:S+" "+R+" - "+f+" "+D:e.eraIndex!=o.eraIndex||e.eraIndex!=this.eras.length-1?y+" "+S+" "+R+" "+r+" - "+p+" "+f+" "+D+" "+s:y+" "+S+" "+R+" - "+p+" "+f+" "+D}if(this.calendarType!=ATCalendarType.CALENDAR_TYPE_DAY_TIME){if(this.calendarType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME){if(Math.max(e.precision,t.precision)==ATTimeUnit.WEEK){var w=this.GetWeeksSinceZeroDate(e);this.GetWeekSinceZeroDate(t);return"Week "+w.toString()+" - "+M.toString()}if(Math.max(e.precision,t.precision)==ATTimeUnit.DAY){var x=this.weekdays[e.weekdayIndex].name,v=this.GetWeekSinceZeroDate(e),U=this.GetDaysSinceZeroDate(e),k=U-v*this.weekdays.length,E=this.weekdays[t.weekdayIndex].name,M=this.GetWeekSinceZeroDate(t),Y=this.GetDaysSinceZeroDate(t),F=Y-M*this.weekdays.length;return 0>k&&v--,0>F&&M--,v==M?x+" - "+E+" Week "+v.toString():x+" Week "+v.toString()+" - "+E+" Week "+M.toString()}if(Math.max(e.precision,t.precision)==ATTimeUnit.HOUR){var x=this.weekdays[e.weekdayIndex].name,v=this.GetWeeksSinceZeroDate(e),U=this.GetDaysSinceZeroDate(e),k=U-v*this.weekdays.length,E=this.GetWeekSinceZeroDate(t),Y=this.GetDaysSinceZeroDate(t),F=Y-endWeeksSinceZero*this.weekdays.length;if(0>k)v--;else if(0==k){var C=this.GetHoursSinceZeroDate(e),N=C-U*this.hoursInDay;0>N&&v--}if(0>F)M--;else if(0==F){var P=this.GetHoursSinceZero(t),W=P-Y*this.hoursInDay;0>W&&M--}var R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),A=!1;return"a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)&&"p"==D.charAt(D.length-2),e.weekdayIndex==t.weekdayIndex&&v==M?(1==A&&(R=R.substr(0,R.length-3)),x+" Week "+v.toString()+" "+R+" - "+D):v==M?R+" "+y+" - "+D+" "+E+" Week "+v.toString():R+" "+x+" Week "+v.toString()+" - "+D+" "+E+" Week "+M.toString()}if(Math.max(e.precision,t.precision)==ATTimeUnit.MINUTE){var x=this.weekdays[e.weekdayIndex].name,v=this.GetWeeksSinceZeroDate(e),U=this.GetDaysSinceZeroDate(e),k=U-v*this.weekdays.length,E=this.weekdays[t.weekdayIndex].name,M=this.GetWeeksSinceZeroDate(t),Y=this.GetDaysSinceZeroDate(t),F=Y-M*this.weekdays.length;if(0>k)v--;else if(0==k){var C=this.GetHoursSinceZeroDate(e),N=C-U*this.hoursInDay;if(0>N)v--;else if(0==N){var b=this.GetMinutesSinceZeroDate(e),_=b-60*C;0>_&&v--}}if(0>F)M--;else if(0==F){var P=this.GetHoursSinceZeroDate(t),W=P-Y*this.hoursInDay;if(0>W)M--;else if(0==W){var B=this.GetMinutesSinceZeroDate(t),Z=B-60*P;0>Z&&M--}}var R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),L=!1;return("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)&&"p"==D.charAt(D.length-2))&&(L=!0),e.weekdayIndex==endDay.weekdayIndex&&v==M?(1==A&&(R=R.substr(0,R.length-3)),x+" Week "+v.toString()+" "+R+" - "+D):v==M?R+" "+x+" - "+D+" "+E+" Week "+v.toString():R+" "+x+" Week "+v.toString()+" - "+D+" "+E+" Week "+M.toString()}var x=this.weekdays[e.weekdayIndex].name,v=this.GetWeeksSinceZeroDate(e),U=this.GetDaysSinceZeroDate(e),k=U-v*this.weekdays.length,E=this.weekdays[t.weekdayIndex].name,M=this.GetWeeksSinceZeroDate(t),Y=this.GetDaysSinceZeroDate(t),F=Y-M*this.weekdays.length;if(0>k&&v--,0==k){var C=this.GetHoursSinceZeroDate(e),N=C-U*this.hoursInDay;if(0>N)startWeeksSinceZero--;else if(0==N){var b=this.GetHoursSinceZeroDate(e),_=b-60*C;if(0>_)v--;else if(0==_){var O=this.GetSecondsSinceZeroDate(e),H=O-60*b;0>H&&v--}}}if(0>F&&M--,0==F){var P=this.GetHoursSinceZeroDate(t),W=P-Y*this.hoursInDay;if(0>W)P--;else if(0==W){var B=this.GetHoursSinceZeroDate(t);if(0>Z)M--;else if(0==Z){var G=this.GetSecondsSinceZeroDate(t),z=G-60*B;0>z&&M--}}}var R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),A=!1;return("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(D.length-2)||"p"==D.charAt(D.length-2))&&(A=!0),e.weekdayIndex==endDay.weekdayIndex&&v==M?(1==A&&(R=R.substr(0,R.length-3)),R+" - "+D+" "+y+" Week "+v.toString()):v==M?R+" "+x+" - "+D+" "+E+" Week "+v.toString():R+" "+x+" Week "+v.toString()+" - "+D+" "+E+" Week "+M.toString();
}return this.naturalStringFromDate(e,!0)+" - "+this.naturalStringFromDate(t,!0)}if(Math.max(e.precision,t.precision)==ATTimeUnit.DAY){var U=this.GetDaysSinceZeroDate(e),Y=this.GetDaysSinceZeroDate(t);return U==Y-1?this.naturalStringFromDate(e,!0):"Day "+U.toString()+" - "+(Y-1).toString()}if(Math.max(e.precision,t.precision)==ATTimeUnit.HOUR){var U=this.GetDaysSinceZeroDate(e),Y=this.GetDaysSinceZeroDate(t),C=this.GetHoursSinceZeroDate(e),P=this.GetHoursSinceZeroDate(t),N=C-U*this.hoursInDay,W=P-Y*this.hoursInDay,R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),A=!1;return("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==D.charAt(D.length-2)&&"p"==D.charAt(D.length-2))&&(A=!0),0>N&&U--,0>W&&Y--,U==Y?(1==A&&(R=R.substr(0,R.length-3)),R+" - "+D+" Day "+q.toString()):R+" Day "+q.toString()+" - "+D+" - Day "+Y.toString()}if(Math.max(e.precision,t.precision)!=ATTimeUnit.MINUTE){var U=this.GetDaysSinceZeroDate(e),Y=this.GetDaysSinceZeroDate(t),C=this.GetHoursSinceZeroDate(e),P=this.GetHoursSinceZeroDate(t),N=C-U*this.hoursInDay,W=P-Y*this.hoursInDay,R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),A=!1;if(("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)||"p"==D.charAt(D.length-2))&&(A=!0),0>N)U--;else if(0==N){var C=this.GetMinutesSinceZeroDate(e),_=b-60*C;if(0>_)U--;else if(0==_){var O=this.GetSecondsSinceZeroDate(e),H=O-60*b;0>H&&U--}}if(0>W)Y--;else if(0==W){var B=this.GetMinutesSinceZeroDate(e),Z=B-60*P;if(0>Z)Y--;else if(0==Z){var G=this.GetSecondsSinceZeroDate(t),z=G-60*B;0>z&&Y--}}return startDaySinceZeroDate==Y?(1==A&&(R=R.substr(0,R.length-3)),R+" - "+D+" Day "+U.toString()):R+" Day"+U.toString()+" - "+D+" Day "+Y.toString()}var q=this.GetDaysSinceZeroDate(e),C=(this.GetDaysSinceZeroDate(t),this.GetHoursSinceZeroDate(e)),P=this.GetHoursSinceZeroDate(t),N=C-U*this.hoursInDay,W=P-Y*this.hoursInDay,R=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),D=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),K=!1;if(("a"==R.charAt(R.length-2)&&"a"==D.charAt(D.length-2)||"p"==R.charAt(R.length-2)&&"p"==D.charAt(D.length-2))&&(K=!0),0>N)U--;else if(0==N){var b=this.GetMinutesSinceZeroDate(e),_=b-60*C;0>_&&U--}if(0>W)Y--;else if(0==W){var B=this.GetMinutesSinceZeroDate(t),Z=B-60*P;0>Z&&Y--}return U==Y?(1==A&&(R=R.substr(0,R.length-3)),R+" - "+D+" Day "+U.toString()):void(R+" Day "+U.toString()+" - "+D+"Day "+U.toString())},ATCalendar.prototype.eraStringFromDate=function(e){return this.eras[e.eraIndex].name},ATCalendar.prototype.yearStringFromDate=function(e){if(e.year>1e9){var t=e.year%1e9;if(1e6>t){var a=ATUtilties.floatToYear(e.year/1e9);return a.toString()+" billion"}var n=e.year/1e9;return n.toString()+" billion"}if(e.year>1e6){var t=(this.eras[e.eraIndex].shortName,e.year%1e6);if(1e3>t){var i=ATUtilities.floatToYear(e.year%1e6);return i.toString()+" million"}var o=year/1e6;return o.toString()+" million"}return e.year.toString()},ATCalendar.prototype.monthStringFromDate=function(e){return this.months[e.month-1].name},ATCalendar.prototype.shortMonthStringFromDate=function(e){return this.months[e.month-1].shortName},ATCalendar.prototype.dayStringFromDate=function(e){return e.day.toString()},ATCalendar.prototype.timeStringFromDate=function(e,t){var a=this.timeFormat;if("undefined"==typeof t&&(t=e.precision),t==ATTimeUnit.HOUR){if("%I:%M:%S"===a&&this.hoursInDay%2==0){var n=e.hour%(this.hoursInDay/2);return e.hour<this.hoursInDay/2?n.toString()+" am":n.toString()+" pm"}return"%H:%M"===a?ATUtilities.numberToTwoDigitString(e.hour)+"00h":e.hour.toString()+":00"}if(t==ATTimeUnit.MINUTE){if("%I:%M:%S"===a&&this.hoursInDay%2==0){var n=e.hour%(this.hoursInDay/2);return e.hour<this.hoursInDay/2?n.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)+" am":n.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)+" pm"}return"%H%M"===a?ATUtilities.numberToTwoDigitString(e.hour)+ATUtilities.numberToTwoDigitString(e.minute)+"h":e.hour.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)}if(t==ATTimeUnit.SECOND){if("%I:%M:%S"===a&&this.hoursInDay%2==0){var n=e.hour%(this.hoursInDay/2);return e.hour<this.hoursInDay/2?n.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)+":"+ATUtilities.numberToTwoDigitString(e.second)+" am":n.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)+":"+ATUtilities.numberToTwoDigitString(e.second)+" pm"}return"%H%M"===a?ATUtilities.numberToTwoDigitString(e.hour)+ATUtilities.numberToTwoDigitString(e.minute)+"h":e.hour.toString()+":"+ATUtilities.numberToTwoDigitString(e.minute)+":"+ATUtilities.numberToTwoDigitString(e.second)}return""},ATCalendar.prototype.modifyWeekdayInMatchResult=function(e,t){if(e.weekdayRange.length>0){var a=this.weekdays[e.date.weekdayIndex].name;1==t&&(a=this.weekdays[e.date.weekdayIndex].shortName);var n=e.weekdayRange,i=new ATRange(n.location,n.length);i.length=a.length;var o=i.length-n.length;e.text=ATUtilities.replaceStringBetween(e.text,e.weekdayRange.location,e.weekdayRange.location+e.weekdayRange.length,a),e.weekdayRange.length=i.length,e.eraRange.location>n.location&&(e.eraRange.location+=o),e.yearRange.location>n.location&&(e.yearRange.location+=o),e.monthRange.location>n.location&&(e.monthRange.location+=o),e.dayRange.location>n.location&&(e.dayRange.location+=o),e.hourRange.location>n.location&&(e.hourRange.location+=o),e.minuteRange.location>n.location&&(e.minuteRange.location+=o),e.secondRange.location>n.location&&(e.secondRange.location+=o),e.amPmRange.location>n.location&&(e.amPmRange.location+=o),e.selection.location>n.location&&(e.selection.location+=o),e.updatedCursorPosition>n.location&&(e.updatedCursorPosition+=o)}},ATCalendar.prototype._isStandardMonths=function(){return 12!=this.months.length?!1:31!=this.months[0].normalDuration||31!=this.months[0].leapDuration?!1:28!=this.months[1].normalDuration||29!=this.months[1].leapDuration?!1:31!=this.months[2].normalDuration||31!=this.months[2].leapDuration?!1:30!=this.months[3].normalDuration||30!=this.months[3].leapDuration?!1:31!=this.months[4].normalDuration||31!=this.months[4].leapDuration?!1:30!=this.months[5].normalDuration||30!=this.months[5].leapDuration?!1:31!=this.months[6].normalDuration||31!=this.months[6].leapDuration?!1:31!=this.months[7].normalDuration||31!=this.months[7].leapDuration?!1:30!=this.months[8].normalDuration||30!=this.months[8].leapDuration?!1:31!=this.months[9].normalDuration||31!=this.months[9].leapDuration?!1:30!=this.months[10].normalDuration||30!=this.months[10].leapDuration?!1:31==this.months[11].normalDuration&&31==this.months[11].leapDuration},ATCalendar.prototype._toDaysSinceCalcZero=function(e,t,a,n){return e?(a=(a+9)%12,t-=ATUtilities.floatToInt(a/10),365*t+ATUtilities.floatToInt(t/4)-ATUtilities.floatToInt(t/100)+ATUtilities.floatToInt(t/400)+ATUtilities.floatToInt((306*a+5)/10)+(n-1)):(a=(a+9)%12,t+=ATUtilities.floatToInt(a/10),365*t-ATUtilities.floatToInt((306*a+5)/10)+(n-1))},ATCalendar.prototype._fromDaysSinceCalcZero=function(e,t,a){var n,i,o,r;t?(n=ATUtilities.floatToInt((1e4*e+14780)/3652425),i=e-(365*n+ATUtilities.floatToInt(n/4)-ATUtilities.floatToInt(n/100)+ATUtilities.floatToInt(n/400)),0>i&&(n--,i=e-(365*n+ATUtilities.floatToInt(n/4)-ATUtilities.floatToInt(n/100)+ATUtilities.floatToInt(n/400))),o=ATUtilities.floatToInt((52+100*i)/3060),a.year=n+ATUtilities.floatToInt((o+2)/12),a.month=ATUtilities.floatToInt((o+2)%12)+1,a.day=i-ATUtilities.floatToInt((306*o+5)/10)+1):(n=e/365,r=365*n-e,0>r&&(n++,r=e-365*n),o=ATUtilities.floatToInt((52+100*r)/3060),a.year=n-ATUtilities.floatToInt((o+2)/12),a.month=ATUtilities.floatToInt((o+2)%12)+1,a.day=r-ATUtilities.floatToInt((306*o+5)/10)+1)},ATCalendar.prototype.incrementDateString=function(e,t,a){var n=new ATRange(t,0),i=new ATStringSelection(e,n),o=this.dateWithPartialString(e,t,!0),r=!1,s=!1,h=!1,l=!1,m=!1,g=!1,d=!1,c=!1,u=new ATRange(t,0),T="";if(t=o.updatedCursorPosition,this.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(o.eraRange.contains(t)){var y=o.date.eraIndex+a;if(y>=0&&y<this.eras.length){s=!0,r=!0,u=o.eraRange;var p=e.substring(o.eraRange.location,o.eraRange.location+o.eraRange.length),R=e.match(this.longEraNameRegExp),D=e.match(this.shortEraNameRegExp);T=null!=D?this.eras[y].shortName:this.eras[y].name}}else if(o.yearRange.contains(t)){var A=o.validDate?o.date.year:parseInt(e.substring(o.yearRange.location,o.yearRange.location+o.yearRange.length));A+=a,A>0&&(r=!0,h=!0,u=o.yearRange,T=A.toString())}else if(o.monthRange.contains(t)){var A=o.validDate?o.date.month:parseInt(e.substring(o.monthRange.location,o.monthRange.location+o.monthRange.length));A+=a,0>=A&&(A=this.months.length),A>this.months.length&&(A=1),r=!0,l=!0;var p=e.substring(o.monthRange.location,o.monthRange.location+o.monthRange.length),R=p.match(this.longMonthNameRegExp),D=p.match(this.shortMonthNameRegExp);null!=R?(u=o.monthRange,T=this.months[A-1].name):null!=D?(u=o.monthRange,T=this.months[A-1].shortName):(u=o.monthRange,T=A.toString())}else if(o.dayRange.contains(t)||o.weekdayRange.contains(t)){var A=o.validDate?o.date.day:parseInt(e.substring(o.dayRange.location,o.dayRange.location+o.dayRange.length));A+=a,0>=A&&(A=this.maximumDaysInAnyMonth),A>this.maximumDaysInAnyMonth&&(A=1),r=!0,m=!0,u=o.dayRange,T=A.toString()}else if(o.hourRange.contains(t)){var A=o.validDate?o.date.hour:parseInt(e.substring(o.hourRange.location,o.hourRange.location+o.hourRange.length));if(A+=a,0>A&&(A=this.hoursInDay-1),A>=this.hoursInDay&&(A=0),-1!=o.amPmRange.location){if(!((A<this.hoursInDay/2||A==this.hoursInDay)&&(o.date.hour<this.hoursInDay/2||o.date.hour==this.hoursInDay)||A>=this.hoursInDay/2&&A<this.hoursInDay-1&&o.date.hour>=this.hoursInDay/2&&o.date.hour<this.hoursInDay-1)){var I=!1,S="",f=new ATRange(t,0),w=e.substring(o.amPmRange.location,o.amPmRange.location+o.amPmRange.length);"AM"==w?(S="PM",I=!0,f=o.amPmRange):"am"==w?(S="pm",I=!0,f=o.amPmRange):"pm"==w?(S="am",I=!0,f=o.amPmRange):"PM"==w?(S="AM",I=!0,f=o.amPmRange):"aM"==w?(S="pM",I=!0,f=o.amPmRange):"Am"==w?(S="Pm",I=!0,f=o.amPmRange):"pM"==w?(S="aM",I=!0,f=o.amPmRange):"Pm"==w&&(S="Am",I=!0,f=o.amPmRange),1==I&&(i.text=ATUtilities.replaceStringBetween(i.text,o.amPmRange.location,o.amPmRange.location+o.amPmRange.length,S))}A>this.hoursInDay/2&&(A-=this.hoursInDay/2)}r=!0,g=!0,u=o.hourRange,T=A.toString()}else if(o.minuteRange.contains(t)){var A=o.validDate?o.date.minute:parseInt(e.substring(o.minuteRange.location,o.minuteRange.location+o.minuteRange.length));A+=a,0>A&&(A=59),A>59&&(A=0),r=!0,d=!0,u=o.minuteRange,T=ATUtilities.numberToTwoDigitString(A)}else if(o.secondRange.contains(t)){var A=o.validDate?o.date.second:parseInt(e.substring(o.secondRange.location,o.secondRange.location+o.secondRange.length));A+=a,0>A&&(A=59),A>59&&(A=0),r=!0,c=!0,u=o.secondRange,T=ATUtilities.numberToTwoDigitString(A)}}else if(this.calendarType==ATCalendarType.CALENDAR_TYPE_HOUR_TIME){if(1==o.negationRange.contains(t)&&0==o.hourRange.contains(t)){var x=!0,v=this.getHoursSinceZeroDate(o.date);if(0>v)x=!1;else if(0==v){var U=this.getMinutesSinceZeroDate(o.date);if(0>U)x=!1;else if(0==U){var k=this.getSecondsSinceZeroDate(o.date);0>k&&(x=!1)}}r=!0,u=o.negationRange,T=0==x?"+":"-"}else if(o.hourRange.contains(t)){var v=Math.abs(this.getHoursSinceZeroDate(o.date)),A=v+a;0>A?r=!1:(r=!0,u=o.hourRange,T=A.toString())}else if(o.minuteRange.contains(t)){var v=this.getHoursSinceZeroDate(o.date),U=this.getMinutesSinceZeroDate(o.date),E=Math.abs(U-60*v),A=E+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.minuteRange,T=ATUtilities.numberToTwoDigitString(A)}else if(o.secondRange.contains(t)){var U=this.getMinutesSinceZeroDate(o.date),M=this.getSecondsSinceZeroDate(o.date),k=Math.abs(M-60*U),A=k+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.secondRange,T=ATUtilities.numberToTwoDigitString(A)}}else if(this.calendarType==ATCalendarType.CALENDAR_TYPE_DAY_TIME){if(o.floatingDayRange.contains(t)){r=!0;var Y=this.getDaysSinceZeroDate(o.date);0>=Y&&o.date.timestamp<this.zeroDate.timestamp&&(o.date.hour!=this.zeroDate.hour||o.date.minute!=this.zeroDate.minute||o.date.second!=this.zeroDate.second)&&Y--;var A=Y+a;u=o.floatingDayRange,T=A.toString()}else if(o.hourRange.contains(t)){var A=o.date.hour+a;if(0>A&&(A=this.hoursInDay-1),A>=this.hoursInDay&&(A=0),-1!=o.amPmRange.location){if(!((A<this.hoursInDay/2||A==this.hoursInDay)&&(o.date.hour<this.hoursInDay/2||o.date.hour==this.hoursInDay)||A>this.hoursInDay/2&&A<this.hoursInDay-1&&o.date.hour>=this.hoursInDay/2&&o.date.hour<this.hoursInDay-1)){var I=!1,S="",f=new ATRange(t,0),w=e.substring(o.amPmRange.location,o.amPmRange.location+amPmRange.length);"AM"==w?(S="PM",I=!0,f=o.amPmRange):"am"==w?(S="pm",I=!0,f=o.amPmRange):"pm"==w?(S="am",I=!0,f=o.amPmRange):"PM"==w?(S="AM",I=!0,f=o.amPmRange):"aM"==w?(S="pM",I=!0,f=o.amPmRange):"Am"==w?(S="Pm",I=!0,f=o.amPmRange):"pM"==w?(S="aM",I=!0,f=o.amPmRange):"Pm"==w&&(S="Am",I=!0,f=o.amPmRange),1==I&&ATUtilities.replaceStringBetween(i.text,amPmRange.location,amPmRange.location+amPmRange.length,S)}A>this.hoursInDay/2&&(A-=this.hoursInDay/2)}r=!0,u=o.hourRange,T=A.toString()}else if(o.minuteRange.contains(t)){var A=o.date.minute+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.minuteRange,T=ATUtilities.numberToTwoDigitString(A)}else if(o.secondRange.contains(t)){var A=o.date.second+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.secondRange,T=ATUtilities.numberToTwoDigitString(A)}}else if(this.calendarType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME)if(o.weekRange.contains(t)){r=!0;var F=this.getWeeksSinceZeroDate(o.date);0>=F&&o.date.timestamp<this.zeroDate.timestamp&&(o.date.weekdayIndex!=this.zeroDate.weekdayIndex||o.date.hour!=this.zeroDate.hour||o.date.minute!=this.zeroDate.minute||o.date.second!=this.zeroDate.second)&&F--;var A=F+a;u=o.weekRange,T=A.toString()}else if(o.weekdayRange.contains(t)){var C,N=e.substr(o.weekdayRange.location,o.weekdayRange.length),P=0;for(P=0;P<this.weekdays.length;P++)if(ATUtilities.caseInsensitiveCompare(this.weekdays[P].name,N)||ATUtilities.caseInsensitiveCompare(this.weekdays[P].shortName,N)){C=P+a;break}for(0>C&&(C=this.weekdays.length-1);C>=this.weekdays.length;)C-=this.weekdays.length;u=o.weekdayRange;var R=e.match(this.longWeekdayNameRegExp),D=e.match(this.shortWeekdayNameRegExp);T=null!=D?this.weekdays[C].shortName:this.weekdays[C].name,r=!0}else if(o.hourRange.contains(t)){var A=o.date.hour+a;if(0>A&&(A=this.hoursInDay-1),A>=this.hoursInDay&&(A=0),-1!=o.amPmRange.location){if(!((A<this.hoursInDay/2||A==this.hoursInDay)&&(o.date.hour<this.hoursInDay/2||o.date.hour==this.hoursInDay)||A>this.hoursInDay/2&&A<this.hoursInDay-1&&o.date.hour>=this.hoursInDay/2&&o.date.hour<this.hoursInDay-1)){var I=!1,S="",f=new ATRange(t,0),w=e.substring(o.amPmRange.location,o.amPmRange.location+o.amPmRange.length);"AM"==w?(S="PM",I=!0,f=o.amPmRange):"am"==w?(S="pm",I=!0,f=o.amPmRange):"pm"==w?(S="am",I=!0,f=o.amPmRange):"PM"==w?(S="AM",I=!0,f=o.amPmRange):"aM"==w?(S="pM",I=!0,f=o.amPmRange):"Am"==w?(S="Pm",I=!0,f=o.amPmRange):"pM"==w?(S="aM",I=!0,f=o.amPmRange):"Pm"==w&&(S="Am",I=!0,f=o.amPmRange),1==I&&(i.text=ATUtilities.replaceStringBetween(i.text,o.amPmRange.location,o.amPmRange.location+o.amPmRange.length,S))}A>this.hoursInDay/2&&(A-=this.hoursInDay/2)}r=!0,u=o.hourRange,T=A.toString()}else if(o.minuteRange.contains(t)){var A=o.date.minute+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.minuteRange,T=ATUtilities.numberToTwoDigitString(A)}else if(o.secondRange.contains(t)){var A=o.date.second+a;0>A&&(A=59),A>59&&(A=0),r=!0,u=o.secondRange,T=ATUtilities.numberToTwoDigitString(A)}if(1==r){i.text=ATUtilities.replaceStringBetween(o.text,u.location,u.location+u.length,T),i.selectionRange.location=u.location,i.selectionRange.length=T.length;var W=this.dateWithPartialString(i.text,t,!0);1==W.matchFound&&(i.text=W.text,s?i.selectionRange=W.eraRange:h?i.selectionRange=W.yearRange:l?i.selectionRange=W.monthRange:m?i.selectionRange=W.dayRange:g?i.selectionRange=W.hourRange:d?i.selectionRange=W.minuteRange:c&&(i.selectionRange=W.secondRange))}return i},ATCalendar.prototype.updateStringWithComponents=function(e,t,a,n,i,o){var r=new ATRange(t,0),s=new ATStringSelection(e,r);if(s.text=e,this.calendarType!=ATCalendarType.CALENDAR_TYPE_DATE_TIME)return s;var h=this.dateWithPartialString(e,t,!0);if(!e||!h.matchFound){var l,m=a;return l=-1==i?this.dateWithComponents(m,n,1,1,0,0,0,ATTimeUnit.YEAR):-1==o?this.dateWithComponents(m,n,i,1,0,0,0,ATTimeUnit.MONTH):this.dateWithComponents(m,n,i,o,0,0,0,ATTimeUnit.DAY),s.text=this.naturalStringFromDate(l,!0,!1,null,"%Y"),s.selectionRange.location=s.text.length,s}if(1==h.matchFound){if(-1==i)return s.text=n.toString(),(h.eraRange.length>0||a<this.eras.length-1)&&(s.text+=" ",s.text+=this.eras[a].shortName),s.selectionRange.location=s.text.length,s;if(-1==o){if(h.monthRange.length>0){var g=e.substring(h.monthRange.location,h.monthRange.location+h.monthRange.length),d=g.match(this.longMonthNameRegExp),c=g.match(this.shortMonthNameRegExp);null!=d?s.text=this.months[i-1].name:null!=c?s.text=this.months[i-1].shortName:s.text=this.months[i-1].name}else s.text=this.months[i-1].name;return s.text+=" ",s.text+=n.toString(),(h.eraRange.length>0||a<this.eras.length-1)&&(s.text+=" ",s.text+=this.eras[a].shortName),s.selectionRange.location=s.text.length,s}if(s.text=h.text,h.weekdayRange.length>0){var u=this.weekdays[h.date.weekdayIndex].name,T=h.text.search(u),y=!0;if(-1==T){var p=this.weekdays[h.date.weekdayIndex].shortName;T=h.text.search(p),-1!=T&&(y=!0,u=p)}var R,D=this.dateWithComponents(h.date.eraIndex,n,i,o,0,0,0);R=1==y?this.weekdays[D.weekdayIndex].name:this.weekdays[D.weekdayIndex].shortName,s.text=ATUtilities.replaceStringBetween(s.text,h.weekdayRange.location,h.weekdayRange.location+h.weekdayRange.length,R);var A=R.length-u.length;h.dayRange.location>h.weekdayRange.location&&(h.dayRange.location+=A),h.monthRange.location>h.weekdayRange.location&&(h.monthRange.location+=A),h.yearRange.location>h.weekdayRange.location&&(h.yearRange.location+=A),h.eraRange.location>h.weekdayRange.location&&(h.eraRange.location+=A)}if(h.dayRange.length>0){var I=o.toString(),S=I.length-h.dayRange.length;if(s.text=ATUtilities.replaceStringBetween(s.text,h.dayRange.location,h.dayRange.location+h.dayRange.length,I),h.monthRange.location>h.dayRange.location&&(h.monthRange.location+=S),h.yearRange.location>h.dayRange.location&&(h.yearRange.location+=S),h.eraRange.location>h.dayRange.location&&(h.eraRange.location+=S),!(h.monthRange.length>0))return s.selectionRange.location=s.text.length,s;var f,g=s.text.substring(h.monthRange.location,h.monthRange.location+h.monthRange.length),d=g.match(this.longMonthNameRegExp),c=g.match(this.shortMonthNameRegExp);f=null!=d?this.months[i-1].name:null!=c?this.months[i-1].shortName:i.toString(),s.text=ATUtilities.replaceStringBetween(s.text,h.monthRange.location,h.monthRange.location+h.monthRange.length,f);var w=f.length-h.monthRange.length;h.yearRange.location>h.monthRange.location&&(h.yearRange.location+=w),h.eraRange.location>h.monthRange.location&&(h.eraRange.location+=w),s.text=ATUtilities.replaceStringBetween(s.text,h.yearRange.location,h.yearRange.location+h.yearRange.length,n.toString()),h.eraRange.length>0?s.text=ATUtilities.replaceStringBetween(s.text,h.eraRange.location,h.eraRange.location+h.eraRange.length,this.eras[a].shortName):a<this.eras.length-1&&(s.text+=" ",s.text+=this.eras[a].shortName)}else s.text=o.toString()+" "+this.months[i-1].name+" "+n.toString(),(h.eraRange.length>0||a<this.eras.length-1)&&(s.text+=" ",s.text+=this.eras[a].shortName)}return s.selectionRange.location=s.text.length,s},ATCalendar.prototype.nextComponentInString=function(e,t){var a=new ATRange(t,0),n=new ATStringSelection(e,a);n.text=e,n.selectionRange.location=e.length,n.selectionRange.length=0;var i=this.dateWithPartialString(e,t,!1);if(1==i.matchFound){var o=Number.MAX_VALUE,r=n.selectionRange;i.eraRange.location>t&&i.eraRange.location<o&&(o=i.eraRange.location,r=i.eraRange),i.yearRange.location>t&&i.yearRange.location<o&&(o=i.yearRange.location,r=i.yearRange),i.monthRange.location>t&&i.monthRange.location<o&&(o=i.monthRange.location,r=i.monthRange),i.dayRange.location>t&&i.dayRange.location<o&&(o=i.dayRange.location,r=i.dayRange),i.hourRange.location>t&&i.hourRange.location<o&&(o=i.hourRange.location,r=i.hourRange),i.minuteRange.location>t&&i.minuteRange.location<o&&(o=i.minuteRange.location,r=i.minuteRange),i.secondRange.location>t&&i.secondRange.location<o&&(o=i.secondRange.location,r=i.secondRange),i.floatingDayRange.location>t&&i.floatingDayRange.location<o&&(o=i.floatingDayRange.location,r=i.floatingDayRange),this.calendarType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&i.weekdayRange.location>t&&i.weekdayRange.location<o&&(o=i.weekdayRange.location,r=i.weekdayRange),i.weekRange.location>t&&i.weekRange.location<o&&(o=i.weekRange.location,r=i.weekRange),i.amPmRange.location>t&&i.amPmRange.location<o&&(o=i.amPmRange.location,r=i.amPmRange),n.selectionRange=r}return n},ATCalendar.prototype.previousComponentInString=function(e,t){var a=new ATRange(t,0),n=new ATStringSelection(e,a);n.text=e,n.selectionRange.location=0,n.selectionRange.length=0;var i=this.dateWithPartialString(e,t,!1);if(1==i.matchFound){var o=-1,r=n.selectionRange;i.eraRange.location>=0&&i.eraRange.location+i.eraRange.length<t&&i.eraRange.location>o&&(o=i.eraRange.location,r=i.eraRange),i.yearRange.location>=0&&i.yearRange.location+i.yearRange.length<t&&i.yearRange.location>o&&(o=i.yearRange.location,r=i.yearRange),i.monthRange.location>=0&&i.monthRange.location+i.monthRange.length<t&&i.monthRange.location>o&&(o=i.monthRange.location,r=i.monthRange),i.dayRange.location>=0&&i.dayRange.location+i.dayRange.length<t&&i.dayRange.location>o&&(o=i.dayRange.location,r=i.dayRange),i.hourRange.location>=0&&i.hourRange.location+i.hourRange.length<=t&&i.hourRange.location>o&&(o=i.hourRange.location,r=i.hourRange),i.minuteRange.location>=0&&i.minuteRange.location+i.minuteRange.length<t&&i.minuteRange.location>o&&(o=i.minuteRange.location,r=i.minuteRange),i.secondRange.location>=0&&i.secondRange.location+i.secondRange.length<t&&i.secondRange.location>o&&(o=i.secondRange.location,r=i.secondRange),this.calendarType==ATCalendarType.CALENDAR_TYPE_HOUR_TIME&&i.negationRange.location>=0&&i.negationRange.location+i.negationRange.length<=t&&i.negationRange.location>o&&(o=i.negationRange.location,r=i.negationRange),i.amPmRange.location>=0&&i.amPmRange.location+i.amPmRange.length<t&&i.amPmRange.location>o&&(o=i.amPmRange.location,r=i.amPmRange),this.calendarType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&i.weekdayRange.location>=0&&i.weekdayRange.location+i.weekdayRange.length<t&&i.weekdayRange.location>o&&(o=i.weekdayRange.location,r=i.weekdayRange),n.selectionRange=r}return n},module.exports=ATCalendar;
},{"./ATCalendarType":19,"./ATDate":21,"./ATDateOrder":22,"./ATDateStringMatchResult":24,"./ATEra":42,"./ATMonth":63,"./ATRange":69,"./ATStringSelection":80,"./ATTimeSpan":84,"./ATTimeUnit":85,"./ATUtilities":91,"./ATWeekday":93,"lodash":309}],18:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATTimeUnit=require("./ATTimeUnit"),ATCalendar=require("./ATCalendar"),ATTimeSpan=require("./ATTimeSpan"),ATDate=require("./ATDate"),ATMonth=require("./ATMonth"),ATWeekday=require("./ATWeekday"),templateHtml=require("./templates/calendarPickerTemplate.html"),ATCalendarPicker=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.$el.parent();this.d3El=d3.select("#"+t),this.d3El.classed("calendarPicker"),this.era=1,this.year=1,this.month=1,this.day=1,this.precision=ATTimeUnit.YEAR,this.d3El.html(e({})),this.yearInputD3=this.d3El.select("#calendarYearInput"),this.$yearInput=$(this.yearInputD3[0]),this.$yearInput.on("change",this.calendarYearInputChange.bind(this)),this.yearDownArrowD3=this.d3El.select("#yearDivLower").on("click",this.decrementCalendarYearClick.bind(this)),this.yearUpArrowD3=this.d3El.select("#yearDivHigher").on("click",this.incrementCalendarYearClick.bind(this)),this.headerRow=this.d3El.select("#headerRow"),this.tableBody=this.d3El.select("#tableBody"),this.monthYearOnlyDiv=this.d3El.select("#monthYearOnly"),this.yearOnlyDiv=this.d3El.select("#yearOnly"),this.monthsDiv=this.d3El.select("#months")},render:function(){var t=this;this.d3El.on("click",function(e){t.doNothingClick()}),this.setupParentClick(),this.monthYearOnlyDiv.on("click",function(e){t.monthYearOnlyClicked()}),this.yearOnlyDiv.on("click",function(e){t.yearOnlyClicked()}),this.updateMonthDisplay()},setCalendar:function(t){this.calendar=t,this.updateDisplayHeader()},setDate:function(t,e,i,a,n){this.era=t,this.year=e,this.month=i,this.day=a,this.precision=n,this.updateMonthDisplay()},setTimestamp:function(t,e){var i=this.calendar.dateWithTimestamp(t,e);this.era=i.eraIndex,this.year=i.year,this.month=i.month,this.day=i.day,this.precision=e,this.updateMonthDisplay()},setupParentClick:function(){var t=this,e=this.$el.parent(),i=e.parent();i.on("click",function(){t.doNothingClick()})},setDatePicker:function(t){this.datePicker=t},calendarYearInputChange:function(){var t=this.$yearInput.val(),e={};if(this.calendar.dateWithString(t,e),e.foundResult)this.year=e.date.year,this.era=e.date.eraIndex;else{var i=parseInt(this.$yearInput.val());i>0&&(this.year=i)}this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY),this.resumeFocus(!1)},decrementCalendarYearClick:function(){var t=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision),e=new ATTimeSpan(-1,0,0,0,0,0,0),i=this.calendar.dateByAddingTimespanToDate(t,e);this.era=i.eraIndex,this.year=i.year,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,this.precision),this.resumeFocus(!0)},incrementCalendarYearClick:function(){var t=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision),e=new ATTimeSpan(1,0,0,0,0,0,0),i=this.calendar.dateByAddingTimespanToDate(t,e);this.era=i.eraIndex,this.year=i.year,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,this.precision),this.resumeFocus(!0)},yearOnlyClicked:function(t){this.precision=ATTimeUnit.YEAR,this.day=1,this.month=1,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,-1,-1,ATTimeUnit.YEAR),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},monthYearOnlyClicked:function(t){this.precision=ATTimeUnit.MONTH,this.day=1,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,-1,ATTimeUnit.MONTH),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},clickOnMonth:function(t){if(this.month=t.index+1,this.precision<ATTimeUnit.MONTH&&(this.precision=ATTimeUnit.MONTH),this.precision>=ATTimeUnit.DAY)for(var e=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision);!this.calendar.isValidDate(e);)this.day--,e=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision);this.updateMonthDisplay(),this.datePicker&&(this.precision==ATTimeUnit.MONTH?this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,-1,ATTimeUnit.MONTH):this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY)),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},clickOnDate:function(t){0>=t||(this.day=t,this.precision=ATTimeUnit.DAY,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},doNothingClick:function(t){this.resumeFocus()},resumeFocus:function(t){this.datePicker&&this.datePicker.resumeFocus(t)},updateDisplayHeader:function(){var t=this.calendar.weekdays.length,e=Math.max(3*t,27.5),i=this.headerRow.selectAll("th").data(this.calendar.weekdays);i.text(function(t){return t.shortName.charAt(0)+t.shortName.charAt(1)}),i.enter().append("th").text(function(t){return t.shortName.charAt(0)+t.shortName.charAt(1)}),this.d3El.style("width",e+"rem")},updateMonthDisplay:function(){var t=[],e=this.calendar.months,i=this.precision>ATTimeUnit.YEAR?this.calendar.months[this.month-1]:null,a=this.calendar.isLeapYearInEra(this.year,this.era),n=i?a?i.leapDuration:i.normalDuration:0,s=i?this.calendar.dateWithComponents(this.era,this.year,this.month,1,0,0,0,0).weekdayIndex:0,r=0,h=this.calendar.weekdays.length,o=0,c=[],d=Math.ceil(e.length/6),l=Math.ceil(e.length/d),u=100/l;if(i){for(t.push(c),r=0;s>r;r++)c.push(""),o++;for(r=1;n>=r;r++)o==h&&(o=0,c=[],t.push(c)),c.push(""+r),o++;for(r=o;h>r;r++)c.push("")}var p=this,y=this.monthsDiv.selectAll("div").data(e);y.text(function(t){return t.shortName}).attr("class",function(t,e){return p.precision>ATTimeUnit.YEAR&&e==p.month-1?"selMonth":null}),y.enter().append("div").text(function(t){return t.shortName}).attr("class",function(t,e){return p.precision>ATTimeUnit.YEAR&&e==p.month-1?"selMonth":null}).style("width",u+"%").on("click",function(t){p.clickOnMonth(t)}),y.exit().remove();var m=this.tableBody.selectAll("tr").data(t);m.enter().append("tr");var T=m.selectAll("td").data(function(t){return t});T.select("div").text(function(t){return t}).attr("class",function(t){return p.precision>ATTimeUnit.MONTH&&t==p.day?"selected":null}),T.enter().append("td").append("div").text(function(t){return t}).attr("class",function(t){return p.precision>ATTimeUnit.MONTH&&t==p.day?"selected":""}).on("click",function(t){p.clickOnDate(t)}),T.exit().remove(),m.exit().remove();for(var A=""+this.year;A.length<4;)A="0"+A;A+=" "+this.calendar.eras[this.era].shortName,this.$yearInput.val(A),this.monthYearOnlyDiv.attr("class",this.precision==ATTimeUnit.MONTH?"checked":null),this.yearOnlyDiv.attr("class",this.precision==ATTimeUnit.YEAR?"checked":null)}});module.exports=ATCalendarPicker;
},{"./ATCalendar":17,"./ATDate":21,"./ATMonth":63,"./ATTimeSpan":84,"./ATTimeUnit":85,"./ATWeekday":93,"./templates/calendarPickerTemplate.html":101,"backbone":176,"d3":300,"jquery":307,"lodash":309}],19:[function(require,module,exports){
module.exports={CALENDAR_TYPE_DATE_TIME:0,CALENDAR_TYPE_WEEKDAY_TIME:1,CALENDAR_TYPE_DAY_TIME:2,CALENDAR_TYPE_HOUR_TIME:3};
},{}],20:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/colorDropdownTemplate.html"),ATColorDropdown=Backbone.View.extend({setOptions:function(t){this.visibleOptions=t,this.selectedOption&&this.setValue(this.selectedOption.name)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.visibleOptions,function(i){return i.name==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.name:null},initialize:function(){var t=this.$el.attr("id"),i=t+"-label",e=t+"-caret",s=t+"-dropdown",n=t+"-list",l=_.template(templateHtml),o=this;this.visibleOptions=[],this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.d3El=d3.select("#"+t),this.d3El.classed("bselect colorDropdown",!0),this.d3El.attr("tabindex",0),this.d3El.html(l({})),this.$el.keydown(function(t){return o.keyDownHandler(t)}),this.$el.on("blur",function(){return o.blurHandler()}),this.d3El.on("click",function(){o.open||o.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",i).on("click",this.toggle.bind(this)),this.d3LabelName=this.d3Label.select("span"),this.d3LabelColor=this.d3Label.select(".colorSquareLabel"),this.d3El.select(".bselect-caret").attr("id",e).on("click",this.toggle.bind(this)),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",s),this.$dropdown=$("#"+s),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",n),this.$list=$("#"+n),this.updateTitle()},toggle:function(){this.disabled||this.open?this.hide():(this.show(),this.$el.focus()),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id"),i=t+"-list";this.selectedOption?i+"-"+this.selectedOption.colorId:null;this.disabled||(this.d3El.classed("open",!0),this.$dropdown.slideDown(250),this.renderOptions(),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.scrollItemIntoView(),this.open=!0)},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id"),s=e+"-list";i.attr("id",function(t){return s+"-"+t.colorId}).classed("active",function(i){return t.selectedOption?i.name==t.selectedOption.name:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}),i.select(".colorSquare").style("background",function(t){return t.color}),i.select("span").text(function(t){return t.name});var n=i.enter().append("li").attr("id",function(t){return s+"-"+t.colorId}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return t.selectedOption?i.name==t.selectedOption.name:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)});n.append("div").classed("colorSquare",!0).style("background",function(t){return t.color}),n.append("span").text(function(t){return t.name}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=t+"-list",e=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,s=e?i+"-"+e.value:null,n=null;if(s){n=$("#"+s);var l=this.$list.scrollTop(),o=this.$list.height(),h=n.position()?n.position().top:0,d=n.height();(0>h||h+d>o)&&this.$list.scrollTop(l+h-o/2+d/2)}},updateTitle:function(){this.selectedOption?(this.d3LabelName.text(this.selectedOption.name),this.d3LabelColor.style("background",this.selectedOption.color).style("border-color",null)):(this.d3LabelName.html(this.noOptionPlaceholder),this.d3LabelColor.style("background",null).style("border-color","#999"))},optionClick:function(t){return this.selectedOption=_.find(this.visibleOptions,function(i){return i.name==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change"),!1},keyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;switch(i){case 9:this.open&&(this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide());break;case 13:this.open?this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide():this.$el.closest("form").submit(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);break;case 38:this.open?(-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0):this.show();break;case 40:this.open?(-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0):this.show()}return this.renderOptions(),!e},focusHandler:function(){},blurHandler:function(){this.hide()}});module.exports=ATColorDropdown;
},{"./templates/colorDropdownTemplate.html":102,"backbone":176,"d3":300,"jquery":307,"lodash":309}],21:[function(require,module,exports){
var ATDate=function(t,i,e,s,h,n,a,o,r,d){this.timestamp=t,this.eraIndex=i,this.year=e,this.month=s,this.day=h,this.hour=n,this.minute=a,this.second=o,this.weekdayIndex=r,this.precision=d};ATDate.prototype.copy=function(){return new ATDate(this.timestamp,this.eraIndex,this.year,this.month,this.day,this.hour,this.minute,this.second,this.weekdayIndex,this.precision)},module.exports=ATDate;
},{}],22:[function(require,module,exports){
module.exports={DATE_ORDER_YEAR_MONTH_DAY:0,DATE_ORDER_DAY_MONTH_YEAR:1,DATE_ORDER_MONTH_DAY_YEAR:2};
},{}],23:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),bootstrap=require("bootstrap"),ATCalendarPicker=require("./ATCalendarPicker"),ATTimeUnit=require("./ATTimeUnit"),ATCalendar=require("./ATCalendar"),ATDate=require("./ATDate"),ATDatePicker=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=t+"-picker",i=t+"-input",a=t+"-backdrop",s=t+"-calendar",n=this;this.value=null,this.inputValid=!1,this.changeCallback=null,this.continuousChangeCallback=null,this.allowCompletion=!0,this.allowEmptyValues=!0,this.hasChanged=!1,this.isEndPicker=!1,this.pairedStartPicker=null,this.d3El=d3.select("#"+t),this.d3El.classed("datePickerWrap",!0),this.d3pickerDiv=this.d3El.append("div").attr("id",e).attr("class","datePickerDiv"),this.backdrop=this.d3El.append("div").attr("id",a).attr("class","backdrop").style("display","none").on("click",function(){n.focusLost()}),this.backdropOn=!1,this.d3textInput=this.d3pickerDiv.append("input").attr("id",i).attr("class","datePickerInput").attr("type","text").on("focus",function(){n.focusHandler()}).on("blur",function(){n.blurHandler()}).on("input",function(){n.inputHandler()}).on("keydown",function(){n.keyDownHandler()}),this.textInput=$("#"+i),this.d3calendarIcon=this.d3pickerDiv.append("span").attr("id",i).attr("class","fa fa-calendar-o").on("click",function(){n.calendarClickHandler()}),this.d3calendar=this.d3El.append("div").attr("id",s).style("display","none"),this.calendarPickerView=new ATCalendarPicker({el:"#"+s}),this.calendarPickerView.setDatePicker(this),this.$el.popover({content:this.calendarPickerView.el,html:!0,placement:function(t,e){var i=$(window),a=$(e),s=i.height(),n=(i.width(),312*window.mainApp.timelineView.physicalScaleFactor),l=50,r=a.offset();return r.top+n+l<s?"bottom":r.top-n-l>0?"top":r.left-l>0?"left":"right"},trigger:"manual",animation:!1,template:'<div class="popover calendar"><div class="arrow"></div><div class="popover-content"></div></div>'})},setupAsEndPickerForStartPicker:function(t){this.isEndPicker=!0,this.pairedStartPicker=t},setAllowEmptyValues:function(t){this.allowEmptyValues=t},setChangeCallback:function(t){this.changeCallback=t,this.recordedManagerCallback=null},setContinuousChangeCallback:function(t){this.continuousChangeCallback=t},setManagerCallback:function(t){this.managerCallback=t},setValidCallback:function(t){this.validCallback=t},setResetCallback:function(t){this.resetCallback=t},setRangeConversion:function(t){this.rangeConversion=t,t&&(this.calendar=t.calendar,this.calendar?(this.calendarPickerView.setCalendar(this.calendar),this.d3textInput.attr("type","text"),this.d3textInput.attr("class","datePickerInput"),this.d3calendarIcon.style("display",this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME?null:"none")):(this.d3textInput.attr("type","text"),this.d3textInput.attr("class","datePickerNumberInput"),this.d3calendarIcon.style("display","none")))},text:function(){return this.textInput.val()},setText:function(t){this.textInput.val(t),this.inputHandler()},getValue:function(){return this.value},getValid:function(){return this.inputValid},setValid:function(t){this.inputValid=t,this.textInput[0].setCustomValidity(t?"":"Error"),this.d3El.classed("invalid",!t),this.d3pickerDiv.classed("invalid",!t),this.validCallback&&this.validCallback()},getPrecision:function(){return this.value?this.value.precision:0},getTimestamp:function(){return this.calendar?this.value.timestamp:this.value},setValue:function(t){this.calendar&&t?this.setTimestamp(t.timestamp,t.precision):this.setTimestamp(t),this.setValid(!0)},setTimestamp:function(t,e){var i;if($.isNumeric(t)&&this.calendar){var a=this.isEndPicker,s=this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.value=this.calendar.dateWithTimestamp(t,e),i=this.calendar.naturalStringFromDate(this.value,!0,a,s,"%Y")}else this.value=t,i=t?""+t:"";this.textInput.val(i),this.updateDisplay(),this.initialDate=this.value,this.initialText=i,this.setValid(!0)},setDate:function(t){if(this.calendar){this.isEndPicker,this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.setTimestamp(t.timestamp,t.precision)}else this.setTimestamp(t,null);this.setValid(!0)},setDisabled:function(t){this.disabled=t,this.focusLost(),this.textInput.prop("disabled",t),this.d3El.classed("disabled",t)},setEraYearMonthDayPrecision:function(t,e,i,a,s){var n,l,r=(this.value,this.textInput.val()),h=this.textInput.get(0).selectionStart,c=this.isEndPicker,o=this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.calendar&&(n=s==ATTimeUnit.YEAR?this.rangeConversion.updateStringWithComponents(r,h,[t,e,-1,-1]):s==ATTimeUnit.MONTH?this.rangeConversion.updateStringWithComponents(r,h,[t,e,i,-1]):this.rangeConversion.updateStringWithComponents(r,h,[t,e,i,a]),n=this.calendar.dateWithPartialString(n.string,n.string.length,!0,c,o),l=n.selection,this.value=n.date,this.textInput.val(n.text),this.textInput.get(0).setSelectionRange(l.location,l.location+l.length),this.hasChanged=!0,this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.setValid(!0),this.continuousChangeCallback&&this.continuousChangeCallback())},updateDisplay:function(){var t,e=this.value,i=this.isEndPicker,a=this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.calendar&&this.value&&(i&&this.value.timestamp!=a.timestamp&&0==this.value.hour&&0==this.value.minute&&0==this.value.second&&(t=this.calendar.timespanForPrecision(Math.min(ATTimeUnit.DAY,this.value.precision)),t.days=-t.days,t.months=-t.months,t.years=-t.years,e=this.calendar.dateByAddingTimespanToDate(this.value,t)),this.calendarPickerView.setDate(e.eraIndex,e.year,e.month,e.day,this.value.precision))},keyDownHandler:function(){var t,e,i=d3.event.keyCode||d3.event.which,a=!1,s=this.textInput.val(),n=this.textInput.get(0).selectionStart,l=this.textInput.get(0).selectionEnd,r=this.isEndPicker,h=this.pairedStartPicker?this.pairedStartPicker.getValue():null;switch(this.allowCompletion=!0,i){case 9:this.calendar&&(l==s.length||d3.event.shiftKey?0!=n&&d3.event.shiftKey?(t=this.rangeConversion.previousComponentInString(s,n),selection=t.selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(selection.location,selection.location+selection.length),a=!0):this.focusLost():(t=this.rangeConversion.nextComponentInString(s,n),selection=t.selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(selection.location,selection.location+selection.length),a=!0));break;case 8:case 46:this.allowCompletion=!1;break;case 13:this.textInput.blur(),this.textInput.closest("form").submit(),a=!0;break;case 27:break;case 38:t=this.rangeConversion.incrementString(s,n,1),selection=t.selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(selection.location,selection.location+selection.length),this.calendar?(e=this.calendar.dateWithPartialString(t.string,selection.location,!1,r,h),this.value=e.date,!e.validDate&&(!this.allowEmptyValues||!this.zeroLengthString)||e.errorRanges.length>0?this.setValid(!1):this.setValid(!0)):(this.value=parseInt(t.string),1==isNaN(this.value)?this.setValid(!1):this.setValid(!0)),this.updateDisplay(),this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.hasChanged=!0,a=!0;break;case 40:t=this.rangeConversion.incrementString(s,n,-1),selection=t.selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(selection.location,selection.location+selection.length),this.calendar?(e=this.calendar.dateWithPartialString(t.string,selection.location,!1,r,h),this.value=e.date,!e.validDate&&(!this.allowEmptyValues||!this.zeroLengthString)||e.errorRanges.length>0?this.setValid(!1):this.setValid(!0)):(this.value=parseInt(t.string),1==isNaN(this.value)?this.setValid(!1):this.setValid(!0)),this.updateDisplay(),this.hasChanged=!0,this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,a=!0}this.continuousChangeCallback&&this.continuousChangeCallback(),a&&(d3.event.preventDefault(),d3.event.sourceEvent&&d3.event.sourceEvent.preventDefault())},inputHandler:function(){var t,e,i=this.textInput.val(),a=this.textInput.get(0).selectionStart,s=this.isEndPicker,n=this.pairedStartPicker?this.pairedStartPicker.getValue():null;return this.calendar?(0==i.length?(this.$el.popover("hide"),this.zeroLengthString=!0):this.zeroLengthString&&(this.$el.popover("show"),this.zeroLengthString=!1),t=this.calendar.dateWithPartialString(i,a,this.allowCompletion,s,n),!t.validDate&&(!this.allowEmptyValues||!this.zeroLengthString)||t.errorRanges.length>0?void this.setValid(!1):(this.setValid(!0),e=t.selection,this.value=t.date,this.updateDisplay(),this.allowCompletion&&(this.textInput.val(t.text),this.textInput.get(0).setSelectionRange(e.location,e.location+e.length)),this.allowCompletion=!0,this.hasChanged=!0,this.recordedInputValue=this.value.timestamp,this.recordedInputPrecision=this.value.precision,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,void(this.continuousChangeCallback&&this.continuousChangeCallback()))):isNaN(i)||!i.length?void this.setValid(!1):(this.setValid(!0),this.value=parseInt(i),this.recordedInputValue=this.value,this.recordedInputPrecision=0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,void(this.continuousChangeCallback&&this.continuousChangeCallback()))},focusHandler:function(){this.d3pickerDiv.classed("focusRing",!0)},showCalendar:function(){this.calendar&&(this.focusHasResumed=!0,this.backdropOn=!0,this.backdrop.style("display",null),this.d3calendar.style("display",null),this.$el.popover("show"),this.calendarPickerView.render())},resumeFocus:function(t){t&&this.textInput.focus()},focusLost:function(){return this.backdropOn=!1,this.backdrop.style("display","none"),this.$el.popover("hide"),this.d3pickerDiv.classed("focusRing",!1),this.inputValid?(null!==this.recordedInputValue&&void 0!==this.recordedInputValue&&this.recordedChangeCallback&&this.recordedChangeCallback(this.recordedInputValue,this.recordedInputPrecision),null!==this.recordedInputValue&&void 0!==this.recordedInputValue&&this.recordedManagerCallback&&this.recordedManagerCallback(this.recordedInputValue,this.recordedInputPrecision),this.setValue(this.value),this.recordedInputValue=null,this.recordedInputPrecision=null,this.recordedChangeCallback=null,void(this.recordedManagerCallback=null)):void(this.resetCallback&&this.resetCallback())},blurHandler:function(){this.backdropOn||this.focusLost()},focusAndSelectAll:function(){this.textInput.focus(),this.textInput.select()},commit:function(){null!==this.recordedInputValue&&void 0!==this.recordedInputValue&&this.recordedChangeCallback&&this.focusLost()},calendarClickHandler:function(){this.showCalendar(),this.textInput.focus()}});module.exports=ATDatePicker;
},{"./ATCalendar":17,"./ATCalendarPicker":18,"./ATDate":21,"./ATTimeUnit":85,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],24:[function(require,module,exports){
module.exports=function(t,e,i,a,s,n,h,g,o,R,d,r,u,m,c,l,y,x,f,k){this.validDate=t,this.matchFound=e,this.text=i,this.selection=a,this.date=s,this.eraRange=n,this.hourRange=h,this.minuteRange=g,this.secondRange=o,this.amPmRange=R,this.monthRange=d,this.dayRange=r,this.yearRange=u,this.weekdayRange=m,this.cleanText=c,this.errorRanges=l,this.negationRange=y,this.weekRange=x,this.floatingDayRange=f,this.updatedCursorPosition=k};
},{}],25:[function(require,module,exports){
var TimelineDisplayConstants=require("./ATDisplayConstants"),ATDependencyPath=function(e,t,s){if(this.node1=e,this.node2=t,this.startPt=e.get("totalRect").origin.copy(),this.startPt.x=e.get("startPixel"),this.startPt.y+=e.get("lane").get("top")+TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop+TimelineDisplayConstants.eventMarkerCornerRadius,this.startPt.x=Math.round(this.startPt.x)+.5,this.startPt.y=Math.round(this.startPt.y)+.5,this.endPt=t.get("totalRect").origin.copy(),this.endPt.x=t.get("startPixel"),s&&(this.startPt.x=e.get("stopPixel")),this.endPt.y+=t.get("lane").get("top")+TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop+TimelineDisplayConstants.eventMarkerCornerRadius,this.endPt.x=Math.round(this.endPt.x)+.5,this.endPt.y=Math.round(this.endPt.y)+.5,this.startPt.y==this.endPt.y)this.path=" l"+(this.endPt.x-this.startPt.x)+","+(this.endPt.y-this.startPt.y);else if(Math.abs(this.startPt.x-this.endPt.x)<TimelineDisplayConstants.dependencyHookRadius)if(this.startPt.y<this.endPt.y)this.startPt.x<this.endPt.x?this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0":this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0";else{var n=this.startPt;this.startPt=this.endPt,this.endPt=n,this.startPt.x>this.endPt.x?this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0":this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0"}else if(this.startPt.y<this.endPt.y)this.startPt.x<this.endPt.x?this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x-TimelineDisplayConstants.dependencyHookRadius)+",0":this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x+TimelineDisplayConstants.dependencyHookRadius)+",0";else{var n=this.startPt;this.startPt=this.endPt,this.endPt=n,this.startPt.x>this.endPt.x?this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x+TimelineDisplayConstants.dependencyHookRadius)+",0":this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x-TimelineDisplayConstants.dependencyHookRadius)+",0"}this.name=e.get("lane").id+" "+e.id+" "+t.get("lane").id+" "+t.id};module.exports=ATDependencyPath;
},{"./ATDisplayConstants":26}],26:[function(require,module,exports){
function MakeTimelineDisplayConstants(){this.pixelsToRemScale=.1,this.toolbarHeight=62,this.laneMarginWidth=20,this.normalLifetimeHeight=24,this.lifetimeHeight=24,this.collapsedLaneHeight=this.lifetimeHeight,this.minimumExpandedLaneHeight=2*this.collapsedLaneHeight,this.timeHeaderHeight=53,this.contextHeight=33,this.bookmarksHeight=22,this.navFooterHeight=this.contextHeight+this.bookmarksHeight,this.filterBarHeight=46,this.eventDateTextHeight=18,this.minEventWidthToDropText=100,this.animatedExpansionParentWidth=250,this.maxParentWidthBeforeAutoCollapse=50,this.longEventMinWidth=750,this.eventBoxBorder=0,this.eventBoxPaddingLeft=7,this.eventBoxPaddingRight=0,this.eventBoxPaddingTop=4,this.eventBoxPaddingBottom=4,this.eventMarkerCornerRadius=5,this.eventMarkerSvgNormalExtraWidth=3,this.eventMarkerSvgNormalExtraHeight=3,this.eventMarkerSvgParentExtraWidth=9,this.eventMarkerSvgParentExtraHeight=9,this.eventMarkerMarginRight=4,this.eventMarkerMarginTop=3,this.eventMarkerMarginBottom=2,this.eventMarkerShowMoreMarginLeft=10,this.eventMarkerShowMoreWidth=15,this.eventMarkerShowMoreHeight=18,this.eventParentExpandWidth=9,this.eventParentExpandHeight=10,this.eventParentExpandSpanOffsetFromRight=15,this.eventTextWrapSafetyBuffer=8,this.eventMarkerOffsetFromBoundsTop=this.eventBoxBorder+this.eventBoxPaddingTop+this.eventMarkerMarginTop,this.eventMarkerOffsetFromBoundsLeft=this.eventBoxBorder+this.eventBoxPaddingLeft,this.eventBoxUnderneathWidthAdjust=this.eventBoxBorder+0+this.eventBoxPaddingRight+this.eventBoxBorder,this.eventBoxUnderneathHeightAdjust=this.eventBoxBorder+this.eventMarkerMarginTop+0+this.eventMarkerMarginBottom+0+this.eventBoxBorder,this.eventBoxSideBySideWidthAdjust=this.eventBoxBorder+0+this.eventMarkerMarginRight+0+this.eventMarkerShowMoreMarginLeft+this.eventMarkerShowMoreWidth+this.eventBoxPaddingRight+this.eventBoxBorder,this.eventBoxSideBySideHeightAdjust=this.eventBoxBorder+0+this.eventBoxBorder,this.eventOffsetFromTopOfLane=this.lifetimeHeight+4,this.eventOffsetFromTopOfCollapsedLane=this.collapsedLaneHeight/2-this.eventMarkerCornerRadius-this.eventMarkerOffsetFromBoundsTop,this.eventXOffsetFromPreviousEvent=2*this.eventBoxPaddingLeft,this.eventYOffsetFromPreviousEvent=12,this.eventYOffsetFromPreviousParentEvent=12,this.eventYOffsetFromOwnParentEvent=12,this.eventChildRectPaddingLeft=10,this.eventChildRectPaddingRight=5,this.eventChildRectPaddingBottom=10,this.eventOptimiseFurthestOffscreen=-1e3,this.eventOptimiseMaxPolygonWidth=1e4,this.dependencyHookRadius=10,this.mainTickLineHeight=25,this.mainTickTextOffsetY=20,this.subTickCircleOffsetY=this.timeHeaderHeight-7,this.subTickCircleRadius=1.5,this.subTickTextOffsetY=this.timeHeaderHeight-14,this.laneLabelOffsetX=25,this.lifetimeLabelOffsetX=5,this.lifetimeLeftMargin=120,this.lifetimeLeftMarginToText=10,this.lifetimeLabelMinGap=42,this.contextBarEventRectHeight=18,this.contextBarLabelRectHeight=this.contextHeight-this.contextBarEventRectHeight,this.contextLensImageHeight=this.contextHeight,this.contextLensImageArrowWidth=Math.round(30*this.contextHeight/79),this.contextLensImageMiddleWidth=Math.round(234*this.contextHeight/79),this.contextLensRootFolder="skins/",this.contextLensImageLeftArrowHref="lens-left-arrow.png",this.contextLensImageRightArrowHref="lens-right-arrow.png",this.contextLensImageMiddleHref="lens-middle.png",this.contextDotRadius=5,this.contextDotOffsetY=5,this.contextBarLabelOffsetX=4,this.contextBarLabelOffsetY=28,this.contextLensResizeGrabWidth=10,this.contextLensDragMinGap=2*this.contextLensImageArrowWidth,this.laneNavNodeWidth=10,this.scrollTrackThickness=16,this.scrollTrackTopMargin=1,this.scrollTrackNoLaneNavThickness=16,this.scrollTrackDefaultThickness=28,this.scrollKnobThickness=10,this.scrollKnobXPosition=0,this.scrollKnobDefaultXPosition=3,this.scrollKnobNoLaneNavXPosition=14,this.scrollKnobOpacity=.6,this.scrollKnobFadeOpacity=.6,this.scrollTrackOpacity=1,this.bookmarksBarHeight=22,this.bookmarksRectHeight=18,this.bookmarksRectOffsetY=2,this.relationshipViewEventVerticalPadding=10,this.relationshipViewParentIndent=15,this.relationshipViewEventAreaWidth=520+3*this.relationshipViewParentIndent,this.relationshipViewGroupHeaderHeight=23,this.relationshipViewEntityHeaderHeight=120,this.relationshipViewEntityColumnSpacing=40,this.relationshipViewEntityGroupSpacing=80,this.relationshipViewDateOffsetLeft=5,this.relationshipViewDateOffsetDefaultWidth=80,this.relationshipViewDateOffsetHideWidth=10,this.relationshipViewDateOffsetWidth=this.relationshipViewDateOffsetDefaultWidth,this.relationshipViewEventDotWidth=16,this.relationshipViewEventTextXOffset=this.relationshipViewEventDotWidth+10,this.relationshipViewVerticalSpacing=10,this.relationshipViewDateOffsetLineX=this.relationshipViewDateOffsetWidth-5,this.relationshipViewDateEventLeftLineXOffset=8,this.relationshipViewDateEventLeftLineWidth=this.eventBoxPaddingLeft+5,this.relationshipViewDateEventLeftLineWidthFlattenedTree=12,this.relationshipViewDateEventLeftLineWidthNoChildren=30,this.relationshipViewDateEventLeftLineWidthParent=16,this.relationshipViewDateEventLeftLineWidthLastChildAddition=15,this.relationshipViewDateOffsetLineOffsetFromNodeTop=this.relationshipViewEventVerticalPadding+this.relationshipViewEventDotWidth/2+1,this.relationshipViewEntityOffsetFromLeft=this.relationshipViewEventAreaWidth+this.relationshipViewDateOffsetWidth,this.relationshipNavFooterHeight=this.contextHeight+this.scrollTrackNoLaneNavThickness,this.snapDragMinDist=5,this.snapDragLineLength=100,this.contextLensWidth=120,this.contextLensMinMargin=20,this.minimumParentWidthToShow=400,this.alwaysExpandDurationTS=10,this.touchEventMinimumHoldTimeBeforeMove=300}var TimelineDisplayConstants=new MakeTimelineDisplayConstants;module.exports=TimelineDisplayConstants;
},{}],27:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/displaySettingsTemplate.html"),displaySettingsImageHtml=require("./templates/displaySettingsImage.html"),displaySettingsTagListHtml=require("./templates/displaySettingsTagList.html"),displaySettingsLinkListHtml=require("./templates/displaySettingsLinkList.html"),displaySettingsPropertyBooleanHtml=require("./templates/displaySettingsPropertyBoolean.html"),displaySettingsPropertyNumberHtml=require("./templates/displaySettingsPropertyNumber.html"),displaySettingsPropertyParagraphHtml=require("./templates/displaySettingsPropertyParagraph.html"),displaySettingsPropertyPercentageHtml=require("./templates/displaySettingsPropertyPercentage.html"),displaySettingsPropertyStringHtml=require("./templates/displaySettingsPropertyString.html"),displaySettingsRoleListHtml=require("./templates/displaySettingsRoleList.html"),ATDisplaySettingsView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=this,i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),$("#displaySettingsShowIds").on("change",this.showIdsChanged.bind(this)),$("#displaySettingsShowDates").on("change",this.showDatesChanged.bind(this)),$("#displaySettingsShowDependencies").on("change",this.showDependenciesChanged.bind(this)),$("#displaySettingsShowToday").on("change",this.showTodayChanged.bind(this)),$("#displaySettingsExpandAll").on("change",this.expandAllChanged.bind(this)),this.skinDropdown=new ATDropdown({el:"#displaySettingsSkin"}),this.listenTo(this.skinDropdown,"change",this.skinChanged.bind(this)),this.sizeDropdown=new ATDropdown({el:"#displaySettingsSize"}),this.listenTo(this.sizeDropdown,"change",this.sizeChanged.bind(this)),this.scrollDropdown=new ATDropdown({el:"#displaySettingsScrollingBounds"}),this.listenTo(this.scrollDropdown,"change",this.scrollChanged.bind(this)),this.layoutDropdown=new ATDropdown({el:"#displaySettingsLayout"}),this.listenTo(this.layoutDropdown,"change",this.layoutChanged.bind(this)),this.$leftColumn=$("#leftDisplayColumn"),this.$rightColumn=$("#rightDisplayColumn"),this.$leftDropTarget=$("#leftAddDropTarget"),this.$rightDropTarget=$("#rightAddDropTarget"),this.$availableGroup=$("#availableGroup"),this.$leftDropTarget.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("drop",function(t){return e.drop(t.originalEvent,e.$leftDropTarget)}),this.$rightDropTarget.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("drop",function(t){return e.drop(t.originalEvent,e.$rightDropTarget)}),this.$availableGroup.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("drop",function(t){return e.drop(t.originalEvent,e.$availableGroup)}),$("#displaySettingsForm").on("submit",this.okClickHandler.bind(this)),$("#displaySettingsApply").on("click",this.applyClickHandler.bind(this)),$("#displaySettingsCancel").on("click",this.cancelClickHandler.bind(this)),this.draggedItem=null},setDisplayTemplateSettings:function(t){this.displaySettings=t,this.buildDisplayItems(),this.render()},buildDisplayItems:function(){var t=this.model.get("template"),e=t.properties,i=t.types,n=this.displaySettings.moreInfoLeftColumn,s=this.displaySettings.moreInfoRightColumn,a=/LABEL/g,r=/TYPE/g;this.displayItems=[],this.displayItems.push({name:"Image",type:"image",optionId:-1,show:!0,innerHtml:displaySettingsImageHtml}),this.displayItems.push({name:"Tags",type:"tags",optionId:-1,show:!0,innerHtml:displaySettingsTagListHtml}),this.displayItems.push({name:"Links",type:"links",optionId:-1,show:!0,innerHtml:displaySettingsLinkListHtml}),_.each(e,function(t){var e;e="percentage"==t.type?displaySettingsPropertyPercentageHtml:"multitext"==t.type||"richtext"==t.type?displaySettingsPropertyParagraphHtml:"number"==t.type||"currency"==t.type||"decimal"==t.type?displaySettingsPropertyNumberHtml:"boolean"==t.type?displaySettingsPropertyBooleanHtml:displaySettingsPropertyStringHtml,e=e.replace(a,t.name),this.displayItems.push({name:t.name,type:t.type,optionId:t.id,show:!0,innerHtml:e})},this),_.each(i,function(t){_.each(t.roles,function(e){var i=displaySettingsRoleListHtml.replace(a,e.name);i=i.replace(r,t.name),this.displayItems.push({name:e.name,type:"role",optionId:e.id,show:!0,innerHtml:i})},this)},this),this.leftColItems=[],this.rightColItems=[],_.each(n,function(t){var e=_.find(this.displayItems,function(e){return t.name===e.name},this);e&&this.leftColItems.push(e)},this),_.each(s,function(t){var e=_.find(this.displayItems,function(e){return t.name===e.name},this);e&&this.rightColItems.push(e)},this),this.remainderItems=this.displayItems,this.remainderItems=_.difference(this.remainderItems,this.leftColItems),this.remainderItems=_.difference(this.remainderItems,this.rightColItems)},render:function(){var t,e,i=this,n=d3.select("#leftDisplayColumn").selectAll(".displayItem").data(this.leftColItems),s=d3.select("#rightDisplayColumn").selectAll(".displayItem").data(this.rightColItems),a=d3.select("#available").selectAll(".item").data(this.remainderItems),r=this.displaySettings.skin?this.displaySettings.skin:"dark",o=this.displaySettings.size?this.displaySettings.size:"100",l=this.displaySettings.scrollingBehaviour?this.displaySettings.scrollingBehaviour:"bounce",d=this.displaySettings.layout?this.displaySettings.layout:"cascade";this.formSubmitted=!1,this.skinDropdown.setValue(r),this.sizeDropdown.setValue(o),this.scrollDropdown.setValue(l),this.layoutDropdown.setValue(d),d3.select("#displaySettingsShowIds").attr("checked",this.displaySettings.showEventId?"checked":null),d3.select("#displaySettingsShowDates").attr("checked",this.displaySettings.showEventDate?"checked":null),n.select(".displayItemContent").html(function(t){return t.innerHtml}),n.select(".removeButton").on("click",function(t){i.removeDisplayItem(t)}),t=n.enter().append("div").classed("displayItem draggableClass",!0).attr("draggable","true").on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}).on("dragover",function(t){return i.dragOver(d3.event,$(this))}).on("dragenter",function(t){return i.dragEnter(d3.event,$(this))}).on("dragleave",function(t){return i.dragLeave(d3.event,$(this))}).on("drop",function(t){return i.drop(d3.event,$(this),t)}),t.append("div").classed("displayItemContent",!0).style("pointer-events","none").html(function(t){return t.innerHtml}),t.append("div").classed("removeButton",!0).on("click",function(t){i.removeDisplayItem(t)}).append("span").classed("fa fa-times-circle",!0),n.exit().remove(),s.select(".displayItemContent").html(function(t){return t.innerHtml}),s.select(".removeButton").on("click",function(t){i.removeDisplayItem(t)}),e=s.enter().append("div").classed("displayItem draggableClass",!0).attr("draggable","true").on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}).on("dragover",function(t){return i.dragOver(d3.event,$(this))}).on("dragenter",function(t){return i.dragEnter(d3.event,$(this))}).on("dragleave",function(t){return i.dragLeave(d3.event,$(this))}).on("drop",function(t){return i.drop(d3.event,$(this),t)}),e.append("div").classed("displayItemContent",!0).style("pointer-events","none").html(function(t){return t.innerHtml}),e.append("div").classed("removeButton",!0).on("click",this.removeDisplayItem.bind(this)).append("span").classed("fa fa-times-circle",!0),s.exit().remove(),a.text(function(t){return t.name}),a.enter().append("div").classed("item draggableClass",!0).attr("draggable","true").text(function(t){return t.name}).on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}),a.exit().remove()},dragStart:function(t,e){var i=d3.event;i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("text",t.name),i.dataTransfer.setDragImage(e[0],5,5),this.draggedItem=t},dragEnd:function(t){d3.event;this.draggedItem=null},dragOver:function(t,e){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",e==this.$availableGroup&&e.addClass("over"),!1},dragEnter:function(t,e){e.addClass("over")},dragLeave:function(t,e){e.removeClass("over")},drop:function(t,e,i){var n=_.indexOf(this.leftColItems,this.draggedItem),s=_.indexOf(this.rightColItems,this.draggedItem),a=_.indexOf(this.leftColItems,i),r=_.indexOf(this.rightColItems,i);return t.stopPropagation&&t.stopPropagation(),e.removeClass&&e.removeClass("over"),-1!=n&&(this.displaySettings.moreInfoLeftColumn=_.reject(this.displaySettings.moreInfoLeftColumn,function(t){var e=t.name==this.draggedItem.name;return e},this)),-1!=s&&(this.displaySettings.moreInfoRightColumn=_.reject(this.displaySettings.moreInfoRightColumn,function(t){return t.name==this.draggedItem.name},this)),i?-1!=a?this.displaySettings.moreInfoLeftColumn.splice(a,0,this.draggedItem):-1!=r&&this.displaySettings.moreInfoRightColumn.splice(r,0,this.draggedItem):e==this.$leftDropTarget?this.displaySettings.moreInfoLeftColumn.push(this.draggedItem):e==this.$rightDropTarget&&this.displaySettings.moreInfoRightColumn.push(this.draggedItem),this.buildDisplayItems(),this.render(),t.preventDefault(),!1},removeDisplayItem:function(t){this.displaySettings.moreInfoLeftColumn=_.reject(this.displaySettings.moreInfoLeftColumn,function(e){return e.name==t.name},this),this.displaySettings.moreInfoRightColumn=_.reject(this.displaySettings.moreInfoRightColumn,function(e){return e.name==t.name},this),this.buildDisplayItems(),this.render()},showIdsChanged:function(){this.displaySettings.showEventId=$("#displaySettingsShowIds").prop("checked")},showDatesChanged:function(){this.displaySettings.showEventDate=$("#displaySettingsShowDates").prop("checked")},showDependenciesChanged:function(){this.displaySettings.showDependencies=$("#displaySettingsShowDependencies").prop("checked")},showTodayChanged:function(){this.displaySettings.showTodayLine=$("#displaySettingsShowToday").prop("checked")},expandAllChanged:function(){this.displaySettings.parmenentExpandEvents=$("#displaySettingsExpandAll").prop("checked")},skinChanged:function(){this.displaySettings.skin=this.skinDropdown.getValue()},sizeChanged:function(){this.displaySettings.size=parseInt(this.sizeDropdown.getValue())},scrollChanged:function(){this.displaySettings.scrollingBehaviour=this.scrollDropdown.getValue()},layoutChanged:function(){this.displaySettings.layout=this.layoutDropdown.getValue()},okClickHandler:function(t){return this.formSubmitted===!0?(window.mainApp.removeExistingModal(),t.preventDefault(),!1):(this.formSubmitted=!0,window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),window.mainApp.removeExistingModal(),t.preventDefault(),!1)},applyClickHandler:function(t){return window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),t.preventDefault(),!1},cancelClickHandler:function(t){return window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATDisplaySettingsView;
},{"./ATDropdown":29,"./ATUtilities":91,"./templates/displaySettingsImage.html":103,"./templates/displaySettingsLinkList.html":104,"./templates/displaySettingsPropertyBoolean.html":105,"./templates/displaySettingsPropertyNumber.html":106,"./templates/displaySettingsPropertyParagraph.html":107,"./templates/displaySettingsPropertyPercentage.html":108,"./templates/displaySettingsPropertyString.html":109,"./templates/displaySettingsRoleList.html":110,"./templates/displaySettingsTagList.html":111,"./templates/displaySettingsTemplate.html":112,"backbone":176,"d3":300,"jquery":307,"lodash":309}],28:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/dropdownTemplate.html"),ATDropdown=Backbone.View.extend({setOptions:function(t){this.visibleOptions=t,this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},selectFirst:function(){this.selectedOption=this.visibleOptions.length>0?this.visibleOptions[0]:null,this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},setValue:function(t){var i=t&&t.replace?t.replace(/\s/g,"_-_"):t;this.selectedOption=_.find(this.visibleOptions,function(t){return t.value==i},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},getValue:function(){if(this.selectedOption){var t=this.selectedOption.value;return t&&t.replace&&(t=t.replace(/\_\-\_/g," ")),t}return null},getText:function(){return this.selectedOption?this.selectedOption.name:null},initialize:function(){var t=this.$el.attr("id"),i=t+"-label",e=t+"-caret",s=t+"-dropdown",n=t+"-list",l=_.template(templateHtml),h=this;if(this.visibleOptions=[],this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.d3El=d3.select("#"+t),"SELECT"===this.$el.prop("nodeName")){var o,d=this.d3El.selectAll("option");d.each(function(){var t=$(this),i=t.text(),e=t.prop("value"),s=t.is(":selected");e||(e=i),e=e.replace(/\s/g,"_-_"),h.visibleOptions.push({name:i,value:e}),s&&(h.selectedOption=h.visibleOptions[h.visibleOptions.length-1])}),o=this.$el.prop("class"),this.$el.replaceWith('<div id="'+t+'"></div>'),this.$el=$("#"+t),this.d3El=d3.select("#"+t),this.$el.prop("class",o)}this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(l({})),this.$el.keydown(function(t){return h.keyDownHandler(t)}),this.$el.on("blur",function(){return h.blurHandler()}),this.d3El.on("click",function(){h.open||h.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",i).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",e).on("click",this.toggle.bind(this)),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",s),this.$dropdown=$("#"+s),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",n),this.$list=$("#"+n),this.updateTitle(),this.selectedOption&&this.setValue(this.selectedOption.value)},toggle:function(t){this.disabled||this.open?this.hide():(this.show(),this.$el.focus()),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id"),i=t+"-list";this.selectedOption?i+"-"+this.selectedOption.value:null;this.disabled||(this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.d3El.classed("open",!0),this.$dropdown.slideDown(250),this.renderOptions(),this.scrollItemIntoView(),this.open=!0)},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id"),s=e+"-list";i.attr("id",function(t){return s+"-"+t.value}).classed("active",function(i){return t.selectedOption?i.name==t.selectedOption.name:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).select("span").text(function(t){return t.name});i.enter().append("li").attr("id",function(t){return s+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return t.selectedOption?i.name==t.selectedOption.name:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}).append("span").text(function(t){return t.name}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)});i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=t+"-list",e=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,s=e?i+"-"+e.value:null,n=null;if(s){n=$("#"+s);var l=this.$list.scrollTop(),h=this.$list.height(),o=n.position()?n.position().top:0,d=n.height();(0>o||o+d>h)&&this.$list.scrollTop(l+o-h/2+d/2)}},updateTitle:function(){this.selectedOption?this.d3Label.text(this.selectedOption.name):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){return this.selectedOption=_.find(this.visibleOptions,function(i){return i.name==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change"),!1},keyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;switch(i){case 9:this.open&&(this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide());break;case 13:this.open?this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide():this.$el.closest("form").submit(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);break;case 38:this.open?(-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0):this.show();break;case 40:this.open?(-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0):this.show()}return this.renderOptions(),!e},focusHandler:function(){},blurHandler:function(){this.hide()}});module.exports=ATDropdown;
},{"./templates/dropdownTemplate.html":113,"backbone":176,"d3":300,"jquery":307,"lodash":309}],29:[function(require,module,exports){
arguments[4][28][0].apply(exports,arguments)
},{"./templates/dropdownTemplate.html":113,"backbone":176,"d3":300,"dup":28,"jquery":307,"lodash":309}],30:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),bootstrap=require("bootstrap"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=require("./ATTimeSpan"),ATDurationPicker=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this;this.value=null,this.allowCompletion=!0,this.continuousChangeCallback=null,this.changeCallback=null,this.hasChanged=!1,this.$el.blurOnEnter(),this.d3El=d3.select("#"+e).on("input",function(){t.inputHandler()}).on("blur",function(){t.blurHandler()}).on("keydown",function(){t.keyDownHandler()})},setChangeCallback:function(e){this.changeCallback=e,this.recordedManagerCallback=null},setContinuousChangeCallback:function(e){this.continuousChangeCallback=e},setManagerCallback:function(e){this.managerCallback=e},setRangeConversion:function(e){this.rangeConversion=e},setDurationComponents:function(e){this.rangeConversion&&("date"==this.rangeConversion.type?e.length>0?(this.value=ATTimeSpan.FromComponents(e),this.$el.val(this.rangeConversion.stringFromSpanValue(this.value))):this.disabled||(this.value=null,this.$el.val("")):(this.value=e.length>0?e[0].value:0,e.length>0?this.$el.val(""+this.value):this.$el.val("0")),this.hasChanged=!1)},setValue:function(e){this.value=e,"date"==this.rangeConversion.type?this.value.years||this.value.months||this.value.weeks||this.value.days||this.value.hours||this.value.minutes||this.value.seconds?this.$el.val(this.rangeConversion.stringFromSpanValue(this.value)):this.$el.val(""):this.$el.val(this.rangeConversion.stringFromSpanValue(this.value)),this.hasChanged=!1},setText:function(e){this.$el.val(e),this.allowCompletion=!1,this.inputHandler()},text:function(){return this.$el.val()},getValue:function(){return this.value},getPrecision:function(){return"date"===this.rangeConversion.type&&this.value?0!=this.value.seconds?ATTimeUnit.SECOND:0!=this.value.minutes?ATTimeUnit.MINUTE:0!=this.value.hours?ATTimeUnit.HOUR:0!=this.value.days?ATTimeUnit.DAY:0!=this.value.weeks?ATTimeUnit.WEEK:0!=this.value.months?ATTimeUnit.MONTH:ATTimeUnit.YEAR:0},focusCursor:function(){var e=this.$el.val().length;this.$el.focus(),this.$el[0].setSelectionRange(e,e)},setDisabled:function(e){this.disabled=e,this.$el.prop("disabled",e),this.$el.blur(),!e||"0"!=this.getValue()&&"0 seconds"!=this.getValue()||this.$el.val("")},keyDownHandler:function(){var e=d3.event.keyCode||d3.event.which,t=!1,a=this.$el.val(),n=this.$el.get(0).selectionStart,i=this.$el.get(0).selectionEnd;switch(this.allowCompletion=!0,e){case 9:0==n&&i==a.length||i-n>0&&(this.$el.get(0).setSelectionRange(i,i),t=!0);break;case 8:case 46:this.allowCompletion=!1}this.continuousChangeCallback&&this.continuousChangeCallback(),t&&(d3.event.preventDefault(),d3.event.sourceEvent&&d3.event.sourceEvent.preventDefault())},inputHandler:function(){var e,t=this.$el.val(),a=this.$el.get(0).selectionStart;e=this.rangeConversion.spanValueForPartialString(t,a,this.allowCompletion),selection=e.selection,this.value=e.value,this.allowCompletion&&(this.$el.val(e.string),this.$el.get(0).setSelectionRange(selection.location,selection.location+selection.length)),this.recordedInputValue=this.$el.val(),this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.allowCompletion=!0,this.hasChanged=!0,this.continuousChangeCallback&&this.continuousChangeCallback()},blurHandler:function(){this.$el.val(),this.$el.get(0).selectionStart;"date"==this.rangeConversion.type?(this.recordedChangeCallback&&this.recordedInputValue&&this.recordedChangeCallback(this.recordedInputValue),this.recordedManagerCallback&&this.recordedInputValue&&this.recordedManagerCallback(this.recordedInputValue)):(this.recordedChangeCallback&&!isNaN(this.recordedInputValue)&&this.recordedChangeCallback(this.recordedInputValue),this.recordedManagerCallback&&!isNaN(this.recordedInputValue)&&this.recordedManagerCallback(this.recordedInputValue),this.$el.val().length||this.$el.val("0")),this.recordedInputValue=null,this.recordedChangeCallback=null,this.recordedManagerCallback=null},commit:function(){this.recordedInputValue&&this.recordedChangeCallback&&this.blurHandler()}});module.exports=ATDurationPicker;
},{"./ATTimeSpan":84,"./ATTimeUnit":85,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],31:[function(require,module,exports){
function moveWithinArray(e,t,i){e.splice(i,0,e.splice(t,1)[0])}var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),templateHtml=require("./templates/editCalendarTemplate.html"),masterListHtml=require("./templates/masterList.html"),optionsHtml=require("./templates/optionsTemplate.html"),editEraHtml=require("./templates/editEraPageTemplate.html"),editMonthHtml=require("./templates/editMonthPageTemplate.html"),editWeekdayHtml=require("./templates/editWeekdaysPageTemplate.html"),ATEditCalendarView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.optionsTemplate=_.template(optionsHtml),this.masterListTemplate=_.template(masterListHtml),this.selectedItem=null,this.displayGroups=[],this.displayGroups.push({type:"Eras",icon:"fa-calendar-o",items:[],typeName:"Era"}),this.displayGroups.push({type:"Months",icon:"fa-calendar-o",items:[],typeName:"Month"}),this.displayGroups.push({type:"Weekdays",icon:"fa-calendar-o",items:[],typeName:"Weekday"}),this.d3MasterList=this.d3El.select(".masterViewList"),this.$detailView=$("#editCalendarDetailView"),$("#editCalendarRemoveButton").on("click",this.removeSelectedItem.bind(this)),$("#editCalendarMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#editCalendarMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),$("#editCalendarForm").on("submit",this.okClickHandler.bind(this)),$("#editCalendarCancel").on("click",this.cancelClickHandler.bind(this)),this.grabInitialCalendar()},grabInitialCalendar:function(){this.localTimelineCalendar=JSON.parse(JSON.stringify(this.model)),this.renderMasterList()},setCompletionCallback:function(e){this.completionCallback=e},renderMasterList:function(){var e=this,t=this.localTimelineCalendar.eras,i=this.localTimelineCalendar.months,a=this.localTimelineCalendar.weekdays,s=this.selectedItem;console.log("renderMasterList... before iteration, printing newSelection"),console.dir(s),s&&(_.each(t,function(e){e.name==s.name&&(s=e)}),_.each(i,function(e){e.name==s.name&&(s=e)}),_.each(a,function(e){e.name==s.name&&(s=e)})),console.log("renderMasterList... after iteration, printing newSelection, this.displayGroups, this.localTimelineCalendar"),console.dir(s),console.dir(this.displayGroups),console.dir(this.localTimelineCalendar);var n,r,l,d,h,o;this.displayGroups[0].items=t,this.displayGroups[1].items=i,this.displayGroups[2].items=a,console.log("renderMasterList... after new displayGroups creation, printing newSelection, this.displayGroups, this.localTimelineCalendar"),console.dir(s),console.dir(this.displayGroups),console.dir(this.localTimelineCalendar),n=this.d3MasterList.selectAll(".group").data(this.displayGroups,function(e){return e.type}),d=n.select("ul"),h=d.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==s}),h.select("span").html(function(e){return e.name}),h.select("i").style("color",function(e){return e.color}),o=h.enter().append("li").classed("selected",function(e){return e==s}).on("click",function(t){return e.clickOnListItem(d3.select(this),t)}),o.append("i").attr("class",function(t,i,a){return"fa "+e.displayGroups[a].icon}).style("color",function(e){return e.color}),o.append("span").html(function(e){return e.name}),h.exit().remove(),r=n.enter().append("div").classed("group",!0),l=r.append("div").classed("groupHeading",!0).on("click",function(t){e.clickOnGroupHeading(d3.select(this.parentNode),t)}),l.append("span").html(function(e){return e.type}),l.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)),d=r.append("ul").style("max-height","0px"),h=d.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==s}),o=h.enter().append("li").classed("selected",function(e){return e==s}).on("click",function(t){return e.clickOnListItem(d3.select(this),t)}),o.append("i").attr("class",function(t,i,a){return"fa "+e.displayGroups[a].icon}).style("color",function(e){return e.color}),o.append("span").html(function(e){return e.name}),n.exit().remove(),this.selectedItem=s,this.updateDetailFields(),this.animateExpansion()},clickOnGroupHeading:function(e,t){this.expandedGroupName==t.type?(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null):(this.expandedGroup=t,this.expandedGroupName=t.type,this.selectedItem=t.items.length?t.items[0]:null,console.log("clickOnGroupHeading... Printing this.expandedGroup, this.selectedItem, this.localTimelineCalendar"),console.dir(this.expandedGroup),console.dir(this.selectedItem),console.dir(this.localTimelineCalendar)),this.expandedGroupName?this.d3El.select(".masterViewControls").style("display",null):this.d3El.select(".masterViewControls").style("display","none"),this.renderMasterList()},updateDetailFields:function(){"Eras"==this.expandedGroupName?this.updateEraDetailFields():"Months"==this.expandedGroupName?this.updateMonthDetailFields():"Weekdays"==this.expandedGroupName?this.updateWeekdayDetailFields():this.removeDetailFields()},removeDetailFields:function(){this.$detailView.html("")},updateEraDetailFields:function(){this.$detailView.html(editEraHtml),this.$nameInput=$("#editEraName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editEraShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editEraDuration=$("#editEraDuration"),this.$editEraDuration.on("change",this.editEraDurationChanged.bind(this)),this.$editEraBackwards=$("#editEraBackwards"),this.$editEraBackwards.on("change",this.editEraBackwardsChanged.bind(this)),this.$editEraLeapYear=$("#editEraLeapYear"),this.$editEraLeapYear.on("change",this.editEraLeapYearChanged.bind(this)),this.selectedItem?(this.selectedItem.name==this.localTimelineCalendar.eras[0].name||this.selectedItem.name==this.localTimelineCalendar.eras[this.localTimelineCalendar.eras.length-1].name?(this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editEraDuration.prop("disabled",!0),this.$editEraBackwards.prop("disabled",!0),this.$editEraLeapYear.prop("disabled",!1)):(this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editEraDuration.prop("disabled",!1),this.$editEraBackwards.prop("disabled",!1),this.$editEraLeapYear.prop("disabled",!1)),this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editEraDuration.val(this.selectedItem.duration),this.$editEraBackwards.prop("checked",this.selectedItem.isBackwards),this.$editEraLeapYear.prop("checked",this.selectedItem.hasLeap)):(this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editEraDuration.val(""),this.$editEraBackwards.prop("checked",!1),this.$editEraLeapYear.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editEraDuration.prop("disabled",!0),this.$editEraBackwards.prop("disabled",!0),this.$editEraLeapYear.prop("disabled",!0))},updateMonthDetailFields:function(){this.$detailView.html(editMonthHtml),this.$nameInput=$("#editMonthName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editMonthShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editMonthRegularYearDuration=$("#editMonthRegularYearDuration"),this.$editMonthRegularYearDuration.on("change",this.editMonthRegularYearDurationChanged.bind(this)),this.$editMonthLeapYearDuration=$("#editMonthLeapYearDuration"),this.$editMonthLeapYearDuration.on("change",this.editMonthLeapYearDurationChanged.bind(this)),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editMonthRegularYearDuration.val(this.selectedItem.normalDuration),this.$editMonthLeapYearDuration.val(this.selectedItem.leapDuration),this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editMonthRegularYearDuration.prop("disabled",!1),this.$editMonthLeapYearDuration.prop("disabled",!1)):(this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editMonthRegularYearDuration.val(""),this.$editMonthLeapYearDuration.val(""),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editMonthRegularYearDuration.prop("disabled",!0),this.$editMonthLeapYearDuration.prop("disabled",!0))},updateWeekdayDetailFields:function(){if(this.$detailView.html(editWeekdayHtml),this.$nameInput=$("#editWeekdayName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editWeekdayShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editHoursInDay=$("#editHoursInDay"),this.$editHoursInDay.on("change",this.editHoursInDayChanged.bind(this)),this.$firstDayFinalEra=$("#firstDayFinalEra"),this.$firstDayFinalEra.on("change",this.firstDayFinalEraChanged.bind(this)),this.selectedItem){this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editHoursInDay.val(this.localTimelineCalendar.hoursInDay);var e=this.localTimelineCalendar.weekdayIndexAtZero;e>=0&&(this.localTimelineCalendar.weekdays[e].name==this.selectedItem.name?this.$firstDayFinalEra.prop("checked",!0):this.$firstDayFinalEra.prop("checked",!1)),this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editHoursInDay.prop("disabled",!1),this.$firstDayFinalEra.prop("disabled",!1)}else this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editHoursInDay.val(""),this.$firstDayFinalEra.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editHoursInDay.prop("disabled",!0),this.$firstDayFinalEra.prop("disabled",!0)},clickOnListItem:function(e,t){this.d3MasterList.selectAll("li").classed("selected",!1),e.classed("selected",!0),this.selectedItem=t,this.updateDetailFields()},addListItem:function(e){for(var t=this.expandedGroup.typeName,i=0;this.findItemWithName(t);)i++,t=this.expandedGroup.typeName+""+i;if("Eras"==this.expandedGroupName){this.localTimelineCalendar.eras.push({name:t,shortName:t,duration:1,isBackwards:!1,hasLeap:!1});var a=this.localTimelineCalendar.eras;moveWithinArray(a,this.localTimelineCalendar.eras.length-1,this.localTimelineCalendar.eras.length-2),this.selectedItem=this.localTimelineCalendar.eras[this.localTimelineCalendar.eras.length-2]}else"Months"==this.expandedGroupName?(this.localTimelineCalendar.months.push({name:t,shortName:t,normalDuration:31,leapDuration:31}),this.selectedItem=this.localTimelineCalendar.months[this.localTimelineCalendar.months.length-1]):"Weekdays"==this.expandedGroupName&&(this.localTimelineCalendar.weekdays.push({name:t,shortName:t}),this.selectedItem=this.localTimelineCalendar.weekdays[this.localTimelineCalendar.weekdays.length-1]);return this.renderMasterList(),d3.event.stopPropagation(),!1},removeSelectedItem:function(){var e,t=-1;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),1!=e.length&&(t=_.indexOf(e,this.selectedItem),-1!=t&&("Eras"!=this.expandedGroupName||0!=t&&t!=e.length-1)&&(e=_.without(e,this.selectedItem),"Eras"==this.expandedGroupName?this.localTimelineCalendar.eras=e:"Months"==this.expandedGroupName?this.localTimelineCalendar.months=e:"Weekdays"==this.expandedGroupName&&(this.localTimelineCalendar.weekdays=e),0==e.length?this.selectedItem=null:t>e.length?this.selectedItem=e[e.length-1]:this.selectedItem=e[t],this.renderMasterList()))},moveSelectedItemUp:function(){var e,t=0;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),_.each(e,function(e){e.index=t,t++}),"Eras"==this.expandedGroupName?this.selectedItem.index>0&&this.selectedItem.index<t-1&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index-1):this.selectedItem.index>0&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index-1),this.renderMasterList()},moveSelectedItemDown:function(){var e,t=0;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),_.each(e,function(e){e.index=t,t++}),"Eras"==this.expandedGroupName?this.selectedItem.index>0&&this.selectedItem.index<t-1&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index+1):this.selectedItem.index<t-1&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index+1),this.renderMasterList()},animateExpansion:function(){var e=this,t=this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedGroupName==t.type});t.select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedGroupName!=t.type?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedItem==t})},okClickHandler:function(e){return this.completionCallback&&this.completionCallback(this.localTimelineCalendar),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},cancelClickHandler:function(e){return window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},nameChanged:function(){var e=ATUtilities.regexStrippedString(this.$nameInput.val());if(this.selectedItem.name!=e){var t=this.findItemWithName(e);null==t?(this.selectedItem.name=e,console.log('ATEditCalendar.nameChanged. this.selectedItem.name set to "'+this.selectedItem.name+'"'),console.dir("printing this.selectedItem, this.displayGroups, this.localTimelineCalendar"),console.dir(this.selectedItem),console.dir(this.displayGroups),console.dir(this.localTimelineCalendar),this.$nameInput.val(e),this.renderMasterList()):this.$nameInput.val(this.selectedItem.name)}},shortNameChanged:function(){var e=ATUtilities.regexStrippedString(this.$shortNameInput.val());if(this.selectedItem.shortName!=e){var t=this.findItemWithShortName(e);null==t?(this.selectedItem.shortName=e,this.$shortNameInput.val(e),this.renderMasterList()):this.$shortNameInput.val(this.selectedItem.shortName)}},editEraDurationChanged:function(){this.selectedItem.duration=parseInt(this.$editEraDuration.val()),this.renderMasterList()},editEraBackwardsChanged:function(){this.selectedItem.isBackwards=this.$editEraBackwards.prop("checked"),this.renderMasterList()},editEraLeapYearChanged:function(){this.selectedItem.hasLeap=this.$editEraLeapYear.prop("checked"),this.renderMasterList()},editMonthRegularYearDurationChanged:function(){this.selectedItem.normalDuration=parseInt(this.$editMonthRegularYearDuration.val()),this.renderMasterList()},editMonthLeapYearDurationChanged:function(){this.selectedItem.leapDuration=parseInt(this.$editMonthLeapYearDuration.val()),this.renderMasterList()},editHoursInDayChanged:function(){this.localTimelineCalendar.hoursInDay=parseInt(this.$editHoursInDay.val()),this.renderMasterList()},firstDayFinalEraChanged:function(){var e=this.localTimelineCalendar.weekdays;this.selectedItem.name;if(1==this.$firstDayFinalEra.prop("checked")){var t=_.indexOf(e,this.selectedItem);this.localTimelineCalendar.weekdayIndexAtZero=t,this.renderMasterList()}},findItemWithName:function(e){var t=null,i=this.localTimelineCalendar,a=i.eras,s=i.months,n=i.weekdays;if(!e||0===e.length)return"The string entered is empty.";if(t=_.find(a,function(t){return t.name==e},this))return t;if(t=_.find(s,function(t){return t.name==e},this))return t;if(t=_.find(n,function(t){return t.name==e},this))return t;var r=new RegExp(/[\<\>\{\}\[\]]/);if(r.test(e))return"Invalid character detected";var r=new RegExp(/\b\d+\b/);return r.test(e)?"Names cannot have isolated numbers":null},findItemWithShortName:function(e){var t=null,i=this.localTimelineCalendar,a=i.eras,s=i.months,n=i.weekdays;if(!e||0===e.length)return"The string entered is empty.";if(t=_.find(a,function(t){return t.shortName==e},this))return t;if(t=_.find(s,function(t){return t.shortName==e},this))return t;if(t=_.find(n,function(t){return t.shortName==e},this))return t;var r=new RegExp(/[\<\>\{\}\[\]]/);if(r.test(e))return"Invalid character detected";var r=new RegExp(/\b\d+\b/);return r.test(e)?"Names cannot have isolated numbers":null}});module.exports=ATEditCalendarView;
},{"./ATUtilities":91,"./templates/editCalendarTemplate.html":114,"./templates/editEraPageTemplate.html":116,"./templates/editMonthPageTemplate.html":117,"./templates/editWeekdaysPageTemplate.html":123,"./templates/masterList.html":155,"./templates/optionsTemplate.html":158,"backbone":176,"d3":300,"jquery":307,"lodash":309}],32:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/editRoleListTemplate.html"),bootstrap=require("bootstrap"),ATEditRoleListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.d3El=d3.select("#"+this.elementName),this.useExternalLinkTemplate=!1,this.render([])},render:function(e){var t=this;this.d3El.html(this.elTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var i,a=this.elementName+"-item"+e.id;this.d3El.select(".remove-"+e.id).attr("id",a+"-remove").on("click",function(){t.removeClick(e.id)}),this.d3El.select(".edit-name-"+e.id).attr("id",a+"-edit-name").on("change",function(){t.nameChanged(e.id,$("#"+a+"-edit-name").val())}).on("input",function(){t.nameInput(e.id,$("#"+a+"-edit-name").val())}),this.d3El.select(".edit-multiple-"+e.id).attr("id",a+"-edit-multiple").on("change",function(){t.multipleChanged(e.id,$("#"+a+"-edit-multiple").prop("checked"))}),this.d3El.select(".edit-role-icon-"+e.id).attr("id",a+"-edit-role-icon"),i=$("#"+a+"-edit-role-icon"),i.iconpicker({iconset:"fontawesome",container:this.$el,searchText:"",icon:"fa-"+e.icon}),i.on("change",function(a){var n=a.icon.substr(3);i.iconpicker("closePicker"),t.iconChanged(e.id,n)})},this)},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setNameIsInvalid:function(e,t){var i="#"+this.elementName+"-item"+e+"-edit-name",a=$(i);a[0].setCustomValidity(t?"Error":"")},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setNameChangeCallback:function(e){this.nameChangeCallback=e},setIconChangeCallback:function(e){this.iconChangeCallback=e},setNameInputCallback:function(e){this.nameInputCallback=e},setMultipleChangeCallback:function(e){this.multipleChangeCallback=e},addClick:function(){this.addCallback&&this.addCallback()},removeClick:function(e){this.removeCallback&&this.removeCallback(e)},nameInput:function(e,t){this.nameInputCallback&&this.nameInputCallback(e,t)},nameChanged:function(e,t){this.nameChangeCallback&&this.nameChangeCallback(e,t)},multipleChanged:function(e,t){this.multipleChangeCallback&&this.multipleChangeCallback(e,t)},iconChanged:function(e,t){this.iconChangeCallback&&this.iconChangeCallback(e,t)}});module.exports=ATEditRoleListView;
},{"./templates/editRoleListTemplate.html":120,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],33:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),ATCalendar=require("./ATCalendar"),ATRangeConversion=require("./ATRangeConversion"),ATTimeSpan=require("./ATTimeSpan"),ATTimeUnit=require("./ATTimeUnit"),ATUtilities=require("./ATUtilities"),ATDropdown=require("./ATDropdown"),ATEditRoleListView=require("./ATEditRoleListView"),templateHtml=require("./templates/editTemplateTemplate.html"),masterListHtml=require("./templates/masterList.html"),optionsHtml=require("./templates/optionsTemplate.html"),editRangePropertyHtml=require("./templates/editRangePropertyPageTemplate.html"),editPropertyHtml=require("./templates/editPropertyPageTemplate.html"),editTypeHtml=require("./templates/editTypePageTemplate.html"),editColorHtml=require("./templates/editColorPageTemplate.html"),ATEditTemplateView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.allowEditCalendar=!0,this.BadWords=["Event","Entity","Tag","Color","Parent","Link","Any","None","All","Timeline"],this.rangeTypeConversion={date:"Date",numeric:"Numeric",hierarchy:"Hierarchy"},this.optionsTemplate=_.template(optionsHtml),this.masterListTemplate=_.template(masterListHtml),this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null,this.requireSelectAndFocus=!1,this.selectAndFocusName=null,this.displayGroups=[],this.displayGroups.push({type:"Range",icon:"flag",items:[],typeName:"Range"}),this.displayGroups.push({type:"Properties",icon:"tag",items:[],typeName:"Property"}),this.displayGroups.push({type:"Entity Types",icon:"user",items:[],typeName:"Entity Type"}),this.displayGroups.push({type:"Colors",icon:"square",items:[],typeName:"Color"}),this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.d3MasterList=this.d3El.select(".masterViewList"),this.$detailView=$("#editTemplateDetailView"),$("#editTemplateRemoveButton").on("click",this.removeSelectedItem.bind(this)),$("#editTemplateMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#editTemplateMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),$("#editTemplateForm").on("submit",this.okClickHandler.bind(this)),$("#editTemplateCancel").on("click",this.cancelClickHandler.bind(this)),$("#editTemplateSave").on("click",this.showEnterNameHandler.bind(this)),this.grabInitialTemplate(),this.updateDetailFields()},grabInitialTemplate:function(){var e,t,i,n,s=0;this.localTimelineTemplate=JSON.parse(JSON.stringify(this.model.get("template"))),t=this.localTimelineTemplate.rangeProperties[0].rangePropertyId,e=_.max(this.localTimelineTemplate.properties,function(e){return e.propertyId}).propertyId,i=_.max(this.localTimelineTemplate.types,function(e){return e.typeId}).typeId,n=_.max(this.localTimelineTemplate.colors,function(e){return e.colorId}).colorId,_.each(this.localTimelineTemplate.types,function(e){var t=_.max(e.roles,function(e){return e.roleId}).roleId;t>s&&(s=t)}),this.nextItemId=Math.max(t,e,i,n,s)+1,this.renderMasterList(),this.displayGroups.length&&(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null,this.clickOnGroupHeading(this.displayGroups[0]))},setAllowEditCalendar:function(e){this.allowEditCalendar=e,this.$editCalendar.attr("disabled",!this.allowEditCalendar)},renderMasterList:function(){var e=this,t=this.localTimelineTemplate,i=t.rangeProperties,n=t.properties,s=t.types,a=t.colors,l=this.selectedItem;l&&(_.each(i,function(e){e.name==l.name?l=e:this.requireSelectAndFocus&&e.name==this.selectAndFocusName&&(l=e)}),_.each(n,function(e){e.name==l.name?l=e:this.requireSelectAndFocus&&e.name==this.selectAndFocusName&&(l=e)}),_.each(s,function(e){e.name==l.name?l=e:this.requireSelectAndFocus&&e.name==this.selectAndFocusName&&(l=e)}),_.each(a,function(e){e.name==l.name?l=e:this.requireSelectAndFocus&&e.name==this.selectAndFocusName&&(l=e)}));var o,r,d,p,h,c;this.displayGroups[0].items=i,this.displayGroups[1].items=n,this.displayGroups[2].items=s,this.displayGroups[3].items=a,o=this.d3MasterList.selectAll(".group").data(this.displayGroups,function(e){return e.type}),p=o.select("ul"),h=p.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==l}),h.select("span").html(function(e){return e.name}),h.select("i").style("color",function(e){return e.color}).attr("class",function(t,i,n){return"fa fa-"+(t.icon?t.icon:e.displayGroups[n].icon)}),c=h.enter().append("li").classed("selected",function(e){return e==l}).on("click",function(t){return e.clickOnListItem(t)}),c.append("i").attr("class",function(t,i,n){return"fa fa-"+(t.icon?t.icon:e.displayGroups[n].icon)}).style("color",function(e){return e.color}),c.append("span").html(function(e){return e.name}),h.exit().remove(),r=o.enter().append("div").classed("group",!0),d=r.append("div").classed("groupHeading",!0).on("click",function(t){e.clickOnGroupHeading(t)}),d.append("span").html(function(e){return e.type}),d.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)).style("display",function(e,t){return 0==t?"none":null}),p=r.append("ul").style("max-height","0px"),h=p.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==l}),c=h.enter().append("li").classed("selected",function(e){return e==l}).on("click",function(t){return e.clickOnListItem(t)}),c.append("i").attr("class",function(t,i,n){return"fa fa-"+(t.icon?t.icon:e.displayGroups[n].icon)}).style("color",function(e){return e.color}),c.append("span").html(function(e){return e.name}),o.exit().remove(),this.selectedItem=l,this.updateDetailFields(),this.animateExpansion()},updateDetailFields:function(){"Range"==this.expandedGroupName?this.updateRangePropertyDetailFields():"Properties"==this.expandedGroupName?this.updatePropertyDetailFields():"Entity Types"==this.expandedGroupName?this.updateTypeDetailFields():"Colors"==this.expandedGroupName?this.updateColorDetailFields():this.removeDetailFields()},removeDetailFields:function(){this.$detailView.html("")},updateRangePropertyDetailFields:function(){var e=this;this.$detailView.html(editRangePropertyHtml),this.$nameInput=$("#editRangePropertyName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$typeDisplayDiv=$("#editRangePropertyType"),this.calendarTypeDropdown=new ATDropdown({el:"#editRangePropertyCalendarType"}),this.listenTo(this.calendarTypeDropdown,"change",this.calendarTypeChanged.bind(this)),this.dateMinZoomDropdown=new ATDropdown({el:"#editRangePropertyDateMinZoom"}),this.listenTo(this.dateMinZoomDropdown,"change",this.dateMinZoomChanged.bind(this)),this.dateMaxZoomDropdown=new ATDropdown({el:"#editRangePropertyDateMaxZoom"}),this.listenTo(this.dateMaxZoomDropdown,"change",this.dateMaxZoomChanged.bind(this)),this.$numericMinZoomInput=$("#editRangePropertyNumericMinZoom"),this.$numericMinZoomInput.on("change",this.numericMinZoomChanged.bind(this)),this.$numericMaxZoomInput=$("#editRangePropertyNumericMaxZoom"),this.$numericMaxZoomInput.on("change",this.numericMaxZoomChanged.bind(this)),this.$editCalendar=$("#editCalendarButton"),this.$editCalendar.attr("disabled",!this.allowEditCalendar),this.$editCalendar.on("click",this.showEditCalendarHandler.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$nameInput.prop("disabled",!1),this.$typeDisplayDiv.text(this.rangeTypeConversion[this.selectedItem.type]),this.updateRangeOptionsDisplay()):(this.$nameInput.val(""),this.$nameInput.prop("disabled",!0),this.$typeDisplayDiv.text(""),d3.select("#editRangePropertyDateOptions").style("display","none"),d3.select("#editRangePropertyNumericOptions").style("display","none")),this.setNameFieldIsInvalid(!1)},updatePropertyDetailFields:function(){var e=this;this.$detailView.html(editPropertyHtml),this.$nameInput=$("#editPropertyName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.typeDropdown=new ATDropdown({el:"#editPropertyType"}),this.listenTo(this.typeDropdown,"change",this.propertyTypeChanged.bind(this)),this.$calcFromChildren=$("#editPropertyCalculate"),this.$calcFromChildren.on("change",this.calcFromChildrenChanged.bind(this)),this.$fadeUsingProperty=$("#editPropertyFadeCheckbox"),this.$fadeUsingProperty.on("change",this.fadeUsingPropertyChanged.bind(this)),this.calcModeDropdown=new ATDropdown({el:"#editPropertyCalcMode"}),this.listenTo(this.calcModeDropdown,"change",this.calculationModeChanged.bind(this)),this.$fadeUsingPropertyDiv=$("#editPropertyFadeDiv"),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.typeDropdown.setValue(this.selectedItem.type),this.$nameInput.prop("disabled",!1),this.typeDropdown.setDisabled(!1),this.$calcFromChildren.prop("checked",this.selectedItem.calcFromChildren),"boolean"==this.selectedItem.type||"percentage"==this.selectedItem.type?(this.$fadeUsingProperty.prop("disabled",!1),this.$fadeUsingProperty.prop("checked",this.selectedItem.useForFadingEvents)):(this.$fadeUsingProperty.prop("checked",!1),this.$fadeUsingProperty.prop("disabled",!0))):(this.$nameInput.val(""),this.typeDropdown.setValue(null),this.$nameInput.prop("disabled",!0),this.typeDropdown.setDisabled(!0),this.$calcFromChildren.prop("checked",!1),this.$calcFromChildren.prop("disabled",!0),this.$fadeUsingProperty.prop("checked",!1),this.$fadeUsingProperty.prop("disabled",!0)),this.updatePropertyCalcModeOptions(),this.setNameFieldIsInvalid(!1)},updateTypeDetailFields:function(){var e=this,t=[];e.$iconButton&&e.$iconButton.iconpicker("closePicker"),this.$detailView.html(editTypeHtml),this.$nameInput=$("#editTypeName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$persistentInput=$("#editTypePersistent"),this.$persistentInput.on("change",this.typePersistenceChanged.bind(this)),this.$iconButton=$("#editTypeIcon"),this.roleListView=new ATEditRoleListView({el:"#editRangeRoles"}),this.roleListView.setAddCallback(this.addRoleClicked.bind(this)),this.roleListView.setNameInputCallback(this.editRoleNameInput.bind(this)),this.roleListView.setNameChangeCallback(this.editRoleNameChanged.bind(this)),this.roleListView.setIconChangeCallback(this.editRoleIconChanged.bind(this)),this.roleListView.setMultipleChangeCallback(this.editRoleMultipleChanged.bind(this)),this.roleListView.setRemoveCallback(this.removeRoleClicked.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$persistentInput.prop("checked",!this.selectedItem.persistent),this.$nameInput.prop("disabled",!1),this.$persistentInput.prop("disabled",!1),this.$iconButton.val("fa-"+this.selectedItem.icon),this.$iconButton.prop("disabled",!1),_.each(this.selectedItem.roles,function(e){t.push({id:e.roleId,title:e.name,multiplePerEvent:e.multiplePerEvent,icon:e.icon})},this),this.roleListView.render(t),this.roleListView.setDisabled(!1)):(this.$nameInput.val(""),this.$persistentInput.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$persistentInput.prop("disabled",!0),this.roleListView.setDisabled(!0),this.$iconButton.val(""),this.$iconButton.prop("disabled",!0)),this.$iconButton.iconpicker({iconset:"fontawesome",container:this.$el,searchText:"",icon:"fa-"+this.selectedItem.icon}),this.$iconButton.on("change",function(t){var i=t.icon.substr(3);e.$iconButton.iconpicker("closePicker"),e.iconChanged(i)}),this.setNameFieldIsInvalid(!1)},updateColorDetailFields:function(){var e=this,t=this.$el.attr("id");this.$detailView.html(editColorHtml),this.$nameInput=$("#editColorName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$colorInput=$("#editColorColor"),this.$colorInput.on("change",this.colorColorChanged.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$colorInput.val(this.selectedItem.color),this.$nameInput.prop("disabled",!1),this.$colorInput.prop("disabled",!1),this.$colorInput.spectrum({color:this.selectedItem.color,showInput:!0,showInitial:!1,allowEmpty:!1,showAlpha:!1,showPalette:!1,disabled:!1,showButtons:!1,preferredFormat:"hex",appendTo:"#"+t,change:this.colorColorChanged.bind(this)})):(this.$nameInput.val(""),this.$colorInput.val(""),this.$nameInput.prop("disabled",!0),this.$colorInput.prop("disabled",!0),this.$colorInput.spectrum({color:"#fff"})),this.setNameFieldIsInvalid(!1)},clickOnGroupHeading:function(e){this.expandedGroupName==e.type?(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null):(this.expandedGroup=e,this.expandedGroupName=e.type,this.selectedItem=e.items.length?e.items[0]:null),"Range"!=this.expandedGroupName&&this.expandedGroupName?this.d3El.select(".masterViewControls").style("display",null):this.d3El.select(".masterViewControls").style("display","none"),this.animateExpansion(),this.updateDetailFields()},animateExpansion:function(){var e=this,t=this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedGroupName==t.type});t.select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedGroupName!=t.type?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedItem==t})},clickOnListItem:function(e){var t=this;this.selectedItem=e,this.d3MasterList.selectAll("li").classed("selected",function(e){return t.selectedItem==e}),this.updateDetailFields()},addListItem:function(e){for(var t="New "+this.expandedGroup.typeName,i=0;this.findItemWithName(t);)i++,t="New "+this.expandedGroup.typeName+" "+i;return this.requireSelectAndFocus=!0,this.selectAndFocusName=t,"Range"==this.expandedGroupName||("Properties"==this.expandedGroupName?(this.localTimelineTemplate.properties.push({propertyId:this.nextItemId++,name:t,type:"text",sortOrder:this.localTimelineTemplate.properties.length-1,calcFromChildren:!1,calculationMode:"all"}),this.selectedItem=this.localTimelineTemplate.properties[this.localTimelineTemplate.properties.length-1]):"Entity Types"==this.expandedGroupName?(this.localTimelineTemplate.types.push({typeId:this.nextItemId++,name:t,icon:"user",persistent:!1,sortOrder:this.localTimelineTemplate.types.length-1}),this.selectedItem=this.localTimelineTemplate.types[this.localTimelineTemplate.types.length-1],this.selectedItem.roles=[{roleId:this.nextItemId++,name:t,icon:"circle",multiplePerEvent:!0,allowPercent:!1,sortOrder:0}]):"Colors"==this.expandedGroupName&&(this.localTimelineTemplate.colors.push({colorId:this.nextItemId++,name:t,color:"#999999",sortOrder:this.localTimelineTemplate.colors.length-1}),this.selectedItem=this.localTimelineTemplate.colors[this.localTimelineTemplate.colors.length-1])),this.renderMasterList(),d3.event.stopPropagation(),!1},findItemWithName:function(e){var t=null,i=this.localTimelineTemplate,n=i.rangeProperties,s=i.properties,a=i.types,l=i.colors;if(illegalWords=this.BadWords,!e||0===e.length)return"The string entered is empty.";if(t=_.find(illegalWords,function(t){return t==e},this))return t;if(t=_.find(n,function(t){return t.name==e},this))return t;if(t=_.find(s,function(t){return t.name==e},this))return t;if(t=_.find(l,function(t){return t.name==e},this))return t;if(t=_.find(a,function(t){return t.name==e},this))return t;for(var o=0,r=a.length;r>o;o++){var d=a[o].roles;if(t=_.find(d,function(t){return t.name==e},this))return t}var p=new RegExp(/[\<\>\{\}\[\]]/);return p.test(e)?"Invalid character detected":null},removeSelectedItem:function(){var e,t=-1;"Range"==this.expandedGroupName||("Properties"==this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"==this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"==this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),t=_.indexOf(e,this.selectedItem),e=_.without(e,this.selectedItem),"Range"==this.expandedGroupName||("Properties"==this.expandedGroupName?this.localTimelineTemplate.properties=e:"Entity Types"==this.expandedGroupName?this.localTimelineTemplate.types=e:"Colors"==this.expandedGroupName&&(this.localTimelineTemplate.colors=e)),0==e.length?this.selectedItem=null:t>e.length?this.selectedItem=e[e.length-1]:this.selectedItem=e[t],this.renderMasterList()},moveSelectedItemUp:function(){var e,t=0;"Range"==this.expandedGroupName||("Properties"==this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"==this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"==this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),this.selectedItem.sortOrder=this.selectedItem.sortOrder-1.5,e.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(e,function(e){e.sortOrder=t++}),this.renderMasterList()},moveSelectedItemDown:function(){var e,t=0;"Range"==this.expandedGroupName||("Properties"==this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"==this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"==this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),this.selectedItem.sortOrder=this.selectedItem.sortOrder+1.5,e.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(e,function(e){e.sortOrder=t++}),this.renderMasterList()},nameInput:function(){var e=this.$nameInput.val(),t=!1;if(this.selectedItem.name!=e){var i=this.findItemWithName(e);if(null==i)this.$nameInput[0].setCustomValidity("");else if(this.selectedItem.roles){var n=_.find(this.selectedItem.roles,function(t){return t.name==e},this);n||(t=!0)}else t=!0}this.setNameFieldIsInvalid(t)},setNameFieldIsInvalid:function(e){this.$nameInput[0].setCustomValidity(e?"Error":"")},nameChanged:function(){var e=this.$nameInput.val();if(this.selectedItem.name!=e){var t=this.findItemWithName(e);if(null==t)this.selectedItem.name=this.$nameInput.val(),this.renderMasterList();else if(this.selectedItem.roles){var i=_.find(this.selectedItem.roles,function(t){return t.name==e},this);i&&(this.selectedItem.name=this.$nameInput.val(),this.renderMasterList()),this.$nameInput.val(this.selectedItem.name)}else this.$nameInput.val(this.selectedItem.name)}this.setNameFieldIsInvalid(!1)},iconChanged:function(e){this.selectedItem.icon=e,this.renderMasterList()},updatePropertyCalcModeOptions:function(){var e=[];this.selectedItem?("number"==this.selectedItem.type||"decimal"==this.selectedItem.type||"currency"==this.selectedItem.type?(e.push({name:"Sum",value:"sum"}),e.push({name:"Avg",value:"avg"}),e.push({name:"Max",value:"max"}),e.push({name:"Min",value:"min"})):"boolean"==this.selectedItem.type?(e.push({name:"All",value:"all"}),e.push({name:"Any",value:"any"})):"percentage"==this.selectedItem.type&&e.push({name:"Weighted Percentage",value:"weightedPercentage"}),"text"==this.selectedItem.type||"multitext"==this.selectedItem.type?(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0)):(this.$calcFromChildren.prop("disabled",!1),0==this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!0):this.calcModeDropdown.setDisabled(!1)),this.calcModeDropdown.setOptions(e),this.calcModeDropdown.setValue(this.selectedItem.calculationMode)):(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0),this.calcModeDropdown.setOptions(e),this.calcModeDropdown.setValue(null))},updateRangeOptionsDisplay:function(){"date"==this.selectedItem.type?(d3.select("#editRangePropertyDateOptions").style("display",null),d3.select("#editRangePropertyNumericOptions").style("display","none"),this.calendarTypeDropdown.setValue(parseInt(this.selectedItem.calendar.calendarType)),this.dateMinZoomDropdown.setValue(this.selectedItem.minUnitScale),this.dateMaxZoomDropdown.setValue(this.selectedItem.maxUnitScale)):(d3.select("#editRangePropertyDateOptions").style("display","none"),d3.select("#editRangePropertyNumericOptions").style("display",null),this.$numericMinZoomInput.val(this.selectedItem.minUnitScale),this.$numericMaxZoomInput.val(this.selectedItem.maxUnitScale))},propertyTypeChanged:function(){this.selectedItem.type=this.typeDropdown.getValue(),this.updatePropertyCalcModeOptions(),this.calcModeDropdown.selectFirst(),this.selectedItem.calculationMode=this.calcModeDropdown.getValue(),"text"==this.selectedItem.type||"multitext"==this.selectedItem.type?(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0),this.$calcFromChildren.prop("checked",!1),this.selectedItem.calcFromChildren=!1):(this.$calcFromChildren.prop("disabled",!1),0==this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!0):this.calcModeDropdown.setDisabled(!1)),"boolean"==this.selectedItem.type||"percentage"==this.selectedItem.type?(this.$fadeUsingProperty.prop("disabled",!1),this.$fadeUsingProperty.prop("checked",this.selectedItem.useForFadingEvents)):(this.selectedItem.useForFadingEvents=!1,this.$fadeUsingProperty.prop("disabled",!0),this.$fadeUsingProperty.prop("checked",!1))},colorColorChanged:function(){this.selectedItem.color=this.$colorInput.val(),this.renderMasterList()},typePersistenceChanged:function(){this.selectedItem.persistent=!this.$persistentInput.prop("checked")},calendarTypeChanged:function(){var e,t=this.selectedItem.calendar,i=new ATCalendar(t.eras,t.months,t.weekdays,t.hoursInDay,t.weekdayIndexAtZero,0),n=new ATRangeConversion("date",i),s='Position "zero" in the relative timeline at date:';this.zeroDateFromType=t.calendarType,this.zeroDateToType=parseInt(this.calendarTypeDropdown.getValue()),e=this.zeroDateFromType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME||this.zeroDateToType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?"Date must be at start of week ("+i.weekdays[0].name+")":this.zeroDateFromType==ATCalendarType.CALENDAR_TYPE_DAY_TIME||this.zeroDateToType==ATCalendarType.CALENDAR_TYPE_DAY_TIME?"Date can be any day (no time component)":"Date must be at start of an hour",this.zeroDateFromType!==this.zeroDateToType&&window.mainApp.showZeroDateModal(this.zeroDateChanged.bind(this),this.zeroDateValidate.bind(this),n,this.selectedItem.calendar.zeroDateTS,ATTimeUnit.HOUR,s,e)},zeroDateValidate:function(e,t){var i;return i=this.zeroDateFromType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME||this.zeroDateToType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,1,0,0,0,0)):this.zeroDateFromType==ATCalendarType.CALENDAR_TYPE_DAY_TIME||this.zeroDateToType==ATCalendarType.CALENDAR_TYPE_DAY_TIME?t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,0,1,0,0,0)):t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,0,0,1,0,0)),e.timestamp===i.timestamp},zeroDateChanged:function(e){this.selectedItem.calendar.zeroDateTS=e.timestamp,this.selectedItem.calendar.calendarType=this.zeroDateToType},dateMinZoomChanged:function(){this.selectedItem.minUnitScale=this.dateMinZoomDropdown.getValue()},dateMaxZoomChanged:function(){this.selectedItem.maxUnitScale=this.dateMaxZoomDropdown.getValue()},numericMinZoomChanged:function(){var e=this.$numericMinZoomInput.val();isNaN(e)||(this.selectedItem.minUnitScale=parseFloat(e))},numericMaxZoomChanged:function(){var e=this.$numericMaxZoomInput.val();isNaN(e)||(this.selectedItem.maxUnitScale=parseFloat(e))},addRoleClicked:function(){this.selectedItem.roles.push({roleId:this.nextItemId++,name:"New Role",icon:"circle",multiplePerEvent:!0}),this.updateDetailFields();var e=this.nextItemId-1;$("#editRangeRoles-item"+e+"-edit-name").focus(),$("#editRangeRoles-item"+e+"-edit-name").select()},removeRoleClicked:function(e){var t=_.find(this.selectedItem.roles,function(t){return t.roleId==e});this.selectedItem.roles=_.without(this.selectedItem.roles,t),this.updateDetailFields()},editRoleNameInput:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId==e}),n=!1;if(i){var s=this.findItemWithName(t);s&&this.selectedItem.name!=t&&(n=!0)}this.roleListView.setNameIsInvalid(e,n)},editRoleNameChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId==e});if(i){var n=this.findItemWithName(t);null==n?i.name=t:this.selectedItem.name==t&&(i.name=t)}this.updateDetailFields()},editRoleIconChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId==e});i&&(i.icon=t),this.updateDetailFields()},editRoleMultipleChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId==e});i&&(i.multiplePerEvent=t),this.updateDetailFields()},calcFromChildrenChanged:function(){this.selectedItem.calcFromChildren=this.$calcFromChildren.prop("checked"),0==this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!0):"multitext"!=this.selectedItem.type&&"text"!=this.selectedItem.type&&this.calcModeDropdown.setDisabled(!1)},calculationModeChanged:function(){this.selectedItem.calculationMode=this.calcModeDropdown.getValue()},fadeUsingPropertyChanged:function(){var e=this.$fadeUsingProperty.prop("checked"),t=this.localTimelineTemplate,i=t.properties;e?(_.each(i,function(e){e.useForFadingEvents=!1}),this.selectedItem.useForFadingEvents=!0):this.selectedItem.useForFadingEvents=!1},okClickHandler:function(e){return window.ApplicationInterface&&window.ApplicationInterface.updateTemplate(window.timelineDocumentId,JSON.stringify(this.localTimelineTemplate)),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},cancelClickHandler:function(e){return this.$colorInput&&this.$colorInput.spectrum("hide"),this.$iconButton&&this.$iconButton.iconpicker("closePicker"),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},showEnterNameHandler:function(e){return window.mainApp.showSaveCustomTemplateModal(this.saveAsCustomSubmitHandler.bind(this)),e.preventDefault(),!1},showEditCalendarHandler:function(e){console.log("show edit calendar handler"),window.mainApp.showEditCalendarModal(this.selectedItem.calendar,this.replaceCalendar.bind(this))},replaceCalendar:function(e){this.selectedItem.calendar=e},saveAsCustomSubmitHandler:function(e){return e&&window.ApplicationInterface&&window.ApplicationInterface.saveCustomTemplate(window.timelineDocumentId,JSON.stringify(this.localTimelineTemplate),e),event.preventDefault(),!1}});module.exports=ATEditTemplateView;
},{"./ATCalendar":17,"./ATDatePicker":23,"./ATDropdown":29,"./ATEditRoleListView":32,"./ATRangeConversion":71,"./ATTimeSpan":84,"./ATTimeUnit":85,"./ATUtilities":91,"./templates/editColorPageTemplate.html":115,"./templates/editPropertyPageTemplate.html":118,"./templates/editRangePropertyPageTemplate.html":119,"./templates/editTemplateTemplate.html":121,"./templates/editTypePageTemplate.html":122,"./templates/masterList.html":155,"./templates/optionsTemplate.html":158,"backbone":176,"d3":300,"jquery":307,"lodash":309}],34:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/embedInParentTemplate.html"),ATEmbedInNewParentView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$titleInput=$("#embedInParentTitle"),this.colorDropdown=new ATColorDropdown({el:"#embedInParentColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#embedInParentParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),$("#embedInParentForm").on("submit",this.addClickHandler.bind(this)),this.renderTemplate()},renderTemplate:function(){var e=this.model.get("template"),t=e.colors;this.colorDropdown.setOptions(t),this.$titleInput.val(""),this.colorDropdown.setValue(t[0].name)},resetForm:function(e){var t=this.model.get("template"),n=t.colors;this.$titleInput.val("New Event"),this.colorDropdown.setValue(n[0].name),this.updateParentDropdown(e),this.formSubmitted=!1,window.setTimeout(this.$titleInput.focus.bind(this.$titleInput),500),window.setTimeout(this.$titleInput.select.bind(this.$titleInput),501)},updateParentDropdown:function(e){var t=this.model.get("timeline"),n=t.get("events").models,i=this.model.get("eventData").eventIds,o=[{value:-1,sortValue:"-1",label:"(No Parent)"}],r=t.get("events").findChild(i[0]),a=r?r.get("parentId"):-1;_.each(n,function(e){!_.contains(i,e.id)&&this.validateDependencyLoop(i,e.id,!0)&&(o.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),this.addChildrenOfEventsToOptions(o,e,i))},this),o.sort(function(e,t){var n=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),i=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),o=Math.min(n.length,i.length),r=0;for(r=0;o>r;r++)if(n[r]!=i[r])return n[r]-i[r];return n.length-i.length}),_.each(i,function(e){var n=t.get("events").findChild(e);a!=n.get("parentId")&&(a=-1)}),this.parentSearchDropdown.setOptions(o),this.parentSearchDropdown.setValue(a)},addChildrenOfEventsToOptions:function(e,t,n){var i=this;t.children.each(function(t){!_.contains(n,t.id)&&i.validateDependencyLoop(n,t.id,!0)&&e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t,n)})},validateDependencyLoop:function(e,t,n){var i=this.model.get("timeline"),o=i.get("events"),r=o.findChild(t),a=_.map(_.keys(r.get("dependencies")),function(e){return parseInt(e)}),d=r.children,l=!1,s=!1;return _.contains(e,t)?!1:(_.each(a,function(t){this.validateDependencyLoop(e,t,!1)||(l=!0)},this),d.each(function(t){this.validateDependencyLoop(e,t.id,!1)||(l=!0)},this),l?!1:!n||(_.each(e,function(e){var n=o.findChild(e),i=_.map(_.keys(n.get("dependencies")),function(e){return parseInt(e)});_.contains(i,t)&&(s=!0)},this),!s))},addClickHandler:function(e){var t=(this.model.get("template"),this.$titleInput.val()),n=this.colorDropdown.getValue(),i=parseInt(this.parentSearchDropdown.getValue());return this.formSubmitted===!0?(e.preventDefault(),!1):(this.formSubmitted=!0,window.mainApp.removeExistingModal(),window.ApplicationInterface&&window.ApplicationInterface.embedSelectedEventsInNewParentEvent(window.timelineDocumentId,t,n,i),e.preventDefault(),!1)}});module.exports=ATEmbedInNewParentView;
},{"./ATColorDropdown":20,"./ATDropdown":29,"./ATSearchDropdown":77,"./templates/embedInParentTemplate.html":124,"backbone":176,"d3":300,"jquery":307,"lodash":309}],35:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),templateHtml=require("./templates/enterDateTemplate.html"),ATEnterDateView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t({windowTitle:"Enter Date"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterDateWindowTitle"),this.d3WindowAboveMsg=d3.select("#enterDateWindowAboveMessage"),this.d3WindowBelowMsg=d3.select("#enterDateWindowBelowMessage"),this.d3DatePicker=this.d3El.select("#enterDatePicker"),this.datePickerView=new ATDatePicker({el:"#enterDatePicker"}),this.datePickerView.setContinuousChangeCallback(this.validateInput.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$submitButton=$("#enterDateSubmit"),$("#enterDateForm").on("submit",this.addClickHandler.bind(this))},resetForm:function(){this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectDateIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectDateIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;t>0&&(this.datePickerView.setText(e),this.validateInput()),this.datePickerView.resumeFocus(!0),this.$earlyInputCatcher.removeClass("activeCatcher")},setCallback:function(e){this.callbackFunction=e},setValidatorFunction:function(e){this.validatorFunction=e},setWindowTitle:function(e){this.$windowTitle.text(e)},setWindowAboveMessage:function(e){this.d3WindowAboveMsg.text(e).style("display",e?null:"none")},setWindowBelowMessage:function(e){this.d3WindowBelowMsg.text(e).style("display",e?null:"none")},setRangeConversion:function(e){this.datePickerView.setRangeConversion(e)},setTimestamp:function(e,t){this.datePickerView.setTimestamp(e,t),this.datePickerView.focusAndSelectAll()},validateInput:function(){var e=this.datePickerView.getValue(),t=this.validatorFunction?this.validatorFunction(e,this.datePickerView.calendar):!0;return this.$submitButton.prop("disabled",!t),t},addClickHandler:function(e){var t=this.datePickerView.getValue();return this.formSubmitted===!0?(e.preventDefault(),window.mainApp.removeExistingModal(),!1):(this.formSubmitted=!0,e.preventDefault(),this.validateInput()?(this.callbackFunction&&this.callbackFunction(t),window.mainApp.removeExistingModal(),!1):!1)}});module.exports=ATEnterDateView;
},{"./ATDatePicker":23,"./templates/enterDateTemplate.html":125,"backbone":176,"d3":300,"jquery":307,"lodash":309}],36:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDurationPicker=require("./ATDurationPicker"),templateHtml=require("./templates/enterDurationTemplate.html"),ATEnterDurationView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(i({windowTitle:"Enter Duration"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterDurationWindowTitle"),this.d3Duration=this.d3El.select("#enterDurationPicker"),this.durationPickerView=new ATDurationPicker({el:"#enterDurationPicker"}),this.durationPickerView.setContinuousChangeCallback(this.validateInput.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$submitButton=$("#enterDurationSubmit"),$("#enterDurationForm").on("submit",this.addClickHandler.bind(this))},setCallback:function(t){this.callbackFunction=t},setValidatorFunction:function(t){this.validatorFunction=t},setWindowTitle:function(t){this.$windowTitle.text(t)},setRangeConversion:function(t){this.durationPickerView.setRangeConversion(t)},resetForm:function(){this.durationPickerView.setText(""),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectFieldIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectFieldIfUnfocused:function(){var t=this.$earlyInputCatcher.val(),i=t.length;this.durationPickerView.setText(t),this.durationPickerView.focusCursor(),i>0&&this.validateInput(),this.$earlyInputCatcher.removeClass("activeCatcher")},setValue:function(t){this.durationPickerView.setValue(t)},validateInput:function(){var t=this.durationPickerView.text(),i=this.validatorFunction?this.validatorFunction(t):!0;return this.$submitButton.prop("disabled",!i),i},addClickHandler:function(t){var i=this.durationPickerView.text();this.durationPickerView.getValue();return this.formSubmitted===!0?(t.preventDefault(),window.mainApp.removeExistingModal(),!1):(this.formSubmitted=!0,t.preventDefault(),this.validateInput()?(this.callbackFunction&&this.callbackFunction(i),window.mainApp.removeExistingModal(),!1):!1)}});module.exports=ATEnterDurationView;
},{"./ATDurationPicker":30,"./templates/enterDurationTemplate.html":126,"backbone":176,"d3":300,"jquery":307,"lodash":309}],37:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/enterNameTemplate.html"),ATEnterNameView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(e({windowTitle:"Enter Name"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterNameWindowTitle"),this.d3WindowAboveMsg=d3.select("#enterNameWindowAboveMessage"),this.d3WindowBelowMsg=d3.select("#enterNameWindowBelowMessage"),this.$nameInput=$("#enterNameInput"),this.$nameInput.on("input",this.validateNameInput.bind(this)),this.$submitButton=$("#enterNameSubmit"),this.$earlyInputCatcher=$("#modalInputCatcher"),$("#enterNameForm").on("submit",this.addClickHandler.bind(this))},setCallback:function(t){this.callbackFunction=t},setValidatorFunction:function(t){this.validatorFunction=t},setWindowTitle:function(t){this.$windowTitle.text(t)},setWindowAboveMessage:function(t){this.d3WindowAboveMsg.text(t).style("display",t?null:"none")},setWindowBelowMessage:function(t){this.d3WindowBelowMsg.text(t).style("display",t?null:"none")},resetForm:function(){this.$nameInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectNameIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectNameIfUnfocused:function(){var t=this.$earlyInputCatcher.val(),e=t.length;this.$nameInput.val(t),this.$nameInput.focus(),this.$nameInput[0].setSelectionRange(e,e),e>0&&this.validateNameInput(),this.$earlyInputCatcher.removeClass("activeCatcher")},validateNameInput:function(){var t=this.$nameInput.val(),e=this.validatorFunction?this.validatorFunction(t):t.length>0;return this.$submitButton.prop("disabled",!e),e},addClickHandler:function(t){this.$nameInput.val();return this.formSubmitted===!0?(t.preventDefault(),window.mainApp.removeExistingModal(),!1):(this.formSubmitted=!0,this.validateNameInput()?(this.callbackFunction&&this.callbackFunction(this.$nameInput.val()),window.mainApp.removeExistingModal(),t.preventDefault(),!1):void t.preventDefault())}});module.exports=ATEnterNameView;
},{"./templates/enterNameTemplate.html":127,"backbone":176,"d3":300,"jquery":307,"lodash":309}],38:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEntity=Backbone.Model.extend({defaults:function(){return{name:null,color:null,type:null,sortOrder:0,startTS:0,stopTS:0,hasStart:!1,hasStop:!1,visibleAsColumn:!0,relationships:{}}},update:function(e){var t,r;if(e.relUpdates||e.relDeletes){r=_.clone(this.get("relationships"));for(t in e.relUpdates)e.relUpdates.hasOwnProperty(t)&&(r[+t]=e.relUpdates[t]);_.each(e.relDeletes,function(e){delete r[+e]}),this.set({relationships:r}),this.trigger("relationshipsChanged")}}});module.exports=ATEntity;
},{"backbone":176,"lodash":309}],39:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEventNodeList=require("./ATEventNodeList"),ATEntityLane=Backbone.Model.extend({defaults:function(){return{timeline:null,entity:null,top:0,height:0,nameWidth:null,sortOrder:0,collapsed:!1}},initialize:function(){this.nodes=new ATEventNodeList,this.layoutRequired=!0;var e=this.get("timeline"),t=e.get("events"),i=this.get("entity"),n=i.get("relationships"),d=(_.keys(n),this.nodes,this);this.relationshipUpdatePending=!1,this.set({sortOrder:i.get("sortOrder")}),this.updateRelationshipNodes(),this.nameChanged(),this.listenTo(t,"add remove",function(){d.relationshipsChanged()}),this.listenTo(i,"change:relationships",function(){d.relationshipsChanged()}),this.listenTo(i,"change:name",function(){d.nameChanged()}),this.listenTo(i,"change:sortOrder",function(){this.set({sortOrder:i.get("sortOrder")})}),this.listenTo(t,"layoutRequired",function(){this.layoutRequired=!0}),this.listenTo(t,"childNodeAdded",function(){this.trigger("childNodeAdded")})},destroy:function(){},scaleChanged:function(e){this.nodes.each(function(t){t.scaleChanged(e)})},eventsChanged:function(){var e=this.get("timeline"),t=e.get("events"),i=this.nodes,n=[];i.each(function(e){t.get(e.id)||n.push(e)},this),i.remove(n)},nameChanged:function(){this.set("nameWidth",window.mainApp.timelineView.calcEntityTextWidth(this.get("entity").get("name")))},relationshipsChanged:function(){this.relationshipUpdatePending=!0},updateRelationshipNodes:function(){var e=this.get("timeline"),t=e.get("events"),i=this.get("entity"),n=i.get("relationships"),d=_.keys(n),s=this.nodes,h=[],o=[],a={};_.each(d,function(e){var i=t.get(e),d=s.get(e);i&&-1==i.get("parentId")&&(d?(d.set("role",n[e]),d.childrenChanged(),a[d.id]=d.id):(h.push({id:i.id,lane:this,event:t.findChild(i.id)}),a[i.id]=i.id))},this),_.each(d,function(e){var i=t.findChild(e);if(i&&-1!=i.get("parentId")){for(;i&&-1!=i.get("parentId");)i=t.findChild(i.get("parentId"));i&&!a[i.id]&&(node=s.get(i.id),node?(node.set("role","Inherited"),node.childrenChanged(),a[node.id]=node.id):(h.push({id:i.id,lane:this,event:t.findChild(i.id)}),a[i.id]=i.id))}},this),s.each(function(e){_.contains(a,e.id)&&t.get(e.id)||o.push(e)},this),s.remove(o),s.set(h,{remove:!1}),this.relationshipUpdatePending=!1}});module.exports=ATEntityLane;
},{"./ATEventNodeList":46,"backbone":176,"lodash":309}],40:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEntityLane=require("./ATEntityLane"),ATEntityLaneList=Backbone.Collection.extend({model:ATEntityLane,comparator:"sortOrder",initialize:function(){this.listenTo(this,"change:collapsed",function(){this.trigger("laneCollapsed")}),this.listenTo(this,"change:sortOrder",function(){this.sort()})}});module.exports=ATEntityLaneList;
},{"./ATEntityLane":39,"backbone":176,"lodash":309}],41:[function(require,module,exports){
var Backbone=require("backbone"),ATEntity=require("./ATEntity"),ATEntityList=Backbone.Collection.extend({model:ATEntity,comparator:"name"});module.exports=ATEntityList;
},{"./ATEntity":38,"backbone":176}],42:[function(require,module,exports){
var ATEra=function(s,a,i,t,h,r){this.index=s,this.name=a,this.shortName=i,this.duration=t,this.isBackwards=h,this.hasLeap=r};module.exports=ATEra;
},{}],43:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEvent=Backbone.Model.extend({defaults:function(){return{title:null,displayId:null,startTS:null,endTS:null,precision:null,dateString:null,visible:!0,isFaded:!1,parentId:-1,values:{},links:[],tags:[],imagePath:null,relationships:[],color:null,dependencies:{},successors:[],selected:!1}},initialize:function(){var e=require("./ATEventList");this.children=new e},update:function(e){var i,n=this.children,t=e.valueUpdates;if(t){var s=_.clone(this.get("values"));for(i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);this.set({values:s})}e.childUpdates&&_.each(e.childUpdates,function(e){var i=_.pick(e,"id","title","displayId","startTS","endTS","precision","dateString","color","links","tags","visible","isFaded","dependencies","successors","relationships");i.parentId=this.id,n.set([i],{remove:!1}),n.get(e.id).update(e)},this),e.childDeletes&&n.remove(e.childDeletes)},appendAllDescendants:function(e){var i=this.children;return e.push.apply(e,i.models),i.each(function(i){i.appendAllDescendants(e)}),e},hasChildInIdMap:function(e){var i,n=this.children.length,t=this.children.models;if(e[this.id])return!0;for(i=0;n>i;i++)if(t[i].hasChildInIdMap(e))return!0;return!1},matchString:function(e){var i=this.get("title"),n=new RegExp(e,"i"),t=i.match(n);return!!t}});module.exports=ATEvent;
},{"./ATEventList":44,"backbone":176,"lodash":309}],44:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEvent=require("./ATEvent"),ATEventList=Backbone.Collection.extend({model:ATEvent,findChild:function(e){var n,t,i,r=this.get(e);if(r)return r;for(t=this.length,i=0;t>i;i++)if(n=this.at(i),r=n.children.findChild(e))return r;return null}});module.exports=ATEventList;
},{"./ATEvent":43,"backbone":176,"lodash":309}],45:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATSize=require("./ATSize"),ATEventNode=Backbone.Model.extend({defaults:function(){return{event:null,lane:null,role:null,contentHTML:null,startPixel:null,stopPixel:null,displayTitle:null,showChildNodes:!1,showMore:!1,textSize:new ATSize(0,0),parentTextSize:new ATSize(0,0),smallTextSize:new ATSize(0,0),bigTextSize:new ATSize(0,0),markerRect:new ATRect(TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft,TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop,0,2*TimelineDisplayConstants.eventMarkerCornerRadius),totalRect:new ATRect(0,0,0,0),relationshipTotalRect:new ATRect(0,0,0,0),smallTotalRect:new ATRect(0,0,0,0),markerPoints:[],bulletPos:null,selected:!1,relationshipRect:new ATRect(0,0,0,0),relationshipLineYPixel:0}},initialize:function(){var e,t=this.get("lane"),i=this.get("event"),n=i.children,s=t.get("entity").attributes.relationships,a=[],h=window.mainApp.displaySettings.showEventId,l=require("./ATEventNodeList");this.childNodes=new l,this.childRect=new ATRect(0,0,0,0),e=this.childNodes,this.calcTextSizeRequired=!0,this.calcRectsRequired=!0,this.calcBigTextRequired=!0,s[this.id]?this.set("role",s[this.id]):this.set("role","Inherited"),this.set("displayTitle",(h?i.get("displayId")+". ":"")+i.get("title")),n.each(function(e){e.hasChildInIdMap(s)&&a.push({id:e.id,lane:t,event:e})}),e.set(a,{remove:!1}),this.useScale=window.mainApp.timelineViewModel.get("unitScale"),this.listenTo(i.children,"add remove",function(){this.childrenChanged()}),this.listenTo(i,"change:startTS change:endTS change:maxScale change:visible",function(){this.scaleChanged(this.useScale)}),this.listenTo(i,"change:title change:dateString change:displayId",function(){var e=this.get("event"),t=window.mainApp.displaySettings.showEventId;this.set("displayTitle",(t?e.get("displayId")+". ":"")+e.get("title")),this.calcEventTextRequired=!0}),this.listenTo(i,"change:values change:relationships",function(){this.valuesChanged()}),this.listenTo(this,"change:showMore",function(){this.showMoreChanged()}),this.listenTo(this,"change:showChildNodes",function(){this.showChildNodesChanged()}),this.listenTo(i,"change:links",function(){this.linksChanged()}),this.listenTo(i,"change:selected",this.selectionChanged),this.listenTo(e,"add",this.childAdded),this.listenTo(e,"remove",this.childRemoved),this.scaleChanged(this.useScale),this.valuesChanged(),this.linksChanged()},destroy:function(){},showMoreChanged:function(){this.calcBigTextRequired&&this.get("showMore")&&(this.calcEventTextRequired=!0),window.ApplicationInterface&&window.ApplicationInterface.setEventNodeShowMoreState(window.timelineDocumentId,parseInt(this.id),parseInt(this.get("lane").id),this.get("showMore")),this.calcRectsRequired=!0},showChildNodesChanged:function(){0==this.get("event").children.length&&this.set("showChildNodes",!1),this.get("showChildNodes")?this.get("showMore")&&this.set("showMore",!1):this.childNodes.each(function(e){e.get("showChildNodes")&&e.set("showChildNodes",!1)}),window.ApplicationInterface&&window.ApplicationInterface.setParentExpandedState(window.timelineDocumentId,parseInt(this.id),parseInt(this.get("lane").id),this.get("showChildNodes")),this.calcRectsRequired=!0},displayTemplateChanged:function(){this.valuesChanged(),this.childNodes.each(function(e){e.displayTemplateChanged()});var e=this.get("event"),t=window.mainApp.displaySettings.showEventId;this.set("displayTitle",(t?e.get("displayId")+". ":"")+e.get("title")),this.calcBigTextRequired=!0,this.calcEventTextRequired=!0},valuesChanged:function(){this.get("event");this.set("contentHTML",window.mainApp.timelineView.moreTemplate({event:this.get("event")})),this.calcBigTextRequired=!0,this.calcEventTextRequired=!0},linksChanged:function(){var e=this.get("event"),t=e.get("links"),i=null;_.each(t,function(e){var t=e.path,n=t.substr((~-t.lastIndexOf(".")>>>0)+2).toLowerCase();"png"!=n&&"jpg"!=n&&"jpeg"!=n&&"bmp"!=n&&"gif"!=n||i||(i=t)}),e.set("imagePath",i),this.valuesChanged(),this.calcBigTextRequired=!0,this.calcEventTextRequired=!0},childrenChanged:function(){var e=this.get("lane"),t=this.get("event"),i=t.children,n=e.get("entity").get("relationships"),s=[];i.each(function(t){t.hasChildInIdMap(n)&&s.push({id:t.id,lane:e,event:t})}),this.childNodes.set(s,{remove:!0}),this.childNodes.each(function(e){e.childrenChanged()}),i.length||this.set("showChildNodes",!1)},childAdded:function(){this.trigger("childNodeAdded")},childRemoved:function(){},scaleChanged:function(e){var t=this.get("event");t.get("startTS"),t.get("endTS");this.childNodes.each(function(t){t.scaleChanged(e)}),this.calcPixels(e),this.useScale=e},selectionChanged:function(){this.set("selected",this.get("event").get("selected"))},calcPixels:function(e){var t=this.get("event");maxScale=t.get("visible")?t.get("maxScale"):0,scale=maxScale<0?1:maxScale>e?1:maxScale/e,this.set({startPixel:t.get("startTS")/e,stopPixel:t.get("endTS")/e,scale:scale}),this.calcRectsRequired=!0},calcRects:function(){var e,t,i,n,s=this.get("startPixel"),a=this.get("stopPixel"),h=this.get("markerRect"),l=this.get("smallTextSize"),o=this.get("bigTextSize"),r=this.get("parentTextSize"),d=a-s,c=this.get("showMore"),g=new ATRect(0,0,0,0),p=new ATRect(0,0,0,0),u=[];if(this.get("showChildNodes")){if(d>0&&d<TimelineDisplayConstants.maxParentWidthBeforeAutoCollapse&&window.mainApp.timelineView.model.get("unitScale")>window.mainApp.timelineView.minimumUnitScale)return this.set("showChildNodes",!1),void(window.mainApp.timelineView.renderFlags.data=!0);if(c)return void this.set({showMore:!1})}if(h.size.width=Math.max(Math.round(a-s),2*TimelineDisplayConstants.eventMarkerCornerRadius),h.size.height=2*TimelineDisplayConstants.eventMarkerCornerRadius,n=window.mainApp.timelineView.isExport?h.size.width:Math.min(TimelineDisplayConstants.eventOptimiseMaxPolygonWidth,h.size.width),window.mainApp.timelineView.isExport&&n>TimelineDisplayConstants.eventOptimiseMaxPolygonWidth){var T=0,m=TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-2*TimelineDisplayConstants.eventMarkerCornerRadius,C=Math.min(n/2,m),w=n;for(u.push("0.5,"+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+",0.5 "+(Math.round(C)+.5)+",0.5 "+(Math.round(C)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)),w-=C,T+=C;w>m;)C=Math.min(m,w-m),u.push(""+(Math.round(T)+.5)+",0.5 "+(Math.round(T+C)+.5)+",0.5 "+(Math.round(T+C)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(Math.round(T)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)),w-=C,T+=C;u.push(""+(Math.round(T)+.5)+",0.5 "+(Math.round(n-TimelineDisplayConstants.eventMarkerCornerRadius)+.5)+",0.5 "+(Math.round(n)+.5)+","+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(Math.round(n-TimelineDisplayConstants.eventMarkerCornerRadius)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(Math.round(T)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5))}else u.push("0.5,"+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+",0.5 "+(Math.round(n-TimelineDisplayConstants.eventMarkerCornerRadius)+.5)+",0.5 "+(Math.round(n)+.5)+","+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(Math.round(n-TimelineDisplayConstants.eventMarkerCornerRadius)+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5)+" "+(TimelineDisplayConstants.eventMarkerCornerRadius+.5)+","+(2*TimelineDisplayConstants.eventMarkerCornerRadius+.5));this.childNodes.length>0?(i=new ATPoint(Math.max(h.centerX()-TimelineDisplayConstants.eventParentExpandWidth/2,h.right()-TimelineDisplayConstants.eventParentExpandSpanOffsetFromRight),h.centerY()-TimelineDisplayConstants.eventParentExpandHeight/2),h.size.width+=TimelineDisplayConstants.eventMarkerSvgParentExtraWidth,h.size.height+=TimelineDisplayConstants.eventMarkerSvgParentExtraHeight):(i=new ATPoint(0,0),h.size.width+=TimelineDisplayConstants.eventMarkerSvgNormalExtraWidth,h.size.height+=TimelineDisplayConstants.eventMarkerSvgNormalExtraHeight),g.origin.x=s-TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft,d<2*TimelineDisplayConstants.eventMarkerCornerRadius&&(g.origin.x-=TimelineDisplayConstants.eventMarkerCornerRadius),p.origin.x=g.origin.x,e=this.get("showChildNodes")?r:this.get("showMore")?o:window.mainApp.displaySettings.showEventDate?l:r,t=this.get("showChildNodes")?r:window.mainApp.displaySettings.showEventDate?l:r,h.size.width>TimelineDisplayConstants.minEventWidthToDropText||this.get("showChildNodes")?(g.size.width=Math.max(h.size.width+TimelineDisplayConstants.eventMarkerShowMoreMarginLeft+TimelineDisplayConstants.eventMarkerShowMoreWidth,e.width)+TimelineDisplayConstants.eventBoxUnderneathWidthAdjust,g.size.height=h.size.height+e.height+TimelineDisplayConstants.eventBoxUnderneathHeightAdjust,p.size.width=Math.max(h.size.width+TimelineDisplayConstants.eventMarkerShowMoreMarginLeft+TimelineDisplayConstants.eventMarkerShowMoreWidth,t.width)+TimelineDisplayConstants.eventBoxUnderneathWidthAdjust,p.size.height=h.size.height+t.height+TimelineDisplayConstants.eventBoxUnderneathHeightAdjust):(g.size.width=h.size.width+e.width+TimelineDisplayConstants.eventBoxSideBySideWidthAdjust,g.size.height=e.height+TimelineDisplayConstants.eventBoxSideBySideHeightAdjust,p.size.width=h.size.width+t.width+TimelineDisplayConstants.eventBoxSideBySideWidthAdjust,p.size.height=t.height+TimelineDisplayConstants.eventBoxSideBySideHeightAdjust),this.set({markerRect:h,textSize:e,markerPoints:u,bulletPos:i,totalRect:g,smallTotalRect:p}),this.calcRectsRequired=!1}});module.exports=ATEventNode;
},{"./ATDisplayConstants":26,"./ATEventNodeList":46,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATSize":79,"backbone":176,"lodash":309}],46:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEventNode=require("./ATEventNode"),ATUtilities=require("./ATUtilities"),ATEventNodeList=Backbone.Collection.extend({model:ATEventNode,initialize:function(){this.sortRequired=!1,this.listenTo(this,"change:totalRect",this.markSortRequired),this.listenTo(this,"change:values",function(){this.trigger("layoutRequired")}),this.listenTo(this,"add",function(){this.sortRequired=!0,this.trigger("childNodeAdded")})},markSortRequired:function(){this.sortRequired=!0,this.trigger("layoutRequired")},findNode:function(t){var e,i,r,n=this.get(t);if(n)return n;for(i=this.length,r=0;i>r;r++)if(e=this.at(r),n=e.childNodes.findNode(t))return n;return null},destroy:function(){this.off(null,null,this)},sortChildren:function(){this.sort(),this.each(function(t){t.childNodes.sortChildren()})},comparator:function(t,e){var i=t.get("event").attributes,r=e.get("event").attributes;return i.startTS==r.startTS?ATUtilities.versionNumberCompare(i.displayId,r.displayId):i.startTS-r.startTS}});module.exports=ATEventNodeList;
},{"./ATEventNode":45,"./ATUtilities":91,"backbone":176,"lodash":309}],47:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/exportCSVTemplate.html"),ATExportCSVView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.d3El=d3.select("#"+t),this.d3El.html(e({windowTitle:"Export to CSV"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#exportCSVWindowTitle"),this.$delimiterCommaInput=$("#delimiterInputComma"),this.dateFormatDropdown=new ATDropdown({el:"#dateFormatInput"}),this.timeFormatDropdown=new ATDropdown({el:"#timeFormatInput"}),this.$submitButton=$("#exportCSVSubmit"),$("#exportCSVForm").on("submit",this.addClickHandler.bind(this))},setWindowTitle:function(t){this.$windowTitle.text(t)},addClickHandler:function(t){var e=this.$delimiterCommaInput.is(":checked"),i=parseInt(this.dateFormatDropdown.getValue()),o=this.timeFormatDropdown.getValue();return o=0!=o,window.ApplicationInterface&&window.ApplicationInterface.exportCsv(window.timelineDocumentId,e,i,o),window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATExportCSVView;
},{"./ATDropdown":29,"./templates/exportCSVTemplate.html":139,"backbone":176,"d3":300,"jquery":307,"lodash":309}],48:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATViewMode=require("./ATViewMode"),TimelineDisplayConstants=require("./ATDisplayConstants"),templateHtml=require("./templates/exportImageTemplate.html"),ATRect=require("./ATRect"),ATDatePicker=require("./ATDatePicker"),ATExportImageView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Export to Image or PDF"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#exportImageWindowTitle"),this.d3StartDate=this.d3El.select("#startDateInputImage"),this.startDatePickerView=new ATDatePicker({el:"#startDateInputImage"}),this.d3EndDate=this.d3El.select("#endDateInputImage"),this.endDatePickerView=new ATDatePicker({el:"#endDateInputImage"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.exportViewport=new ATRect(0,0,0,0),this.validSize=!1,this.currentFormat(),this.$submitButton=$("#exportImageSubmit"),$("#entireTimelineImage").on("click",this.entireTimeline.bind(this)),$("#formatCurrentImage").on("click",this.currentFormat.bind(this)),$("#betweenDatesImage").on("click",this.betweenDates.bind(this)),this.startDatePickerView.setChangeCallback(this.updateDates.bind(this)),this.endDatePickerView.setChangeCallback(this.updateDates.bind(this)),$("#exportImageForm").on("submit",this.addClickHandler.bind(this))},calculateRangeOnShow:function(){var e=(window.mainApp.getUnitScale(),this.printSize/100,$("input[name=Format]:checked","#exportImageForm").val());window.mainApp.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW?($("#betweenDatesImage").prop("disabled","disabled"),$("#formatCurrentImage").prop("disabled","disabled"),e="All",$("#entireTimelineImage").prop("checked",!0),$("#betweenDatesImage").prop("checked",!1),$("#formatCurrentImage").prop("checked",!1)):($("#betweenDatesImage").prop("disabled",null),$("#formatCurrentImage").prop("disabled",null)),"Current"==e?this.currentFormat():"All"==e?this.entireTimeline():this.betweenDates()},setRangeConversion:function(e){this.startDatePickerView.setRangeConversion(e),this.endDatePickerView.setRangeConversion(e)},currentFormat:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),this.exportViewport=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?window.mainApp.timelineView.viewport.deepCopy():window.mainApp.relationshipView.viewport.deepCopy(),this.checkFileSizeLimits()},entireTimeline:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),this.exportViewport.origin.x=window.mainApp.getEarliestEventPixel(),this.exportViewport.origin.y=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?-TimelineDisplayConstants.timeHeaderHeight:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.exportViewport.size.width=window.mainApp.getLatestEventPixel()-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeight(),this.checkFileSizeLimits()},betweenDates:function(){this.startDatePickerView.setDisabled(!1),this.endDatePickerView.setDisabled(!1),this.updateDates()},updateDates:function(){var e,i;null!==this.startDatePickerView.getValue()&&(e=this.startDatePickerView.getTimestamp()),null!==this.endDatePickerView.getValue()&&(i=this.endDatePickerView.getTimestamp()),isNaN(e)&&isNaN(i)||i>=e&&(this.exportViewport.origin.x=window.mainApp.pixelForTimestamp(e),this.exportViewport.origin.y=-TimelineDisplayConstants.timeHeaderHeight,this.exportViewport.size.width=window.mainApp.pixelForTimestamp(i)-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeight(),this.checkFileSizeLimits())},checkFileSizeLimits:function(){var e=65536;this.exportViewport.size.width*=window.mainApp.timelineView.physicalScaleFactor,this.exportViewport.size.height*=window.mainApp.timelineView.physicalScaleFactor,this.exportViewport.size.width=4*Math.ceil(this.exportViewport.size.width/4),this.exportViewport.size.height=4*Math.ceil(this.exportViewport.size.height/4),this.exportViewport.size.width>=e||this.exportViewport.size.height>=e?(this.validSize=!1,$("#widthLabelImage").text(Math.round(this.exportViewport.size.width)),$("#heightLabelImage").text(Math.round(this.exportViewport.size.height)),$("#exportImageSubmit").prop("disabled","disabled"),$("#exportImageWarningLabel").text("Error: Dimensions too large to export (Max width/height: "+e+" pixels)")):(this.validSize=!0,$("#widthLabelImage").text(Math.round(this.exportViewport.size.width)),$("#heightLabelImage").text(Math.round(this.exportViewport.size.height)),$("#exportImageSubmit").prop("disabled",null),$("#exportImageWarningLabel").text(""))},setWindowTitle:function(e){this.$windowTitle.text(e)},addClickHandler:function(e){var i=window.mainApp.getUnitScale();return this.validSize?(window.ApplicationInterface&&window.ApplicationInterface.exportImage(window.timelineDocumentId,""+this.exportViewport.origin.x,""+this.exportViewport.origin.y,this.exportViewport.size.width,this.exportViewport.size.height,""+i),window.mainApp.removeExistingModal(),e.preventDefault(),!1):(e.preventDefault(),!1)}});module.exports=ATExportImageView;
},{"./ATDatePicker":23,"./ATDisplayConstants":26,"./ATRect":73,"./ATViewMode":92,"./templates/exportImageTemplate.html":140,"backbone":176,"d3":300,"jquery":307,"lodash":309}],49:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),ATAutoSuggestField=require("./ATAutoSuggestField"),templateHtml=require("./templates/filterBarTemplate.html"),itemsHtml=require("./templates/filterBarItemsTemplate.html"),dhtmlXMenuObject=require("../lib/dhtmlxmenu"),ATFilterBarView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=this,t=_.template(templateHtml);this.itemsTemplate=_.template(itemsHtml),this.chosenLogic="AND",this.chosenNegate="HAS",this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3InlineAdd=this.d3El.select("#filterBarInlineAdd"),this.d3Items=this.d3El.select("#filterBarItems"),this.inlineAddScopeField=new ATAutoSuggestField({el:"#filterBarInlineAddScope"}),this.inlineAddValueField=new ATAutoSuggestField({el:"#filterBarInlineAddValue"}),this.inlineAddScopeField.setPlaceholderText("Field","Click to add filter..."),this.inlineAddScopeField.setLookupFunction(this.lookupScope.bind(this)),this.inlineAddValueField.setPlaceholderText("Value",""),this.inlineAddValueField.setLookupFunction(this.lookupValue.bind(this)),this.inlineAddScopeField.setOnFocus(function(){i.scopeFieldFocused(),i.resumeFocus()}),this.inlineAddScopeField.setOnGoToNextField(function(){i.inlineAddValueField.focusClickHandler()}),this.inlineAddValueField.setOnFocus(function(){i.valueFieldFocused(),i.resumeFocus()}),this.inlineAddValueField.setOnGoToNextField(function(){$("#filterBarInlineAddButton").focus()}),this.d3InlineLogicDiv=d3.select("#filterBarInlineAddLogic"),this.$inlineLogicDiv=$("#filterBarInlineAddLogic"),this.d3InlineLogicValue=d3.select("#filterBarInlineAddLogicValue"),this.$inlineLogicValue=$("#filterBarInlineAddLogicValue"),this.d3InlineLogicOptions=this.d3InlineLogicDiv.selectAll("li").data(["AND","OR"]).on("click",this.logicOptionClick.bind(this)),this.$logicDropdown=$("#filterBarInlineAddLogicList"),this.$inlineLogicDiv.on("focus",this.resumeFocus.bind(this)),this.$inlineLogicValue.on("click",this.showLogicDropdown.bind(this)),this.d3InlineNegateDiv=d3.select("#filterBarInlineAddNegate"),this.$inlineNegateDiv=$("#filterBarInlineAddNegate"),this.d3InlineNegateValue=d3.select("#filterBarInlineAddNegateValue"),this.$inlineNegateValue=$("#filterBarInlineAddNegateValue"),this.d3InlineNegateOptions=this.d3InlineNegateDiv.selectAll("li").data(["HAS","NOT"]).on("click",this.negateOptionClick.bind(this)),this.$negateDropdown=$("#filterBarInlineAddNegateList"),this.$inlineNegateDiv.on("focus",this.resumeFocus.bind(this)),this.$inlineNegateValue.on("click",this.showNegateDropdown.bind(this)),$("#filterBarInlineAddButton").on("focus",function(){i.resumeFocus()}),$("#filterBarInlineAddButton .imageButton").on("focus",function(){i.resumeFocus()}),this.listenTo(this.model.get("timeline"),"change:filters",this.renderFilterItems),this.inlineAddScopeField.setOptions(this.scopeList()),this.listenTo(this.model,"change:template",function(){i.scopeOptionsList=null,i.inlineAddScopeField.setOptions(i.scopeList())}),$(".manageFilterIcon").on("click",function(){i.manageFilterClicked()}),$(".clearFilterIcon").on("click",this.clearFilterClicked.bind(this)),$("#filterBarInlineAddButton").on("click",this.addClicked.bind(this))},configureManageFilterMenu:function(e){var i,t=JSON.parse(e),n=[{id:"save",text:"Save..."},{id:"load",text:"Load",items:[]},{id:"delete",text:"Delete",items:[]}];for(i=0;i<t.length;i++)n[1].items.push({id:"load"+i,text:t[i]}),n[2].items.push({id:"delete"+i,text:t[i]});0==t.length&&(n[1].disabled=!0,n[2].disabled=!0),this.manageFilterMenu?(this.manageFilterMenu.clearAll(),this.manageFilterMenu.loadStruct(n)):(this.manageFilterMenu=new dhtmlXMenuObject({context:!0,items:n}),this.manageFilterMenu.setAutoShowMode(!1),this.manageFilterMenu.setAutoHideMode(!0),this.manageFilterMenu.setContextMenuHideAllMode(!1),this.manageFilterMenu.attachEvent("onClick",this.manageFilterMenuItemClick.bind(this)))},valueFieldFocused:function(){this.inlineAddValueField.setOptions(this.createValueList()),this.inlineAddScopeField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown()},scopeFieldFocused:function(){this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown()},resumeFocus:function(){var e=this,i=this.model.get("timeline").get("filters");this.d3InlineAdd.classed("focus",!0),this.d3InlineLogicDiv.classed("hide",0==i.length),this.$backdrop||(this.$backdrop=$('<div class="filterBackdrop"/>'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){e.removeFocus()})),this.adjustFilterSize()},removeFocus:function(){this.d3InlineAdd.classed("focus",!1),this.$backdrop&&(this.$backdrop.remove(),this.$backdrop=null),this.adjustFilterSize(),this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown(),this.focusHasResumed=!1},renderFilterItems:function(){var e=this,i=this.model.get("timeline").get("filters");this.d3Items.html(this.itemsTemplate({items:i})),this.d3Items.selectAll(".remove").data(i).on("click",function(i){e.removeItem(i.uniqueId)}),this.adjustFilterSize()},adjustFilterSize:function(){window.mainApp.adjustFilterBar(!1)},showLogicDropdown:function(){var e=this;this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideNegateDropdown(),this.d3InlineLogicOptions.classed("active",function(i){return i==e.chosenLogic}).classed("highlight",function(i,t){return i==e.chosenLogic}),e.$logicDropdown.slideDown(250)},hideLogicDropdown:function(){this.$logicDropdown.slideUp(250)},logicOptionClick:function(e){this.chosenLogic=e,this.$inlineLogicValue.text(e),this.hideLogicDropdown()},showNegateDropdown:function(){var e=this;this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.d3InlineNegateOptions.classed("active",function(i){return i==e.chosenNegate}).classed("highlight",function(i,t){return i==e.chosenNegate}),e.$negateDropdown.slideDown(250)},hideNegateDropdown:function(){this.$negateDropdown.slideUp(250)},negateOptionClick:function(e){this.chosenNegate=e,this.$inlineNegateValue.text(e),this.hideNegateDropdown()},scopeList:function(){if(!this.scopeOptionsList){var e=this.model.get("template"),i=["Title","Color","Entity","Tag"];_.each(e.properties,function(e){i.push(e.name)},this),_.each(e.types,function(e){i.push(e.name),_.each(e.roles,function(t){t.name!=e.name&&i.push(t.name)},this)},this),_.each(e.rangeProperties,function(e){i.push(e.name)},this),i.sort(),this.scopeOptionsList=i}return this.scopeOptionsList},lookupScope:function(e){var i=this.scopeList();return e.length>0&&(match=_.find(i,function(i){return ATUtilities.caseInsensitiveStartsWith(i,e)})),{match:match,list:i}},createValueList:function(){var e,i=this.model.get("template"),t=this.model.get("timeline"),n=t.get("entities").models,l=this.inlineAddScopeField.values().suggestion,s=!1;return options=[],match=null,type=null,prop=null,"Color"===l&&(_.each(i.colors,function(e){options.push(e.name)}),s=!0),"Entity"===l&&(_.each(n,function(e){options.push(e.get("name"))}),options.push("None"),s=!0),"Tag"===l&&(e=this.model.get("tags"),_.each(e,function(e){options.push(e)}),s=!0),s||(_.each(i.types,function(e){var i;e.name==l?type=e:(i=_.find(e.roles,function(e){return e.name==l}),i&&(type=e))},this),type&&(_.each(n,function(e){e.get("type")==type.name&&options.push(e.get("name"))}),options.push("None"),s=!0)),s||(prop=_.find(i.properties,function(e){return e.name==l}),prop&&"boolean"==prop.type&&(options.push("Yes"),options.push("No"),s=!0)),options},lookupValue:function(e){var i=this.createValueList();return i.length?(e.length>0&&(match=_.find(i,function(i){return ATUtilities.caseInsensitiveStartsWith(i,e)})),{match:match,list:i}):{match:e,list:[e]}},addClicked:function(){var e=this.inlineAddScopeField.values().suggestion,i=this.inlineAddValueField.values().suggestion,t=this.chosenLogic+("NOT"==this.chosenNegate?" NOT":""),n=this.inlineAddScopeField.isInputValid()&&this.inlineAddValueField.isInputValid();return n?(window.ApplicationInterface&&window.ApplicationInterface.addFilterItem(window.timelineDocumentId,e,i,t),this.removeFocus(),this.inlineAddScopeField.clear(),this.inlineAddValueField.clear(),this.logicOptionClick("AND"),this.negateOptionClick("HAS")):0==this.inlineAddScopeField.isInputValid()?this.inlineAddScopeField.focusClickHandler():0==this.inlineAddValueField.isInputValid()&&this.inlineAddValueField.focusClickHandler(),!1},removeItem:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e)},manageFilterClicked:function(){var e=this;if(this.manageFilterMenu){var i=$(".manageFilterIcon"),t=i.offset(),n=this.model.get("timeline").get("filters");t.bottom=t.top+i.innerHeight(),0==n.length?this.manageFilterMenu.setItemDisabled("save"):this.manageFilterMenu.setItemEnabled("save"),setTimeout(function(){e.manageFilterMenu.showContextMenu(t.left,t.bottom)})}else window.ApplicationInterface&&window.ApplicationInterface.manageFilters()},manageFilterMenuItemClick:function(e,i,t){var n=this.manageFilterMenu.getParentId(e),l=this.manageFilterMenu.getItemText(e);return"save"==e?(window.mainApp.showSaveFilterModal(),!1):(window.ApplicationInterface&&("load"==n?window.ApplicationInterface.loadSavedFilter(window.timelineDocumentId,l):"delete"==n&&window.ApplicationInterface.deleteSavedFilter(window.timelineDocumentId,l)),!1)},boundsForManageIcon:function(){var e=$(".manageFilterIcon"),i=null;return e&&(i=e[0].getBoundingClientRect()),i?i.left+" "+i.right+" "+i.bottom+" "+i.top:""},clearFilterClicked:function(){var e=this.model.get("timeline").get("filters");window.ApplicationInterface&&_.each(e,function(e){window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e.uniqueId)},this)}});module.exports=ATFilterBarView;
},{"../lib/dhtmlxmenu":5,"./ATAutoSuggestField":15,"./ATUtilities":91,"./templates/filterBarItemsTemplate.html":142,"./templates/filterBarTemplate.html":143,"backbone":176,"d3":300,"jquery":307,"lodash":309}],50:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/findReplaceTemplate.html"),ATFindReplaceView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$findInput=$("#findInput"),this.$replaceInput=$("#replaceInput"),this.$eventTitles=$("#eventTitlesCheckbox"),this.$eventProperties=$("#eventPropertiesCheckbox"),this.$tags=$("#tagsCheckbox"),this.$entityNames=$("#entityNamesCheckbox"),this.$bookmarks=$("#bookmarksCheckbox"),this.$submitButton=$("#findReplaceSubmit"),this.$eventTitles.prop("checked",!0),this.$eventProperties.prop("checked",!0),this.$tags.prop("checked",!0),this.$entityNames.prop("checked",!0),this.$bookmarks.prop("checked",!0),$("#findReplaceForm").on("submit",this.okClickHandler.bind(this)),$("#findReplaceCancel").on("click",this.cancelClickHandler.bind(this)),this.$findInput.on("input",this.validate.bind(this)),this.$replaceInput.on("input",this.validate.bind(this)),this.$eventTitles.on("click",this.validate.bind(this)),this.$eventProperties.on("click",this.validate.bind(this)),this.$tags.on("click",this.validate.bind(this)),this.$entityNames.on("click",this.validate.bind(this)),this.$bookmarks.on("click",this.validate.bind(this))},resetForm:function(){this.$findInput.val(""),this.$replaceInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectFieldIfUnfocused.bind(this),500)},focusAndSelectFieldIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$findInput.val(e),this.$findInput.focus(),this.$findInput[0].setSelectionRange(t,t),this.$earlyInputCatcher.removeClass("activeCatcher")},validate:function(){var e=this.$findInput.val(),t=this.$replaceInput.val(),i=this.$eventTitles.prop("checked"),n=this.$eventProperties.prop("checked"),s=this.$tags.prop("checked"),a=this.$entityNames.prop("checked"),c=this.$bookmarks.prop("checked"),h=!1;e&&t&&(i||n||s||a||c)&&(h=!0),this.$submitButton.prop("disabled",!h)},cancelClickHandler:function(e){return window.mainApp.removeExistingModal(),e.preventDefault(),!1},okClickHandler:function(e){if(window.ApplicationInterface){var t=this.$findInput.val(),i=this.$replaceInput.val(),n=this.$eventTitles.prop("checked"),s=this.$eventProperties.prop("checked"),a=this.$tags.prop("checked"),c=this.$entityNames.prop("checked"),h=this.$bookmarks.prop("checked");t&&i&&(n||s||a||c||h)&&window.ApplicationInterface.findAndReplace(window.timelineDocumentId,t,i,n,s,a,c,h)}return window.mainApp.removeExistingModal(),e.preventDefault(),!1}});module.exports=ATFindReplaceView;
},{"./templates/findReplaceTemplate.html":144,"backbone":176,"d3":300,"jquery":307,"lodash":309}],51:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/iconContextMenuTemplate.html"),ATIconContextMenu=Backbone.View.extend({setOptions:function(t){this.rawOptions=t.slice(),this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(i){return i.value==t},this),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.value:null},initialize:function(){var t=this.$el.attr("id"),i=t+"-list",e=_.template(templateHtml),s=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),this.allowNewItems=!0,this.createNewText="",this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.$el.html(e({elementName:t})),this.d3El=d3.select("#"+t),this.d3El.classed("iconContextMenu bselect-dropdown",!0).style("display","none"),this.$el.keydown(function(t){return s.divKeyDownHandler(t)}).on("focus",function(){s.focusHandler()}).on("blur",function(){s.blurHandler()}),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",i),this.$list=$("#"+i),this.$list.on("scroll",this.listScrollHandler.bind(this))},show:function(t,i,e){this.highlightIndex=-1,this.renderOptions();var s=this.$el.attr("id"),n=s+"-list",h=(this.selectedOption?n+"-"+this.selectedOption.value:null,t.offset()),l={width:t.outerWidth(),height:t.outerHeight()},o={width:$(window).width(),height:$(window).height()},c={width:this.$el.width(),height:this.$el.height()},d=isNaN(i)||isNaN(e)?{left:Math.min(h.left,o.width-c.width-5),top:h.top+l.height}:{left:Math.min(h.left+i,o.width-c.width-5),top:h.top+e};d.top+c.height>o.height-10?(this.d3El.style("left",d.left+"px"),this.d3El.style("bottom",o.height-d.top+4+"px"),this.d3El.style("top",null)):(this.d3El.style("left",d.left+"px"),this.d3El.style("top",d.top+"px"),this.d3El.style("bottom",null)),this.d3El.classed("open",!0),this.$el.slideDown(250),this.open=!0},hide:function(){this.$el.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id"),s=e+"-list";i.attr("id",function(t){return s+"-"+t.value}).classed("active",function(i){return t.selectedOption?i.value==t.selectedOption.value:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).select("span").html(function(t){return'<i class="fa fa-'+t.icon+'"></i> '+t.label}),i.enter().append("li").attr("id",function(t){return s+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return t.selectedOption?i.value==t.selectedOption.value:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}).append("span").html(function(t){return'<i class="fa fa-'+t.icon+'"></i> '+t.label}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=t+"-list",e=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,s=e?i+"-"+e.value:null,n=null;if(s){n=$("#"+s);var h=this.$list.scrollTop(),l=this.$list.height(),o=n.position()?n.position().top:0,c=n.height();searchBottom=5,(o<searchBottom||o+c>l+searchBottom)&&this.$list.scrollTop(h-searchBottom+o-l/2+c/2)}},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(i){return i.value==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;if(this.open)switch(i){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0}return this.renderOptions(),!e},focusHandler:function(){this.open&&(this.focusHasResumed=!0)},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0)},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATIconDropDownGlobalTimeout&&clearTimeout(ATIconDropDownGlobalTimeout),ATIconDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},200)},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATIconDropDownGlobalTimeout=null}});module.exports=ATIconContextMenu;
},{"./templates/iconContextMenuTemplate.html":145,"backbone":176,"d3":300,"jquery":307,"lodash":309}],52:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/importCsvTemplate.html"),firstPageHtml=require("./templates/importCsvFirstPageTemplate.html"),secondPageHtml=require("./templates/importCsvSecondPageTemplate.html"),ATImportCsvView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.page1Template=_.template(firstPageHtml),this.page2Template=_.template(secondPageHtml),this.page=1,this.importCsvColumns={headers:[],options:[]},this.d3El=d3.select("#"+t),this.d3El.html(e()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.d3ContentDiv=d3.select("#importCsvContent"),this.$cancelButton=$("#importCsvCancel"),this.$previousButton=$("#importCsvPrevious"),this.$nextButton=$("#importCsvNext"),$("#importCsvCancel").on("click",this.cancelBtnHandler.bind(this)),$("#importCsvPrevious").on("click",this.previousBtnHandler.bind(this)),$("#importCsvForm").on("submit",this.nextBtnHandler.bind(this)),this.renderPage1()},configureAsPage1:function(){this.page=1,this.renderPage1()},configureAsPage2:function(t,e){this.importCsvColumns.headers=t,this.page=2,this.renderPage2(e)},renderPage1:function(){1==this.page?(this.d3ContentDiv.html(this.page1Template()),this.$delimiterCommaInput=$("#importCsvDelimiterInputComma"),this.$headerRowInput=$("#importCsvHeaderRow"),this.$nextButton.attr("value","Next"),this.$previousButton.attr("disabled",!0),this.$nextButton.attr("disabled",!1)):this.d3ContentDiv.html("An error has occurred")},renderPage2:function(t){var e=this,i=[],o=[];return 2!=this.page?void this.d3ContentDiv.html("An error has occurred"):(_.each(t.properties,function(t){i.push(t.name)}),_.each(t.types,function(t){_.each(t.roles,function(t){o.push(t.name)})}),this.importCsvColumns.options=[],this.importCsvColumns.options.push("Ignore this column","Title","Start","Duration","End","Color","Tags","Links"),this.importCsvColumns.options=this.importCsvColumns.options.concat(i),this.importCsvColumns.options=this.importCsvColumns.options.concat(o),this.d3ContentDiv.html(this.page2Template(this.importCsvColumns)),this.columnDropdowns={},_.each(this.importCsvColumns.headers,function(t){e.columnDropdowns[t]=new ATDropdown({el:"#csvImportOption_"+t.replace(/\W/g,"_")}),e.columnDropdowns[t].setValue("Ignore this column"),e.listenTo(e.columnDropdowns[t],"change",e.validateForm.bind(e))}),this.$nextButton.attr("value","Import"),this.$previousButton.attr("disabled",!1),void this.validateForm())},validateForm:function(){var t=[],e=[],i=!1,o=!1,n=!0,r=!1,s=this;if(_.each(this.importCsvColumns.headers,function(a){var l=s.columnDropdowns[a].getValue();"Ignore this column"!==l&&(_.contains(t,l)&&(n=!1,r=!0,_.contains(e,l)||e.push(l)),t.push(l),"Title"===l&&(i=!0),"Start"===l&&(o=!0))}),i&&o||(n=!1),i)if(o)if(r===!0){for(var a="Error: Duplicate copies of: ",l=0;l<e.length;l++)a+=l==e.length-1?'"'+e[l]+'".':'"'+e[l]+'", ';$("#errorFieldImportCsv").text(a)}else $("#errorFieldImportCsv").empty();else $("#errorFieldImportCsv").text("A column for Start Date must be selected.");else $("#errorFieldImportCsv").text("A column for Title must be selected.");return this.$nextButton.prop("disabled",!n),n},cancelBtnHandler:function(t){return window.mainApp.removeExistingModal(),t.preventDefault(),!1},previousBtnHandler:function(t){return this.page>1&&(this.page--,this.renderPage1()),t.preventDefault(),!1},nextBtnHandler:function(t){var e=this;if(1==this.page){if(window.ApplicationInterface){var i=this.$delimiterCommaInput.is(":checked"),o=this.$headerRowInput.is(":checked");window.ApplicationInterface.importCsvFirstModal(window.timelineDocumentId,i,o)}}else if(2==this.page){var n=[];if(!this.validateForm())return t.preventDefault(),!1;_.each(this.importCsvColumns.headers,function(t){var i=t,o=e.columnDropdowns[t].getValue();"Ignore this column"!=o&&n.push({header:i,option:o})});var r=JSON.stringify(n);window.ApplicationInterface&&window.ApplicationInterface.importCsvSecondModal(window.timelineDocumentId,r),window.mainApp.removeExistingModal()}return t.preventDefault(),!1}});module.exports=ATImportCsvView;
},{"./ATDropdown":29,"./templates/importCsvFirstPageTemplate.html":146,"./templates/importCsvSecondPageTemplate.html":147,"./templates/importCsvTemplate.html":148,"backbone":176,"d3":300,"jquery":307,"lodash":309}],53:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorListView=require("./ATInspectorListView"),templateHtml=require("./templates/linkPageTemplate.html"),addLinkHtml=require("./templates/addLinkTemplate.html"),bootstrap=require("bootstrap"),ATInspectorLinkPageView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.addLinkTemplate=_.template(addLinkHtml),this.d3El=d3.select("#"+this.elementName),this.editingLinkIndex=-1,this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate()},renderTemplate:function(){var e=this.elementName+"-links";this.d3El.html(this.elTemplate()),this.d3ListElement=this.d3El.select(".links").attr("id",e),this.listView=new ATInspectorListView({el:"#"+e}),this.listView.setUseExternalLinkTemplate(!0),this.listView.setListId(0),this.listView.setAddCallback(this.addClicked.bind(this)),this.listView.setEditCallback(this.editClicked.bind(this)),this.listView.setRemoveCallback(this.removeClicked.bind(this)),this.listView.setQuicklookCallback(this.quicklookClicked.bind(this)),this.listView.setRevealCallback(this.revealClicked.bind(this)),this.listView.setOpenCallback(this.openClicked.bind(this))},render:function(){var e=this.model.get("eventData"),t=e.externalLinks,i=[],n=0;this.currentEventIds=e.eventIds,_.each(t,function(e){i.push({id:n,title:e.description,extra:e.filepath,quicklookDisabled:!1,revealDisabled:e.isWebLink,openDisabled:!1}),n++},this),this.listView.render(i),this.listView.setDisabled(!e.enabled)},addClicked:function(e,t){var i=this;this.removeExistingPopover(),this.sourceElement=t,t.popover({content:this.addLinkTemplate(),title:'<span>Add External Link</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),o=i.height(),s=(i.width(),312*window.mainApp.timelineView.physicalScaleFactor),a=50,l=n.offset();return l.top+s+a<o?"bottom":l.top-s-a>0?"top":l.left-a>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(t),this.adjustPopoverTabbing(),$("#addLink-delete").css("display","none"),$("#addLink-browse").on("click",function(){i.popoverBrowseClick()}),$("#addLink-form").on("submit",function(){return i.popoverSubmit(),!1}),$("#popoverClose").on("click",function(){i.removeExistingPopover()})},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},adjustPopoverTabbing:function(){var e=this,t=$(".popover").find("select, input, textarea, button, div.bselect"),i=t.first();t.last();i.focus(),t.on("keydown",function(t){var i=t.keycode||t.which;9===i?e.tabNext(t):27===i&&(e.removeExistingPopover(),t.preventDefault())})},tabNext:function(e){var t=$(".popover").find('.pure-modal-field > select, .pure-modal-field > input[type="text"], .pure-modal-field > textarea, .pure-modal-field > div.bselect').filter(":visible"),i=_.indexOf(t,e.target);-1==i?(e.preventDefault(),t.first().focus()):!e.shiftKey&&i>=t.length-1?(e.preventDefault(),t.first().focus()):e.shiftKey&&0==i&&(e.preventDefault(),t.last().focus())},popoverBrowseClick:function(){this.removeExistingPopover(),window.ApplicationInterface&&window.ApplicationInterface.selectedEventsBrowseExternalLink(window.timelineDocumentId,this.currentEventIds.join())},popoverSubmit:function(){var e=$("#addLinkPath").val(),t=this.model.get("eventData"),i=t.externalLinks,n=$("#addLinkDescription").val();return e?(""===n&&(n=e),window.ApplicationInterface&&this.editingLinkIndex>=0&&this.editingLinkIndex<i.length&&window.ApplicationInterface.selectedEventsRemoveExternalLink(window.timelineDocumentId,this.currentEventIds.join(),i[this.editingLinkIndex].filepath),window.ApplicationInterface&&e&&window.ApplicationInterface.selectedEventsAddExternalLink(window.timelineDocumentId,this.currentEventIds.join(),e,n),this.removeExistingPopover(),!1):(this.removeExistingPopover(),!1)},editClicked:function(e,t,i){var n=this,o=this.model.get("eventData"),s=o.externalLinks,a=s[t];this.removeExistingPopover(),this.editingLinkIndex=t,this.sourceElement=i,i.popover({content:this.addLinkTemplate(),title:'<span>Add External Link</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),o=i.height(),s=(i.width(),312*window.mainApp.timelineView.physicalScaleFactor),a=50,l=n.offset();return l.top+s+a<o?"bottom":l.top-s-a>0?"top":l.left-a>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(i),this.adjustPopoverTabbing(),$("#addLinkPath").val(a.filepath),$("#addLinkDescription").val(a.description),$("#addLink-browse").on("click",function(){n.popoverBrowseClick()}),$("#addLink-delete").on("click",function(){return n.removeClicked(e,t,i),!1}),$("#addLink-form").on("submit",function(){return n.popoverSubmit(),!1}),$("#popoverClose").on("click",function(){n.removeExistingPopover()})},removeClicked:function(e,t,i){var n=this.model.get("eventData"),o=n.externalLinks;window.ApplicationInterface&&t>=0&&t<o.length&&window.ApplicationInterface.selectedEventsRemoveExternalLink(window.timelineDocumentId,this.currentEventIds.join(),o[t].filepath),this.removeExistingPopover()},quicklookClicked:function(e,t,i){var n=this.model.get("eventData"),o=n.externalLinks;window.ApplicationInterface&&t>=0&&t<o.length&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(o),t)},revealClicked:function(e,t,i){var n=this.model.get("eventData"),o=n.externalLinks;window.ApplicationInterface&&t>=0&&t<o.length&&window.ApplicationInterface.revealExternalLink(window.timelineDocumentId,o[t].filepath)},openClicked:function(e,t,i){var n=this.model.get("eventData"),o=n.externalLinks;window.ApplicationInterface&&t>=0&&t<o.length&&window.ApplicationInterface.openExternalLink(window.timelineDocumentId,o[t].filepath,o[t].isWebLink)},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove(),this.editingLinkIndex=-1}});module.exports=ATInspectorLinkPageView;
},{"./ATInspectorListView":54,"./templates/addLinkTemplate.html":98,"./templates/linkPageTemplate.html":150,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],54:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/listTemplate.html"),displayOnlyTemplateHtml=require("./templates/listDisplayOnlyTemplate.html"),linkTemplateHtml=require("./templates/externalLinkListTemplate.html"),bootstrap=require("bootstrap"),ATInspectorListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.linkTemplate=_.template(linkTemplateHtml),this.displayOnlyTemplate=_.template(displayOnlyTemplateHtml),this.useTemplate=this.elTemplate,this.titleClickCallback=null,this.d3El=d3.select("#"+this.elementName),this.useExternalLinkTemplate=!1,this.render([])},setUseRegularTemplate:function(){this.useTemplate=this.elTemplate},setUseExternalLinkTemplate:function(){this.useTemplate=this.linkTemplate},setUseDisplayOnlyTemplate:function(){this.useTemplate=this.displayOnlyTemplate},setTitleClickCallback:function(e){this.titleClickCallback=e},render:function(e){var t=this;this.d3El.html(this.useTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var l=this.elementName+"-item"+e.id;this.d3El.select(".remove-"+e.id).attr("id",l+"-remove").on("click",function(){t.removeClick(e.id)}),this.d3El.select(".edit-"+e.id).attr("id",l+"-edit").on("click",function(){t.editClick(e.id)}),this.d3El.select(".quicklook-"+e.id).attr("id",l+"-quicklook").on("click",function(){t.quicklookClick(e.id)}),this.d3El.select(".reveal-"+e.id).attr("id",l+"-reveal").on("click",function(){t.revealClick(e.id)}),this.d3El.select(".open-"+e.id).attr("id",l+"-open").on("click",function(){t.openClick(e.id)}),this.d3El.select(".title-"+e.id).attr("id",l+"-title").classed("clickable",null!=this.titleClickCallback).on("click",function(){t.titleClick(e.id)})},this)},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setListId:function(e){this.listId=e},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setEditCallback:function(e){this.editCallback=e},setQuicklookCallback:function(e){this.quicklookCallback=e},setRevealCallback:function(e){this.revealCallback=e},setOpenCallback:function(e){this.openCallback=e},addClick:function(){this.addCallback&&this.addCallback(this.listId,$("#"+this.elementName+"-add"))},removeClick:function(e){var t=this.elementName+"-item"+e+"-edit";this.removeCallback&&this.removeCallback(this.listId,e,$("#"+t))},editClick:function(e){var t=this.elementName+"-item"+e+"-edit";this.editCallback&&this.editCallback(this.listId,e,$("#"+t))},quicklookClick:function(e){var t=this.elementName+"-item"+e+"-quicklook";this.quicklookCallback&&this.quicklookCallback(this.listId,e,$("#"+t))},revealClick:function(e){var t=this.elementName+"-item"+e+"-reveal";this.revealCallback&&this.revealCallback(this.listId,e,$("#"+t))},openClick:function(e){var t=this.elementName+"-item"+e+"-open";this.openCallback&&this.openCallback(this.listId,e,$("#"+t))},titleClick:function(e){this.titleClickCallback&&this.titleClickCallback(e)}});module.exports=ATInspectorListView;
},{"./templates/externalLinkListTemplate.html":141,"./templates/listDisplayOnlyTemplate.html":151,"./templates/listTemplate.html":152,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],55:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATCalendar=require("./ATCalendar"),ATInspectorModel=Backbone.Model.extend({defaults:function(){return{template:{types:[{id:1,name:"Arc",roles:[{id:2,name:"Arc",multiplePerEvent:!1}]},{id:3,name:"Person",roles:[{id:4,name:"Observer",multiplePerEvent:!0}]}],rangeProperties:[{id:6,name:"Date",type:"date",calendar:new ATCalendar.prototype.DefaultCalendar}],properties:[{id:8,name:"Summary",type:"multitext"}],colors:[{id:1e4,name:"Red",color:"#ff0000"},{id:10001,name:"Green",type:"#00ff00"},{id:10002,name:"Blue",type:"#0000ff"}],validPropertyTypes:[],validRangeTypes:[]},eventData:{enabled:!1,parentId:-1,eventIds:[]},entitiesByType:{},tags:[]}}});module.exports=ATInspectorModel;
},{"./ATCalendar":17,"backbone":176,"d3":300,"jquery":307,"lodash":309}],56:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/propertyPageTemplate.html"),ignore2=require("jquery-ui/autocomplete"),ignore=require("../lib/bootstrap-tokenfield"),ATInspectorPropertyPageView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this;this.elTemplate=_.template(templateHtml),this.d3El=d3.select("#"+e),this.listenTo(this.model,"change:template",function(){t.renderTemplate(),t.render()}),this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate(),this.render()},renderTemplate:function(){var e=this,t=this.model.get("template").properties;this.$lastElement=null,this.$lastMultilineElement=null,this.$tagField&&(this.$tagField.tokenfield("destroy"),this.$tagField=null),this.$inputViews={},this.$checkboxes={},this.d3El.html(this.elTemplate({properties:t})),this.$tagField=$("#inspectorTagsField"),this.$tagField.tokenfield({createTokensOnBlur:!0}),this.$tagField.on("tokenfield:createdtoken",this.addTagHandler.bind(this)),this.$tagField.on("tokenfield:removedtoken",this.removeTagHandler.bind(this)),this.$tagField.on("tokenfield:editedtoken",this.editTagHandler.bind(this)),_.each(t,function(t){var i="inspector-property-"+t.propertyId,n=$("#"+i);"string"==t.type||"text"==t.type||"number"==t.type||"decimal"==t.type||"percentage"==t.type||"currency"==t.type||"multitext"==t.type||"richtext"==t.type?(e.$inputViews[t.propertyId]=n,"multitext"!=t.type&&"richtext"!=t.type?n.blurOnEnter():this.$lastMultilineElement=n,n.on("input",function(){e.inputHandler(t.propertyId)}),n.on("blur",function(){e.blurHandler(t.propertyId)})):"boolean"==t.type&&(e.$checkboxes[t.propertyId]=n,n.on("change",function(){e.changeHandler(t.propertyId)})),this.$lastElement=n},this),this.resizeMultilineElement()},resizeMultilineElement:function(){if(this.$lastMultilineElement&&this.$lastElement){var e=this.$el.parent(),t=this.$lastElement.parent().parent(),i=e.offset().top+e.height(),n=this.$lastMultilineElement.height(),l=t.offset(),r=l?l.top+t.height():i,a=n+i-r-10,s=Math.max(a,120);this.$lastMultilineElement.css("min-height",s)}},render:function(){var e=this.model.get("eventData"),t=this.model.get("tags"),i=e.values?e.values:{};this.currentEventIds=e.eventIds,this.insideRender=!0,this.$tagField.tokenfield("setTokens",e.tags?e.tags:[]),this.$tagField.data("bs.tokenfield").$input.autocomplete({source:t?t:[]}),_.each(this.$inputViews,function(t,n){var l=e.allowEditProperty?e.allowEditProperty[n]:!1;if(i[n]){var r=this.model.get("template").properties,a="unknown";_.each(r,function(e){e.propertyId==n&&(a=e.type)},this),"number"==a?t.val(parseInt(i[n].value)):"currency"==a?t.val(parseFloat(i[n].value).toFixed(2)):"percentage"==a?t.val(parseInt(i[n].value)):t.val(i[n].value)}else t.val("");t.prop("disabled",!e.enabled||!l)},this),_.each(this.$checkboxes,function(t,n){var l=e.allowEditProperty?e.allowEditProperty[n]:!1;i[n]&&1==i[n].value?t.prop("checked",!0):t.prop("checked",!1),t.prop("disabled",!e.enabled||!l)},this),e.enabled?this.$tagField.tokenfield("enable"):this.$tagField.tokenfield("disable"),this.resizeMultilineElement(),this.insideRender=!1},changeHandler:function(e){if(this.$checkboxes[e]&&window.ApplicationInterface){var t=this.$checkboxes[e].is(":checked");window.ApplicationInterface.selectedEventsValueChanged(window.timelineDocumentId,this.currentEventIds.join(),t?"1":"0",e)}},inputHandler:function(e){this.$inputViews[e]&&(this.recordedInputPropertyId=e,this.recordedInputValue=this.$inputViews[e].val(),this.recordedInputEvents=this.currentEventIds)},blurHandler:function(e){null!==this.recordedInputValue&&void 0!==this.recordedInputValue&&e==this.recordedInputPropertyId&&this.$inputViews[e]&&window.ApplicationInterface&&window.ApplicationInterface.selectedEventsValueChanged(window.timelineDocumentId,this.recordedInputEvents.join(),this.recordedInputValue,e),this.recordedInputValue=null,this.recordedInputPropertyId=null},addTagHandler:function(e){this.insideRender||window.ApplicationInterface&&window.ApplicationInterface.selectedEventsAddTags(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value)},removeTagHandler:function(e){var t=e.attrs.length;this.insideRender||window.ApplicationInterface&&(t>1?_.each(e.attrs,function(e){window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,this.currentEventIds.join(),e.value)},this):window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value))},editTagHandler:function(e){this.insideRender||window.ApplicationInterface&&window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value)}});module.exports=ATInspectorPropertyPageView;
},{"../lib/bootstrap-tokenfield":3,"./templates/propertyPageTemplate.html":160,"backbone":176,"d3":300,"jquery":307,"jquery-ui/autocomplete":302,"lodash":309}],57:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),ATTimeSpan=require("./ATTimeSpan"),ATDurationPicker=require("./ATDurationPicker"),ATDropdown=require("./ATDropdown"),ATRangeControlManager=require("./ATRangeControlManager"),ATInspectorListView=require("./ATInspectorListView"),ATSearchDropdown=require("./ATSearchDropdown"),templateHtml=require("./templates/rangePageTemplate.html"),addDependencyHtml=require("./templates/addDependencyTemplate.html"),bootstrap=require("bootstrap"),ATInspectorRangePageView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.addDependencyTemplate=_.template(addDependencyHtml),this.rangePropertyId=-1,this.d3El=d3.select("#"+this.elementName),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate()},setRangeId:function(e){this.rangePropertyId=e},setRangeConversion:function(e){this.rangeConversion=e,this.rangeControlManager&&this.rangeControlManager.setRangeConversion(e)},renderTemplate:function(){var e=this,t=this.elementName+"-predecessor",i=this.elementName+"-startDate",n=this.elementName+"-duration",s=this.elementName+"-endDate",o=this.elementName+"-successor",r=function(t,i){e.startChangeHandler(t,i,e.handlerEventIds)},a=function(t,i){e.endChangeHandler(t,i,e.handlerEventIds)},d=function(t){e.durationChangeHandler(t,e.handlerEventIds)};this.d3El.html(this.elTemplate({})),this.d3StartDate=this.d3El.select(".startDate").attr("id",i),this.startDatePickerView=new ATDatePicker({el:"#"+i}),this.d3EndDate=this.d3El.select(".endDate").attr("id",s),this.endDatePickerView=new ATDatePicker({el:"#"+s}),this.d3Duration=this.d3El.select(".duration").attr("id",n),this.durationPickerView=new ATDurationPicker({el:"#"+n}),this.rangeControlManager=new ATRangeControlManager(this.startDatePickerView,this.durationPickerView,this.endDatePickerView),this.rangeControlManager.setRangeConversion(this.rangeConversion),this.rangeControlManager.setStartChangeCallback(r),this.rangeControlManager.setEndChangeCallback(a),this.rangeControlManager.setDurationChangeCallback(d),this.startDatePickerView.setAllowEmptyValues(!1),this.endDatePickerView.setAllowEmptyValues(!1),this.startDatePickerView.setResetCallback(function(){window.setTimeout(e.resetStartDateField.bind(e),0)}),this.endDatePickerView.setResetCallback(function(){window.setTimeout(e.resetEndDateField.bind(e),0)}),this.d3predecessorList=this.d3El.select(".basedOn").attr("id",t),this.predecessorListView=new ATInspectorListView({el:"#"+t}),this.d3successorList=this.d3El.select(".successor").attr("id",o),this.successorListView=new ATInspectorListView({el:"#"+o}),this.predecessorListView.setListId(this.rangePropertyId),this.predecessorListView.setAddCallback(this.addPredecessorClicked.bind(this)),this.predecessorListView.setEditCallback(this.editPredecessorClicked.bind(this)),this.predecessorListView.setRemoveCallback(this.removePredecessorClicked.bind(this)),this.predecessorListView.setTitleClickCallback(this.goToPredecessorClicked.bind(this)),this.successorListView.setListId(this.rangePropertyId),this.successorListView.setAddCallback(this.addSuccessorClicked.bind(this)),this.successorListView.setEditCallback(this.editSuccessorClicked.bind(this)),this.successorListView.setRemoveCallback(this.removeSuccessorClicked.bind(this)),this.successorListView.setTitleClickCallback(this.goToSuccessorClicked.bind(this)),this.successorListView.setUseDisplayOnlyTemplate()},render:function(){var e=this.model.get("eventData"),t=e.rangeValues?e.rangeValues[this.rangePropertyId]:null,i=[],n=[],s=t?t.position:{value:null,precision:null},o=t?t.endPosition:{value:null,precision:null},r=t?t.span:"",a=(this.model.get("timeline"),e.allowEditStart&&e.enabled),d=e.allowEditDuration&&e.enabled,c=e.allowAddPredecessor&&e.enabled;this.handlerEventIds=e.eventIds,this.startDatePickerView.commit(),this.endDatePickerView.commit(),this.durationPickerView.commit(),this.currentEventIds=e.eventIds,t&&(_.each(t.predecessors,function(e){var t=ATTimeSpan.FromComponents(e.offset);i.push({actionIcon:"pencil-square-o",id:e.predecessorId,title:e.predecessorTitle,extra:t.toString()+" from "+(e.addToEnd?"end":"start")})},this),_.each(t.successors,function(e){var t=ATTimeSpan.FromComponents(e.offset);n.push({actionIcon:null,id:e.successorId,title:e.successorTitle,extra:t.toString()+" from "+(e.addToEnd?"end":"start")})},this)),this.predecessorListView.render(i),this.successorListView.render(n),this.startDatePickerView.setTimestamp(s.value,s.precision),this.endDatePickerView.setTimestamp(o.value,o.precision),this.durationPickerView.setDurationComponents(r),this.rangeControlManager.updateEndPicker(),this.durationPickerView.setDisabled(!d),this.startDatePickerView.setDisabled(!a),this.endDatePickerView.setDisabled(!d),this.predecessorListView.setDisabled(!c),this.successorListView.setDisabled(!c)},resetStartDateField:function(){var e=this.model.get("eventData"),t=e.rangeValues?e.rangeValues[this.rangePropertyId]:null,i=t?t.position:{value:null,precision:null};this.startDatePickerView.setTimestamp(i.value,i.precision),this.rangeControlManager.updateEndPicker()},resetEndDateField:function(){var e=this.model.get("eventData"),t=e.rangeValues?e.rangeValues[this.rangePropertyId]:null,i=t?t.endPosition:{value:null,precision:null};this.endDatePickerView.setTimestamp(i.value,i.precision),this.rangeControlManager.updateSpan()},startChangeHandler:function(e,t,i){if(this.startDatePickerView.getValid()&&window.ApplicationInterface&&i&&i.length){var n=""+e;window.ApplicationInterface.selectedEventsRangePositionChanged(window.timelineDocumentId,i.join(),n,t,this.rangePropertyId)}},endChangeHandler:function(e,t,i){if(console.log("ATInspectorRangePageView.endChangeHandler called..."),this.endDatePickerView.getValid()&&window.ApplicationInterface&&i&&i.length){var n=""+e;console.log("ATInspectorRangePageView.endChangeHandler: sending value "+n+" to C++"),window.ApplicationInterface.selectedEventsRangeEndPositionChanged(window.timelineDocumentId,i.join(),n,t,this.rangePropertyId)}},durationChangeHandler:function(e,t){window.ApplicationInterface&&t&&t.length&&window.ApplicationInterface.selectedEventsRangeSpanChanged(window.timelineDocumentId,t.join(),e,this.rangePropertyId)},addPredecessorClicked:function(e,t){this.editingPredecessor=!0,this.editingSuccessor=!1,this.addClicked(e,t)},addSuccessorClicked:function(e,t){this.editingPredecessor=!1,this.editingSuccessor=!0,this.addClicked(e,t)},addClicked:function(e,t){var i=this;this.editingRelationshipWithEventId=null,this.removeExistingPopover(),t.popover({content:this.addDependencyTemplate(),title:"<span>Add "+(this.editingPredecessor?"Predecessor":"Successor")+'</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=(i.width(),312*window.mainApp.timelineView.physicalScaleFactor),r=50,a=n.offset();return a.top+o+r<s?"bottom":a.top-o-r>0?"top":a.left-r>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(t),this.eventSearchDropdown=new ATSearchDropdown({el:"#addDependencyEvent"}),this.eventSearchDropdown.setSearchWordByWord(!0),this.updateEventSearchDropdown(),this.fromDropdown=new ATDropdown({el:"#addDependency-from"}),this.dependencyOffsetPickerView=new ATDurationPicker({el:"#addDependency-offset"}),this.dependencyOffsetPickerView.setRangeConversion(this.rangeConversion),this.adjustPopoverTabbing(),$("#addDependency-delete").css("display","none"),$("#addDependency-form").on("submit",function(){return i.popoverSubmitClick(),!1}),$("#popoverClose").on("click",function(){i.removeExistingPopover()})},editPredecessorClicked:function(e,t,i){this.editingPredecessor=!0,this.editingSuccessor=!1,this.editClicked(e,t,i)},editSuccessorClicked:function(e,t,i){this.editingPredecessor=!1,this.editingSuccessor=!0,this.editClicked(e,t,i)},editClicked:function(e,t,i){var n=this,s=this.model.get("eventData"),o=s.rangeValues?s.rangeValues[this.rangePropertyId]:null,r=this.editingPredecessor?o.predecessors:o.successors,a=this.editingPredecessor?"predecessorId":"successorId",d=null,c=!0,l=null;_.each(r,function(e){e[a]==t&&(d=e,c=e.addToEnd,l=ATTimeSpan.FromComponents(e.offset))}),this.removeExistingPopover(),this.editingRelationshipWithEventId=t,i.popover({content:this.addDependencyTemplate(),title:"<span>Edit "+(this.editingPredecessor?"Predecessor":"Successor")+'</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=(i.width(),312*window.mainApp.timelineView.physicalScaleFactor),r=50,a=n.offset();return a.top+o+r<s?"bottom":a.top-o-r>0?"top":a.left-r>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(i),this.eventSearchDropdown=new ATSearchDropdown({el:"#addDependencyEvent"}),this.eventSearchDropdown.setSearchWordByWord(!0),this.updateEventSearchDropdown(t),this.eventSearchDropdown.setValue(t),this.fromDropdown=new ATDropdown({el:"#addDependency-from"}),this.fromDropdown.setValue(c?0:1),this.dependencyOffsetPickerView=new ATDurationPicker({el:"#addDependency-offset"}),this.dependencyOffsetPickerView.setRangeConversion(this.rangeConversion),this.dependencyOffsetPickerView.setValue(l),$("#addDependency-delete").on("click",function(){return n.editingPredecessor?n.removePredecessorClicked(e,t,i):n.removeSuccessorClicked(e,t,i),!1}),this.adjustPopoverTabbing(),$("#addDependency-form").on("submit",function(){return n.popoverSubmitClick(),!1}),$("#popoverClose").on("click",function(){n.removeExistingPopover()})},addChildrenOfEventsToArray:function(e,t){var i=this;_.each(t,function(t){t.children.each(function(t){e.push(t),i.addChildrenOfEventsToArray(e,[t])})},this)},adjustPopoverTabbing:function(){var e=this,t=$(".popover").find("select, input, textarea, button, div.bselect"),i=t.first();t.last();i.focus(),t.on("keydown",function(t){var i=t.keycode||t.which;9===i?e.tabNext(t):27===i&&(e.removeExistingPopover(),t.preventDefault())})},tabNext:function(e){var t=$(".popover").find('.pure-modal-field > select, .pure-modal-field > input[type="text"], .pure-modal-field > textarea, .pure-modal-field > div.bselect').filter(":visible"),i=_.indexOf(t,e.target);-1==i?(e.preventDefault(),t.first().focus()):!e.shiftKey&&i>=t.length-1?(e.preventDefault(),t.first().focus()):e.shiftKey&&0==i&&(e.preventDefault(),t.last().focus())},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},popoverSubmitClick:function(){var e=this.eventSearchDropdown.getValue(),t=$("#addDependency-offset").val(),i=1==parseInt(this.fromDropdown.getValue());window.ApplicationInterface&&e&&(this.editingPredecessor?this.editingRelationshipWithEventId?window.ApplicationInterface.selectedEventsEditPredecessor(window.timelineDocumentId,this.currentEventIds.join(),this.editingRelationshipWithEventId,e,t,i,this.rangePropertyId):window.ApplicationInterface.selectedEventsAddPredecessor(window.timelineDocumentId,this.currentEventIds.join(),e,t,i,this.rangePropertyId):this.editingRelationshipWithEventId?window.ApplicationInterface.selectedEventsEditSuccessor(window.timelineDocumentId,this.currentEventIds.join(),this.editingRelationshipWithEventId,e,t,i,this.rangePropertyId):window.ApplicationInterface.selectedEventsAddSuccessor(window.timelineDocumentId,this.currentEventIds.join(),e,t,i,this.rangePropertyId)),this.removeExistingPopover()},updateEventSearchDropdown:function(e){var t=this.model.get("timeline").get("events").models,i=this.model.get("eventData").eventIds,n=this.fullAncestryList(i),s=_.union(i,n),o=_.clone(t),r=[];_.each(o,function(t){(!_.contains(s,t.id)&&this.validateDependencyLoop(s,t.id,!0)||t.id==e)&&r.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),this.addChildrenOfEventsToOptions(r,t,s,e)},this),r.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(i.length,n.length),o=0;for(o=0;s>o;o++)if(i[o]!=n[o])return i[o]-n[o];return i.length-n.length}),this.eventSearchDropdown.setOptions(r)},addChildrenOfEventsToOptions:function(e,t,i,n){var s=this;t.children.each(function(t){(!_.contains(i,t.id)&&s.validateDependencyLoop(i,t.id,!0)||t.id==n)&&e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),s.addChildrenOfEventsToOptions(e,t,i,n)})},validateDependencyLoop:function(e,t,i){var n=this.model.get("timeline"),s=n.get("events"),o=s.findChild(t),r=_.map(_.keys(o.get("dependencies")),function(e){return parseInt(e)}),a=o.children,d=!1,c=!1;return _.contains(e,t)?!1:(_.each(r,function(t){this.validateDependencyLoop(e,t,!1)||(d=!0)},this),a.each(function(t){this.validateDependencyLoop(e,t.id,!1)||(d=!0)},this),d?!1:!i||(_.each(e,function(e){var i=s.findChild(e),n=_.map(_.keys(i.get("dependencies")),function(e){return parseInt(e)});_.contains(n,t)&&(c=!0)},this),!c))},fullAncestryList:function(e){var t=this.model.get("timeline"),i=t.get("events"),n=[];return _.each(e,function(e){this.addAncestorsOfEventToList(i,e,n)},this),n},addAncestorsOfEventToList:function(e,t,i){var n=e.findChild(t),s=n.get("parentId");s>0&&(i.push(s),this.addAncestorsOfEventToList(e,s,i))},removePredecessorClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemovePredecessor(window.timelineDocumentId,this.currentEventIds.join(),t,this.rangePropertyId),this.removeExistingPopover()},removeSuccessorClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemoveSuccessor(window.timelineDocumentId,this.currentEventIds.join(),t,this.rangePropertyId),this.removeExistingPopover()},goToPredecessorClicked:function(e){window.mainApp.timeline.clearSelection(!0),window.mainApp.timeline.selectEventWithID(e),window.mainApp.timelineView.revealChildNode(e)},goToSuccessorClicked:function(e){window.mainApp.timeline.clearSelection(!0),window.mainApp.timeline.selectEventWithID(e),window.mainApp.timelineView.revealChildNode(e)},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove(),this.editingRelationshipWithEventId=null}});module.exports=ATInspectorRangePageView;
},{"./ATDatePicker":23,"./ATDropdown":29,"./ATDurationPicker":30,"./ATInspectorListView":54,"./ATRangeControlManager":70,"./ATSearchDropdown":77,"./ATTimeSpan":84,"./templates/addDependencyTemplate.html":94,"./templates/rangePageTemplate.html":161,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],58:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorListView=require("./ATInspectorListView"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/rolePageTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),addRoleHtml=require("./templates/addRoleTemplate.html"),bootstrap=require("bootstrap"),ATInspectorRolePageView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.optionsTemplate=_.template(optionsHtml),this.addRoleTemplate=_.template(addRoleHtml),this.d3Elements={},this.listViews={},this.dropdowns={},this.d3El=d3.select("#"+this.elementName),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:entitiesByType",this.renderEntities),this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate()},renderTemplate:function(){var e=this,t=[];this.d3Elements={},this.listViews={},this.dropdowns={},_.each(this.model.get("template").types,function(e){_.each(e.roles,function(e){e.roleId||(e.roleId=e.id),t.push(e)},this)},this),this.d3El.html(this.elTemplate({roles:t})),this.entitySearchContextMenu=new ATSearchableContextMenu({el:"#inspectorRoleEntitySearch"}),this.listenTo(this.entitySearchContextMenu,"change",this.contextEntityClick.bind(this)),_.each(t,function(t){var i=this.elementName+"-"+t.roleId;this.d3Elements[t.roleId]=this.d3El.select(".role_"+t.roleId).attr("id",i),t.multiplePerEvent?(this.listViews[t.roleId]=new ATInspectorListView({el:"#"+i}),this.listViews[t.roleId].setListId(t.roleId),this.listViews[t.roleId].setAddCallback(this.addClicked.bind(this)),this.listViews[t.roleId].setEditCallback(this.editClicked.bind(this)),this.listViews[t.roleId].setRemoveCallback(this.removeClicked.bind(this))):(this.dropdowns[t.roleId]=new ATDropdown({el:"#"+i}),this.listenTo(this.dropdowns[t.roleId],"change",function(){e.selectChangeHandler(t.roleId)}))},this),this.renderEntities()},renderEntities:function(){var e=this.model.get("template").types,t=this.model.get("entitiesByType");_.each(e,function(e){var i=t[e.name],n=[{name:"None",value:-1}];_.each(i,function(e){n.push({name:e.name,value:e.entityId})}),_.each(e.roles,function(e){e.multiplePerEvent||this.dropdowns[e.roleId].setOptions(n)},this)},this),this.render()},render:function(){var e=this.model.get("eventData");this.model.get("template").types;this.currentEventIds=e.eventIds,_.each(this.listViews,function(t,i){var n=e.relationshipsPerRole?e.relationshipsPerRole[i]:[],s=[];_.each(n,function(e){s.push({actionIcon:null,id:e.entityId,title:e.entityName,extra:e.entityAge})},this),t.render(s),t.setDisabled(!e.enabled)},this),_.each(this.dropdowns,function(t,i){var n=e.relationshipsPerRole?e.relationshipsPerRole[i]:[];n&&n[0]?t.setValue(n[0].entityId):t.setValue(-1),t.setDisabled(!e.enabled)},this),this.entitySearchContextMenu.hide()},addClicked:function(e,t){var i=this.model.get("template").types,n=_.find(i,function(t){return _.find(t.roles,function(t){return t.roleId==e})});_.find(n.roles,function(t){return t.roleId==e});this.sourceElement=t,this.editingRoleId=e,this.updateEntitySearchDropdown(e),this.entitySearchContextMenu.show(t)},updateEntitySearchDropdown:function(e){var t=this.model.get("template").types,i=_.find(t,function(t){return _.find(t.roles,function(t){return t.roleId==e})}),n=(_.find(i.roles,function(t){return t.roleId==e}),this.model.get("entitiesByType")),s=this.model.get("eventData"),o=s.relationshipsPerRole[e],l=_.reject(n[i.name],function(e){return _.find(o,function(t){return t.entityId==e.entityId})});options=[],_.each(l,function(e){options.push({value:e.entityId,label:e.name})}),this.entitySearchContextMenu.setOptions(options)},contextEntityClick:function(){var e=this.entitySearchContextMenu.getNewItemText(),t=this.entitySearchContextMenu.getValue();window.ApplicationInterface&&(t?window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,this.currentEventIds.join(),t,this.editingRoleId,1):e&&window.ApplicationInterface.selectedEventsAddRelationshipToNewEntity(window.timelineDocumentId,this.currentEventIds.join(),e,this.editingRoleId,1))},editClicked:function(e,t,i){},removeClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemoveRelationship(window.timelineDocumentId,this.currentEventIds.join(),t,e)},selectChangeHandler:function(e){var t=parseInt(this.dropdowns[e].getValue());window.ApplicationInterface&&window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,this.currentEventIds.join(),t,e,1)}});module.exports=ATInspectorRolePageView;
},{"./ATDropdown":29,"./ATInspectorListView":54,"./ATSearchableContextMenu":78,"./templates/addRoleTemplate.html":99,"./templates/optionsTemplate.html":158,"./templates/rolePageTemplate.html":163,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],59:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorRangePageView=require("./ATInspectorRangePageView"),ATInspectorPropertyPageView=require("./ATInspectorPropertyPageView"),ATInspectorRolePageView=require("./ATInspectorRolePageView"),ATInspectorLinkPageView=require("./ATInspectorLinkPageView"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),templateHtml=require("./templates/inspectorTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),tabGroupHtml=require("./templates/tabGroupTemplate.html"),ATInspectorView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml),n=_.template(tabGroupHtml);this.minWidth=200,this.maxWidth=400,this.stackedWidth=280,this.currentWidthWhenOpen=350,this.optionsTemplate=_.template(optionsHtml),this.d3El=d3.select("#"+e),this.d3El.html(i({})),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:eventData",this.render),this.listenTo(this.model,"change:timeline",this.updateParentDropdown),this.$headerText=$("#inspectorHeaderText"),this.$headerEventId=$("#inspectorHeaderEventID"),this.d3HeaderEventId=d3.select("#inspectorHeaderEventID"),this.$topBox=$("#inspectorTopBox"),this.$titleInput=$("#inspectorTitle"),$("#inspectorCloseArrow").on("click",function(){window.ApplicationInterface&&window.ApplicationInterface.closeInspector(window.timelineDocumentId)}),$("#inspectorForm").on("submit",function(){return!1}),this.colorDropdown=new ATColorDropdown({el:"#inspectorColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#inspectorParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),this.$titleInput.on("input",function(){t.titleInputHandler()}),this.$titleInput.blurOnEnter().on("blur",function(){t.titleBlurHandler()}),this.listenTo(this.colorDropdown,"change",function(){t.colorChangeHandler()}),this.listenTo(this.parentSearchDropdown,"change",function(){t.parentChangeHandler()}),this.d3TabGroup=this.d3El.select("#inspectorTabGroup"),this.tabs=[{index:0,name:"Range",icon:"flag"},{index:1,name:"Values",icon:"tags"},{index:2,name:"Roles",icon:"users"},{index:3,name:"Links",icon:"link"}],this.d3TabGroup.html(n({tabs:this.tabs})),this.$tabBar=$("#inspectorTabGroup .tabs"),this.d3TabContentGroup=this.d3TabGroup.select(".tabContentGroup"),_.each(this.tabs,function(e){e.button=this.d3El.select("#"+e.name+"-tab-button").on("click",function(){t.tabClicked(e.index)}),e.page=this.d3El.select("#"+e.name+"-page")},this),this.rangePageView=new ATInspectorRangePageView({el:"#"+this.tabs[0].name+"-page",model:this.model}),this.propertyPageView=new ATInspectorPropertyPageView({el:"#"+this.tabs[1].name+"-page",model:this.model}),this.rolePageView=new ATInspectorRolePageView({el:"#"+this.tabs[2].name+"-page",model:this.model}),this.linkPageView=new ATInspectorLinkPageView({el:"#"+this.tabs[3].name+"-page",model:this.model}),this.resizeDrag=d3.behavior.drag().on("dragstart",this.resizeDragStarted.bind(this)).on("drag",this.resizeDragged.bind(this)).on("dragend",this.resizeDragEnded.bind(this)),d3.select("#inspectorResizeGrabber").call(this.resizeDrag),this.tabClicked(0),this.renderTemplate(),this.render(),this.updateParentDropdown(),window.addEventListener("resize",this.resize.bind(this),!1),this.resize()},resize:function(){var e=this.$el.innerWidth(),t=this.$el.innerHeight(),i=this.$topBox.outerHeight(),n=this.$tabBar.outerHeight(),r=t-i,s=r-n,o=window.mainApp&&window.mainApp.displaySettings?this.stackedWidth*window.mainApp.displaySettings.size/100:this.stackedWidth;this.d3El.classed("stacked",o>e),this.d3TabGroup.style("height",r+"px"),this.d3TabContentGroup.style("height",s+"px"),d3.selectAll(".tabcontent").style("min-height",s+"px"),this.propertyPageView.resizeMultilineElement()},renderTemplate:function(){var e=this.model.get("template"),t=e.colors;this.colorDropdown.setOptions(t),this.rangePageView.setRangeId(e.rangeProperties[0].rangePropertyId)},resizeDragStarted:function(e){},resizeDragged:function(e){var t,i=d3.event.sourceEvent.clientX;this.resizeDragStartX||(this.resizeDragStartX=i,this.resizeDragOriginalWidth=this.$el.innerWidth()),t=this.resizeDragOriginalWidth+(this.resizeDragStartX-i),t<this.minWidth?t=this.minWidth:t>this.maxWidth&&(t=this.maxWidth),this.currentWidthWhenOpen=t,window.mainApp.resizeInspector(t),window.ApplicationInterface&&window.ApplicationInterface.setInspectorWidth(window.timelineDocumentId,t)},resizeDragEnded:function(e){this.resizeDragStartX=null,this.originalWidth=null},setRangeConversion:function(e){this.rangePageView.setRangeConversion(e)},render:function(){var e,t,i,n=this,r=this.model.get("eventData"),s="Event:",o=[];if(this.currentEventIds=r.eventIds,r.eventIds)for(e=0;e<r.eventIds.length;e++)o.push({id:r.eventIds[e],displayId:r.displayEventIds[e]});o.sort(function(e,t){return e.displayIndex<t.displayIndex?-1:e.displayIndex==t.displayIndex?0:1}),this.commitTitle(),0==o.length?s="Events: None selected":o.length>1&&(s="Events:",o.length>5&&(s+=" (Multiple)",o=[])),t=this.d3HeaderEventId.selectAll("span").data(o),t.select("a").text(function(e){return e.displayId}),t.select("i").text(function(e,t){return t<o.length-1?", ":""}),i=t.enter().append("span"),i.append("a").text(function(e){return e.displayId}).on("click",function(e){n.eventIdClicked(e.id)}),i.append("i").text(function(e,t){return t<o.length-1?", ":""}),t.exit().remove(),this.$headerText.text(s),this.$titleInput.val(r.title),this.colorDropdown.setValue(r.color),this.updateParentDropdown(),this.parentSearchDropdown.setValue(r.parentId),this.$titleInput.prop("disabled",!r.enabled),this.colorDropdown.setDisabled(!r.enabled),this.parentSearchDropdown.setDisabled(!r.enabled),this.setTitleFieldIsInvalid(!1)},updateParentDropdown:function(){var e=this.model.get("timeline").get("events").models,t=this.model.get("eventData").eventIds,i=[{value:-1,sortValue:"-1",label:"(No Parent)"}];_.each(e,function(e){_.contains(t,e.id)||(i.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),this.addChildrenOfEventsToOptions(i,e,t))},this),i.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),r=Math.min(i.length,n.length),s=0;for(s=0;r>s;s++)if(i[s]!=n[s])return i[s]-n[s];return i.length-n.length}),this.parentSearchDropdown.setOptions(i),this.parentSearchDropdown.setValue(this.model.get("eventData").parentId)},addChildrenOfEventsToOptions:function(e,t,i){var n=this;t.children.each(function(t){_.contains(i,t.id)||(e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),n.addChildrenOfEventsToOptions(e,t,i))})},titleInputHandler:function(){this.recordedInputTitle=this.$titleInput.val(),this.recordedInputEvents=this.currentEventIds,this.setTitleFieldIsInvalid(!this.$titleInput.val())},setTitleFieldIsInvalid:function(e){this.$titleInput&&this.$titleInput[0].setCustomValidity(e?"Error":"")},titleBlurHandler:function(){var e=this.model.get("eventData");this.recordedInputTitle?window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsTitle(window.timelineDocumentId,this.recordedInputEvents.join(),this.recordedInputTitle):(this.$titleInput.val(e?e.title:""),this.setTitleFieldIsInvalid(!1)),this.recordedInputTitle=null,this.recordedInputEvents=null},commitTitle:function(){this.titleBlurHandler()},colorChangeHandler:function(){window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsColor(window.timelineDocumentId,this.currentEventIds.join(),this.colorDropdown.getValue())},parentChangeHandler:function(){var e=this.parentSearchDropdown.getValue(),t=this.currentEventIds.join();window.mainApp.showNewParentPromptIfNeeded(e,function(i){window.ApplicationInterface.setSelectedEventsParent(window.timelineDocumentId,t,e,i)})},tabClicked:function(e){var t=0;for(t=0;t<this.tabs.length;t++)this.tabs[t].button.classed("selected",t==e),this.tabs[t].page.classed("visible",t==e);this.propertyPageView.resizeMultilineElement()},eventIdClicked:function(e){return d3.event.preventDefault(),d3.event.stopPropagation(),window.mainApp.timelineView.revealChildNode(parseInt(e)),!1}});module.exports=ATInspectorView;
},{"./ATColorDropdown":20,"./ATInspectorLinkPageView":53,"./ATInspectorPropertyPageView":56,"./ATInspectorRangePageView":57,"./ATInspectorRolePageView":58,"./ATSearchDropdown":77,"./templates/inspectorTemplate.html":149,"./templates/optionsTemplate.html":158,"./templates/tabGroupTemplate.html":169,"backbone":176,"d3":300,"jquery":307,"lodash":309}],60:[function(require,module,exports){
var ATPoint=require("./ATPoint"),ATLine=function(i,n,t,e){this.origin=new ATPoint(i,n),this.destination=new ATPoint(t,e)};ATLine.prototype.deepCopy=function(){return new ATLine(this.origin.x,this.origin.y,this.destination.x,this.destination.y)},module.exports=ATLine;
},{"./ATPoint":67}],61:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),d3=require("d3"),utf8=require("utf8"),Backbone=require("backbone"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATViewMode=require("./ATViewMode"),ATTimeline=require("./ATTimeline"),ATTimeUnit=require("./ATTimeUnit"),ATTimelineViewModel=require("./ATTimelineViewModel"),ATTimelineView=require("./ATTimelineView"),ATRelationshipView=require("./ATRelationshipView"),ATInspectorView=require("./ATInspectorView"),ATInspectorModel=require("./ATInspectorModel"),ATFilterBarView=require("./ATFilterBarView"),ATAddEntityView=require("./ATAddEntityView"),ATAddEventView=require("./ATAddEventView"),ATEmbedInNewParentView=require("./ATEmbedInNewParentView"),ATManageEntitiesView=require("./ATManageEntitiesView"),ATEditTemplateView=require("./ATEditTemplateView"),ATEditCalendarView=require("./ATEditCalendarView"),ATDisplaySettingsView=require("./ATDisplaySettingsView"),ATTagManagerView=require("./ATTagManagerView"),ATNewParentView=require("./ATNewParentView"),ATEnterNameView=require("./ATEnterNameView"),ATEnterDateView=require("./ATEnterDateView"),ATEnterDurationView=require("./ATEnterDurationView"),ATSyncBinderView=require("./ATSyncBinderView"),ATSyncSettingsView=require("./ATSyncSettingsView"),ATExportCSVView=require("./ATExportCSVView"),ATImportCsvView=require("./ATImportCsvView"),ATExportImageView=require("./ATExportImageView"),ATPrintView=require("./ATPrintView"),ATFindReplaceView=require("./ATFindReplaceView"),ATOnboardingView=require("./ATOnboardingView"),ATToolbar=require("./ATToolbar"),ATOnboarding=require("./ATOnboarding"),ATRect=require("./ATRect"),ATBounds=require("./ATBounds"),ATUtilities=require("./ATUtilities"),mainTimelineHtml=require("./templates/mainTimelineWindow.html"),ATMainTimelineApp=function(){this.timeline=new ATTimeline,this.inspectorModel=new ATInspectorModel({timeline:this.timeline}),this.timelineViewModel=new ATTimelineViewModel({timeline:this.timeline,inspectorModel:this.inspectorModel}),this.firstDataLoad=!0,this.titleEditDiv=null,this.draggingEvent=!1,this.eventDragStartPos=null,this.eventDragEndPos=null,this.displaySettings=null,this.modalStack=[],d3.select("body").classed("welcomeScreen",!1).classed("mainApp",!0),d3.select("#bounds").html(mainTimelineHtml),this.relationshipView=new ATRelationshipView({el:"#relationshipContentDiv",model:this.timelineViewModel}),this.relationshipView.setInspectorModel(this.inspectorModel),this.timelineView=new ATTimelineView({el:"#mainTimelineContentDiv",model:this.timelineViewModel}),this.timelineView.setRelationshipView(this.relationshipView),this.switchToTimelineView(),this.inspectorView=new ATInspectorView({el:"#inspector",model:this.inspectorModel}),this.inspectorD3=d3.select("#inspector"),this.mainCanvasD3=d3.select("#mainTimelineCanvas"),this.syncBinderD3=d3.select("#syncBinder"),this.$bounds=$("#bounds"),this.filterBarView=new ATFilterBarView({el:"#filterBarDiv",model:this.inspectorModel}),this.onboarding=new ATOnboarding,this.isWindows=!1,this.isMac=!1,this.bindKeyEvents()};ATMainTimelineApp.prototype.bindKeyEvents=function(){Mousetrap.bind("home",this.homeKeyPressed.bind(this)),Mousetrap.bind("end",this.endKeyPressed.bind(this)),Mousetrap.bind("pageup",this.pageUpKeyPressed.bind(this)),Mousetrap.bind("pagedown",this.pageDownKeyPressed.bind(this))},ATMainTimelineApp.prototype.loadNewData=function(e){var i,t=this,n=utf8.decode(atob(e)),o=JSON.parse(n),a=0;if(this.timelineView.calcEventTextSizeCount=0,this.timelineView.holdRendering(),o.displayTemplate&&(this.displaySettings=o.displayTemplate,this.timelineView.setDisplayTemplateSettings(o.displayTemplate),this.inspectorView.resize()),this.timeline.update(o),this.firstDataLoad&&(a=this.timelineViewModel.contentXAverage,i=-TimelineDisplayConstants.timeHeaderHeight,o.unitScale&&this.timelineViewModel.set("unitScale",o.unitScale),isNaN(o.startPixel)||(a=o.startPixel),o.positiveOnly&&(this.timelineView.rangeX=new ATBounds(-TimelineDisplayConstants.laneMarginWidth,Number.MAX_VALUE))),(o.calendar||o.timelineType)&&this.inspectorView.setRangeConversion(this.timeline.rangeConversion),(o.expandedParents||o.showMoreNodes)&&(this.timelineView.calculateIfRequired(),o.expandedParents&&_.each(o.expandedParents,function(e){this.timelineView.setShowChildNodes(e.nodeId,e.laneId)},this),o.showMoreNodes&&_.each(o.showMoreNodes,function(e){this.timelineView.setShowMoreEventInfo(e.nodeId,e.laneId)},this)),this.updateOnboarding(o),this.timelineView.renderFlags.data=!0,this.timelineView.renderFlags.calculate=!0,this.timelineView.renderIfRequired(),this.firstDataLoad&&(this.timelineView.scrollTopLeftToPoint(a,i),this.timelineView.animateContextBarReturn(0,0)),(o.minUnitScale||o.maxUnitScale)&&(this.timelineViewModel.get("unitScale")<o.minUnitScale?this.timelineView.animatedZoomToUnitScale(o.minUnitScale,1e3):this.timelineViewModel.get("unitScale")>o.maxUnitScale&&this.timelineView.animatedZoomToUnitScale(o.maxUnitScale,1e3),o.minUnitScale&&window.setTimeout(function(){t.timelineView.minimumUnitScale=o.minUnitScale},1100),o.maxUnitScale&&window.setTimeout(function(){t.timelineView.maximumUnitScale=o.maxUnitScale},1100),window.appToolbar&&window.appToolbar.setSliderPositionRange(o.minUnitScale,o.maxUnitScale)),this.firstDataLoad&&(this.timelineView.releaseRendering(),this.firstDataLoad=!1),this.timelineView.releaseRendering(),o.selectedEvents&&o.selectedEvents.length){this.timeline.selectedEvents.length;this.timeline.selectEventsWithIDs(o.selectedEvents),this.timelineView.calculateIfRequired(),this.timelineView.scrollToEventsIfOffScreen(o.selectedEvents)}},ATMainTimelineApp.prototype.updateOnboarding=function(e){var i=!1;this.onboarding.activeCount()&&(_.each(e.entityUpdates,function(e){(e.relationships||e.relUpdates&&_.keys(e.relUpdates).length)&&(i=!0)}),e.eventUpdates.length>0&&this.onboarding.removeOnboardingMessage("firstTimer-addEvent"),e.entityUpdates.length>0&&this.onboarding.removeOnboardingMessage("firstTimer-addEntity"),i&&this.onboarding.removeOnboardingMessage("firstTimer-addRelationship"),e.laneTypeName&&"None"!=e.laneTypeName&&this.onboarding.removeOnboardingMessage("firstTimer-laneGrouping"))},ATMainTimelineApp.prototype.setInspectorTemplate=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i),n=[],o=[],a=[],s=1;this.inspectorModel.set({template:t}),window.appToolbar&&(o.push({identifier:"laneNone",text:"None",shortcut:"Ctrl+0"}),o.push({identifier:"-"}),_.each(t.types,function(e){var i=e.name,t=e.typeId;o.push({identifier:"lane"+i,text:"Group by "+i,shortcut:"Ctrl+"+s}),n.push({identifier:"addEntity"+t,text:"Add "+i}),a.push({identifier:"addEntity"+t,text:"Add "+i}),s++},this),window.appToolbar.updateOptionsForIdentifier("addEntity",n),window.appToolbar.updateOptionsForIdentifier("lane",o),window.appToolbar.updateOptionsForIdentifier("addEntityMenu",a))},ATMainTimelineApp.prototype.setRecentFiles=function(e){if(window.appToolbar){var i=utf8.decode(atob(e)),t=JSON.parse(i),n=[],o=0;_.each(t,function(e){n.push({identifier:"openRecent_"+o,text:e.name}),o++}),window.appToolbar.updateOptionsForIdentifier("openRecent",n)}},ATMainTimelineApp.prototype.switchToTimelineView=function(){this.timelineView.holdRendering(),this.timelineView.setViewMode(ATViewMode.TIMELINE_VIEW),this.relationshipView.toggleView(!1),this.firstDataLoad||(this.timelineView.calculateIfRequired(),this.timelineView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)),this.timelineView.releaseRendering(),window.appToolbar&&(this.setToolbarItemState("timelineView",!0),this.setToolbarItemState("relationshipView",!1),this.enableToolbarItem("zoom"),this.enableToolbarItem("zoomIn"),this.enableToolbarItem("zoomOut"))},ATMainTimelineApp.prototype.switchToRelationshipView=function(){this.timelineView.holdRendering(),this.timelineView.setViewMode(ATViewMode.RELATIONSHIP_VIEW),this.relationshipView.toggleView(!0),this.firstDataLoad||(this.timelineView.calculateIfRequired(),this.relationshipView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)),this.timelineView.releaseRendering(),window.appToolbar&&(this.setToolbarItemState("timelineView",!1),this.setToolbarItemState("relationshipView",!0),this.disableToolbarItem("zoom"),this.disableToolbarItem("zoomIn"),this.disableToolbarItem("zoomOut"))},ATMainTimelineApp.prototype.setRelationshipViewTreeFlattened=function(e){this.relationshipView.setTreeFlattened(e)},ATMainTimelineApp.prototype.setRelationshipViewShowOffsets=function(e){this.relationshipView.setShowOffsets(e)},ATMainTimelineApp.prototype.mouseWheelWorkaround=function(e,i,t,n,o){this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.mouseWheelWorkaround(e,i,t,n,o):this.relationshipView.mouseWheelWorkaround(e,i,t,n,o)},ATMainTimelineApp.prototype.setInspectorData=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({eventData:t})},ATMainTimelineApp.prototype.setInspectorEntities=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({entitiesByType:t})},ATMainTimelineApp.prototype.setInspectorTags=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({tags:t})},ATMainTimelineApp.prototype.removeExistingModal=function(){this.modalStack.length>0&&this.modalStack[this.modalStack.length-1].modal("hide")},ATMainTimelineApp.prototype.modalClosed=function(e){this.modalStack=_.without(this.modalStack,e),0==this.modalStack.length&&window.ApplicationInterface&&window.ApplicationInterface.lastModalClosed(window.timelineDocumentId)},ATMainTimelineApp.prototype.showModal=function(e,i){var t=this;window.isAeonWebExport||(i||this.removeExistingModal(),this.modalStack.push(e),e.on("hidden.bs.modal",function(){t.modalClosed(e)}),e.modal("show"),window.ApplicationInterface&&window.ApplicationInterface.modalOpened(window.timelineDocumentId))},ATMainTimelineApp.prototype.showNewParentPromptIfNeeded=function(e,i){var t=this.timeline.get("events").findChild(e);return!t||t.children.length>0?void i(!1):(this.newParentModal||(this.newParentModal=$("#newParentModal"),$("#newParentModal").modal({show:!1,backdrop:"static"}),this.newParentView=new ATNewParentView({el:"#newParentModal"})),this.newParentView.setCallback(i),this.newParentView.setParentEventTitle(t.get("title")),void this.showModal(this.newParentModal,!0))},ATMainTimelineApp.prototype.showAddEventModal=function(e,i,t){this.addEventModal||(this.addEventModal=$("#addEventModal"),$("#addEventModal").modal({show:!1,backdrop:"static"}),this.addEventView=new ATAddEventView({el:"#addEventModal",model:this.inspectorModel})),this.addEventView.setRangeConversion(this.timeline.rangeConversion),this.showModal(this.addEventModal),e||(e=this.timeline.rangeConversion.calendar?this.timeline.rangeConversion.calendar.dateWithTimestamp(this.timelineView.centerTimestamp(),ATTimeUnit.SECOND):this.timelineView.centerTimestamp()),t||(t=-1),i||(i=-1),this.addEventView.resetForm(e,t,i)},ATMainTimelineApp.prototype.showFindReplaceModal=function(){this.findReplaceModal||(this.findReplaceModal=$("#findReplaceModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.findReplaceView=new ATFindReplaceView({el:"#findReplaceModal"})),this.showModal(this.findReplaceModal),this.findReplaceView.resetForm()},ATMainTimelineApp.prototype.showEmbedInNewParentModal=function(e){this.embedInNewParentModal||(this.embedInNewParentModal=$("#embedInNewParentModal"),$("#embedInNewParentModal").modal({show:!1,backdrop:"static"}),this.embedInNewParentView=new ATEmbedInNewParentView({el:"#embedInNewParentModal",model:this.inspectorModel})),this.showModal(this.embedInNewParentModal),e||(e=-1),this.embedInNewParentView.resetForm(e)},ATMainTimelineApp.prototype.showOnboardingModal=function(e){this.onboardingModal||(this.onboardingModal=$("#onboardingModal"),$("#onboardingModal").modal({show:!1,backdrop:"static"}),this.onboardingView=new ATOnboardingView({el:"#onboardingModal"})),this.onboardingView.configureForCategory(e),this.showModal(this.onboardingModal)},ATMainTimelineApp.prototype.showAddEntityModal=function(e){var i=this;this.addEntityModal||(this.addEntityModal=$("#addEntityModal"),$("#addEntityModal").modal({show:!1,backdrop:"static"}),this.addEntityView=new ATAddEntityView({el:"#addEntityModal",model:this.inspectorModel})),this.addEntityView.setTypeId(e),this.addEntityView.setRangeConversion(this.timeline.rangeConversion),this.addEntityView.setValidatorFunction(function(e){var t=!1;return e.length?(i.timeline.get("entities").each(function(i){i.get("name")==e&&(t=!0)}),!t):!1}),this.addEntityView.setWindowTitle("Add Entity"),this.addEntityView.setWindowBelowMessage("NOTE: Entity names must be unique (e.g. Arcs and Characters cannot share a name)."),this.showModal(this.addEntityModal),this.addEntityView.resetForm()},ATMainTimelineApp.prototype.showManageEntitiesModal=function(){var e=this;this.manageEntitiesModal||(this.manageEntitiesModal=$("#manageEntitiesModal"),$("#manageEntitiesModal").modal({show:!1,backdrop:"static"}),this.manageEntitiesView=new ATManageEntitiesView({el:"#manageEntitiesModal",model:this.inspectorModel})),this.manageEntitiesView.setRangeConversion(this.timeline.rangeConversion),this.manageEntitiesView.updateDetailFields(),this.showModal(this.manageEntitiesModal),window.setTimeout(function(){e.manageEntitiesView.immediateUpdateExpandedGroupHeight()},300)},ATMainTimelineApp.prototype.showEditTemplateModal=function(){this.editTemplateModal||(this.editTemplateModal=$("#editTemplateModal"),$("#editTemplateModal").modal({show:!1,backdrop:"static"}),this.editTemplateView=new ATEditTemplateView({el:"#editTemplateModal",model:this.inspectorModel})),this.editTemplateView.grabInitialTemplate(),this.editTemplateView.setAllowEditCalendar(0==this.timeline.get("events").length&&0==this.timeline.get("entities").length),this.showModal(this.editTemplateModal)},ATMainTimelineApp.prototype.showEditCalendarModal=function(e,i){console.log("show edit calendar modal"),console.dir(e),this.editCalendarModal||(this.editCalendarModal=$("#editCalendarModal"),$("#editCalendarModal").modal({show:!1,backdrop:"static"}),this.editCalendarView=new ATEditCalendarView({el:"#editCalendarModal",model:e})),this.editCalendarView.model=e,this.editCalendarView.grabInitialCalendar(),this.editCalendarView.setCompletionCallback(i),this.showModal(this.editCalendarModal,!0)},ATMainTimelineApp.prototype.showDisplaySettingsModal=function(){this.displaySettingsModal||(this.displaySettingsModal=$("#displaySettingsModal"),$("#displaySettingsModal").modal({show:!1,backdrop:"static"}),this.displaySettingsView=new ATDisplaySettingsView({el:"#displaySettingsModal",model:this.inspectorModel})),this.displaySettingsView.setDisplayTemplateSettings(this.displaySettings),this.showModal(this.displaySettingsModal)},ATMainTimelineApp.prototype.showTagManagerModal=function(e){var i=utf8.decode(atob(e));this.tagManagerModal||(this.tagManagerModal=$("#tagManagerModal"),$("#tagManagerModal").modal({show:!1,backdrop:"static"}),this.tagManagerView=new ATTagManagerView({el:"#tagManagerModal",model:this.inspectorModel})),this.tagManagerView.setTags(JSON.parse(i)),this.showModal(this.tagManagerModal)},ATMainTimelineApp.prototype.showSyncSettingsModal=function(e){var i=utf8.decode(atob(e));this.syncSettingsModal||(this.syncSettingsModal=$("#syncSettingsModal"),$("#syncSettingsModal").modal({show:!1,backdrop:"static"}),this.syncSettingsView=new ATSyncSettingsView({el:"#syncSettingsModal",model:this.inspectorModel})),this.syncSettingsView.setScrivenerFields(JSON.parse(i)),this.showModal(this.syncSettingsModal)},ATMainTimelineApp.prototype.showAddBookmarkModal=function(){var e=this;this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(function(i){if(window.ApplicationInterface){var t=e.timelineView.model.get("unitScale");if(window.ApplicationInterface)if(e.timelineView.viewMode==ATViewMode.TIMELINE_VIEW)window.ApplicationInterface.addBookmark(window.timelineDocumentId,i,e.timelineView.viewport.centerX()*t,t);else{var n=e.relationshipView.fakeCenterTsForBookmark();isNaN(n)||window.ApplicationInterface.addBookmark(window.timelineDocumentId,i,n,t)}}}),this.enterNameView.setWindowTitle("Add Bookmark"),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage(""),this.showModal(this.enterNameModal),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showSaveFilterModal=function(){this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(function(e){window.ApplicationInterface&&window.ApplicationInterface.saveFilterWithName(window.timelineDocumentId,e)}),this.enterNameView.setWindowTitle("Save Filter As..."),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage(""),this.showModal(this.enterNameModal),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showSaveCustomTemplateModal=function(e){this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(e),this.enterNameView.setWindowTitle("Save As Custom Template"),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage("Note: Your current event display layout will be saved with the template."),this.showModal(this.enterNameModal,!0),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showZeroDateModal=function(e,i,t,n,o,a,s){this.enterDateModal||(this.enterDateModal=$("#enterDateModal"),$("#enterDateModal").modal({show:!1,backdrop:"static"}),this.enterDateView=new ATEnterDateView({el:"#enterDateModal"})),this.enterDateView.setRangeConversion(t),this.enterDateView.setCallback(e),this.enterDateView.setValidatorFunction(i),this.enterDateView.setWindowTitle("Change Calendar Type"),this.enterDateView.setWindowAboveMessage(a),this.enterDateView.setWindowBelowMessage(s),this.showModal(this.enterDateModal,!0),this.enterDateView.setTimestamp(n,o),this.enterDateView.resetForm()},ATMainTimelineApp.prototype.showShiftEventsModal=function(){this.enterDurationModal||(this.enterDurationModal=$("#enterDurationModal"),$("#enterDurationModal").modal({show:!1,backdrop:"static"}),this.enterDurationView=new ATEnterDurationView({el:"#enterDurationModal"})),this.enterDurationView.setCallback(function(e){window.ApplicationInterface&&window.ApplicationInterface.moveSelectedEventsByDuration(window.timelineDocumentId,e)}),this.enterDurationView.setRangeConversion(this.timeline.rangeConversion),this.enterDurationView.setWindowTitle("Shift Events By..."),this.showModal(this.enterDurationModal,!0),this.enterDurationView.resetForm()},ATMainTimelineApp.prototype.adjustFilterBar=function(e){var i=this;this.filterBarVisible&&this.timelineView.filterBarDiv.style("visibility",null),window.setTimeout(function(){i.resizeFilterBar(e)},100)},ATMainTimelineApp.prototype.resizeFilterBar=function(e){function i(){return function(){var e=d3.interpolateNumber(n,o);return function(i){var n=e(i);t.timelineView.holdRendering(),t.timelineView.filterBarDiv.style("height",n+"px"),t.timelineView.filterBarDiv.style("visibility",n?null:"hidden"),t.timelineView.filterBarDiv.classed("visibleFilter",!(!t.filterBarVisible||n!=o)),t.timelineView.d3El.style("top",n+"px"),t.relationshipView.d3El.style("top",n+"px"),t.timelineView.resizeWindow(null,!0),t.timelineView.releaseRendering()}}}var t=this,n=$(".filterBar").innerHeight(),o=this.filterBarVisible?$(".filterControl").outerHeight()+9:0;e?d3.transition().duration(300).tween("filterTween",i()):(t.timelineView.holdRendering(),t.timelineView.filterBarDiv.style("height",o+"px"),t.timelineView.d3El.style("top",o+"px"),t.relationshipView.d3El.style("top",o+"px"),t.timelineView.resizeWindow(null,!0),t.timelineView.filterBarDiv.style("visibility",this.filterBarVisible?null:"hidden"),t.timelineView.filterBarDiv.classed("visibleFilter",this.filterBarVisible),t.timelineView.releaseRendering())},ATMainTimelineApp.prototype.resizeInspector=function(e){var i=$("#syncBinder").width(),t=i+e;this.timelineView.holdRendering(),this.inspectorD3.style("width",e+"px"),window.isAeonWebExport?this.mainCanvasD3.style("width","calc(100% - "+t+"px)"):this.mainCanvasD3.style("width","-webkit-calc(100% - "+t+"px)"),this.timelineView.resizeWindow(null),0==e?this.inspectorD3.style("display","none"):this.inspectorD3.style("display",null),this.inspectorView.resize(),this.timelineView.releaseRendering()},ATMainTimelineApp.prototype.adjustInspector=function(e){function i(){return function(){var e=d3.interpolateNumber(n,o);return function(i){t.resizeInspector(e(i))}}}var t=this,n=$("#inspector").innerWidth(),o=this.inspectorVisible?this.inspectorView.currentWidthWhenOpen:0;e?d3.transition().duration(300).tween("inspectorTween",i()):t.resizeInspector(o)},ATMainTimelineApp.prototype.disableNonWebElements=function(){this.hideInspector(!1),this.hideFilterBar(!1),this.hideSyncBinder(!1)},ATMainTimelineApp.prototype.showFilterBar=function(e){this.filterBarVisible=!0,this.adjustFilterBar(e),window.appToolbar&&this.setToolbarItemState("filter",!0)},ATMainTimelineApp.prototype.hideFilterBar=function(e){this.filterBarVisible=!1,this.adjustFilterBar(e),window.appToolbar&&this.setToolbarItemState("filter",!1)},ATMainTimelineApp.prototype.showInspector=function(e){this.inspectorVisible=!0,this.adjustInspector(e),window.appToolbar&&this.setToolbarItemState("inspector",!0)},ATMainTimelineApp.prototype.hideInspector=function(e){this.inspectorVisible=!1,this.adjustInspector(e),this.onboarding.hideOnboardingMessage("firstTimer-addRelationship"),window.appToolbar&&this.setToolbarItemState("inspector",!1)},ATMainTimelineApp.prototype.setInspectorWidthWhenOpen=function(e){this.inspectorView.currentWidthWhenOpen=e},ATMainTimelineApp.prototype.zoomIn=function(){window.appToolbar&&window.appToolbar.adjustItemSliderValue("zoom",10)},ATMainTimelineApp.prototype.zoomOut=function(){window.appToolbar&&window.appToolbar.adjustItemSliderValue("zoom",-10)},ATMainTimelineApp.prototype.zoomToFit=function(){this.timelineView.animatedZoomToFit()},ATMainTimelineApp.prototype.resizeSyncBinder=function(e){var i=$("#inspector").innerWidth(),t=i+e;this.timelineView.holdRendering(),this.syncBinderD3.style("width",e+"px"),window.isAeonWebExport?this.mainCanvasD3.style("width","calc(100% - "+t+"px)"):this.mainCanvasD3.style("width","-webkit-calc(100% - "+t+"px)"),this.mainCanvasD3.style("left",e+"px"),this.timelineView.resizeWindow(null),0==e?this.syncBinderD3.style("display","none"):this.syncBinderD3.style("display",null),this.syncBinderView&&this.syncBinderView.resize(),this.timelineView.releaseRendering()},ATMainTimelineApp.prototype.adjustSyncBinder=function(e){function i(){return function(){var e=d3.interpolateNumber(n,o);return function(i){t.resizeSyncBinder(e(i))}}}var t=this,n=$("#syncBinder").innerWidth(),o=this.syncBinderVisible?this.syncBinderView.currentWidthWhenOpen:0;this.$bounds.innerWidth(),$("#inspector").innerWidth();e?d3.transition().duration(300).tween("syncBinderTween",i()):t.resizeSyncBinder(o)},ATMainTimelineApp.prototype.showSyncBinder=function(e,i,t,n){var o=utf8.decode(atob(t));this.syncBinderView||(this.syncBinderView=new ATSyncBinderView({el:"#syncBinder",model:this.timeline})),this.syncBinderView.currentWidthWhenOpen=i,this.syncBinderView.setSyncData(o),n&&this.syncBinderView.setErrorMessage(n),this.syncBinderVisible=!0,this.adjustSyncBinder(e)},ATMainTimelineApp.prototype.hideSyncBinder=function(e){this.syncBinderVisible=!1,this.adjustSyncBinder(e)},ATMainTimelineApp.prototype.updateSyncErrorMessage=function(e){this.syncBinderView&&this.syncBinderView.setErrorMessage(e)},ATMainTimelineApp.prototype.updateSyncData=function(e){var i=utf8.decode(atob(e));this.syncBinderView&&this.syncBinderView.setSyncData(i)},ATMainTimelineApp.prototype.expandSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.expandItemInBinder(e)},ATMainTimelineApp.prototype.collapseSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.collapseItemInBinder(e)},ATMainTimelineApp.prototype.editSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.editItemInBinder(e)},ATMainTimelineApp.prototype.showSyncLinkPopover=function(e){this.syncBinderView&&this.syncBinderView.showLinkEventPopoverForItem(e)},ATMainTimelineApp.prototype.collapseAllLanes=function(){this.timelineView.collapseAllLanes()},ATMainTimelineApp.prototype.expandAllLanes=function(){this.timelineView.expandAllLanes()},ATMainTimelineApp.prototype.setForWindows=function(){d3.select("body").classed("windows",!0).classed("mac",!1),this.isWindows=!0},ATMainTimelineApp.prototype.setForMac=function(){d3.select("body").classed("windows",!1).classed("mac",!0),this.isMac=!0},ATMainTimelineApp.prototype.setForExport=function(){this.setForImmediateRender(),d3.select("body").classed("export",!0),this.hideFilterBar(!1),this.hideInspector(!1),this.hideSyncBinder(!1)},ATMainTimelineApp.prototype.setForImmediateRender=function(){this.timelineView.timelinePainter.defaultTransitionDuration=0,this.timelineView.timelinePainter.transitionDuration=0,this.timelineView.isExport=!0,this.timelineView.timelinePainter.isExport=!0},ATMainTimelineApp.prototype.getUnitScale=function(){return this.timelineView.model.get("unitScale")},ATMainTimelineApp.prototype.setUnitScale=function(e){function i(e,i){return function(){var n=d3.interpolateNumber(e,i);return function(e){var i=n(e);t.timelineView.zoomToScale(i)}}}var t=this,n=this.getUnitScale();this.timelineView.holdRendering(),0==this.timelineView.timelinePainter.defaultTransitionDuration?this.timelineView.zoomToScale(e):d3.transition().duration(500).tween("animatedZoom",i(n,e)),this.timelineView.releaseRendering()},ATMainTimelineApp.prototype.unitScaleChanged=function(){var e=this.timelineView.model.get("unitScale"),i=this;window.appToolbar&&window.appToolbar.setItemSliderValue("zoom",e),window.scaleAppNotifyTimeout&&clearTimeout(window.scaleAppNotifyTimeout),window.scaleAppNotifyTimeout=setTimeout(function(){i.sendUnitScaleToAppInterface(e)},100)},ATMainTimelineApp.prototype.sendUnitScaleToAppInterface=function(e){window.ApplicationInterface&&window.ApplicationInterface.setUnitScale(window.timelineDocumentId,""+e)},ATMainTimelineApp.prototype.scrollPositionChanged=function(){var e=this.timelineView.viewport.origin.x,i=this.timelineView.viewport.origin.y,t=this;window.scrollAppNotifyTimeout&&clearTimeout(window.scrollAppNotifyTimeout),window.scrollAppNotifyTimeout=setTimeout(function(){t.sendScrollPositionToAppInterface(e,i)},100)},ATMainTimelineApp.prototype.sendScrollPositionToAppInterface=function(e,i){window.ApplicationInterface&&window.ApplicationInterface.setScrollPosition(window.timelineDocumentId,""+e,""+i)},ATMainTimelineApp.prototype.getScrollPosition=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.viewport.origin.x+","+this.timelineView.viewport.origin.y:this.relationshipView.viewport.origin.x+","+this.relationshipView.viewport.origin.y},ATMainTimelineApp.prototype.getEarliestEventPixel=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.model.findEarliestEventPixel()-20:this.relationshipView.rangeX.min},ATMainTimelineApp.prototype.getLatestEventPixel=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.model.findLatestEventPixel()+20:this.relationshipView.rangeX.max},ATMainTimelineApp.prototype.getTimelineHeight=function(){var e=this.timelineView.model.lastLane();return e.get("top")+e.get("height")+(this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?TimelineDisplayConstants.timeHeaderHeight:TimelineDisplayConstants.relationshipViewEntityHeaderHeight)},ATMainTimelineApp.prototype.reportExportSetupCompletion=function(){var e=this.getTimelineHeight()*this.timelineView.physicalScaleFactor;window.ApplicationInterface&&window.ApplicationInterface.exportSetupComplete(this.timelineDocumentId,e)},ATMainTimelineApp.prototype.getPhysicalScaleFactor=function(){return this.timelineView.physicalScaleFactor},ATMainTimelineApp.prototype.pixelForTimestamp=function(e){return e/this.timelineView.model.get("unitScale")},ATMainTimelineApp.prototype.setScrollPosition=function(e,i){this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollTopLeftToPoint(e,i):this.relationshipView.scrollTopLeftToPoint(e,i)},ATMainTimelineApp.prototype.assumeAllEventsAreOpen=function(){return this.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree},ATMainTimelineApp.prototype.sortFunctionForEventNodes=function(){return this.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree?function(e,i){return e.get("relationshipTotalRect").origin.y-i.get("relationshipTotalRect").origin.y}:function(e,i){var t=e.get("event").get("displayId"),n=i.get("event").get("displayId");return ATUtilities.versionNumberCompare(t,n)}},ATMainTimelineApp.prototype.sortFunctionForEvents=function(){return this.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree?null:function(e,i){var t=e.get("displayId"),n=i.get("displayId");return ATUtilities.versionNumberCompare(t,n)}},ATMainTimelineApp.prototype.selectAll=function(){this.timelineView.model.selectAll(this.assumeAllEventsAreOpen())},ATMainTimelineApp.prototype.selectAllBefore=function(){this.timelineView.model.selectAllBefore(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes())},ATMainTimelineApp.prototype.selectAllAfter=function(){this.timelineView.model.selectAllAfter(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes())},ATMainTimelineApp.prototype.findFirst=function(e){this.timelineView.findFirst(e,this.sortFunctionForEvents())},ATMainTimelineApp.prototype.selectNextEvent=function(){var e=this.timelineView.model.selectNextEvent(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes());e&&this.timelineView.scrollToNodeIfOffScreen(e)},ATMainTimelineApp.prototype.selectPreviousEvent=function(){var e=this.timelineView.model.selectPreviousEvent(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes());e&&this.timelineView.scrollToNodeIfOffScreen(e)},ATMainTimelineApp.prototype.applySearchResult=function(e,i,t){var n,o,a=i?e:utf8.decode(atob(e)),s=a?JSON.parse(a):{};this.relationshipView.relationshipPainter.setHighlightString(s.highlightString),this.timelineView.timelinePainter.setHighlightString(s.highlightString),window.appToolbar&&window.appToolbar.markErrorTextItem("search",t),s.selectEventId>0?(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(s.selectEventId),n=this.timelineView.model.findNodeForEventId(s.selectEventId),n&&(o=n.get("lane"),o.get("collapsed")&&this.timelineView.toggleLane(o.id),this.timelineView.revealChildNode(s.selectEventId,o.id))):s.scrollPosition&&this.timelineView.scrollToTimestamp(s.scrollPosition)},ATMainTimelineApp.prototype.getViewportSize=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.viewport.size.width+","+this.timelineView.viewport.size.height:this.relationshipView.viewport.size.width+","+this.relationshipView.viewport.size.height},ATMainTimelineApp.prototype.getBoundsForManageFilterButton=function(){return this.filterBarView.boundsForManageIcon()},ATMainTimelineApp.prototype.setDocumentSize=function(e,i){d3.select("body").style("width",e+"px").style("height",i+"px"),d3.select("#bounds").style("width",e+"px").style("height",i+"px"),this.timelineView.resizeWindow(null)},ATMainTimelineApp.prototype.hideSelectedEventDetails=function(){this.timelineView.hideSelectedEventDetails()},ATMainTimelineApp.prototype.hideAllEventDetails=function(){
this.timelineView.hideAllEventDetails(this.assumeAllEventsAreOpen())},ATMainTimelineApp.prototype.showSelectedEventDetails=function(){this.timelineView.showSelectedEventDetails()},ATMainTimelineApp.prototype.expandSelectedParentEvents=function(){this.timelineView.expandSelectedParentEvents()},ATMainTimelineApp.prototype.collapseSelectedParentEvents=function(){this.timelineView.collapseSelectedParentEvents()},ATMainTimelineApp.prototype.setMoreTemplate=function(e){this.timelineView.setMoreTemplate(e)},ATMainTimelineApp.prototype.createToolbar=function(){window.appToolbar||(window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.toolbarCommands),window.appToolbar.setMenuCommands(window.menuCommands)),d3.select("#bounds").classed("underToolbar",!0),window.appToolbar.setDisabled(_.pluck(window.toolbarCommands,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.toolbarCommands[0].options,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[0].options,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[1].options,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[2].options,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[3].options,"identifier"),!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[4].options,"identifier"),!1),window.appToolbar.setDisabled(["findPrevious","findNext","syncClose","deactivate"],!0),this.enableToolbarItemsForSelection()},ATMainTimelineApp.prototype.createWebToolbar=function(){window.appToolbar||(window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.webToolbarCommands)),d3.select("#bounds").classed("webUnderToolbar",!0),this.enableToolbarItemsForSelection(),window.isAeonWebExport&&"MacOS"===this.osCheck()&&d3.select("body").classed("windows",!1).classed("mac",!0)},ATMainTimelineApp.prototype.renderSyncContextMenu=function(e){this.syncBinderView&&this.syncBinderView.renderJsContextMenuWithItems(e)},ATMainTimelineApp.prototype.renderDefaultContextMenu=function(e){this.timelineView.renderJsContextMenuWithItems(e)},ATMainTimelineApp.prototype.configureManageFilterMenu=function(e){var i=utf8.decode(atob(e));this.filterBarView.configureManageFilterMenu(i)},ATMainTimelineApp.prototype.focusToolbarSearch=function(){window.appToolbar&&window.appToolbar.focusTextItem("search")},ATMainTimelineApp.prototype.enableToolbarItemsForSelection=function(){window.appToolbar&&window.appToolbar.setSelectionCount(this.timeline.selectedEvents.length)},ATMainTimelineApp.prototype.enableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!1):console.log("enableToolbarItem FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.disableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!0):console.log("disableToolbarItem FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.setToolbarItemState=function(e,i){window.appToolbar?window.appToolbar.setState(e,i):console.log("setToolbarItemState FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.showExportCSV=function(){this.$exportCsvModal||(this.$exportCsvModal=$("#exportCsvModal"),$("#exportCsvModal").modal({show:!1,backdrop:"static"}),this.exportCSVView=new ATExportCSVView({el:"#exportCsvModal"})),this.showModal(this.$exportCsvModal)},ATMainTimelineApp.prototype.showExportImage=function(){this.$exportImageModal||(this.$exportImageModal=$("#exportImageModal"),$("#exportImageModal").modal({show:!1,backdrop:"static"}),this.exportImageView=new ATExportImageView({el:"#exportImageModal"}),this.exportImageView.setRangeConversion(this.timeline.rangeConversion)),this.exportImageView.calculateRangeOnShow(),this.showModal(this.$exportImageModal)},ATMainTimelineApp.prototype.showPrint=function(){this.$printModal||(this.$printModal=$("#printModal"),$("#printModal").modal({show:!1,backdrop:"static"}),this.printView=new ATPrintView({el:"#printModal"}),this.printView.setRangeConversion(this.timeline.rangeConversion)),this.printView.calculateRangeOnShow(),this.showModal(this.$printModal)},ATMainTimelineApp.prototype.showImportCsvFirstModal=function(){this.$importCsvModal||(this.$importCsvModal=$("#importCsvModal"),$("#importCsvModal").modal({show:!1,backdrop:"static"}),this.importCsvView=new ATImportCsvView({el:"#importCsvModal"})),this.importCsvView.configureAsPage1(),this.showModal(this.$importCsvModal)},ATMainTimelineApp.prototype.showImportCsvSecondModal=function(e){if(0!=e.length){var i=utf8.decode(atob(e)),t=JSON.parse(i);return this.$importCsvModal?void this.importCsvView.configureAsPage2(t[0],t[1]):void console.log("attempting to show Csv Second page when first page was never shown")}},ATMainTimelineApp.prototype.formInputHasFocus=function(){var e=$(document.activeElement);return e[0]!=$(document)[0]&&e[0]!=$("html")[0]&&e[0]!=$("body")[0]},ATMainTimelineApp.prototype.showOnboardingSequence=function(e){this.onboarding.showOnboardingSequence(e)},ATMainTimelineApp.prototype.hideOnboardingSequence=function(e){this.onboarding.hideOnboardingSequence(e)},ATMainTimelineApp.prototype.homeKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollToPixelXY(null,this.timelineView.rangeY.min):this.relationshipView.scrollToPixelXY(null,this.relationshipView.rangeY.min),!1},ATMainTimelineApp.prototype.endKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollToPixelXY(null,this.timelineView.rangeY.max):this.relationshipView.scrollToPixelXY(null,this.relationshipView.rangeY.max),!1},ATMainTimelineApp.prototype.pageDownKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollPageDown():this.relationshipView.gotoNextEvent(),!1},ATMainTimelineApp.prototype.pageUpKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollPageUp():this.relationshipView.gotoPreviousEvent(),!1},ATMainTimelineApp.prototype.osCheck=function(){var e=null;return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e},ATMainTimelineApp.prototype.revealInTimeline=function(){this.timeline.selectedEvents.length>=1&&this.timelineView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)},ATMainTimelineApp.prototype.selectAndScrollToEvents=function(e){var i=_.map(e.split(","),function(e){return parseInt(e)});this.timeline.selectEventsWithIDs(i),1==i.length&&this.timelineView.scrollToEventsIfOffScreen(i)},module.exports=ATMainTimelineApp;
},{"./ATAddEntityView":13,"./ATAddEventView":14,"./ATBounds":16,"./ATDisplayConstants":26,"./ATDisplaySettingsView":27,"./ATEditCalendarView":31,"./ATEditTemplateView":33,"./ATEmbedInNewParentView":34,"./ATEnterDateView":35,"./ATEnterDurationView":36,"./ATEnterNameView":37,"./ATExportCSVView":47,"./ATExportImageView":48,"./ATFilterBarView":49,"./ATFindReplaceView":50,"./ATImportCsvView":52,"./ATInspectorModel":55,"./ATInspectorView":59,"./ATManageEntitiesView":62,"./ATNewParentView":64,"./ATOnboarding":65,"./ATOnboardingView":66,"./ATPrintView":68,"./ATRect":73,"./ATRelationshipView":74,"./ATSyncBinderView":81,"./ATSyncSettingsView":82,"./ATTagManagerView":83,"./ATTimeUnit":85,"./ATTimeline":86,"./ATTimelineView":87,"./ATTimelineViewModel":88,"./ATToolbar":90,"./ATUtilities":91,"./ATViewMode":92,"./templates/mainTimelineWindow.html":153,"backbone":176,"d3":300,"jquery":307,"lodash":309,"utf8":312}],62:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATDropdown=require("./ATDropdown"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATUtilities=require("./ATUtilities"),templateHtml=require("./templates/manageEntitiesTemplate.html"),masterListHtml=require("./templates/masterList.html"),optionsHtml=require("./templates/optionsTemplate.html"),ATManageEntitiesView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml);this.optionsTemplate=_.template(optionsHtml),this.masterListTemplate=_.template(masterListHtml),this.displayGroups=[],this.expandedTypeId=null,this.selectedEntity=null,this.requireSelectAndFocus=!1,this.selectAndFocusName=null,this.BadWords=["Event","Entity","Tag","Color","Parent","Link","Any","All","Timeline"],this.d3El=d3.select("#"+e),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template",this.renderMasterList.bind(this)),this.listenTo(this.model,"change:entitiesByType",function(){t.renderMasterList(),t.updateDetailFields()}),this.listenTo(this.model.get("timeline"),"change:events",this.updateEventDropdowns.bind(this)),this.d3MasterList=this.d3El.select(".masterViewList"),this.d3AgeGroupDiv=this.d3El.select("#manageEntitiesAgeGroup"),$("#manageEntitiesForm").on("submit",function(){return!1}),this.$nameInput=$("#manageEntitiesName"),this.$nameInput.on("change",this.entityNameChanged.bind(this)),this.$nameInput.on("input",this.entityNameInput.bind(this)),this.$notesInput=$("#manageEntitiesNotes"),this.$notesInput.on("change",this.entityNotesChanged.bind(this)),this.$colorInput=$("#manageEntitiesColor"),this.$colorInput.spectrum({color:"#ffffff",showInput:!0,showInitial:!1,allowEmpty:!1,showAlpha:!1,showPalette:!1,showButtons:!1,preferredFormat:"hex",appendTo:"#"+e,change:this.entityColorChanged.bind(this)}),this.createOffsetPickerView=new ATDurationPicker({el:"#manageEntitiesCreateOffset"}),this.createOffsetFromDropdown=new ATDropdown({el:"#manageEntitiesCreateOffsetFrom"}),this.destroyOffsetPickerView=new ATDurationPicker({el:"#manageEntitiesDestroyOffset"}),this.destroyOffsetFromDropdown=new ATDropdown({el:"#manageEntitiesDestroyOffsetFrom"}),$("#manageEntitiesRemoveButton").on("click",this.removeSelectedItem.bind(this)),this.createEventSearchDropdown=new ATSearchDropdown({el:"#manageEntitiesCreateEvent"}),this.createEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.createEventSearchDropdown.setSearchWordByWord(!0),this.destroyEventSearchDropdown=new ATSearchDropdown({el:"#manageEntitiesDestroyEvent"}),this.destroyEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.destroyEventSearchDropdown.setSearchWordByWord(!0),this.d3CreateDate=this.d3El.select("#manageEntitiesCreateDate"),this.createDatePickerView=new ATDatePicker({el:"#manageEntitiesCreateDate"}),this.d3DestroyDate=this.d3El.select("#manageEntitiesDestroyDate"),this.destroyDatePickerView=new ATDatePicker({el:"#manageEntitiesDestroyDate"}),this.createDatePickerView.setResetCallback(function(){window.setTimeout(t.resetCreateDateField.bind(t),0)}),this.destroyDatePickerView.setResetCallback(function(){window.setTimeout(t.resetDestroyDateField.bind(t),0)}),this.listenTo(this.createEventSearchDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.destroyEventSearchDropdown,"change",this.destroyEventChangeHandler.bind(this)),this.listenTo(this.createOffsetFromDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.destroyOffsetFromDropdown,"change",this.destroyEventChangeHandler.bind(this)),this.createOffsetPickerView.setChangeCallback(this.createEventChangeHandler.bind(this)),this.destroyOffsetPickerView.setChangeCallback(this.destroyEventChangeHandler.bind(this)),this.createDatePickerView.setChangeCallback(this.createPositionChangeHandler.bind(this)),this.destroyDatePickerView.setChangeCallback(this.destroyPositionChangeHandler.bind(this)),$("#manageEntitiesSortAlphaButton").on("click",this.sortItemsAlphabetically.bind(this)),$("#manageEntitiesMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#manageEntitiesMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),this.renderMasterList(),this.displayGroups.length&&this.clickOnGroupHeading(this.displayGroups[0])},setRangeConversion:function(e){this.rangeConversion=e,this.createDatePickerView.setRangeConversion(e),this.destroyDatePickerView.setRangeConversion(e),this.createOffsetPickerView.setRangeConversion(e),this.destroyOffsetPickerView.setRangeConversion(e)},renderMasterList:function(){var e=this,t=this.model.get("template"),i=this.model.get("entitiesByType");types=t.types,index=0,newSelection=null;var n,s,a,o,r,d;index=0,_.each(types,function(e){this.displayGroups.length<=index?this.displayGroups.push({type:e,icon:"star",items:[]}):(this.displayGroups[index].type=e,this.displayGroups[index].icon="star",this.displayGroups[index].items=[]),index++},this),types.length<this.displayGroups.length&&this.displayGroups.splice(types.length,this.displayGroups.length-types.length),_.each(i,function(e,t){var i=_.find(this.displayGroups,function(e){return ATUtilities.caseInsensitiveCompare(e.type.name,t)},this);i&&_.each(e,function(e){e.icon||(e.icon=i.icon),i.items.push(e),this.selectedEntity&&e.entityId==this.selectedEntity.entityId?newSelection=e:this.requireSelectAndFocus&&e.name==this.selectAndFocusName&&(newSelection=e)},this)},this),n=this.d3MasterList.selectAll(".group").data(this.displayGroups),n.select(".groupHeading").select("span").html(function(e){return e.type.name}),o=n.select("ul"),r=o.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==newSelection}),r.select("span").html(function(e){return e.name}),r.select("i").attr("class",function(e){return"fa fa-"+e.icon}),d=r.enter().append("li").classed("selected",function(e){return e==newSelection}).on("click",function(t){return e.clickOnListItem(t)}),d.append("i").attr("class",function(e){return"fa fa-"+e.icon}),d.append("span").html(function(e){return e.name}),r.exit().remove(),s=n.enter().append("div").classed("group",!0),a=s.append("div").classed("groupHeading",!0).on("click",function(t){e.clickOnGroupHeading(t)}),a.append("span").html(function(e){return e.type.name}),a.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)),o=s.append("ul").style("max-height","0px"),r=o.selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==newSelection}),d=r.enter().append("li").classed("selected",function(e){return e==newSelection}).on("click",function(t){return e.clickOnListItem(t)}),d.append("i").attr("class",function(e){return"fa fa-"+e.icon}),d.append("span").html(function(e){return e.name}),n.exit().remove(),this.selectedEntity=newSelection,this.updateDetailFields(),this.animateExpansion()},updateEventDropdowns:function(){var e=this.model.get("timeline").get("events").models,t=[{value:-1,sortValue:"-1",label:"(No Event)"}];_.each(e,function(e){t.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),this.addChildrenOfEventsToOptions(t,e)},this),t.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(i.length,n.length),a=0;for(a=0;s>a;a++)if(i[a]!=n[a])return i[a]-n[a];return i.length-n.length}),this.createEventSearchDropdown.setOptions(t),this.destroyEventSearchDropdown.setOptions(t)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},updateDetailFields:function(){var e=this,t=(this.model.get("template"),this.model.get("entitiesByType"),null),i=null;this.rangeConversion&&(this.updateEventDropdowns(),this.selectedEntity?(this.$nameInput.val(this.selectedEntity.name),this.$notesInput.val(this.selectedEntity.notes),this.$nameInput.prop("disabled",!1),this.$notesInput.prop("disabled",!1),this.$colorInput.val(this.selectedEntity.color),this.$colorInput.prop("disabled",!1),this.$colorInput.spectrum("set",this.selectedEntity.color),this.$colorInput.spectrum("enable"),this.createEventSearchDropdown.setDisabled(!1),this.destroyEventSearchDropdown.setDisabled(!1),this.selectedEntity.createPosition&&this.rangeConversion&&(t=this.rangeConversion.valueForPartialString(this.selectedEntity.createPosition)),t?this.createDatePickerView.setValue(t.value):this.createDatePickerView.setValue(null),this.selectedEntity.destroyPosition&&this.rangeConversion&&(i=this.rangeConversion.valueForPartialString(this.selectedEntity.destroyPosition)),i?this.destroyDatePickerView.setValue(i.value):this.destroyDatePickerView.setValue(null),this.selectedEntity.createEvent.eventId>0?(this.createEventSearchDropdown.setValue(this.selectedEntity.createEvent.eventId),this.createDatePickerView.setDisabled(!0),this.createOffsetPickerView.setText(this.selectedEntity.createEvent.offsetString),this.createOffsetPickerView.setDisabled(!1),this.createOffsetFromDropdown.setValue(this.selectedEntity.createEvent.baseString),this.createOffsetFromDropdown.setDisabled(!1)):(this.createEventSearchDropdown.setValue(-1),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setValue("start"),this.createOffsetFromDropdown.setDisabled(!0)),this.selectedEntity.destroyEvent.eventId>0?(this.destroyEventSearchDropdown.setValue(this.selectedEntity.destroyEvent.eventId),this.destroyDatePickerView.setDisabled(!0),this.destroyOffsetPickerView.setText(this.selectedEntity.destroyEvent.offsetString),this.destroyOffsetPickerView.setDisabled(!1),this.destroyOffsetFromDropdown.setValue(this.selectedEntity.destroyEvent.baseString),this.destroyOffsetFromDropdown.setDisabled(!1)):(this.destroyEventSearchDropdown.setValue(-1),this.destroyDatePickerView.setDisabled(!1),this.destroyOffsetPickerView.setDurationComponents([]),this.destroyOffsetPickerView.setDisabled(!0),this.destroyOffsetFromDropdown.setValue("start"),this.destroyOffsetFromDropdown.setDisabled(!0)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1)):(this.$nameInput.val(""),this.$notesInput.val(""),this.$nameInput.prop("disabled",!0),this.$notesInput.prop("disabled",!0),this.$colorInput.val(""),this.$colorInput.prop("disabled",!0),this.$colorInput.spectrum("set","#ccc"),this.$colorInput.spectrum("disable"),this.createOffsetPickerView.setDurationComponents([]),this.destroyOffsetPickerView.setDurationComponents([]),this.createOffsetFromDropdown.setValue("start"),this.destroyOffsetFromDropdown.setValue("start"),this.createEventSearchDropdown.setValue(-1),this.destroyEventSearchDropdown.setValue(-1),this.createDatePickerView.setValue(null),this.destroyDatePickerView.setValue(null),this.createEventSearchDropdown.setDisabled(!0),this.createDatePickerView.setDisabled(!0),this.destroyEventSearchDropdown.setDisabled(!0),this.destroyDatePickerView.setDisabled(!0),this.createOffsetPickerView.setDisabled(!0),this.destroyOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0),this.destroyOffsetFromDropdown.setDisabled(!0)),this.setNameFieldIsInvalid(!1))},resetCreateDateField:function(){this.createDatePickerView.setValue(null)},resetDestroyDateField:function(){this.destroyDatePickerView.setValue(null)},clickOnGroupHeading:function(e){this.expandedTypeId==e.type.typeId?(this.expandedTypeId=null,this.selectedEntity=null):(this.expandedTypeId=e.type.typeId,this.selectedEntity=e.items.length?e.items[0]:null),e.type.persistent?this.d3AgeGroupDiv.style("display","none"):this.d3AgeGroupDiv.style("display",null),this.animateExpansion(),this.updateDetailFields()},immediateUpdateExpandedGroupHeight:function(){var e=this,t=this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedTypeId==t.type.typeId});t.select("ul").style("max-height",function(t){var i=0;return e.expandedTypeId!=t.type.typeId?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedEntity==t})},animateExpansion:function(){var e=this,t=this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedTypeId==t.type.typeId});t.select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedTypeId!=t.type.typeId?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedEntity==t})},clickOnListItem:function(e){var t=this;this.selectedEntity=e,this.d3MasterList.selectAll("li").classed("selected",function(e){return t.selectedEntity==e}),this.updateDetailFields()},findEntityWithName:function(e){var t=null,i=this.model.get("entitiesByType");return _.each(i,function(i,n){var s=_.find(i,function(t){return t.name==e});null!=s&&(t=s)}),t},addListItem:function(e){for(var t="New Entity",i=0;this.findEntityWithName(t);)i++,t="New Entity "+i;return this.selectedEntity=null,this.requireSelectAndFocus=!0,this.selectAndFocusName=t,window.ApplicationInterface&&window.ApplicationInterface.addEntity(window.timelineDocumentId,t,e.type.typeId,-1,"",!1,""),d3.event.stopPropagation(),!1},removeSelectedItem:function(e){var t=this.selectedEntity?this.selectedEntity.entityId:-1,i=this.model.get("template"),n=(this.model.get("entitiesByType"),i.types,_.find(this.displayGroups,function(e){return e.type.typeId==this.expandedTypeId},this)),s=_.indexOf(n.items,this.selectedEntity);return null==this.selectedEntity?(e.stopPropagation(),void e.preventDefault()):(s==n.items.length-1?s>0?this.selectedEntity=n.items[s-1]:this.selectedEntity=null:this.selectedEntity=n.items[s+1],window.ApplicationInterface&&window.ApplicationInterface.removeEntity(window.timelineDocumentId,t),e.stopPropagation(),e.preventDefault(),!1)},moveSelectedItemUp:function(){var e,t=this.selectedEntity?this.selectedEntity.entityId:-1,i=this.model.get("template"),n=(this.model.get("entitiesByType"),i.types,_.find(this.displayGroups,function(e){return e.type.typeId==this.expandedTypeId},this)),s=_.indexOf(n.items,this.selectedEntity);this.selectedEntity&&0!=s&&(e=n.items[s-1],window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,t,e.entityId))},moveSelectedItemDown:function(){var e,t=this.selectedEntity?this.selectedEntity.entityId:-1,i=this.model.get("template"),n=(this.model.get("entitiesByType"),i.types,_.find(this.displayGroups,function(e){return e.type.typeId==this.expandedTypeId},this)),s=_.indexOf(n.items,this.selectedEntity);!this.selectedEntity||s>=n.items.length||(e=n.items[s+1],window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,t,e.entityId))},sortItemsAlphabetically:function(){window.ApplicationInterface&&window.ApplicationInterface.sortEntitiesOfType(window.timelineDocumentId,this.expandedTypeId)},entityNameInput:function(){if(this.selectedEntity){var e=this.$nameInput.val(),t=this.BadWords,i=this.selectedEntity.name,n=new RegExp(/[\<\>\{\}\[\]]/),s=!1;console.log("entityNameInput called"),e&&0!==e.length?_.find(t,function(t){return t==e},this)?s=!0:n.test(e)?s=!0:e!=i&&this.findEntityWithName(e)&&(s=!0):s=!0}this.setNameFieldIsInvalid(s)},setNameFieldIsInvalid:function(e){this.$nameInput[0].setCustomValidity(e?"Error":"")},entityNameChanged:function(){if(this.selectedEntity){var e=this.$nameInput.val(),t=this.BadWords,i=this.selectedEntity.name,n=new RegExp(/[\<\>\{\}\[\]]/);console.log("entityNameChanged called"),e&&0!==e.length?_.find(t,function(t){return t==e},this)?e=i:n.test(e)?e=i:this.findEntityWithName(e)&&(e=i):e=i,this.setNameFieldIsInvalid(!1),this.$nameInput.val(e),window.ApplicationInterface&&window.ApplicationInterface.setEntityName(window.timelineDocumentId,e,this.selectedEntity.entityId)}},entityNotesChanged:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityNotes(window.timelineDocumentId,this.$notesInput.val(),this.selectedEntity.entityId)},entityColorChanged:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityColor(window.timelineDocumentId,this.$colorInput.val(),this.selectedEntity.entityId)},createPositionChangeHandler:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityCreatePosition(window.timelineDocumentId,this.createDatePickerView.text(),this.selectedEntity.entityId)},destroyPositionChangeHandler:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityDestroyPosition(window.timelineDocumentId,this.destroyDatePickerView.text(),this.selectedEntity.entityId)},createEventChangeHandler:function(){var e=this.createEventSearchDropdown.getValue();this.selectedEntity&&(e>0?(this.destroyOffsetPickerView.setDisabled(!0),0==this.createOffsetPickerView.text().length&&(this.createOffsetPickerView.setText("0 seconds"),this.createOffsetFromDropdown.setValue("start")),window.ApplicationInterface&&window.ApplicationInterface.setEntityCreateEvent(window.timelineDocumentId,e,this.createOffsetPickerView.text(),"start"==this.createOffsetFromDropdown.getValue(),this.selectedEntity.entityId)):window.ApplicationInterface&&window.ApplicationInterface.removeEntityCreateEvent(window.timelineDocumentId,this.selectedEntity.entityId))},destroyEventChangeHandler:function(){var e=this.destroyEventSearchDropdown.getValue();this.selectedEntity&&(e>0?(0==this.destroyOffsetPickerView.text().length&&(this.destroyOffsetPickerView.setText("0 seconds"),this.destroyOffsetFromDropdown.setValue("start")),window.ApplicationInterface&&window.ApplicationInterface.setEntityDestroyEvent(window.timelineDocumentId,e,this.destroyOffsetPickerView.text(),"start"==this.destroyOffsetFromDropdown.getValue(),this.selectedEntity.entityId)):window.ApplicationInterface&&window.ApplicationInterface.removeEntityDestroyEvent(window.timelineDocumentId,this.selectedEntity.entityId))}});module.exports=ATManageEntitiesView;
},{"./ATDatePicker":23,"./ATDropdown":29,"./ATDurationPicker":30,"./ATSearchDropdown":77,"./ATUtilities":91,"./templates/manageEntitiesTemplate.html":154,"./templates/masterList.html":155,"./templates/optionsTemplate.html":158,"backbone":176,"d3":300,"jquery":307,"lodash":309}],63:[function(require,module,exports){
var ATMonth=function(t,i,n,o,h){this.index=t,this.normalDuration=o,this.leapDuration=h,this.name=i,this.shortName=n};module.exports=ATMonth;
},{}],64:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/newParentTemplate.html"),ATNewParentView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,n=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(n({eventTitle:"New Event"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$eventTitle=$("#newParentEventTitle"),$("#newParentYesButton").on("click",function(e){t.resultHandler(!0,e)}),$("#newParentNoButton").on("click",function(e){t.resultHandler(!1,e)})},setParentEventTitle:function(e){this.$eventTitle.text(e)},setCallback:function(e){this.callbackFunction=e},resultHandler:function(e,t){return this.callbackFunction&&this.callbackFunction(e),window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATNewParentView;
},{"./templates/newParentTemplate.html":156,"backbone":176,"d3":300,"jquery":307,"lodash":309}],65:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),d3=require("d3"),Backbone=require("backbone"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATOnboarding=function(){this.onboardObjects={},this.onboardElements={},this.d3OnboardWrapper=d3.select("#onboardingWrapper"),this.d3ArrowsWrapper=d3.select("#onboardingArrowsWrapper")};ATOnboarding.prototype.showOnboardingSequence=function(t){"first-time-user"==t?this.showFirstTimeUserOnboarding():"version1-upgrade"==t?this.showV1UpgradeOnboarding():"filter"==t?this.showFilterOnboarding():"scrivener"==t?this.showScrivenerOnboarding():"scrivener-conflict"==t&&this.showScrivenerConflictOnboarding()},ATOnboarding.prototype.hideOnboardingSequence=function(t){var e=this,i=_.clone(this.onboardObjects);_.each(i,function(i,n){i.sequence==t&&e.hideOnboardingMessage(i.id)})},ATOnboarding.prototype.showFirstTimeUserOnboarding=function(){this.onboardObjects.scrollContext={sequence:"first-time-user",id:"scrollContext",text:"Scroll timeline by<br /> dragging this lens",position:{target:".contextLens",targetAlignH:"left",targetAlignV:"top",divEdgeH:"center",divEdgeV:"bottom",marginX:60,marginY:10},arrow:null,hasIcon:"fa-times-circle",removeOnClose:!0,showNext:null},this.onboardObjects["firstTimer-addEvent"]={sequence:"first-time-user",id:"firstTimer-addEvent",text:"Double click anywhere on the timeline to add an event",position:{target:"#mainTimelineContentDiv",targetAlignH:"center",targetAlignV:"center",divEdgeH:"center",divEdgeV:"center",marginX:0,marginY:0},arrow:null,hasIcon:!1,removeOnClose:!1,showNext:"firstTimer-addEntity"},this.onboardObjects["firstTimer-addEntity"]={sequence:"first-time-user",id:"firstTimer-addEntity",text:"Add people and projects",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:window.mainApp.isWindows?245:145,marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+55:55},arrow:{target:null,targetAlignH:"left",targetAlignV:"top",offsetX:window.mainApp.isWindows?190:90,offsetY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+10:10,flipX:!0,flipY:!0},hasIcon:"fa-times-circle",removeOnClose:!1,showNext:"firstTimer-addRelationship"},this.onboardObjects["firstTimer-addRelationship"]={sequence:"first-time-user",id:"firstTimer-addRelationship",text:"Assign entities to events<br /> under the Roles tab",position:{target:"#inspector",targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:-20,marginY:440},arrow:{target:"#Roles-tab-button",targetAlignH:"center",targetAlignV:"bottom",offsetX:0,offsetY:10,flipX:!1,flipY:!0},hasIcon:"fa-times-circle",removeOnClose:!1,showNext:"firstTimer-laneGrouping"},this.onboardObjects["firstTimer-laneGrouping"]={sequence:"first-time-user",id:"firstTimer-laneGrouping",text:"Divide events by person or project",position:{target:null,targetAlignH:"right",targetAlignV:"top",divEdgeH:"right",divEdgeV:"top",marginX:370,marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+55:55},arrow:{target:null,targetAlignH:"right",targetAlignV:"top",offsetX:window.mainApp.isWindows?-180:-230,offsetY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+10:10,flipX:!1,flipY:!0},hasIcon:"fa-times-circle",removeOnClose:!0,showNext:null,lastForSequence:"first-time-user"},this.showOnboardingMessage("firstTimer-addEvent"),this.showOnboardingMessage("scrollContext")},ATOnboarding.prototype.showV1UpgradeOnboarding=function(){this.onboardObjects["v1-arcsAreEntities"]={sequence:"version1-upgrade",id:"v1-arcsAreEntities",text:"Arcs are now another entity type",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:window.mainApp.isWindows?245:145,marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+55:55},arrow:{target:null,targetAlignH:"left",targetAlignV:"top",offsetX:window.mainApp.isWindows?190:90,offsetY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+10:10,flipX:!0,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"v1-laneGrouping"},this.onboardObjects["v1-laneGrouping"]={sequence:"version1-upgrade",id:"v1-laneGrouping",text:"Divide events by anything (not just arcs)",position:{target:null,targetAlignH:"right",targetAlignV:"top",divEdgeH:"right",divEdgeV:"top",marginX:370,marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+55:55},arrow:{target:null,targetAlignH:"right",targetAlignV:"top",offsetX:window.mainApp.isWindows?-180:-230,offsetY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+10:10,flipX:!1,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"v1-addRelationship"},this.onboardObjects["v1-addRelationship"]={sequence:"version1-upgrade",id:"v1-addRelationship",text:"Relationship now set<br />under Roles tab",position:{target:"#inspector",targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:-20,marginY:440},arrow:{target:"#Roles-tab-button",targetAlignH:"center",targetAlignV:"bottom",offsetX:0,offsetY:10,flipX:!1,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"v1-dependencies"},this.onboardObjects["v1-dependencies"]={sequence:"version1-upgrade",id:"v1-dependencies",text:"Make events depend<br />on other events",position:{target:"#inspector",targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:-260,marginY:290},arrow:{target:"#Range-tab-button",targetAlignH:"center",targetAlignV:"bottom",offsetX:0,offsetY:10,flipX:!1,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"v1-parent"},this.onboardObjects["v1-parent"]={sequence:"version1-upgrade",id:"v1-parent",text:"Nest sub-events under<br />parent events",position:{target:"#inspector",targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:-260,marginY:190},arrow:{target:"#inspectorParent",targetAlignH:"left",targetAlignV:"bottom",offsetX:20,offsetY:5,flipX:!1,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"v1-bookmarks"},this.onboardObjects["v1-bookmarks"]={sequence:"version1-upgrade",id:"v1-bookmarks",text:"Add bookmarks to navigate quickly",position:{target:".bookmarkAdd",targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"bottom",marginX:180,marginY:40},arrow:{target:".bookmarkAdd",targetAlignH:"center",targetAlignV:"top",offsetX:0,offsetY:-5,flipX:!0,flipY:!1},hasIcon:"fa-times-circle",removeOnClose:!0,showNext:null,lastForSequence:"version1-upgrade"},this.showOnboardingMessage("v1-arcsAreEntities")},ATOnboarding.prototype.showFilterOnboarding=function(){this.onboardObjects["filter-field"]={sequence:"filter",id:"filter-field",text:"Type any field, property or role name",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:(window.mainApp.isWindows,120),marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+100:100},arrow:{target:"#filterBarInlineAdd",targetAlignH:"left",targetAlignV:"bottom",offsetX:25,offsetY:15,flipX:!0,flipY:!0},hasIcon:"null",removeOnClose:!1,showNext:"filter-value"},this.onboardObjects["filter-value"]={sequence:"filter",id:"filter-value",text:"Enter value, name or comparison (eg. > 2000)",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:(window.mainApp.isWindows,220),marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+100:100},arrow:{target:"#filterBarInlineAdd",targetAlignH:"left",targetAlignV:"bottom",offsetX:125,offsetY:15,flipX:!0,flipY:!0},hasIcon:"null",removeOnClose:!1,showNext:"filter-save"},this.onboardObjects["filter-save"]={sequence:"filter",id:"filter-cog",text:"Click cog to save/load filters",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:(window.mainApp.isWindows,120),marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+100:100},arrow:{target:".filterControl",targetAlignH:"left",targetAlignV:"bottom",offsetX:15,offsetY:10,flipX:!0,flipY:!0},hasIcon:"fa-times-circle",removeOnClose:!0,showNext:null,lastForSequence:"filter"}},ATOnboarding.prototype.showScrivenerOnboarding=function(){this.onboardObjects["scriv-dragevent-in"]={sequence:"scrivener",id:"scriv-dragevent-in",text:"Drag events into binder<br /> to create documents",position:{target:"#syncBinderContent",targetAlignH:"right",targetAlignV:"bottom",divEdgeH:"left",divEdgeV:"middle",marginX:50,marginY:-100},arrow:{target:"#syncBinderTreeContainer",targetAlignH:"middle",targetAlignV:"bottom",offsetX:0,offsetY:-200,flipX:!0,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"scriv-dragevent-out"},this.onboardObjects["scriv-dragevent-out"]={sequence:"scrivener",id:"scriv-dragevent-out",text:"Drag documents into timeline<br /> to create events",position:{target:"#syncBinderTreeContainer",targetAlignH:"middle",targetAlignV:"bottom",divEdgeH:"middle",divEdgeV:"middle",marginX:0,marginY:-100},arrow:{target:"#syncBinderContent",targetAlignH:"right",targetAlignV:"bottom",offsetX:100,offsetY:-200,flipX:!1,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"scriv-right-click-options"},this.onboardObjects["scriv-right-click-options"]={sequence:"scrivener",id:"scriv-right-click-options",text:"Right-click document for<br />more options",position:{target:"#syncBinderTreeContainer",targetAlignH:"middle",targetAlignV:"bottom",divEdgeH:"middle",divEdgeV:"middle",marginX:0,marginY:-100},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"scriv-sync-status"},this.onboardObjects["scriv-sync-status"]={sequence:"scrivener",id:"scriv-sync-status",text:"Sync status shown<br />next to documents",position:{target:"#syncBinderContent",targetAlignH:"right",targetAlignV:"top",divEdgeH:"left",divEdgeV:"middle",marginX:50,marginY:250},arrow:{target:"#syncBinderTreeContainer",targetAlignH:"right",targetAlignV:"top",offsetX:-15,offsetY:100,flipX:!0,flipY:!0},hasIcon:"fa-arrow-circle-right",removeOnClose:!0,showNext:"scriv-sync-changes"},this.onboardObjects["scriv-sync-changes"]={sequence:"scrivener",id:"scriv-sync-changes",text:"Sync changes between<br />project and timeline",position:{target:"#syncBinderContent",targetAlignH:"right",targetAlignV:"top",divEdgeH:"left",divEdgeV:"middle",marginX:50,marginY:250},arrow:{target:"#syncBinderSyncButton",targetAlignH:"middle",targetAlignV:"bottom",offsetX:0,offsetY:5,flipX:!0,flipY:!0},hasIcon:"fa-times-circle",removeOnClose:!0,showNext:null,lastForSequence:"scrivener"},this.showOnboardingMessage("scriv-dragevent-in")},ATOnboarding.prototype.showScrivenerConflictOnboarding=function(){this.onboardObjects["scriv-conflict"]={sequence:"scrivener-conflict",id:"scriv-conflict",text:"Conflicts can be manually resolved by right-clicking.",position:{target:null,targetAlignH:"left",targetAlignV:"top",divEdgeH:"left",divEdgeV:"top",marginX:(window.mainApp.isWindows,120),marginY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+100:100},arrow:{target:null,targetAlignH:"left",targetAlignV:"top",offsetX:(window.mainApp.isWindows,20),offsetY:window.mainApp.isWindows?TimelineDisplayConstants.toolbarHeight+50:50,flipX:!0,flipY:!0},hasIcon:null,removeOnClose:!0,showNext:null,lastForSequence:"scrivener-conflict-onboarding"},this.showOnboardingMessage("scriv-conflict")},ATOnboarding.prototype.activeCount=function(){return _.keys(this.onboardObjects).length},ATOnboarding.prototype.showOnboardingMessage=function(t){var e=this,i=d3.select("#onboardingWrapper"),n=d3.select("#onboarding-"+t),o=d3.select("#onboardingArrow-"+t),r=this.onboardObjects[t];r&&(n.empty()&&(n=i.append("div").attr("id","onboarding-"+t).classed("onboarding",!0).style("opacity","0")),n.html(r.text),r.hasIcon&&n.append("i").classed("fa closeButton",!0).classed(r.hasIcon,!0).on("click",function(){r.removeOnClose?e.removeOnboardingMessage(t):e.hideOnboardingMessage(t)}),r.arrow&&o.empty()&&(d3.select("#onboardingArrowsWrapper").append("g").attr("id","onboardingArrow-"+t).classed("onboardingArrow",!0).append("path").attr("filter","url(#chalk)"),o=d3.select("#onboardingArrow-"+t).style("opacity","0")),r.div=n,r.arrowG=o,this.onboardElements[t]=r,this.positionOnboardingMessage(r))},ATOnboarding.prototype.removeOnboardingMessage=function(t,e){var i=this.onboardObjects[t];this.hideOnboardingMessage(t),i&&i.showNext&&this.showOnboardingMessage(i.showNext),i&&i.lastForSequence&&window.ApplicationInterface&&window.ApplicationInterface.onboardingSequenceComplete(window.timelineDocumentId,i.lastForSequence),delete this.onboardObjects[t]},ATOnboarding.prototype.hideOnboardingMessage=function(t){var e=(this.onboardObjects[t],d3.select("#onboarding-"+t));e.style("opacity",1).transition().style("opacity",0).remove();var i=d3.select("#onboardingArrow-"+t);i.style("opacity",1).transition().style("opacity",0).remove(),delete this.onboardElements[t]},ATOnboarding.prototype.repositionOnboardingElements=function(){_.each(this.onboardElements,function(t,e){this.positionOnboardingMessage(t)},this)},ATOnboarding.prototype.positionOnboardingMessage=function(t){var e,i,n,o,r,s,a=t.div,g=$(a[0]),l=t.position,d=t.arrow,c={x:0,y:0},p={x:0,y:0},f={x:0,y:0};if(l){if(l.target?(n=$(l.target),o=n.offset(),r={width:n.outerWidth(),height:n.outerHeight()}):(n=$(window),o={left:0,top:0},r={width:n.width(),height:n.height()}),0==n.length)return;s={width:g.outerWidth(),height:g.innerHeight()},"left"==l.targetAlignH?c.x=o.left:"right"==l.targetAlignH?c.x=o.left+r.width:c.x=o.left+r.width/2,"top"==l.targetAlignV?c.y=o.top:"bottom"==l.targetAlignV?c.y=o.top+r.height:c.y=o.top+r.height/2,"left"==l.divEdgeH?c.x+=l.marginX:"right"==l.divEdgeH?c.x-=s.width+l.marginX:c.x-=s.width/2-l.marginX,"top"==l.divEdgeV?c.y+=l.marginY:"bottom"==l.divEdgeV?c.y-=s.height+l.marginY:c.y-=s.height/2-l.marginY,a.style("left",c.x+"px"),a.style("top",c.y+"px"),a.transition().style("opacity",1)}if(d){if(p={x:d.flipX?c.x-5:c.x+s.width+5,y:c.y+s.height/2},d.target?(n=$(d.target),o=n.offset(),r={width:n.outerWidth(),height:n.outerHeight()}):(n=$(window),o={left:0,top:0},r={width:n.width(),height:n.height()}),0==n.length)return;"left"==d.targetAlignH?f.x=o.left+d.offsetX:"right"==d.targetAlignH?f.x=o.left+r.width+d.offsetX:f.x=o.left+r.width/2+d.offsetX,"top"==d.targetAlignV?f.y=o.top+d.offsetY:"bottom"==d.targetAlignV?f.y=o.top+r.height+d.offsetY:f.y=o.top+r.height/2+d.offsetY,window.mainApp.isWindows&&(p.y-=TimelineDisplayConstants.toolbarHeight,f.y-=TimelineDisplayConstants.toolbarHeight,console.log("Windows: corrected to arrowStart.y = "+p.y+", arrowEnd.y = "+f.y)),i=Math.abs(f.x-p.x),arrowHeight=Math.abs(f.y-p.y),e="M 0,0  q "+i+",0 "+i+","+arrowHeight+" m 0,8 m -12,-12 l 12,12 l 12, -12",t.arrowG.attr("transform","translate("+p.x+" "+p.y+") scale("+(d.flipX?-1:1)+" "+(d.flipY?-1:1)+")").select("path").attr("d",e),t.arrowG.transition().style("opacity",1)}},module.exports=ATOnboarding;
},{"./ATDisplayConstants":26,"backbone":176,"d3":300,"jquery":307,"lodash":309}],66:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/onboardingTemplate.html"),ATOnboardingView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.pages=[],this.currentPage=0,this.currentCategory=null,this.categoryTitle="",this.categoryHelpUrl="",this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.d3CategorySpan=d3.select("#onboardingCategory"),this.d3ContentDiv=d3.select("#onboardingContent"),this.d3TitleText=d3.select("#onboardingTitle"),this.d3PageSpan=d3.select("#onboardingPage"),this.d3TotalPagesSpan=d3.select("#onboardingPages"),this.$nextButton=$("#onboardingNext"),this.$prevButton=$("#onboardingPrev"),this.$nextButton.on("click",this.nextClickHandler.bind(this)),this.$prevButton.on("click",this.prevClickHandler.bind(this)),$("#btnOnboardingHelp").on("click",this.helpClickHandler.bind(this))},configureForCategory:function(e){"version1-upgrade"==e?this.configureAsV1Upgrade():"first-time-user"==e?this.configureAsFirstTimeUser():"filter"==e?this.configureAsFilter():"scrivener"==e?this.configureAsScrivener():this.pages=[],this.currentPage=0,this.currentCategory=e,this.render()},configureAsV1Upgrade:function(){this.pages=[{title:"Version 2: Some Important Changes",template:"<p></p><p>Click through these tips for a quick overview, but we highly recommend clicking on <strong>Online Help</strong> below for a summary of the changes and where you can find things in Aeon Timeline 2.</p>"},{title:"Arcs are entities",template:'<p>The only way to group events in version 1 was to divide them into different "Arcs". In Aeon Timeline 2, Arcs are now just another type of Entity.</p><p>Each template (Fiction, Legal, Project Management, etc.) defines its own entity types.</p><p>When upgrading a version 1 file, we use a template that matches your original version 1 timeline as closely as possible.</p>'},{title:"Group by any entity type",template:'<p>Aeon Timeline 2 allows you to group events by any entity type.</p><p>Click on the Group by button in the toolbar <i class="fa fa-align-justify"></i><i class = "fa fa-angle-down"></i> to switch from grouping by Arc to grouping by another type such as Person.</p><p>As events can have relationships with multiple People, it is possible for the same event to appear in multiple groups. When you click on such an event to select it, all copies of that event will be highlighted.</p>'},{title:"Setting relationships",template:'<p>Relationships between events and entities (including Arcs) are configured in the "Roles" tab in the Inspector.</p><p>Set birth dates/events for people in the Manage Entities dialog.</p><p> Once set, group by "Person" to see their ages shown at the top of each group.</p>'},{title:"Settings",template:"<p>Under Timeline Settings, you can define your own Entity Types, Roles and Properties. If you have been using version 1 for something other than fiction, you can also rename the existing entity types in your upgraded file to something more suitable (e.g. rename Arc to Project).</p><p>Under Display Settings, choose your preferred skin color, font size, and what information is displayed when you expand an event.</p>"},{title:"Dependencies and parents",template:'<p>Some new features you may want to explore:<ul><li>Make events depend on other events (e.g. tie an event to be exactly 10 years after an earlier event) under the "Range" tab in the Inspector.</li><li>Make events a sub-event under a parent in the Inspector, or hold "Alt" while dragging an event onto a parent.</li></ul></p>'},{title:"Navigation",template:'<p>Some tips to help you navigate quickly around your timeline:<ul><li>Click "First" or "Last" in the Bookmarks Bar at the bottom of the screen to go to the first or last event.</li><li>Add your own Bookmarks to quickly navigate to a set zoom and time.</li><li>Type a date in the search bar to scroll to that date.</li></ul></p>'}],this.categoryTitle="Upgrading Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/upgrading-from-version1/"},configureAsFirstTimeUser:function(){this.pages=[{title:"Welcome to Aeon Timeline 2",template:"<p></p><p>Click through these tips to help get you started with Version 2.</p><p>We highly recommend clicking on <strong>Online Help</strong> below for a broader introduction to Aeon Timeline 2.</p>"},{title:"Adding events",template:'<p>Add Events using the toolbar icon <i class="fa fa-plus-circle"></i> or by double clicking on the timeline (this pre-fills the dialog with the date where you clicked).</p><p>If you are new to Aeon Timeline, the best way to get started is to fill your timeline with events.</p><p>When it starts to feel a bit cluttered, you can then begin to bring in other elements (such as People/Places/Arcs/Projects) to give your timeline more structure.</p>'},{title:"Adding entities",template:'<p>Add entities (eg. people, places, projects) to your timeline with the "Add Entity" button on the toolbar.</p><p>Available entity types and roles depend on your chosen template, for example:<br /><ul><li><strong>Fiction</strong> contains Arc, Place, and Character.</li><li><strong>Project Management</strong> contains Project and Employee.</li><li><strong>Legal</strong> contains Person (with Client/Witness roles) and Category.</li></ul>You can configure your own entity types under Timeline Settings.</p>'},{title:"Adding relationships",template:"<p>Click on the Roles tab in the Inspector to set relationships between events and entities.</p>"},{title:"Group by any entity type",template:'<p>As you add events, you will eventually want to divide them into groups on your timeline.</p><p>Click on the "Group by" button in the toolbar <i class="fa fa-align-justify"></i><i class = "fa fa-angle-down"></i> to choose the entity type to use when grouping events.</p><p>If you have added a creation date/event for an entity (e.g. a character\'s birth), entity ages will be shown at the top of each group.</p>'},{title:"Navigation",template:'<p>Some tips to help you navigate quickly around your timeline:<ul><li>Click "First" or "Last" in the Bookmarks Bar at the bottom of the screen to go to the first or last event.</li><li>Add your own Bookmarks to quickly navigate to a set zoom and time.</li><li>Type a date in the search bar to scroll to that date.</li></ul></p>'},{title:"Explore more",template:"<p>When you are comfortable with the basics, go to the Help menu for more advanced onboarding tips.</p>"}],this.categoryTitle="Getting Started Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/getting-started/"},configureAsFilter:function(){this.pages=[{title:"Available filters",template:"<p>Click on the filter bar to add a new filtering criteria.</p><p>For 'field', you can enter 'title', 'date', 'color', 'parent', 'tag', or the name of any property, entity type or role.</p><p>When you begin typing a field name, the filter bar will auto-complete the first available option that begins with your typed text. If your desired option is shown as the auto-complete, you can hit 'tab' to begin entering the value. Otherwise, continue typing additional characters until your intended value is shown."},{title:"Available values",template:"<p>When filtering by entity type or role, the 'value' can be an entity name or 'None' if you want to find unallocated events.</p><p>When filtering by date or a numeric value, the 'value' can including comparisons such as '> 2000' or 'before August 2010'.</p>"},{title:"Saving filters",template:'<p>You can save and reload filters that you expect to use frequently by clicking on the Settings icon <i class="fa fa-cog"></i> in the Filter Bar.</p>'}],this.categoryTitle="Filtering Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/filtering/"},configureAsScrivener:function(){this.pages=[{title:"Introduction to Scrivener syncing",template:"<p>Scrivener syncing allows you to link events in your timeline with documents in your Scrivener project.</p><p>Aeon Timeline will keep track of changes made to timeline events or Scrivener documents. Each time you sync, any changes made to the event will be copied across to the corresponding metadata for the Scrivener document, and vice versa.</p><p>When a Scrivener project is opened, its Binder is represented on the left side of the Aeon Timeline interface. This is a fully functional Binder - you can drag documents around in this binder and it will be reflected in Scrivener when you next run that application.</p>"},{title:"Sync settings",template:'<p>The first time you sync, you will be asked to choose which timeline values you want to sync with the Scrivener project.</p><p>You can sync any timeline event fields, including title, dates, properties, and relationships.</p><p>On the Scrivener side, you can sync with the document title, synopsis, label, existing custom metadata fields, or you can choose to create a new custom metadata field for certain timeline properties</p><p>You can change your sync settings at any time by clicking on the Settings icon <i class="fa fa-cog"></i> in the Scrivener binder.</p>'},{title:"Creating new items",template:"<p>To create a new timeline event from a Scrivener document, simply drag documents from the binder into the timeline area.</p><p>To create a new Scrivener document from a timeline event, simply drag events from the timeline and drop them into the binder.</p>"},{title:"Linking existing items",template:"<p>If you are starting with a pre-existing timeline and Scrivener project, you will want to link together existing items.</p><p>To do so, right-click on the Scrivener document and choose 'Link to event...'.</p>"},{title:"Syncing status",template:'<p>Each time you sync, the status will be shown next to each document in the binder:</p><p><i class="fa fa-check-circle onboardingSyncIcon" style="color: #5cb85c"></i> Event and document are in sync (no changes)<br /><i class="fa fa-exclamation-circle onboardingSyncIcon" style="color: #f0ad4e"></i> Changes need to be synced<br /><i class="fa fa-exclamation-triangle onboardingSyncIcon" style="color: #d9534f"></i> Conflicting changes must be manually resolved<br /><i class="fa fa-question-circle onboardingSyncIcon" style="color: #bbb"></i> New document</p><p>Click the Sync icon <i class="fa fa-refresh"></i> to sync all changes between the project  and timeline.</p><p>If there are any conflicts, you can resolve them manually by right clicking on the document.</p>'}],this.categoryTitle="Syncing Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/scrivener-syncing/"},render:function(){var e=this.pages[this.currentPage];e&&(this.d3ContentDiv.html(e.template),this.d3TitleText.text(e.title),this.d3PageSpan.text(this.currentPage+1),this.d3TotalPagesSpan.text(this.pages.length),this.d3CategorySpan.text(this.categoryTitle)),this.currentPage>=this.pages.length-1?this.$nextButton.attr("value","Done"):this.$nextButton.attr("value","Next"),this.$prevButton.attr("disabled",0==this.currentPage)},nextClickHandler:function(e){return this.currentPage>=this.pages.length-1?(window.ApplicationInterface&&window.ApplicationInterface.onboardingSequenceComplete(window.timelineDocumentId,this.currentCategory),window.mainApp.removeExistingModal()):(this.currentPage++,this.render()),e.preventDefault(),!1},prevClickHandler:function(e){return this.currentPage>0&&(this.currentPage--,this.render()),e.preventDefault(),!1},helpClickHandler:function(e){if(window.ApplicationInterface&&this.categoryHelpUrl){var t=[{filepath:this.categoryHelpUrl}];window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(t),0)}return e.preventDefault(),!1}});module.exports=ATOnboardingView;
},{"./ATDropdown":29,"./ATUtilities":91,"./templates/onboardingTemplate.html":157,"backbone":176,"d3":300,"jquery":307,"lodash":309}],67:[function(require,module,exports){
var ATPoint=function(t,i){this.x=t,this.y=i};ATPoint.prototype.copy=function(){return new ATPoint(this.x,this.y)},ATPoint.prototype.scale=function(t){this.x*=t,this.y*=t},ATPoint.prototype.debugAsString=function(){return"[ATPoint x: "+this.x+", y: "+this.y+"]"},module.exports=ATPoint;
},{}],68:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATViewMode=require("./ATViewMode"),ATDropdown=require("./ATDropdown"),TimelineDisplayConstants=require("./ATDisplayConstants"),templateHtml=require("./templates/printTemplate.html"),ATRect=require("./ATRect"),ATDatePicker=require("./ATDatePicker"),ATPrintView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Print Options"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#printWindowTitle"),this.d3StartDate=this.d3El.select("#startDateInputPrint"),this.startDatePickerView=new ATDatePicker({el:"#startDateInputPrint"}),this.d3EndDate=this.d3El.select("#endDateInputPrint"),this.endDatePickerView=new ATDatePicker({el:"#endDateInputPrint"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.skinDropdown=new ATDropdown({el:"#printSettingsSkin"}),this.listenTo(this.skinDropdown,"change",this.skinChanged.bind(this)),this.sizeDropdown=new ATDropdown({el:"#printSettingsSize"}),this.listenTo(this.sizeDropdown,"change",this.sizeChanged.bind(this)),this.skinDropdown.setValue("print"),this.sizeDropdown.setValue("100"),this.exportViewport=new ATRect(0,0,0,0),this.printSkin="print",this.printSize=100,this.omitCollapsedLanes=!0,this.currentFormat(),this.$submitButton=$("#printSubmit"),$("#entireTimelinePrint").on("click",this.entireTimeline.bind(this)),$("#formatCurrentPrint").on("click",this.currentFormat.bind(this)),$("#betweenDatesPrint").on("click",this.betweenDates.bind(this)),this.startDatePickerView.setChangeCallback(this.updateDates.bind(this)),this.endDatePickerView.setChangeCallback(this.updateDates.bind(this)),$("#printSettingsOmitCollapsedLanes").on("click",this.omitCollapsedLanesChange.bind(this)),$("#printForm").on("submit",this.addClickHandler.bind(this))},calculateRangeOnShow:function(){var e=(window.mainApp.getUnitScale(),this.printSize/100,$("input[name=Format]:checked","#printForm").val());window.mainApp.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW?($("#betweenDatesPrint").prop("disabled","disabled"),$("#formatCurrentPrint").prop("disabled","disabled"),e="All",$("#entireTimelinePrint").prop("checked",!0),$("#betweenDatesPrint").prop("checked",!1),$("#formatCurrentPrint").prop("checked",!1)):($("#betweenDatesPrint").prop("disabled",null),$("#formatCurrentPrint").prop("disabled",null)),"Current"==e?this.currentFormat():"All"==e?this.entireTimeline():this.betweenDates()},setRangeConversion:function(e){this.startDatePickerView.setRangeConversion(e),this.endDatePickerView.setRangeConversion(e)},currentFormat:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),$("#printSettingsOmitCollapsedLanes").prop("disabled",!0),$("#printSettingsOmitCollapsedLanes").prop("checked",!1),this.exportViewport=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?window.mainApp.timelineView.viewport.deepCopy():window.mainApp.relationshipView.viewport.deepCopy(),$("#widthLabel").text(Math.round(this.exportViewport.size.width)),$("#heightLabel").text(Math.round(this.exportViewport.size.height))},entireTimeline:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),$("#printSettingsOmitCollapsedLanes").prop("disabled",!1),$("#printSettingsOmitCollapsedLanes").prop("checked",!0),this.exportViewport.origin.x=window.mainApp.getEarliestEventPixel(),this.exportViewport.origin.y=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?-TimelineDisplayConstants.timeHeaderHeight:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.exportViewport.size.width=window.mainApp.getLatestEventPixel()-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeight()},betweenDates:function(){$("#printSettingsOmitCollapsedLanes").prop("disabled",!1),$("#printSettingsOmitCollapsedLanes").prop("checked",!0),this.startDatePickerView.setDisabled(!1),this.endDatePickerView.setDisabled(!1),this.updateDates()},updateDates:function(){var e,i;null!==this.startDatePickerView.getValue()&&(e=this.startDatePickerView.getTimestamp()),null!==this.endDatePickerView.getValue()&&(i=this.endDatePickerView.getTimestamp()),isNaN(e)&&isNaN(i)||i>=e&&(this.exportViewport.origin.x=window.mainApp.pixelForTimestamp(e),this.exportViewport.origin.y=-TimelineDisplayConstants.timeHeaderHeight,this.exportViewport.size.width=window.mainApp.pixelForTimestamp(i)-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeight())},skinChanged:function(){this.printSkin=this.skinDropdown.getValue()},sizeChanged:function(){this.printSize=parseInt(this.sizeDropdown.getValue())},omitCollapsedLanesChange:function(){this.omitCollapsedLanes=$("#printSettingsOmitCollapsedLanes").is(":checked")},setWindowTitle:function(e){this.$windowTitle.text(e)},addClickHandler:function(e){var i,t,n=window.mainApp.getUnitScale(),s=this.printSize/100,r=$("input[name=Format]:checked","#printForm").val();return"Current"==r&&(this.exportViewport=window.mainApp.timelineView.viewport.deepCopy(),this.exportViewport.size.height-=TimelineDisplayConstants.navFooterHeight),i=this.exportViewport.size.width*s,t=this.exportViewport.size.height*s,window.ApplicationInterface.printWithSettings(window.timelineDocumentId,""+this.exportViewport.origin.x,""+this.exportViewport.origin.y,i,t,""+n,this.printSkin,this.printSize,this.omitCollapsedLanes,"Current"!=r),window.mainApp.removeExistingModal(),e.preventDefault(),!1}});module.exports=ATPrintView;
},{"./ATDatePicker":23,"./ATDisplayConstants":26,"./ATDropdown":29,"./ATRect":73,"./ATViewMode":92,"./templates/printTemplate.html":159,"backbone":176,"d3":300,"jquery":307,"lodash":309}],69:[function(require,module,exports){
var ATRange=function(t,n){this.location=t,this.length=n};ATRange.prototype.contains=function(t){return t>=this.location&&t<=this.location+this.length},module.exports=ATRange;
},{}],70:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATCalendarPicker=require("./ATCalendarPicker"),ATTimeUnit=require("./ATTimeUnit"),ATCalendar=require("./ATCalendar"),ATDate=require("./ATDate"),ATDateOrder=require("./ATDateOrder"),bootstrap=require("bootstrap"),ATRangeControlManager=function(e,t,a){this.startPicker=e,this.durationPicker=t,this.endPicker=a,this.startPicker.setManagerCallback(this.startChangeHandler.bind(this)),this.durationPicker.setManagerCallback(this.durationChangeHandler.bind(this)),this.endPicker.setManagerCallback(this.endChangeHandler.bind(this)),this.endPicker.setupAsEndPickerForStartPicker(this.startPicker)};ATRangeControlManager.prototype.startChangeHandler=function(e,t){this.updateEndPicker()},ATRangeControlManager.prototype.durationChangeHandler=function(e){this.updateEndPicker()},ATRangeControlManager.prototype.endChangeHandler=function(e,t){this.updateSpan()},ATRangeControlManager.prototype.updateEndPicker=function(){if(this.rangeConversion){var e=this.startPicker.getValue(),t=this.durationPicker.getValue(),a=e&&t?this.rangeConversion.valueByAddingSpanToValue(e,t):null;a&&e&&(a.timestamp&&a.timestamp<e.timestamp||!a.timestamp&&e>a)&&(a=e),this.endPicker.setValue(a)}},ATRangeControlManager.prototype.updateSpan=function(){if(this.rangeConversion){var e=this.startPicker.getValue(),t=this.endPicker.getValue(),a=this.rangeConversion.spanBetweenValues(e,t);null!=t&&null!=e&&(t.timestamp&&t.timestamp<e.timestamp||!t.timestamp&&e>t)&&(t=e,this.endPicker.setValue(t),a=this.rangeConversion.spanBetweenValues(e,t)),this.durationPicker.setValue(a)}},ATRangeControlManager.prototype.setStartChangeCallback=function(e){this.startChangeCallback=e,this.startPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setDurationChangeCallback=function(e){this.durationChangeCallback=e,this.durationPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setEndChangeCallback=function(e){this.endChangeCallback=e,this.endPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setRangeConversion=function(e){this.rangeConversion=e,this.startPicker.setRangeConversion(e),this.durationPicker.setRangeConversion(e),this.endPicker.setRangeConversion(e)},module.exports=ATRangeControlManager;
},{"./ATCalendar":17,"./ATCalendarPicker":18,"./ATDate":21,"./ATDateOrder":22,"./ATTimeUnit":85,"backbone":176,"bootstrap":177,"d3":300,"jquery":307,"lodash":309}],71:[function(require,module,exports){
var ATUtilities=require("./ATUtilities"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=require("./ATTimeSpan"),ATCalendar=require("./ATCalendar"),ATDate=require("./ATDate"),ATRange=require("./ATRange"),ATRangePositionSuggestion=require("./ATRangePositionSuggestion"),TimelineDisplayConstants=require("./ATDisplayConstants");ATCalendarType=require("./ATCalendarType");var ATRangeConversion=function(e,n){this.type=e,this.calendar=n};ATRangeConversion.prototype.stringFromValue=function(e,n){return"date"==this.type?e.timestamp?this.calendar.stringFromDate(e,n):this.calendar.stringFromDate(this.calendar.dateWithTimestamp(e),n):this.stringFromNumber(e)},ATRangeConversion.prototype.naturalStringFromValue=function(e,n){return"date"==this.type?e.timestamp?this.calendar.naturalStringFromDate(e,!1,!1,!1,n?"%G":"%Y"):this.calendar.naturalStringFromDate(this.calendar.dateWithTimestamp(e),!1,!1,!1,n?"%G":"%Y"):this.stringFromNumber(e)},ATRangeConversion.prototype.stringFromNumber=function(e){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+" billion":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+" million":""+e},ATRangeConversion.prototype.shortStringFromNumber=function(e){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+"b":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+"m":""+e},ATRangeConversion.prototype.stringFromRoundedNumber=function(e,n){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+" billion":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+" million":n?e.toFixed(n):""+e},ATRangeConversion.prototype.stringFromSpanValue=function(e){return"date"==this.type?e.toString():this.stringFromNumber(e)},ATRangeConversion.prototype.shortStringFromSpanValue=function(e){return"date"==this.type?e.toShortString():this.shortStringFromNumber(e)},ATRangeConversion.prototype.decimalPlaces=function(e){for(var n=0;1>e;)e*=10,n++;return n},ATRangeConversion.prototype.valueFromTimestamp=function(e,n){return"date"==this.type?this.calendar.dateWithTimestamp(e,n):parseInt(e)},ATRangeConversion.prototype.valueByAddingSpanToValue=function(e,n){return"date"==this.type?null==e||null==n||void 0==e||void 0==n?null:$.isNumeric(e.timestamp)?this.calendar.dateByAddingTimespanToDate(e,n):this.calendar.dateByAddingTimespanToDate(this.calendar.dateWithTimestamp(e),n):isNaN(e)||isNaN(n)?e:e+n},ATRangeConversion.prototype.valueAtEvenSpanBeforeTimestamp=function(e,n){return"date"==this.type?this.calendar.dateAtEvenTimespanBeforeDate(this.calendar.dateWithTimestamp(e),n):e%n},ATRangeConversion.prototype.spanBetweenValues=function(e,n){return"date"==this.type?this.calendar.timespanBetweenDates(e,n):n-e},ATRangeConversion.prototype.spanForPrecision=function(e,n){var a=n?-1:1;return"date"==this.type?e==ATTimeUnit.YEAR?new ATTimeSpan(a,0,0,0,0,0,0):e==ATTimeUnit.MONTH?new ATTimeSpan(0,a,0,0,0,0,0):e==ATTimeUnit.WEEK?new ATTimeSpan(0,0,a,0,0,0,0):e==ATTimeUnit.DAY?new ATTimeSpan(0,0,0,a,0,0,0):e==ATTimeUnit.HOUR?new ATTimeSpan(0,0,0,0,a,0,0):e==ATTimeUnit.MINUTE?new ATTimeSpan(0,0,0,0,0,a,0):new ATTimeSpan(0,0,0,0,0,0,a):a},ATRangeConversion.prototype.roundedSpanForScale=function(e){return"date"==this.type?this.calendar.roundedTimespanForScale(e):this.roundedNumberForScale(units)},ATRangeConversion.prototype.roundedSpanForUnitsAtScale=function(e,n){return"date"==this.type?this.calendar.roundedTimespanForSecondsAtScale(e,n):this.roundedNumberForValue(e,n)},ATRangeConversion.prototype.roundedValueForValue=function(e,n){return"date"==this.type?this.roundedDateForValue(e,n):this.roundedNumberForValue(e,n)},ATRangeConversion.prototype.valueForPartialString=function(e,n,a){return"date"==this.type?this.dateValueForPartialString(e,n,a):this.numberValueForPartialString(e,n,a)},ATRangeConversion.prototype.spanValueForPartialString=function(e,n,a){return"date"==this.type?this.timespanValueForPartialString(e,n,a):this.numberValueForPartialString(e,n,a)},ATRangeConversion.prototype.incrementString=function(e,n,a){return"date"==this.type?this.incrementDateString(e,n,a):this.incrementNumberString(e,n,a)},ATRangeConversion.prototype.nextComponentInString=function(e,n){return"date"==this.type?this.nextComponentInDateString(e,n):this.nextComponentInNumberString(e,n)},ATRangeConversion.prototype.previousComponentInString=function(e,n){return"date"==this.type?this.previousComponentInDateString(e,n):this.previousComponentInNumberString(e,n)},ATRangeConversion.prototype.updateStringWithComponents=function(e,n,a){return"date"==this.type?this.updateDateStringWithComponents(e,n,a):this.updateNumberStringWithComponents(e,n,a)},ATRangeConversion.prototype.labelsBetweenBounds=function(e,n,a,r,t,i){return"date"==this.type?this.dateLabelsBetweenBounds(e,n,a,r,t,i):this.numberLabelsBetweenBounds(e,n,a,r,t,i)},ATRangeConversion.prototype.calculateMarkerSpacing=function(e,n){return"date"==this.type?this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME?this.calculateDateMarkerSpacing(e,n):this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?this.calculateFloatingWeekMarkerSpacing(e,n):this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_DAY_TIME?this.calculateFloatingDayMarkerSpacing(e,n):this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_HOUR_TIME?this.calculateZeroHourMarkerSpacing(e,n):this.calculateDateMarkerSpacing(e,n):this.calculateNumberMarkerSpacing(e,n)},ATRangeConversion.prototype.lifetimeMarks=function(e,n,a,r,t,i,o,s){return"date"==this.type?this.dateLifetimeMarks(e,n,a,r,t,i,o,s):this.numberLifetimeMarks(e,n,a,r,t,i,o,s)},ATRangeConversion.prototype.roundedNumberForScale=function(e){for(rounded=1;e>rounded&&(rounded*=2,!(rounded>=e))&&(rounded=5*rounded/2,!(rounded>=e));)rounded*=2;return rounded},ATRangeConversion.prototype.roundedDateForValue=function(e,n){var a=this.calendar,r=a.roundedTimespanForScale(n);return a.dateAtEvenTimespanBeforeDate(a.dateWithTimestamp(e),r)},ATRangeConversion.prototype.roundedNumberForValue=function(e,n){var a=this.roundedNumberForScale(n);return ATUtilities.floatToInt(e/a)*a},ATRangeConversion.prototype.dateValueForPartialString=function(e,n,a){var r=this.calendar,t=r.dateWithPartialString(e,n,a);return new ATRangePositionSuggestion(t.matchFound,t.date,t.text,t.selectionRange,t.cleanText)},ATRangeConversion.prototype.numberValueForPartialString=function(e,n,a){var r=e.length?parseInt(e):0;return isNaN(r)?new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e):new ATRangePositionSuggestion(!0,r,""+r,new ATRange(n,0),""+r)},ATRangeConversion.prototype.timespanValueForPartialString=function(e,n,a){var r=new RegExp("\\b(y(e(a(r(s)?)?)?)?)","i"),t=this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME?new RegExp("\\b(m(o(n(t(h(s)?)?)?)?)?)","i"):new RegExp("\\b(mo(n(t(h(s)?)?)?)?)","i"),i=new RegExp("\\b(w(e(e(k(s)?)?)?)?)","i"),o=new RegExp("\\b(d(a(y(s)?)?)?)","i"),s=new RegExp("\\b(h(o(u(r(s)?)?)?)?)","i"),p=this.calendar.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME?new RegExp("\\b(mi(n(u(t(e(s)?)?)?)?)?)","i"):new RegExp("\\b(m(i(n(u(t(e(s)?)?)?)?)?)?)","i"),T=new RegExp("\\b(s(e(c(o(n(d(s)?)?)?)?)?)?)","i"),m=(new RegExp("\\b(d+)(s)?$"),0);if(a){var u=e.substring(0,n),S=!1,g="";if(n!=e.length){g=e.substring(n,e.length-1);var c=/^[^A-Za-z]/;S=c.test(g)}if(1==S||n==e.length){var A=!1;if(n==e.length){var l=u.match(/(\d+)(\s?)$/);null!=l&&(""==l[2]?(e=u+" seconds",m=8,A=!0):(e=u+"seconds",m=7,A=!0))}if(0==A){var M=new RegExp("([A-Za-z]+)$"),k=u.match(M);if(null!=k){var d=k[1].toString(),w=u.substring(0,k.index),h=d.match(r);if(null!=h){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"year"+g,A=!0,m=4-h[1].length):(e=w+y+"years"+g,A=!0,m=5-h[1].length)}if(0==A){var F=d.match(p);if(null!=F){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"minute"+g,A=!0,m=6-F[1].length):(e=w+y+"minutes"+g,m=7-F[1].length,A=!0)}}if(0==A){var v=d.match(t);if(null!=v){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"month"+g,A=!0,m=5-v[1].length):(e=w+y+"months"+g,m=6-v[1].length,A=!0)}}if(0==A){var R=d.match(o);if(null!=R){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"day"+g,A=!0,m=3-R[1].length):(e=w+y+"days"+g,m=4-R[1].length,A=!0)}}if(0==A){var D=d.match(i);if(null!=D){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"week"+g,A=!0,m=4-D[1].length):(e=w+y+"weeks"+g,m=5-D[1].length,A=!0)}}if(0==A){var C=d.match(s);if(null!=C){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"hour"+g,A=!0,m=4-C[1].length):(e=w+y+"hours"+g,m=5-C[1].length,A=!0)}}if(0==A){var x=d.match(T);if(null!=x){var b=w.match(/(\d+)(\s*)$/),f=parseInt(b[1]),y="";""==b[2]&&(y=" ",n++),1==f?(e=w+y+"second"+g,A=!0,m=6-x[1].length):(e=w+y+"seconds"+g,m=7-x[1].length,A=!0)}}}}}}if(e.length>0){var I=ATTimeSpan.FromString(e),E=!0;return 0==I.years&&0==I.months&&0==I.days&&0==I.weeks&&0==I.hours&&0==I.minutes&&0==I.seconds&&(E=!1),new ATRangePositionSuggestion(E,I,e,new ATRange(n,m),I.toString())}var P=new ATTimeSpan(0,0,0,0,0,0,0);return new ATRangePositionSuggestion(!1,P,"0",new ATRange(n,0),"0")},ATRangeConversion.prototype.updateDateStringWithComponents=function(e,n,a){var r=a[0],t=a[1],i=a[2],o=a[3],s=this.calendar,p=s.updateStringWithComponents(e,n,r,t,i,o),T=this.valueForPartialString(p.text,!1);return new ATRangePositionSuggestion(T.matchFound,T.value,T.string,p.selectionRange,T.cleanText)},ATRangeConversion.prototype.updateNumberStringWithComponents=function(e,n,a){var r=a[0];return r?new ATRangePositionSuggestion(!0,r,""+r,new ATRange(n,0),""+r):new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e)},ATRangeConversion.prototype.incrementDateString=function(e,n,a){var r=this.calendar,t=r.incrementDateString(e,n,a),i=this.valueForPartialString(t.text,!1);return new ATRangePositionSuggestion(i.matchFound,i.value,t.text,t.selectionRange,i.cleanString)},ATRangeConversion.prototype.incrementNumberString=function(e,n,a){var r=parseInt(e)+a;return r?new ATRangePositionSuggestion(!0,r,""+r,new ATRange(n,0),""+r):new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e)},ATRangeConversion.prototype.nextComponentInDateString=function(e,n){var a=this.calendar,r=a.nextComponentInString(e,n);return new ATRangePositionSuggestion(!0,0,r.text,r.selectionRange,r.text)},ATRangeConversion.prototype.previousComponentInDateString=function(e,n){var a=this.calendar,r=a.previousComponentInString(e,n);return new ATRangePositionSuggestion(!0,0,r.text,r.selectionRange,r.text)},ATRangeConversion.prototype.nextComponentInNumberString=function(e,n){var a=parseInt(e);return a?new ATRangePositionSuggestion(!0,a,""+a,new ATRange(n,0),""+a):new ATRangePositionSuggestion(!1,a,e,new ATRange(n,0),e)},ATRangeConversion.prototype.previousComponentInNumberString=function(e,n){var a=parseInt(e);return a?new ATRangePositionSuggestion(!0,a,""+a,new ATRange(n,0),""+a):new ATRangePositionSuggestion(!1,a,e,new ATRange(n,0),e)},ATRangeConversion.prototype.calculateDateMarkerSpacing=function(e,n){var a,r,t,i,o,s,p={},T=n*e,m=this.calendar,u=m.months.length,S=m.hoursInDay;if(30>T)return 5>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):10>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):15>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):20>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),p.mainMarkerFormat="%d %b %G %H:%M:%S",p.subMarkerFormat="%H:%M:%S",p;if(1800>T)return 60>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerFormat="%H:%M:%S"):120>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerFormat="%H:%M:%S"):300>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerFormat="%H:%M"):600>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerFormat="%H:%M"):900>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat="%H:%M"):1200>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat="%H:%M"):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerFormat="%H:%M"),p.mainMarkerFormat="%d %b %G %H:%M",p;if(T<m.secondsInDay/2){for(a=!1,s=1;S/2>s;s++)if(S%s==0&&3600*s>T){p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),1==s?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0):s%2==0?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s/2,0,0):s%3==0?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s/3,0,0):p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),a=!0;break}if(p.mainMarkerFormat="%d %b %G %H:00",p.subMarkerFormat="%H:%M",a)return p}if(T<=m.secondsInDay)return t=1,p.mainMarkerSpacing=new ATTimeSpan(0,0,0,t,0,0,0),p.mainMarkerFormat="%d %b %G %E",r=S,S%5==0?r=S/5:S%4==0?r=S/4:S%3==0?r=S/3:S%2==0&&(r=S/2),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,r,0,0),p.subMarkerFormat="%H:00",p;if(T<m.secondsInWeek)return p.mainMarkerSpacing=new ATTimeSpan(0,0,1,0,0,0,0),p.mainMarkerFormat="%a %d %b %G %E",p.subMarkerFormat="%a",p.subMarkerSpacing=new ATTimeSpan(0,0,0,1,0,0,0),p;if(T<m.avgSecondsInYear/2){for(o=Math.ceil(1*T/m.avgSecondsInMonth),t=1;o>t;)do t++;while(u%t!=0);return p.mainMarkerFormat="%b %G %E",p.subMarkerFormat="%b",p.mainMarkerSpacing=new ATTimeSpan(0,t,0,0,0,0,0),p.subMarkerSpacing=new ATTimeSpan(0,1,0,0,0,0,0),p}for(o=Math.ceil(1*T/m.avgSecondsInYear),t=1,i=1;o>t;){if(t*=2,t>=o){i=4;break}if(t=5*t/2,i=5,t>=o)break;t*=2}return p.mainMarkerFormat="%G %E",p.mainMarkerSpacing=new ATTimeSpan(t,0,0,0,0,0,0),1==t?(u%4==0?p.subMarkerSpacing=new ATTimeSpan(0,u/4,0,0,0,0,0):u%3==0?p.subMarkerSpacing=new ATTimeSpan(0,u/3,0,0,0,0,0):u%2==0?p.subMarkerSpacing=new ATTimeSpan(0,u/2,0,0,0,0,0):p.subMarkerSpacing=new ATTimeSpan(0,u,0,0,0,0,0),p.subMarkerFormat="%b"):2==t?(p.subMarkerSpacing=new ATTimeSpan(1,0,0,0,0,0,0),p.subMarkerFormat="%g"):(p.subMarkerSpacing=new ATTimeSpan(t/i,0,0,0,0,0,0),p.subMarkerFormat="%g"),p},ATRangeConversion.prototype.calculateFloatingWeekMarkerSpacing=function(e,n){var a,r,t,i,o,s,p={},T=n*e,m=this.calendar,u=(m.months.length,m.hoursInDay);if(30>T)return 5>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):10>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):15>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):20>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),p.mainMarkerFormat="%a Week %Z %H:%M:%S",p.subMarkerFormat="%H:%M:%S",p;if(1800>T)return 60>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerFormat="%H:%M:%S"):120>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerFormat="%H:%M:%S"):300>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerFormat="%H:%M"):600>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerFormat="%H:%M"):900>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat="%H:%M"):1200>T?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat="%H:%M"):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerFormat="%H:%M"),p.mainMarkerFormat="%a Week %Z %H:%M",p;if(T<m.secondsInDay/2){for(a=!1,s=1;u/2>s;s++)if(u%s==0&&3600*s>T){p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),1==s?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0):s%2==0?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s/2,0,0):s%3==0?p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s/3,0,0):p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),a=!0;break}if(p.mainMarkerFormat="%a Week %Z %H:00",p.subMarkerFormat="%H:%M",a)return p}if(T<=m.secondsInDay)return t=1,p.mainMarkerSpacing=new ATTimeSpan(0,0,0,t,0,0,0),p.mainMarkerFormat="%a Week %Z",r=u,u%5==0?r=u/5:u%4==0?r=u/4:u%3==0?r=u/3:u%2==0&&(r=u/2),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,r,0,0),p.subMarkerFormat="%H:00",p;for(o=Math.ceil(1*T/m.secondsInWeek),t=1,i=1;o>t;){if(t*=2,t>=o){i=4;break}if(t=5*t/2,i=5,t>=o)break;t*=2}return p.mainMarkerFormat="Week %Z",p.mainMarkerSpacing=new ATTimeSpan(0,0,t,0,0,0,0),1==t?(p.subMarkerSpacing=new ATTimeSpan(0,0,0,1,0,0,0),p.subMarkerFormat="%a"):(p.subMarkerSpacing=new ATTimeSpan(0,0,t/i,0,0,0,0),p.subMarkerFormat="Week %Z"),p},ATRangeConversion.prototype.calculateFloatingDayMarkerSpacing=function(e,n){var a,r,t,i,o,s={},p=n*e,T=this.calendar,m=(T.months.length,T.hoursInDay);if(30>p)return 5>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):10>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):15>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):20>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),s.mainMarkerFormat="Day %z %H:%M:%S",s.subMarkerFormat="%H:%M:%S",s;if(1800>p)return 60>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),s.subMarkerFormat="%H:%M:%S"):120>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),s.subMarkerFormat="%H:%M:%S"):300>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),s.subMarkerFormat="%H:%M"):600>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),s.subMarkerFormat="%H:%M"):900>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerFormat="%H:%M"):1200>p?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerFormat="%H:%M"):(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),s.subMarkerFormat="%H:%M"),s.mainMarkerFormat="Day %z %H:%M",s;if(p<T.secondsInDay/2){for(a=!1,o=1;m/2>o;o++)if(m%o==0&&3600*o>p){s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,o,0,0),1==o?s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0):o%2==0?s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,o/2,0,0):o%3==0?s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,o/3,0,0):s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,o,0,0),a=!0;break}if(s.mainMarkerFormat="Day %z %H:00",s.endMarkerFormat="%H:00",s.subMarkerFormat="%H:%M",a)return s}for(i=Math.ceil(1*p/T.secondsInDay),r=1,t=1;i>r;){if(r*=2,r>=i){t=2==r?2:4;break}if(r=5*r/2,t=5,r>=i)break;r*=2}return s.mainMarkerFormat="Day %z",s.mainMarkerSpacing=new ATTimeSpan(0,0,0,r,0,0,0),1==r?(s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,4,0,0),s.subMarkerFormat="%H:00"):(s.subMarkerSpacing=new ATTimeSpan(0,0,0,r/t,0,0,0),s.subMarkerFormat="Day %z"),s},ATRangeConversion.prototype.calculateZeroHourMarkerSpacing=function(e,n){var a,r,t,i={},o=n*e,s=this.calendar;s.months.length,s.hoursInDay;if(30>o)return 5>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):10>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):15>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):20>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),i.mainMarkerFormat="%x:%v:%u",i.subMarkerFormat="%x:%v:%u",i;if(1800>o)return 60>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),i.subMarkerFormat="%x:%v:%u"):120>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),i.subMarkerFormat="%x:%v:%u"):300>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),i.subMarkerFormat="%x:%v"):600>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),i.subMarkerFormat="%x:%v"):900>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerFormat="%x:%v"):1200>o?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerFormat="%x:%v"):(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerFormat="%x:%v"),i.mainMarkerFormat="%x:%v",i;for(t=Math.ceil(1*o/1200),a=1,r=1;t>a;){if(a*=2,a>=t){r=4;break}if(a=5*a/2,r=5,a>=t)break;a*=2}return i.mainMarkerFormat="%x:00",i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,a,0,0),1==a?(i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerFormat="%x:%v"):(i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,a/r,0,0),i.subMarkerFormat="%x:%v"),i},ATRangeConversion.prototype.calculateNumberMarkerSpacing=function(e,n){var a,r,t,i={},t=n*e;for(a=1,r=1;t>a;){if(a*=2,a>=t){r=4;break}if(a=5*a/2,r=5,a>=t)break;a*=2}return i.mainMarkerFormat="",i.subMarkerFormat="",i.mainMarkerSpacing=a,1==a?i.subMarkerSpacing=.2:i.subMarkerSpacing=a/r,i},ATRangeConversion.prototype.dateLifetimeMarks=function(e,n,a,r,t,i,o,s){var p,T,m,u,S,g,c,A,l,M,k,d,w,h=this.calendar,b=r?ATUtilities.floatToInt(t/a):null,f=h.dateWithTimestamp(t),y=Math.max(t,e),F=ATUtilities.floatToInt(y/a),v=h.dateWithTimestamp(y),R=[],D=2,k=new ATTimeSpan(0,0,0,0,0,0,0),C=1;if(!r)return[];if(i&&(p=ATUtilities.floatToInt(o/a),n>o&&(n=o),y>o))return[];for(s.years*=2,s.months*=2,s.weeks*=2,s.days*=2,s.hours*=2,s.minutes*=2,s.seconds*=2,0!=s.years||h.yearsBetweenDates(f,v)>=D?(0==s.years&&(s=new ATTimeSpan(1,0,0,0,0,0,0)),C=s.years):0!=s.months||h.monthsBetweenDates(f,v)>=D?(0==s.months&&(s=new ATTimeSpan(0,1,0,0,0,0,0)),C=s.months):0!=s.weeks||h.weeksBetweenDates(f,v)>=D?(0==s.weeks&&(s=new ATTimeSpan(0,0,1,0,0,0,0)),C=s.weeks):0!=s.days||h.daysBetweenDates(f,v)>=D?(0==s.days&&(s=new ATTimeSpan(0,0,0,1,0,0,0)),C=s.days):0!=s.hours||h.hoursBetweenDates(f,v)>=D?(0==s.hours&&(s=new ATTimeSpan(0,0,0,0,1,0,0)),C=s.hours):0!=s.minutes||h.minutesBetweenDates(f,v)>=D?(0==s.minutes&&(s=new ATTimeSpan(0,0,0,0,0,1,0)),C=s.minutes):(0==s.seconds&&(s=new ATTimeSpan(0,0,0,0,0,0,1)),C=s.seconds),l=h.dateBeforeDateAtTimespanFromStart(v,s,f),M=ATUtilities.floatToInt(l.timestamp/a),0!=s.years?(T=h.yearsBetweenDates(f,l),k.years=T,m="year"):0!=s.months?(T=h.monthsBetweenDates(f,l),k.months=T,m="month"):0!=s.weeks?(T=h.weeksBetweenDates(f,l),k.weeks=T,m="week"):0!=s.days?(T=h.daysBetweenDates(f,l),k.days=T,m="day"):0!=s.hours?(T=h.hoursBetweenDates(f,l),k.hours=T,m="hour"):0!=s.minutes?(T=h.minutesBetweenDates(f,l),k.minutes=T,m="minute"):(T=h.secondsBetweenDates(f,l),k.seconds=T,m="second"),d=h.dateByAddingTimespanToDate(l,s),w=ATUtilities.floatToInt(d.timestamp/a),A=w-M,R=[],F>b&&A>4*TimelineDisplayConstants.lifetimeLabelMinGap&&w-F>2*TimelineDisplayConstants.lifetimeLabelMinGap&&(S=ATUtilities.floatToInt(F*a),g=h.dateWithTimestamp(S),c=0!=s.years?h.yearsBetweenDates(f,g):0!=s.months?h.monthsBetweenDates(f,g):0!=s.weeks?h.weeksBetweenDates(f,g):0!=s.days?h.daysBetweenDates(f,g):0!=s.hours?h.hoursBetweenDates(f,g):0!=s.minutes?h.minutesBetweenDates(f,g):h.secondsBetweenDates(f,g),u="("+c+" "+m+(1==T?"":"s")+")",R.push({xPosition:F,text:u,showDot:!1}));l.timestamp<n;)u=0==T?"Born":this.stringFromNumber(T)+" "+m+(1==T?"":"s"),d=h.dateByAddingTimespanToDate(l,s),w=ATUtilities.floatToInt(d.timestamp/a),w>p&&(w=p),M>=F&&w-M>TimelineDisplayConstants.lifetimeLabelMinGap&&R.push({xPosition:M,text:u,showDot:!0}),l=d,M=ATUtilities.floatToInt(l.timestamp/a),T+=C;return n>=o&&R.push({xPosition:p,text:"Died",showDot:!0}),R},ATRangeConversion.prototype.numberLifetimeMarks=function(e,n,a,r,t,i,o,s){var p,T,m,u,S,g,c,A=o/a,l=Math.max(t,e),M=ATUtilities.floatToInt(l/a),k=[];new ATTimeSpan(0,0,0,0,0,0,0);if(!r)return[];if(i&&(n>o&&(n=o),l>o))return[];for(s*=2,c=this.decimalPlaces(s),p=ATUtilities.floatToInt((l-t)/s)*s,u=t+p,S=ATUtilities.floatToInt(u/a),nextValue=u+s,g=ATUtilities.floatToInt(nextValue/a),m=g-S,k=[];n>u;)T=0==p?"0":this.stringFromRoundedNumber(p,c),nextValue=u+s,g=ATUtilities.floatToInt(nextValue/a),g>A&&(g=A),S>=M&&g-S>TimelineDisplayConstants.lifetimeLabelMinGap&&k.push({xPosition:S,text:T,showDot:!0}),u=nextValue,S=ATUtilities.floatToInt(u/a),p+=s;return n>=o&&k.push({xPosition:A,text:"Died",showDot:!0}),k},ATRangeConversion.prototype.dateLabelsBetweenBounds=function(e,n,a,r,t,i){var o,s,p=this.calendar,T=p.dateWithTimestamp(e),m=p.dateAtEvenTimespanBeforeDate(T,r),u=p.dateByAddingTimespanToDate(m,r),S=[];for(p.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME&&u.eraIndex!=m.eraIndex&&(u=p.dateAtEvenTimespanBeforeDate(u,r));m.timestamp<=n;)o=ATUtilities.floatToInt(m.timestamp/a),s=p.stringFromDate(m,t),S.push({xPosition:o,text:s}),m=u,u=p.dateByAddingTimespanToDate(u,r),p.calendarType==ATCalendarType.CALENDAR_TYPE_DATE_TIME&&u.eraIndex!=m.eraIndex&&(u=p.dateAtEvenTimespanBeforeDate(u,r));return S},ATRangeConversion.prototype.numberLabelsBetweenBounds=function(e,n,a,r,t,i){var o,s,p,T=ATUtilities.floatToInt(e/r)*r,m=T+r,u=[];for(p=this.decimalPlaces(r);n>=T;)o=ATUtilities.floatToInt(T/a),s=this.stringFromRoundedNumber(T,p),u.push({xPosition:o,text:s}),T=m,m+=r;return u},module.exports=ATRangeConversion;
},{"./ATCalendar":17,"./ATCalendarType":19,"./ATDate":21,"./ATDisplayConstants":26,"./ATRange":69,"./ATRangePositionSuggestion":72,"./ATTimeSpan":84,"./ATTimeUnit":85,"./ATUtilities":91}],72:[function(require,module,exports){
var ATRangePositionSuggestion=function(i,t,n,s,o){this.matchFound=i,this.value=t,this.string=n,this.selection=s,this.cleanString=o};module.exports=ATRangePositionSuggestion;
},{}],73:[function(require,module,exports){
var ATPoint=require("./ATPoint"),ATSize=require("./ATSize"),ATRect=function(t,i,e,o){this.origin=new ATPoint(t,i),this.size=new ATSize(e,o)};ATRect.prototype.debugAsString=function(){return"[ATRect x: "+this.origin.x+", y: "+this.origin.y+", w: "+this.size.width+", h: "+this.size.height+"]"},ATRect.prototype.deepCopy=function(){return new ATRect(this.origin.x,this.origin.y,this.size.width,this.size.height)},ATRect.prototype.scale=function(t){this.origin.x*=t,this.origin.y*=t,this.size.width*=t,this.size.height*=t},ATRect.prototype.left=function(){return this.origin.x},ATRect.prototype.centerX=function(){return this.origin.x+this.size.width/2},ATRect.prototype.right=function(){return this.origin.x+this.size.width},ATRect.prototype.top=function(){return this.origin.y},ATRect.prototype.centerY=function(){return this.origin.y+this.size.height/2},ATRect.prototype.bottom=function(){return this.origin.y+this.size.height},ATRect.prototype.overlaps=function(t){return this.right()>=t.left()&&this.left()<=t.right()&&this.bottom()>=t.top()&&this.top()<=t.bottom()},ATRect.prototype.contains=function(t){return this.left()<=t.x&&this.right()>=t.x&&this.top()<=t.y&&this.bottom()>=t.y},ATRect.prototype.containsRect=function(t){var i=this.left()<=t.left()&&this.right()>=t.right()&&this.top()<=t.top()&&this.bottom()>=t.bottom();return i},ATRect.prototype.union=function(t,i){var e=this.left(),o=this.right(),r=this.bottom(),n=this.top(),h=t.left(),s=t.right(),c=t.bottom(),p=t.top(),u=h>e?e:h,g=p>n?n:p;return new ATRect(u-i,g-i,(o>s?o:s)-u+2*i,(r>c?r:c)-g+2*i)},module.exports=ATRect;
},{"./ATPoint":67,"./ATSize":79}],74:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),ATIconContextMenu=require("./ATIconContextMenu"),Opentip=require("../lib/opentip"),Hammer=require("hammerjs"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATRelationshipViewPainter=require("./ATRelationshipViewPainter"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=require("./ATTimeSpan"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATBounds=require("./ATBounds"),ATSize=require("./ATSize"),ATViewMode=require("./ATViewMode"),selectColumnHtml=require("./templates/relationshipViewSelectColumnsTemplate.html"),bootstrap=require("bootstrap"),ATRelationshipView=Backbone.View.extend({initialize:function(){var e=this.$el.attr("id");this.selectColumnTemplate=_.template(selectColumnHtml),this.eventRowsByGroup=[],this.entityColumnsByType=[],this.showOffsets=!0,this.timeline=this.model.get("timeline"),this.timelineView=null,this.d3El=d3.select("#"+e),this.viewport=new ATRect(0,-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,0,0),this.rangeX=new ATBounds(0,0),this.rangeY=new ATBounds(-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,350),this.physicalScaleFactor=1,this.filterBarDiv=d3.select("#filterBarDiv"),this.bookmarksDiv=d3.select("#bookmarks"),this.layers={},this.layers.entity_header=this.d3El.select("#relationship_entity_header"),this.layers.bg_layer=this.d3El.select("#relationship_bg_layer"),this.layers.intersection_layer=this.d3El.select("#relationship_intersection_layer"),this.layers.offset_layer=this.d3El.select("#relationship_offset_layer"),this.layers.event_layer=this.d3El.select("#relationship_event_layer"),this.layers.lane_layer=this.d3El.select("#relationship_lane_layer"),this.layers.lane_nav_svg=this.d3El.select(".laneNavSvg"),this.layers.x_scroll_svg=this.d3El.select(".xScrollSvg"),this.layers.ui_drawing_svg=this.d3El.select("#relationship_ui_drawing_svg"),this.relationshipPainter=new ATRelationshipViewPainter(this),this.el.addEventListener("wheel",this.mouseWheel.bind(this),!1),this.d3El.on("click",this.canvasClick.bind(this)),this.roleContextMenu=new ATIconContextMenu({el:"#relationshipViewRoleContextMenu"}),this.listenTo(this.roleContextMenu,"change",this.contextRoleClick.bind(this)),window.isAeonWebExport?$("#relationshipSettingsButton").css("display","none"):$("#relationshipSettingsButton").on("click",this.relationshipSettingsClick.bind(this)),$("#relationshipTreeNestingButton").on("click",this.relationshipTreeNestingClick.bind(this)),$("#relationshipFlattenNestingButton").on("click",this.relationshipFlattenClick.bind(this)),$("#relationshipOffsetButton").on("click",this.relationshipShowOffsetsClick.bind(this)),this.eventDrag=d3.behavior.drag().on("dragstart",this.eventNodeDragStarted.bind(this)).on("drag",this.eventNodeDragged.bind(this)).on("dragend",this.eventNodeDragEnded.bind(this)),this.columnDrag=d3.behavior.drag().on("dragstart",this.columnDragStarted.bind(this)).on("drag",this.columnDragged.bind(this)).on("dragend",this.columnDragEnded.bind(this)),this.columnGroupDrag=d3.behavior.drag().on("dragstart",this.columnGroupDragStarted.bind(this)).on("drag",this.columnGroupDragged.bind(this)).on("dragend",this.columnGroupDragEnded.bind(this)),this.laneDrag=d3.behavior.drag().on("dragstart",this.laneDragStarted.bind(this)).on("drag",this.laneDragged.bind(this)).on("dragend",this.laneDragEnded.bind(this)),this.verticalScrollDrag=d3.behavior.drag().on("dragstart",this.verticalScrollDragStarted.bind(this)).on("drag",this.verticalScrollDragged.bind(this)).on("dragend",this.verticalScrollDragEnded.bind(this)),this.horizontalScrollDrag=d3.behavior.drag().on("dragstart",this.horizontalScrollDragStarted.bind(this)).on("drag",this.horizontalScrollDragged.bind(this)).on("dragend",this.horizontalScrollDragEnded.bind(this))},setInspectorModel:function(e){this.inspectorModel=e},setShowOffsets:function(e){this.timelineView.holdRendering(),this.showOffsets=e,this.model.relationshipViewShowOffsets=e,TimelineDisplayConstants.relationshipViewDateOffsetWidth=e?TimelineDisplayConstants.relationshipViewDateOffsetDefaultWidth:TimelineDisplayConstants.relationshipViewDateOffsetHideWidth,this.showOffsets?$("#relationshipOffsetButton").addClass("selected"):$("#relationshipOffsetButton").removeClass("selected"),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()},setTreeFlattened:function(e){this.timelineView.holdRendering(),this.model.relationshipViewFlattenTree=e,this.updateRelationshipFlattenButtonStates(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()},toggleView:function(e){this.timelineView.holdRendering(),this.d3El.style("display",e?null:"none"),this.adjustWindowScale(),this.timelineView.releaseRendering()},setTimelineView:function(e){this.timelineView=e},scrollTopLeftToPoint:function(e,t){var i=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width)),n=new ATBounds(this.rangeY.min,Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height));this.viewport.origin.x=i.constrain(e),this.viewport.origin.y=n.constrain(t),this.timelineView.renderFlags.viewport=!0,this.timelineView.renderIfRequired()},scrollLeftToPoint:function(e){this.scrollTopLeftToPoint(e,this.viewport.top())},scrollTopToPoint:function(e){this.scrollTopLeftToPoint(this.viewport.left(),e)},scrollToPixelXY:function(e,t,i){function n(i,n,s,r){return function(){var a=d3.interpolateNumber(i,n),l=d3.interpolateNumber(s,r);return function(i){o.timelineView.holdRendering(),o.scrollTopLeftToPoint(a(i),l(i)),a(i)==e&&l(i)==t&&(o.gestureCallReceivedFromCpp||(o.lastWheelTime=null)),o.timelineView.releaseRendering()}}}var o=this;null==e&&(e=this.viewport.origin.x),null==t&&(t=this.viewport.origin.y),i||(i=1e3),d3.transition().duration(i).tween("animatedscroll",n(this.viewport.origin.x,e,this.viewport.origin.y,t)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},scrollIncrement:function(e,t){return this.scrollTopLeftToPoint(this.viewport.origin.x+e,this.viewport.origin.y+t)},clientXLeftOfSyncBinder:function(e){if(!window.mainApp.syncBinderVisible)return e;var t=$("#syncBinder").innerWidth();return e-t},clientYBelowFilterBar:function(e){return window.mainApp.filterBarVisible||window.appToolbar?window.appToolbar?window.mainApp.filterBarVisible?e-TimelineDisplayConstants.filterBarHeight-TimelineDisplayConstants.toolbarHeight:e-TimelineDisplayConstants.toolbarHeight:e-TimelineDisplayConstants.filterBarHeight:e},rawMousePositionToScaledCanvasPosition:function(e){var t=new ATPoint(e);return t.x=this.clientXLeftOfSyncBinder(e.x),t.y=this.clientYBelowFilterBar(e.y),t.x/=this.physicalScaleFactor,t.y/=this.physicalScaleFactor,t},mouseWheel:function(e){var e=window.event||e,t=e.wheelDeltaX||40*-e.deltaX,i=e.wheelDeltaY||40*-e.deltaY,n=e.clientX,o=e.clientY;return this.mouseWheelWorkaround(t,i,n,o,e.ctrlKey||e.metaKey),e.preventDefault(),!1},mouseWheelWorkaround:function(e,t,i,n,o){var s,r;if(!this.roleContextMenu.open){if(this.timelineView.holdRendering(),0!=i&&0!=n&&(s=this.rawMousePositionToScaledCanvasPosition(new ATPoint(+i,+n)),r=s.x,0>r||r>this.viewport.size.width))return void this.timelineView.releaseRendering();if(o)return void this.timelineView.releaseRendering();finalX=this.viewport.origin.x-e,finalY=this.viewport.origin.y-t,this.scrollTopLeftToPoint(finalX,finalY),this.timelineView.releaseRendering()}},canvasSize:function(){var e=this.el.getBoundingClientRect();return new ATSize(e.width/this.physicalScaleFactor,e.height/this.physicalScaleFactor)},adjustWindowScale:function(){var e=this.canvasSize();10*this.physicalScaleFactor+"px";this.viewport=new ATRect(this.viewport.origin.x,this.viewport.origin.y,e.width,e.height),this.d3El.select(".laneNavSvgWrap").attr("viewBox","0 0 28 "+e.height),this.d3El.select(".xScrollSvgWrap").attr("viewBox","0 0 "+e.width+" 16")},absoluteToRelativePoint:function(e){return new ATPoint(e.x-this.viewport.origin.x,e.y-this.viewport.origin.y)},relativeToAbsolutePoint:function(e){return new ATPoint(e.x+this.viewport.origin.x,e.y+this.viewport.origin.y)},render:function(e){var t=this.pruneData(this.model);this.relationshipPainter.render(t,e)},pruneData:function(){var e,t,i=this,n=this.model,o=n.displayLanes.length,s=n.displayLanes[o-1],r=this.viewport,a=s.top+s.height,l=o>1&&a>r.size.height-TimelineDisplayConstants.timeHeaderHeight-TimelineDisplayConstants.contextHeight-TimelineDisplayConstants.bookmarksHeight,h=n.get("timeline").get("events").models,d=(h.length,l?n.navigationLanes:[]),c=[],g=TimelineDisplayConstants.relationshipViewEventAreaWidth+TimelineDisplayConstants.relationshipViewDateOffsetWidth+TimelineDisplayConstants.relationshipViewEntityColumnSpacing;return TimelineDisplayConstants.scrollKnobXPosition=l?TimelineDisplayConstants.scrollKnobDefaultXPosition:TimelineDisplayConstants.scrollKnobNoLaneNavXPosition,TimelineDisplayConstants.scrollTrackThickness=l?TimelineDisplayConstants.scrollTrackDefaultThickness:TimelineDisplayConstants.scrollTrackNoLaneNavThickness,c=_.map(n.displayLanes,function(e){var t=_.clone(e),n=e.top;return e.top<=r.bottom()&&e.top+e.height>=r.top()?(t.nodes=_.filter(t.nodes,function(e){var t,i=e.totalRect;return t=new ATRect(r.origin.x,i.origin.y+n,i.size.width,i.size.height),t.overlaps(r)?(e.selected=e.original.get("selected"),!0):!1}),t.intersections=_.filter(t.intersections,function(e){var t=i.absoluteToRelativePoint(new ATPoint(e.xPixel,0));return t.x>=g})):t.nodes=[],t}),e=[],t=[],_.each(n.displayColumnGroups,function(i){e.push({name:i.name,xPixel:i.xPixel}),t=_.union(t,i.entityColumns)}),_.each(t,function(e){var t=i.absoluteToRelativePoint(new ATPoint(e.xPixel,0));e.drawInEventArea=t.x>=g}),{lanes:c,navigationLanes:d,columnGroups:e,columns:t,bookmarks:this.model.get("timeline").get("bookmarks"),filters:this.model.get("timeline").get("filters")}},eventNodeClick:function(e){var t=this;null!=d3.event.touches;if(this.hideRoleContextMenuIfOpen(),this.timelineView.holdRendering(),d3.event.shiftKey&&d3.event.altKey)this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id);else if(d3.event.shiftKey&&this.nodeToStartShiftSelection){var i,n,o,s=_.findIndex(this.model.displayLanes,function(e){return e.id==t.nodeToStartShiftSelection.laneId}),r=_.findIndex(this.model.displayLanes[s].nodes,function(e){return e.id==t.nodeToStartShiftSelection.id}),a=_.findIndex(this.model.displayLanes,function(t){return t.id==e.laneId}),l=_.findIndex(this.model.displayLanes[a].nodes,function(t){return t.id==e.id});if(a>s){for(n=this.model.displayLanes[s],o=n.nodes.length,i=r;o>i;i++)this.timeline.selectEventWithID(n.nodes[i].id);for(i=s+1;a>i;i++)n=this.model.displayLanes[i],_.each(n.nodes,function(e){t.timeline.selectEventWithID(e.id)});for(n=this.model.displayLanes[a],i=0;l>=i;i++)this.timeline.selectEventWithID(n.nodes[i].id)}else if(a==s&&l>r)for(n=this.model.displayLanes[a],i=r;l>=i;i++)this.timeline.selectEventWithID(n.nodes[i].id);else if(a==s&&r>l)for(n=this.model.displayLanes[a],i=l;r>=i;i++)this.timeline.selectEventWithID(n.nodes[i].id);else if(s>a){for(n=this.model.displayLanes[a],o=n.nodes.length,i=l;o>i;i++)this.timeline.selectEventWithID(n.nodes[i].id);for(i=a+1;s>i;i++)n=this.model.displayLanes[i],_.each(n.nodes,function(e){t.timeline.selectEventWithID(e.id)});for(n=this.model.displayLanes[s],i=0;r>=i;i++)this.timeline.selectEventWithID(n.nodes[i].id)}}else d3.event.metaKey||d3.event.ctrlKey?e.selected?this.timeline.unselectEventWithID(e.id):this.timeline.selectEventWithID(e.id):(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id));return d3.event.shiftKey||(this.nodeToStartShiftSelection=e),this.timelineView.releaseRendering(),d3.event.stopPropagation(),d3.event.preventDefault(),!1},eventNodeForYPosition:function(e){var t=null;return this.model.lanes.each(function(i){var n=i.get("top"),o=e-i.get("top");e>=n&&n+i.get("height")>=e&&i.nodes.each(function(e){e.get("relationshipTotalRect").top()<o&&e.get("relationshipTotalRect").bottom()>=o&&(t=e)})}),t},nodesSurroundingYPosition:function(e,t){var i=null,n=null;return _.each(this.model.displayLanes,function(o){var s=o.top,r=e-o.top,a=!1,l=null;e>=s&&s+o.height>=e&&_.each(o.nodes,function(e){a&&!n&&(n=e),e.totalRect.top()<r&&e.totalRect.bottom()>=r&&(a=!0,t?(i=l,n=e):i=e),l=e})}),{match:i,next:n}},entityColumnForXPosition:function(e){var t=null;return _.each(this.model.displayColumnGroups,function(i){_.each(i.entityColumns,function(i){i.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing<e&&i.xPixel>=e&&(t=i)})}),t?t.id:-1},canvasClick:function(e){var t=(null!=d3.event.touches,this.rawMousePositionToScaledCanvasPosition(new ATPoint(d3.event.x,d3.event.y))),i=this.relativeToAbsolutePoint(t),n=this.eventNodeForYPosition(i.y),o=n?n.id:-1,s=this.entityColumnForXPosition(i.x),r=this.clientYBelowFilterBar(d3.event.y);return r<=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.lifetimeHeight||r>=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.scrollTrackNoLaneNavThickness?(this.roleContextMenu.hide(),void this.timeline.clearSelection()):(this.timelineView.holdRendering(),0>=o&&this.timeline.clearSelection(),!this.roleContextMenu.open&&o>0&&s>0?(this.eventIdForContextMenu=o,this.entityIdForContextMenu=s,this.updateRoleContextOptions(),this.roleContextMenu.show(this.$el,this.clientXLeftOfSyncBinder(d3.event.x),r)):this.roleContextMenu.hide(),this.timelineView.releaseRendering(),d3.event.stopPropagation(),d3.event.preventDefault(),!1)},hideRoleContextMenuIfOpen:function(){this.roleContextMenu.open&&(this.roleContextMenu.hide(),this.roleContextMenu.open=!1)},updateRoleContextOptions:function(){var e=this.timeline,t=this.inspectorModel.get("template"),i=e.get("entities").get(this.entityIdForContextMenu),n=i.get("type"),o=_.find(t.types,function(e){return e.name==n}),s=o.roles,r=[];r.push({value:-1,icon:"ban",label:"None"}),_.each(s,function(e){r.push({value:e.roleId,icon:e.icon,label:e.name})},this),this.roleContextMenu.setOptions(r)},contextRoleClick:function(e){var t=this.roleContextMenu.getValue();window.ApplicationInterface&&(t>0?window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,""+this.eventIdForContextMenu,this.entityIdForContextMenu,t,1):-1==t&&window.ApplicationInterface.selectedEventsRemoveRelationship(window.timelineDocumentId,""+this.eventIdForContextMenu,this.entityIdForContextMenu))},relationshipTreeNestingClick:function(){this.setTreeFlattened(!1),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewFlattenTree(window.timelineDocumentId,!1)},relationshipFlattenClick:function(){this.setTreeFlattened(!0),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewFlattenTree(window.timelineDocumentId,!0)},relationshipShowOffsetsClick:function(){this.setShowOffsets(!this.showOffsets),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewShowOffsets(window.timelineDocumentId,this.showOffsets)},updateRelationshipFlattenButtonStates:function(){this.model.relationshipViewFlattenTree?($("#relationshipTreeNestingButton").removeClass("selected"),$("#relationshipFlattenNestingButton").addClass("selected")):($("#relationshipTreeNestingButton").addClass("selected"),$("#relationshipFlattenNestingButton").removeClass("selected"))},relationshipSettingsClick:function(e){var t=this,i=this.timeline.get("entities"),n=this.inspectorModel.get("entitiesByType"),o=this.inspectorModel.get("template"),s=o.types,r=[],a=$(e.target);_.each(s,function(e){var t=e.name,o=n[t],s=[];_.each(o,function(e){var t=i.get(e.entityId);s.push({id:t.id,name:t.get("name"),isChecked:t.get("visibleAsColumn")})}),r.push({name:t,items:s})}),this.hideRoleContextMenuIfOpen(),this.removeExistingPopover(),a.popover({content:this.selectColumnTemplate({groups:r}),title:'<span>Select Columns</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:"bottom",trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(a),$(".popover-title").html('<span>Select Columns</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>'),$(".selectColumnGroupCheckbox").on("click",this.groupToggleClick.bind(this)),$(".selectColumnListItemCheckbox").on("click",this.columnToggleClick.bind(this)),$(".selectColumnGroupDisplayToggle").on("click",this.groupDisplayToggleClick.bind(this)),$("#selectColumnAllBtn").on("click",this.allButtonClick.bind(this)),$("#selectColumnNoneBtn").on("click",this.noneButtonClick.bind(this)),$("#popoverClose").on("click",function(){t.removeExistingPopover()}),this.updateGroupCheckboxStates()},updateGroupCheckboxStates:function(){var e=this.timeline.get("entities"),t=this.inspectorModel.get("entitiesByType");_.each(t,function(t,i){var n=!1,o=!1,s=".show-group-"+i;_.each(t,function(t){var i=e.get(t.entityId);i.get("visibleAsColumn")?n=!0:o=!0}),$(s).prop("checked",!o),$(s).prop("indeterminate",n&&o)})},columnToggleClick:function(e){var t,i,n;this.timeline.get("entities");e&&e.target&&(t=$(e.target),i=t.val(),n=t.is(":checked"),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsVisible(window.timelineDocumentId,""+i,n)),this.updateGroupCheckboxStates()},groupDisplayToggleClick:function(e){var t,i,n,o;this.timeline.get("entities");this.timelineView.holdRendering(),e&&e.target&&(t=$(e.target),i=t.data("groupname"),n=$(".selectColumnsGroupWrap-"+i+" .selectColumnsRowWrap"),o=t.hasClass("fa-caret-down"),o?(t.removeClass("fa-caret-down"),t.addClass("fa-caret-right"),n.slideUp()):(t.removeClass("fa-caret-right"),t.addClass("fa-caret-down"),n.slideDown())),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering(),this.updateGroupCheckboxStates()},groupToggleClick:function(e){var t,i,n,o,s=this.timeline.get("entities"),r=[];e&&e.target&&(t=$(e.target),i=t.val(),n=t.is(":checked"),o=".selectColumnsGroupWrap-"+i+" .selectColumnListItemCheckbox",s.each(function(e){e.get("type")==i&&r.push(e.id)}),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsVisible(window.timelineDocumentId,r.join(),n),$(o).prop("checked",n)),this.updateGroupCheckboxStates()},allButtonClick:function(e){var t=this.timeline.get("entities"),i=[];t.each(function(e){i.push(e.id)}),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsVisible(window.timelineDocumentId,i.join(),!0),$(".selectColumnListItemCheckbox").prop("checked",!0),this.updateGroupCheckboxStates()},noneButtonClick:function(e){var t=this.timeline.get("entities"),i=[];t.each(function(e){i.push(e.id)}),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsVisible(window.timelineDocumentId,i.join(),!1),$(".selectColumnListItemCheckbox").prop("checked",!1),this.updateGroupCheckboxStates()},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove()},clickInVerticalScrollTrack:function(){function e(e,i,n,o){return function(){var e=d3.interpolateNumber(n,o);return function(i){t.scrollTopToPoint(e(i))}}}var t=this,i=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,n=(this.viewport.size.height-i-TimelineDisplayConstants.relationshipNavFooterHeight,isNaN(d3.event.clientY)?d3.event.touches[0].clientY:d3.event.clientY),o=this.clientYBelowFilterBar(n)-i,s=this.rangeY.min+o/(this.viewport.size.height-i-TimelineDisplayConstants.navFooterHeight)*(this.rangeY.max-this.rangeY.min);this.hideRoleContextMenuIfOpen(),d3.transition().duration(this.relationshipPainter.transitionDuration).tween("animatedscroll",e(this.viewport.origin.x,this.viewport.origin.x,this.viewport.origin.y,s)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},clickInHorizontalScrollTrack:function(){function e(e,i,n,o){return function(){var n=d3.interpolateNumber(e,i);return function(e){t.scrollLeftToPoint(n(e))}}}var t=this,i=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,n=(this.viewport.size.width-i,isNaN(d3.event.clientX)?d3.event.touches[0].clientX:d3.event.clientX),o=this.clientXLeftOfSyncBinder(n)-i,s=this.rangeX.min+o/(this.viewport.size.width-i)*(this.rangeX.max-this.rangeX.min);this.hideRoleContextMenuIfOpen(),d3.transition().duration(this.relationshipPainter.transitionDuration).tween("animatedscroll",e(this.viewport.origin.x,s,this.viewport.origin.y,this.viewport.origin.y)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragStarted:function(e){this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null,this.hideRoleContextMenuIfOpen(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragged:function(e){var t,i=this,n=isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY,o=this.clientYBelowFilterBar(n),s=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,r=(this.viewport.top()+s,this.viewport.size.height-s-TimelineDisplayConstants.relationshipNavFooterHeight),a=this.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight;this.verticalScrollDragStartY||(this.verticalScrollDragStartY=o?o:1,this.verticalScrollDragStartAbsY=i.viewport.top()),t=this.verticalScrollDragStartAbsY+(o-this.verticalScrollDragStartY)/this.physicalScaleFactor/r*a,this.scrollTopToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null},horizontalScrollDragStarted:function(e){this.horizontalScrollDragStartX=null,this.horizontalScrollDragStartAbsX=null,this.hideRoleContextMenuIfOpen(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},horizontalScrollDragged:function(e){var t,i=this,n=isNaN(d3.event.sourceEvent.clientX)?d3.event.sourceEvent.touches[0].clientX:d3.event.sourceEvent.clientX,o=this.clientXLeftOfSyncBinder(n),s=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,r=(this.viewport.left(),this.viewport.size.width-s),a=this.rangeX.max-s;this.horizontalScrollDragStartX||(this.horizontalScrollDragStartX=o?o:1,this.horizontalScrollDragStartAbsX=i.viewport.left()),t=this.horizontalScrollDragStartAbsX+(o-this.horizontalScrollDragStartX)/this.physicalScaleFactor/r*a,this.scrollLeftToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},horizontalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.horizontalScrollDragStartX=null,this.horizontalScrollDragStartAbsX=null},scrollToLane:function(e){this.hideRoleContextMenuIfOpen(),this.scrollToPixelXY(null,e.top-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.relationshipPainter.transitionDuration)},scrollToNode:function(e){this.hideRoleContextMenuIfOpen(),this.scrollToPixelXY(null,e.get("lane").get("top")+e.get("relationshipTotalRect").origin.y-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,1e3)},scrollToNodeIfOffScreen:function(e){var t,i,n=e.get("lane");n.get("collapsed")&&this.toggleLane(n.id),t=this.viewport.deepCopy(),t.size.height-=TimelineDisplayConstants.bookmarksHeight+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.filterBarHeight,i=e.get("relationshipTotalRect").deepCopy(),i.origin.y+=e.get("lane").get("top"),t.containsRect(i)||this.scrollToNode(e)},scrollToEventsIfOffScreen:function(e){var t,i=this.model.findAllNodesForEventIds(e),n=!1,o=null;t=this.viewport.deepCopy(),t.size.height-=TimelineDisplayConstants.bookmarksHeight+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.filterBarHeight,_.each(i,function(e){var i=e.get("lane"),s=e.get("relationshipTotalRect").deepCopy();s.origin.y+=e.get("lane").get("top"),i.get("collapsed")||(t.containsRect(s)?n=!0:o=e)},this),n||(o?this.scrollToNode(o):i.length>0&&(this.toggleLane(i[0].get("lane").id),this.scrollToNode(i[0])))},resultForDropAtAbsY:function(e,t){var i,n,o,s,r,a,l,h,d,c,g=this.model.laneForAbsoluteY(e),v=g?_.find(this.model.displayLanes,function(e){return e.id==g.id}):null,u=v?v.top:0,p=t&&e<u+t.totalRect.origin.y,m=this.nodesSurroundingYPosition(e,p),w=this.timeline.get("events"),D=m.match,f=m.next,E=D?w.findChild(D.id):null,T=f?w.findChild(f.id):null;if(E&&T)if(o=E.get("startTS"),s=T.get("startTS"),o==s)d=this.timeline.rangeConversion.valueFromTimestamp(o,E.get("precision"));else for(a=(E.get("startTS")+T.get("startTS"))/2,c=Math.max(E.get("precision"),T.get("precision")),h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueAtEvenSpanBeforeTimestamp(a,h),r=isNaN(d.timestamp)?d:d.timestamp;r==o&&c<ATTimeUnit.SECOND;)c++,h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueAtEvenSpanBeforeTimestamp(a,h),r=isNaN(d.timestamp)?d:d.timestamp;else p?(T||g.nodes.length>0&&(f=v.nodes[0],T=w.findChild(f.id)),o=T.get("startTS"),l=this.timeline.rangeConversion.valueFromTimestamp(o,T.get("precision")),c=T.get("precision"),h=this.timeline.rangeConversion.spanForPrecision(c,!0),d=this.timeline.rangeConversion.valueByAddingSpanToValue(l,h)):(E||g.nodes.length>0&&(D=v.nodes[v.nodes.length-1],E=w.findChild(D.id)),o=E.get("startTS"),l=this.timeline.rangeConversion.valueFromTimestamp(o,E.get("precision")),c=E.get("precision"),h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueByAddingSpanToValue(l,h));return i=!0,(E&&t&&E.id==t.id||T&&t&&T.id==t.id)&&(i=!1),n=u+(p?f.totalRect.top():D.totalRect.bottom()),{rangeValue:d,yPosition:n,allowMove:i}},dropSyncItem:function(e,t,i){var n=this.clientXLeftOfSyncBinder(t),o=this.clientYBelowFilterBar(i),s=new ATPoint(n,o),r=this.relativeToAbsolutePoint(s),a=this.model.laneForAbsoluteY(r.y),l=a?parseInt(a.id):-1,h=this.resultForDropAtAbsY(r.y,null).rangeValue;h&&(dateStr=this.timeline.rangeConversion.naturalStringFromValue(h,!1),window.ApplicationInterface&&window.ApplicationInterface.createEventsFromSyncItems(window.timelineDocumentId,e,dateStr,l))},eventNodeDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches,i=d3.event.sourceEvent.altKey,n=d3.event.sourceEvent.shiftKey,o=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey;if(this.eventNodeDragStartTimestamp=d3.event.sourceEvent.timeStamp,t&&d3.event.sourceEvent.touches.length>1||this.disablePan)return void(this.eventDragDisabled=!0);if(1!=window.isAeonWebExport){this.eventDragDisabled=!1;var s=this.model.lanes.get(e.laneId).get("top"),r=new ATPoint(0,e.totalRect.origin.y+s),a=this.absoluteToRelativePoint(r),l=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),h=this.rawMousePositionToScaledCanvasPosition(l);this.timelineView.holdRendering(),this.draggingEvent=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.dragEventForPositionAllowed=!1,this.draggingEventForEndPosition=!1,this.eventDragStartPos=null,this.eventDragEndPos=this.eventDragStartPos,this.eventDragOffsetX=a.x-h.x,this.eventDragOffsetY=a.y-h.y,this.eventDraggingNode=e,this.eventDragFarEnough=!1,n&&i?(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceStartPos=this.relativeToAbsolutePoint(h)):n||o?(this.clickedEventWasOriginallySelected=e.selected,e.selected?n&&this.timeline.unselectEventWithID(e.id):this.timeline.selectEventWithID(e.id)):t||e.selected||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)),this.eventDragStartedWithRightClick=2==d3.event.sourceEvent.button,this.eventDragStartedWithRightClick||(this.dragEventForPositionAllowed=this.timeline.selectedEventsDraggable()&&1==this.timeline.selectedEvents.length,this.timelineView.eventDragTooltip||(this.timelineView.eventDragTooltip=new Opentip($("#mainTimelineCanvas"),{style:"eventDragTooltipStyle"}))),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.releaseRendering()}},eventNodeDragged:function(e){var t=d3.event.sourceEvent.timeStamp-this.eventNodeDragStartTimestamp;if(!(this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan||this.eventDragStartedWithRightClick||2==d3.event.sourceEvent.button)){if(!this.timeline.isEventWithIdSelected(e.id)){if(t<TimelineDisplayConstants.touchEventMinimumHoldTimeBeforeMove)return void(this.eventDragDisabled=!0);this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)}if(this.eventDragDisabled=!1,1!=window.isAeonWebExport){var i,n,o,s,r,a,l,h,d,c,g=this,v=d3.event.sourceEvent.altKey,u=d3.event.sourceEvent.shiftKey,p=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,m=0;if(this.timelineView.holdRendering(),this.draggingEvent){if(s=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),r=this.rawMousePositionToScaledCanvasPosition(s),a=r.x,l=r.y,i=new ATPoint(a+this.eventDragOffsetX,l+this.eventDragOffsetY),n=this.relativeToAbsolutePoint(i),o=this.relativeToAbsolutePoint(new ATPoint(a,l)),n.y=o.y,this.eventDragEndPos&&(m=n.x-this.eventDragEndPos.x),this.eventDragEndPos=n,this.eventDragEndLane=this.model.laneForAbsoluteY(o.y),this.eventDragStartPos||(this.eventDragStartPos=n,this.eventDragStartingLane=this.eventDragEndLane),window.mainApp.syncBinderVisible&&0>a){if(!this.eventDragIntoBinder){var w,D={jstree:!0,draggingEvents:!0,obj:$(this),nodes:[]};_.each(this.timeline.selectedEvents,function(e){var t=g.timeline.get("events").findChild(e);D.nodes.push({id:!0,text:t.get("title"),eventId:t.id}),w=t.get("title")}),this.timeline.selectedEvents.length>1&&(w="Sync "+this.timeline.selectedEvents.length+" new events"),$.vakata.dnd.start(d3.event.sourceEvent,D,'<div id="jstree-dnd" class="jstree-default"><i class="jstree-icon jstree-er"></i>'+w+"</div>"),this.eventDragIntoBinder=!0}this.eventDragTick=null,this.viewDragTick=null,this.eventNodeDragEnded(e),window.mainApp.onboarding.removeOnboardingMessage("scriv-dragevent-in")}else this.eventDragIntoBinder=!1,c=Math.abs(this.eventDragStartPos.x-n.x)+Math.abs(this.eventDragStartPos.y-n.y),c>5&&(this.eventDragFarEnough=!0),v&&u?(this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceFromNode||(this.eventDragMeasureDistanceFromNode=this.eventDragStartingLane.nodes.findNode(e.id)),this.eventDragMeasureDistanceToNode=this.eventNodeForYPosition(o.y),this.eventDragMeasureDistanceEndPos=o,this.timeline.clearSelection(!0),
this.timeline.selectEventWithID(e.id),this.eventDragMeasureDistanceToNode&&this.timeline.selectEventWithID(this.eventDragMeasureDistanceToNode.id)):p?(this.draggingEventForParent=!0,this.draggingEventForEndPosition=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragTargetEventDrop=this.eventNodeForYPosition(o.y),!this.eventDragTargetEventDrop||this.eventDragTargetEventDrop.id!=e.id&&this.timeline.selectedEventsCanHaveParent(this.eventDragTargetEventDrop.id)||(this.eventDragTargetEventDrop=null),this.eventDragChangingParent=!0):(this.draggingEventForEndPosition=!1,this.draggingEventForParent=!1,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragEndLane!=this.eventDragStartingLane?(this.draggingEventForLane=!0,this.draggingEventForPosition=!1):(this.draggingEventForLane=!1,this.draggedEventNode=e,this.dragEventForPositionAllowed?this.draggingEventForPosition=!0:this.draggingEventForPosition=!1)),h=this.viewport.size.width,d=this.viewport.size.height,this.dragScrollIncrementY=0,70>l&&(this.dragScrollIncrementY=-10),l>d-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.draggingEventForParent&&(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1),this.d3EventPt=i,this.scrollIncrement(0,this.dragScrollIncrementY),this.eventDragTick=this.eventNodeDraggedNearEdge.bind(this),window.setTimeout(this.eventDragTick,5)):this.eventDragTick&&(this.eventDragTick=null);d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()}this.eventDragFarEnough&&(this.eventNodeDraggedCalculateActions(),this.relationshipPainter.drawMoveEventLine()),this.timelineView.releaseRendering()}}},eventNodeDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e;this.timelineView.holdRendering(),e=this.relativeToAbsolutePoint(this.d3EventPt),this.eventDragEndPos=e,this.eventDragEndLane=this.model.laneForAbsoluteY(e.y),this.scrollIncrement(0,this.dragScrollIncrementY),this.draggingEventForParent?(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1):this.draggingEventForDistanceMeasure&&(this.eventDragMeasureDistanceToNode=null),this.eventDragTick&&window.setTimeout(this.eventDragTick,15),this.eventDragFarEnough&&(this.draggingEvent&&this.eventNodeDraggedCalculateActions(),this.relationshipPainter.drawMoveEventLine()),this.timelineView.releaseRendering()}},eventNodeDraggedCalculateActions:function(){var e,t,i,n,o,s,r,a,l="tooltipNormal";this.eventDraggingNode;if(this.draggingEventForDistanceMeasure)this.eventDragMeasureDistanceToNode?(i=this.eventDragMeasureDistanceFromNode.get("event"),n=this.eventDragMeasureDistanceToNode.get("event"),i!=n?(n.get("startTS")>i.get("endTS")?(o=this.timeline.rangeConversion.valueFromTimestamp(i.get("endTS")),t="end"):(o=this.timeline.rangeConversion.valueFromTimestamp(i.get("startTS")),t="start"),s=this.timeline.rangeConversion.valueFromTimestamp(n.get("startTS")),r=this.timeline.rangeConversion.spanBetweenValues(o,s),e="Distance from "+t+" of event: "+r.toString()):e="Hover over event to measure distance between events"):e="Hover over event to measure distance between events";else if(this.draggingEventForParent)e=this.eventDragTargetEventDrop?'Make child of "'+this.eventDragTargetEventDrop.get("event").get("title")+'"':"Drop on event to become child";else if(this.draggingEventForLane)e="Add relationship to "+this.eventDragEndLane.get("entity").get("name");else if(this.draggingEventForPosition)this.snapDragLine=null,a=this.resultForDropAtAbsY(this.eventDragEndPos.y,this.draggedEventNode),a.allowMove?(value=a.rangeValue,this.eventDragDropY=a.yPosition,e="Move event to "+this.timeline.rangeConversion.naturalStringFromValue(value,!0)):(this.eventDragDropY=null,e=null);else{if(!this.draggingEvent||this.dragEventForPositionAllowed)return this.timelineView.eventDragTooltip.hide(),void this.timelineView.eventDragTooltip.deactivate();e="Cannot drag dependent events. Move its predecessor instead.",l="tooltipError"}e=e?'<span class="'+l+'">'+e+"</span>":null,e?(this.timelineView.eventDragTooltip.setContent(e),this.timelineView.eventDragTooltip.prepareToShow()):(this.timelineView.eventDragTooltip.hide(),this.timelineView.eventDragTooltip.deactivate())},eventNodeDragEnded:function(e){var t=(d3.event.sourceEvent.altKey,d3.event.sourceEvent.shiftKey),i=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey;if(this.eventDragStartedWithRightClick||this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan)return this.eventDragStartedWithRightClick=!1,this.eventDragDisabled=!1,this.eventDragTick=null,this.draggingEvent=!1,this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,void this.relationshipPainter.drawMoveEventLine();if(this.eventDragDisabled=!1,1!=window.isAeonWebExport){if(this.eventDragTick=null,this.draggingEvent=!1,this.timelineView.holdRendering(),!this.eventDragIntoBinder){var n,o=this.timeline.selectedEvents.join();if(this.eventDragIntoBinder=!1,this.eventDragFarEnough)if(this.draggingEventForParent&&this.eventDragChangingParent)window.ApplicationInterface&&(n=this.eventDragTargetEventDrop?this.eventDragTargetEventDrop.id:-1,window.mainApp.showNewParentPromptIfNeeded(n,function(e){window.ApplicationInterface.moveEventsWithIdsToParent(window.timelineDocumentId,o,n,e)}));else if(this.draggingEventForLane&&this.eventDragEndLane!=this.eventDragStartingLane)window.ApplicationInterface&&window.ApplicationInterface.copyEventsWithIdsToLane(window.timelineDocumentId,o,parseInt(this.eventDragEndLane.id));else if(this.draggingEventForPosition){if(window.ApplicationInterface&&1==this.timeline.selectedEvents.length&&(dropResult=this.resultForDropAtAbsY(this.eventDragEndPos.y,this.draggedEventNode),dropResult.allowMove)){value=dropResult.rangeValue;var s=""+(isNaN(value.timestamp)?value:value.timestamp),r=isNaN(value.precision)?0:value.precision;window.ApplicationInterface.moveEventWithIdToTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],s,r)}}else t||i||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id));else i&&this.clickedEventWasOriginallySelected?this.timeline.unselectEventWithID(e.id):t||i||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id))}this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.eventDragDropY=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,this.relationshipPainter.drawMoveEventLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.eventDragTooltip.hide(),this.timelineView.eventDragTooltip.deactivate(),this.timelineView.releaseRendering()}},laneDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches;1==window.isAeonWebExport||t||e.id<0||(this.draggingLane=!0,this.laneDragStartPos=null,this.laneDragEndLane=null,this.laneDragEndPos=this.laneDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},laneDragged:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i,n,o,s,r,a,l;e.id<0||this.draggingLane&&(i=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),n=this.rawMousePositionToScaledCanvasPosition(i),o=this.relativeToAbsolutePoint(n),s=n.y,l=this.model.laneForAbsoluteY(o.y),l.id>=0&&(this.laneDragEndLane=l),this.laneDragEndPos=o,this.laneDragStartPos||(this.laneDragStartPos=o,this.laneDragStartingLane=this.laneDragEndLane),r=this.viewport.size.width,a=this.viewport.size.height,this.dragScrollIncrementY=0,70>s&&(this.dragScrollIncrementY=-10),s>a-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.d3EventPt=n,this.scrollIncrement(0,this.dragScrollIncrementY),this.laneDragTick=this.laneDraggedNearEdge.bind(this),window.setTimeout(this.laneDragTick,5)):this.laneDragTick&&(this.laneDragTick=null),this.relationshipPainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},laneDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e,t;e=this.relativeToAbsolutePoint(this.d3EventPt),this.laneDragEndPos=e,t=this.model.laneForAbsoluteY(e.y),t.id>=0&&(this.laneDragEndLane=t),this.scrollIncrement(0,this.dragScrollIncrementY),this.laneDragTick&&(this.relationshipPainter.drawMoveLaneLine(),window.setTimeout(this.laneDragTick,15))}},laneDragEnded:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i=e.id;e.id<0||(this.laneDragTick=null,this.draggingLane=!1,this.laneDragEndLane&&this.laneDragEndLane.id!=i&&window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,parseInt(i),parseInt(this.laneDragEndLane.id)),this.laneDragEndPos=null,this.laneDragStartingLane=null,this.laneDragEndLane=null,this.relationshipPainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},temporarilyMoveColumnToPixel:function(e,t){var i,n=this.model.columnForEntityId(e),o=_.find(this.model.displayColumnGroups,function(e){return e.name==n.type}),s=_.indexOf(o.entityColumns,n),r=_.findIndex(o.entityColumns,function(e){return e.xPixel>t}),a=0>r,l=0==r;if(a?r=o.entityColumns.length-1:r--,this.timelineView.holdRendering(),r>s)for(i=s+1;r>=i;i++)o.entityColumns[i].xPixel=o.xPixel+(i-1)*TimelineDisplayConstants.relationshipViewEntityColumnSpacing;else if(s>r)for(i=s-1;i>r;i--)o.entityColumns[i].xPixel=o.xPixel+(i+1)*TimelineDisplayConstants.relationshipViewEntityColumnSpacing;a?n.xPixel=Math.min(t,o.xPixel+r*TimelineDisplayConstants.relationshipViewEntityColumnSpacing+TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2):l?n.xPixel=Math.max(t,o.xPixel):n.xPixel=t,o.entityColumns.sort(function(e,t){return e.xPixel-t.xPixel}),this.model.calculateNodesRelationshipView(!0),this.timelineView.setRenderFlag("data"),this.timelineView.releaseRendering()},temporarilyMoveColumnGroupToPixel:function(e,t){var i=this.model.displayColumnGroups,n=_.find(i,function(t){return t.name==e}),o=(_.indexOf(i,n),_.findIndex(i,function(e){return e.xPixel>t})),s=0>o;s?o=i-1:o--,this.timelineView.holdRendering(),n.xPixel=t,i.sort(function(e,t){return e.xPixel-t.xPixel}),this.model.calculateRelationshipViewColumns(!0,!1),n.xPixel=t,this.model.calculateRelationshipViewColumns(!1,!1),this.model.calculateNodesRelationshipView(!0),this.timelineView.setRenderFlag("data"),this.timelineView.releaseRendering()},columnDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches;1==window.isAeonWebExport||t||e.id<0||(this.draggingColumn=!0,this.columnDragStartPos=null,this.columnDragStartingType=null,this.columnDragEndPos=this.columnDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.relationshipPainter.draggingColumn=!0,this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},columnDragged:function(e){var t=null!=d3.event.sourceEvent.touches,i=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));if(1!=window.isAeonWebExport&&!t){var n,o,s,r,a,l;e.id<0||this.draggingColumn&&(n=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),o=this.rawMousePositionToScaledCanvasPosition(n),s=this.relativeToAbsolutePoint(o),r=o.x,this.columnDragStartPos||(this.columnDragStartPos=s,this.columnDragStartingColumn=this.model.relationshipColumnForAbsoluteX(s.x,this.columnDragStartingType),this.columnDragStartingType=this.columnDragStartingColumn.type),a=this.viewport.size.width,l=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,r<TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft&&this.viewport.origin.x>i.min&&(this.dragScrollIncrementX=-10),r>a-30&&this.viewport.origin.x<i.max&&(this.dragScrollIncrementX=10),this.dragScrollIncrementX?(this.d3EventPt=o,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnDragTick=this.columnDraggedNearEdge.bind(this),window.setTimeout(this.columnDragTick,5)):this.columnDragTick&&(this.columnDragTick=null),this.temporarilyMoveColumnToPixel(e.id,s.x),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},columnDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e=this.relativeToAbsolutePoint(this.d3EventPt),t=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnDragTick&&(this.temporarilyMoveColumnToPixel(this.columnDragStartingColumn.id,e.x),this.viewport.origin.x>t.min&&this.viewport.origin.x<t.max&&window.setTimeout(this.columnDragTick,45))}},columnDragEnded:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i=e.id;if(!(e.id<0)){var n=_.find(this.model.displayColumnGroups,function(t){return t.name==e.type}),o=_.findIndex(n.entityColumns,function(t){return t.id==e.id}),s=_.find(n.entityColumns,function(e){return e.sortOrder==o+1}),r=s?s.id:null;this.columnDragTick=null,this.draggingColumn=!1,this.relationshipPainter.draggingColumn=!1,r&&r!=i?window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,parseInt(i),parseInt(r)):(this.timelineView.holdRendering(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()),this.columnDragStartingColumn=null,this.columnDragStartingType=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()}}},columnGroupDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches;1==window.isAeonWebExport||t||(this.draggingColumnGroup=!0,this.columnGroupDragStartPos=null,this.columnGroupDragStartingType=null,this.columnGroupDragEndPos=this.columnGroupDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.relationshipPainter.draggingColumnGroup=!0,this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},columnGroupDragged:function(e){var t=null!=d3.event.sourceEvent.touches,i=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));if(1!=window.isAeonWebExport&&!t){var n,o,s,r,a,l;this.draggingColumnGroup&&(n=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),o=this.rawMousePositionToScaledCanvasPosition(n),s=this.relativeToAbsolutePoint(o),r=o.x,this.columnGroupDragStartPos||(this.columnGroupDragStartPos=s,this.columnGroupDragStartingColumnGroup=e),a=this.viewport.size.width,l=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,r<TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft&&this.viewport.origin.x>i.min&&(this.dragScrollIncrementX=-10),r>a-30&&this.viewport.origin.x<i.max&&(this.dragScrollIncrementX=10),this.dragScrollIncrementX?(this.d3EventPt=o,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnGroupDragTick=this.columnGroupDraggedNearEdge.bind(this),window.setTimeout(this.columnGroupDragTick,5)):this.columnGroupDragTick&&(this.columnGroupDragTick=null),this.temporarilyMoveColumnGroupToPixel(e.name,s.x),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},columnGroupDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e=this.relativeToAbsolutePoint(this.d3EventPt),t=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnGroupDragTick&&(this.temporarilyMoveColumnGroupToPixel(this.columnGroupDragStartingColumnGroup.name,e.x),this.viewport.origin.x>t.min&&this.viewport.origin.x<t.max&&window.setTimeout(this.columnGroupDragTick,45))}},columnGroupDragEnded:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i=_.findIndex(this.model.displayColumnGroups,function(t){return t.name==e.name}),n=_.find(this.model.displayColumnGroups,function(e){return e.sortOrder==i+1});this.columnGroupDragTick=null,this.draggingColumnGroup=!1,this.relationshipPainter.draggingColumnGroup=!1,n&&n.name!=e.name?window.ApplicationInterface&&window.ApplicationInterface.moveEntityTypeToPositionOfEntityType(window.timelineDocumentId,e.name,n.name):(this.timelineView.holdRendering(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()),this.columnGroupDragStartingColumnGroup=null,this.columnGroupDragStartingType=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()}},bookmarkClick:function(e){var t=e.timestamp,i=t-e.scale*this.viewport.size.width/2,n=this.timeline.firstEventAfterTimestamp(i),o=n?this.model.findAllNodesForEventId(n.id):[],s=null,r=null,a=this.viewport.origin.y;_.each(o,function(e){var t=e.get("lane").get("top")+e.get("relationshipTotalRect").origin.y,i=Math.abs(t-a);(null==s||s>i)&&(r=e,s=i)}),this.hideRoleContextMenuIfOpen(),r&&this.scrollToNode(r),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoFirstBookmark:function(){var e=this.model.findEarliestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoLastBookmark:function(){var e=this.model.findLatestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoPreviousEvent:function(){var e=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,t=this.viewport.origin.y-e;this.scrollToPixelXY(null,t,this.relationshipPainter.transitionDuration),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoNextEvent:function(){var e=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,t=this.viewport.origin.y+e;this.scrollToPixelXY(null,t,this.relationshipPainter.transitionDuration),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},fakeCenterTsForBookmark:function(){var e,t,i=this.viewport.origin.y+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.lifetimeHeight,n=this.eventNodeForYPosition(i),o=n?n.id:-1;return 0>o?null:(e=this.timeline.get("events").findChild(o),t=e.get("startTS"),t+=this.model.get("unitScale")*this.viewport.size.width/2)}});module.exports=ATRelationshipView;
},{"../lib/opentip":11,"./ATBounds":16,"./ATDisplayConstants":26,"./ATIconContextMenu":51,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATRelationshipViewPainter":75,"./ATSize":79,"./ATTimeSpan":84,"./ATTimeUnit":85,"./ATUtilities":91,"./ATViewMode":92,"./templates/relationshipViewSelectColumnsTemplate.html":162,"backbone":176,"bootstrap":177,"d3":300,"hammerjs":301,"jquery":307,"lodash":309}],75:[function(require,module,exports){
function MyRound(t,e){return Math.round(t*e)}function MyCeil(t,e){return Math.ceil(t*e)}var $=require("jquery"),d3=require("d3"),_=require("lodash"),Hilitor2=require("../lib/hilitor2"),ATUtilities=require("./ATUtilities"),Opentip=require("../lib/opentip"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATSize=require("./ATSize"),ATRelationshipViewPainter=function(t){this.relationshipView=t,this.scaleFactor=1,this.bgLayer=t.layers.bg_layer,this.intersectionLayer=t.layers.intersection_layer,this.offsetLayer=t.layers.offset_layer,this.eventLayer=t.layers.event_layer,this.laneLayer=t.layers.lane_layer,this.headerLayer=t.layers.entity_header,this.laneNavSvg=t.layers.lane_nav_svg,this.xScrollSvg=t.layers.x_scroll_svg,this.uiDrawingSvg=t.layers.ui_drawing_svg,this.bookmarksDiv=t.bookmarksDiv,this.bookmarkGroup=this.bookmarksDiv.select(".bookmarkGroup"),this.bookmarkAdd=this.bookmarksDiv.select(".bookmarkAdd"),this.bookmarksConfigured=!1,this.columnGroupNameHeader=this.headerLayer.append("div").classed("relationship_group_name_header",!0),this.columnEntityNameHeader=this.headerLayer.append("div").classed("relationship_entity_name_header",!0),this.verticalAnimateToggledLaneIds=[],this.hilitor=new Hilitor2("relationship_event_layer"),this.hilitor.setMatchType("open"),this.highlightString=null,this.defaultTransitionDuration=300,this.transitionDuration=this.defaultTransitionDuration;var e=0;this.RENDER_LEVEL_SELECTION=e++,this.RENDER_LEVEL_POSITION=e++,this.RENDER_LEVEL_VIEWPORT=e++,this.RENDER_LEVEL_SIZE=e++,this.RENDER_LEVEL_ZOOM=e++,this.RENDER_LEVEL_DATA=e++};ATRelationshipViewPainter.prototype.drawMoveEventLine=function(){var t,e,i,n,a,o,r,s,l,h=this.relationshipView.draggingEventForLane,p=this.relationshipView.draggingEventForParent,c=this.relationshipView.draggingEventForDistanceMeasure,d=this.relationshipView.draggingEventForPosition;p?(e=this.relationshipView.eventDragTargetEventDrop,e?(this.moveEventDragTargetBox||(this.moveEventDragTargetBox=this.uiDrawingSvg.append("rect").attr("class","dragEventTargetDrop")),n=e.get("totalRect"),a=n.top()+this.relationshipView.eventDragEndLane.get("top"),i=this.relationshipView.absoluteToRelativePoint(new ATPoint(n.left(),a)),this.moveEventDragTargetBox.attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",n.size.width).attr("height",n.size.height),this.uiDrawingSvg.attr("width",n.size.width*this.scaleFactor).attr("height",n.size.height*this.scaleFactor).attr("viewBox","0 0 "+n.size.width+" "+n.size.height).style("left",i.x*this.scaleFactor).style("top",i.y*this.scaleFactor)):this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null),this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null)):h||d||c?(t=this.relationshipView.eventDragEndPos,o=this.relationshipView.absoluteToRelativePoint(t),this.moveEventDragLine||(this.moveEventDragLine=this.uiDrawingSvg.append("line").attr("class","dragEventLine")),c?(r=this.relationshipView.absoluteToRelativePoint(this.relationshipView.eventDragMeasureDistanceStartPos),s=this.relationshipView.absoluteToRelativePoint(this.relationshipView.eventDragMeasureDistanceEndPos)):h?(r=new ATPoint(0,o.y),s=new ATPoint(this.relationshipView.viewport.size.width,o.y)):this.relationshipView.eventDragDropY?(r=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,this.relationshipView.eventDragDropY)),s=this.relationshipView.absoluteToRelativePoint(new ATPoint(this.relationshipView.viewport.size.width,this.relationshipView.eventDragDropY))):(r=null,s=null),r&&s?(l=new ATRect(0,0,0,0),l.origin.x=Math.min(r.x,s.x)-2,l.origin.y=Math.min(r.y,s.y)-2,l.size.width=Math.max(Math.abs(r.x-s.x)+2,5),l.size.height=Math.max(Math.abs(r.y-s.y)+2,5),r.x-=l.origin.x,r.y-=l.origin.y,s.x-=l.origin.x,s.y-=l.origin.y,this.moveEventDragLine.attr("x1",Math.floor(r.x)+.5).attr("y1",Math.floor(r.y)+.5).attr("x2",Math.floor(s.x)+.5).attr("y2",Math.floor(s.y)+.5),this.uiDrawingSvg.attr("width",l.size.width?l.size.width*this.scaleFactor:1).attr("height",l.size.height?l.size.height*this.scaleFactor:1).attr("viewBox","0 0 "+l.size.width+" "+l.size.height).style("left",l.origin.x*this.scaleFactor).style("top",l.origin.y*this.scaleFactor)):this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null)):(this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null))},ATRelationshipViewPainter.prototype.drawMoveLaneLine=function(){var t,e;this.relationshipView.laneDragEndLane!=this.relationshipView.laneDragStartingLane?(t=this.relationshipView.laneDragEndPos.y<this.relationshipView.laneDragStartPos.y?new ATPoint(0,this.relationshipView.laneDragEndLane.get("top")+1):new ATPoint(0,this.relationshipView.laneDragEndLane.get("top")+this.relationshipView.laneDragEndLane.get("height")),e=this.relationshipView.absoluteToRelativePoint(t),this.moveLaneDragLine||(this.moveLaneDragLine=this.uiDrawingSvg.append("line").attr("class","dragLaneLine")),this.uiDrawingSvg.attr("width","100%").attr("height",5).attr("viewBox","0 0 100% 5").style("left",0).style("top",e.y*this.scaleFactor-2),this.moveLaneDragLine.attr("x1",0).attr("y1",2).attr("x2","100%").attr("y2",2)):this.moveLaneDragLine&&(this.moveLaneDragLine.remove(),this.moveLaneDragLine=null)},ATRelationshipViewPainter.prototype.setHighlightString=function(t){this.highlightString=ATUtilities.regexEscapedString(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove()},ATRelationshipViewPainter.prototype.render=function(t,e){this.relationshipView.model&&!_.isEmpty(e)&&(this.renderFlags=e,this.renderLevel=this.RENDER_LEVEL_SELECTION,this.renderFlags.position&&(this.renderLevel=this.RENDER_LEVEL_POSITION),this.renderFlags.viewport&&(this.renderLevel=this.RENDER_LEVEL_VIEWPORT),this.renderFlags.size&&(this.renderLevel=this.RENDER_LEVEL_SIZE),this.renderFlags.zoom&&(this.renderLevel=this.RENDER_LEVEL_ZOOM),this.renderFlags.data&&(this.renderLevel=this.RENDER_LEVEL_DATA),(this.renderFlags.viewport||this.renderFlags.zoom||this.draggingColumn||this.draggingColumnGroup)&&(this.transitionDuration=0),this.scaleFactor=this.relationshipView.physicalScaleFactor,this.renderFlags.data&&window.isAeonWebExport&&(this.bookmarkAdd.style("display","none"),$("#relationshipSettingsButton").css("display","none")),this.updateEventLayer(t),this.updateBgLayer(t),this.renderLevel>this.RENDER_LEVEL_SELECTION&&(this.updateOffsetLayer(t),this.updateIntersectionLayer(t),this.updateLaneLayer(t),this.updateHeaderLayer(t),this.updateNavigationLayer(t)),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove(),this.verticalAnimateToggledLaneIds=[],this.transitionDuration=this.defaultTransitionDuration)},ATRelationshipViewPainter.prototype.scrollBackgroundLayer=function(t){},ATRelationshipViewPainter.prototype.dataChangedBackgroundLayer=function(t){},ATRelationshipViewPainter.prototype.updateBgLayer=function(t){var e,i,n,a,o,r=this;n=this.bgLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id}),n.enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),this.renderLevel>this.RENDER_LEVEL_SELECTION&&(lane_div_trans=this.transitionDuration?n.transition().duration(this.transitionDuration):n,lane_div_trans.style("top",function(t){var e=r.relationshipView.absoluteToRelativePoint(new ATPoint(0,t.top));return Math.round(e.y*r.scaleFactor)+"px"})),n.exit().remove(),a=n.selectAll(".relationshipEventLineDiv").data(function(t){return t.nodes},function(t){return t.id}),a.classed("selected",function(t){return t.selected&&!t.isLaneCollapsed}),a.enter().append("div").classed("relationshipEventLineDiv",!0),a.classed("odd",function(t){return t.isOdd}),o=this.transitionDuration?a.transition().duration(this.transitionDuration):a,o.style("top",function(t){return MyRound(t.totalRect.top(),r.scaleFactor)+"px"}).style("height",function(t){return MyRound(t.totalRect.size.height,r.scaleFactor)+"px"}).style("left",0),a.exit().remove(),e=this.bgLayer.selectAll(".relationshipEntityLine").data(_.values(t.columns),function(t){return t.name}),e.enter().append("div").classed("relationshipEntityLine",!0).style("left",function(t){var e=r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing,0));return MyRound(e.x,r.scaleFactor)+"px"}),e.classed("odd",function(t){return t.isOdd}),i=this.transitionDuration?e.transition().duration(this.transitionDuration):e,i.style("left",function(t){var e=r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing,0));return MyRound(e.x,r.scaleFactor)+"px"}).style("display",function(t){return t.drawInEventArea?null:"none"}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateOffsetLayer=function(t){var e,i=this;e=this.offsetLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),e.each(function(t,e){i.renderIndividualLaneOffsetGroup(this,t)}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateIntersectionLayer=function(t){var e,i,n,a,o,r,s=this,l=this.relationshipView.timelineView.showEventDate;e=this.intersectionLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),i=this.transitionDuration?e.transition().duration(this.transitionDuration):e,i.style("top",function(t){var e=s.relationshipView.absoluteToRelativePoint(new ATPoint(0,t.top));return Math.round(e.y*s.scaleFactor)+"px"}),e.exit().remove(),n=e.selectAll(".relationshipEventIntersectionDiv").data(function(t){return t.intersections},function(t){return t.id}),n.enter().append("div").classed("relationshipEventIntersectionDiv",!0),a=this.transitionDuration?n.transition().duration(this.transitionDuration):n,a.style("top",function(t){return MyRound(t.yPixel,s.scaleFactor)+"px"}).style("left",function(t){var e=s.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2,0));return MyRound(e.x,s.scaleFactor)+"px"}).style("color",function(t){return t.color}).attr("class",function(t){return"relationshipEventIntersectionDiv fa fa-"+t.icon}).attr("title",function(t){return t.role+(t.age?": "+t.age:"")}),n.exit().remove(),o=e.selectAll(".relationshipEventIntersectionAgeDiv").data(function(t){return t.intersections},function(t){return t.id}),l?(o.enter().append("div").classed("relationshipEventIntersectionAgeDiv",!0),r=this.transitionDuration?o.transition().duration(this.transitionDuration):o,r.style("top",function(t){return MyRound(t.yPixel+16,s.scaleFactor)+"px"}).style("left",function(t){var e=s.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2,0));return MyRound(e.x,s.scaleFactor)+"px"}).text(function(t){return t.shortAge}),o.exit().remove()):o.remove()},ATRelationshipViewPainter.prototype.updateHeaderLayer=function(t){var e,i,n,a,o,r,s,l=this;e=this.columnGroupNameHeader.selectAll(".relationshipColumnGroupName").data(_.values(t.columnGroups),function(t){return t.name}),n=e.enter().append("div").classed("relationshipColumnGroupName",!0).call(this.relationshipView.columnGroupDrag),n.append("span").classed("relationshipColumnGroupNameText",!0),i=this.transitionDuration?e.transition().duration(this.transitionDuration):e,i.style("left",function(t){var e=l.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0));return MyRound(e.x,l.scaleFactor)+"px"}),i.select(".relationshipColumnGroupNameText").text(function(t){return t.name}),e.exit().remove(),a=this.columnEntityNameHeader.selectAll(".relationshipEntityName").data(_.values(t.columns),function(t){return t.name}),a.enter().append("div").classed("relationshipEntityName",!0).style("left",function(t){var e=l.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0));return MyRound(e.x,l.scaleFactor)+"px"}).call(this.relationshipView.columnDrag),r=this.transitionDuration?a.transition().duration(this.transitionDuration):a,a.html(function(t){return'<i style="color: '+t.color+'" class="fa fa-'+t.icon+'"></i> '+t.name}).attr("title",function(t){return t.name}),r.style("left",function(t){var e=l.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0));return MyRound(e.x,l.scaleFactor)+"px"}),a.classed("odd",function(t){return t.isOdd}),a.exit().remove(),o=this.columnEntityNameHeader.selectAll(".relationshipEntityNameLine").data(_.values(t.columns),function(t){return t.name}),o.enter().append("div").classed("relationshipEntityNameLine",!0).style("left",function(t){var e=l.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0));return MyRound(e.x,l.scaleFactor)+"px"}),s=this.transitionDuration?o.transition().duration(this.transitionDuration):o,s.style("left",function(t){var e=l.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0));return MyRound(e.x,l.scaleFactor)+"px"}),o.exit().remove()},ATRelationshipViewPainter.prototype.updateLaneLayer=function(t){var e,i=this;e=this.laneLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").each(function(t,e){i.createIndividualLaneHeaderDiv(this,t,e)}),e.each(function(t,e){i.renderIndividualLaneHeaderDiv(this,t,e)}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateEventLayer=function(t){var e,i,n,a,o,r=this;e=this.eventLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),e.each(function(t,e){r.renderIndividualLaneEventGroup(this,t)}),e.exit().remove(),i=e.selectAll(".relationshipEventLeftLineDiv").data(function(t){return t.nodes},function(t){return t.id}),i.enter().append("div").classed("relationshipEventLeftLineDiv",!0),n=this.transitionDuration?i.transition().duration(this.transitionDuration):i,n.style("top",function(t){return MyRound(t.lineY,r.scaleFactor)+"px"}).style("left",function(t){return MyRound(t.lineX,r.scaleFactor)+"px"}).style("width",function(t){return MyRound(t.lineWidth,r.scaleFactor)+"px"}),i.exit().remove(),a=e.selectAll(".relationshipEventUpLineDiv").data(function(t){return t.nodes},function(t){return t.id}),a.enter().append("div").classed("relationshipEventUpLineDiv",!0),o=this.transitionDuration?a.transition().duration(this.transitionDuration):a,o.style("top",function(t){return MyRound(t.prevLineY?t.prevLineY:t.lineY,r.scaleFactor)+"px"}).style("height",function(t){return MyRound(t.lineY-(t.prevLineY?t.prevLineY:0),r.scaleFactor)+"px"}).style("visibility",function(t){return t.prevLineY?null:"hidden"}).style("left",function(t){return MyRound(t.verticalLineX,r.scaleFactor)+"px"}).style("width",function(t){return"1px"}),a.exit().remove()},ATRelationshipViewPainter.prototype.updateNavigationLayer=function(t){var e,i=this,n=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_VIEWPORT?this.dataChangedLaneNav(n):this.renderLaneNav(n),this.verticalScrollKnob||(this.verticalScrollTrack=this.laneNavSvg.append("rect").attr("class","scrollTrack").attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("rx",0).attr("ry",0).on("click",function(t){return i.relationshipView.clickInVerticalScrollTrack()}),this.verticalScrollKnob=this.laneNavSvg.append("rect").attr("class","scrollknob verticalScroller").attr("width",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2).call(this.relationshipView.verticalScrollDrag),this.$verticalScrollKnob=$(".relationshipContentDiv .verticalScroller"),this.horizontalScrollTrack=this.xScrollSvg.append("rect").attr("class","scrollTrack").attr("height",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).attr("rx",0).attr("ry",0).on("click",function(t){return i.relationshipView.clickInHorizontalScrollTrack()}),this.horizontalScrollKnob=this.xScrollSvg.append("rect").attr("class","scrollknob horizontalScroller").attr("height",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2).call(this.relationshipView.horizontalScrollDrag),this.$horizontalScrollKnob=$(".relationshipContentDiv .horizontalScroller")),e=this.bookmarkGroup.selectAll(".bookmarkItem").data(t.bookmarks),e.select("span.bookmarkName").text(function(t){return t.name}),e.select("span.bookmarkItemRemove").classed("fa",!0),this.renderNewBookmarks(e.enter().append("div")),e.exit().remove(),this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack),this.renderHorizontalScrollBar(this.horizontalScrollKnob,this.horizontalScrollTrack)},ATRelationshipViewPainter.prototype.renderNewBookmarks=function(t){return t.attr("class","bookmarkItem").on("click",function(t){window.mainApp.timelineView.bookmarkClick(t)}).append("span").classed("bookmarkName",!0).text(function(t){return t.name}),t.append("span").classed("bookmarkItemRemove fa fa-times-circle",!0).on("click",function(t){return window.ApplicationInterface?(window.ApplicationInterface.removeBookmark(window.timelineDocumentId,t.id),d3.event.stopPropagation(),!1):void 0}),t},ATRelationshipViewPainter.prototype.renderIndividualLaneOffsetGroup=function(t,e){var i,n,a,o=this,r=d3.select(t),s=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)),l=r.selectAll(".relationshipEventOffsetLabel").data(e.nodes,function(t){return t.id}),h=r.select(".relationshipLaneOffsetLineDiv"),p=e.nodes.length>0?e.nodes[0].totalRect.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop:0,c=e.nodes.length>0?e.nodes[e.nodes.length-1].totalRect.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop:0;i=this.transitionDuration?r.transition().duration(this.transitionDuration):r,i.style("top",Math.round(s.y*this.scaleFactor)+"px"),l.enter().append("div").classed("relationshipEventOffsetLabel",!0),n=this.transitionDuration?l.transition().duration(this.transitionDuration):l,n.style("top",function(t){return MyRound(t.offsetTextY,o.scaleFactor)+"px"}).style("left",function(t){return MyRound(t.offsetTextX,o.scaleFactor)+"px"}).text(function(t){return t.offsetText}),n.select(".relationshipEventOffsetLabel").style("left",MyRound(TimelineDisplayConstants.relationshipViewDateOffsetLeft,this.scaleFactor)+"px"),l.exit().remove(),a=this.transitionDuration?h.transition().duration(this.transitionDuration):h,a.style("top",MyRound(p,this.scaleFactor)+"px").style("height",MyRound(c-p,this.scaleFactor)+"px")},ATRelationshipViewPainter.prototype.renderIndividualLaneEventGroup=function(t,e){var i,n=this,a=d3.select(t),o=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)),r=a.selectAll(".eventDivWrapper").data(e.nodes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_SELECTION&&(i=this.transitionDuration?a.transition().duration(this.transitionDuration):a,a.classed("collapsed",e.collapsed),i.style("top",Math.round(o.y*this.scaleFactor)+"px"),r.each(function(t){n.updateIndividualEvent(this,t)}),r.enter().append("div").each(function(t){var e=d3.select(this),i=n.transitionDuration?e.transition().duration(n.transitionDuration):e;n.createIndividualEvent(this,e,t),n.updateIndividualEventPosition(this,i,t)})),this.renderLevel>this.RENDER_LEVEL_SELECTION&&r.exit().remove()},ATRelationshipViewPainter.prototype.createIndividualEvent=function(t,e,i){var n=this.verticalAnimateToggledLaneIds.length;e.classed("eventDivWrapper",!0).style("top",MyRound(i.totalRect.origin.y,this.scaleFactor)+"px").style("left",MyRound(i.totalRect.origin.x,this.scaleFactor)+"px").style("width",MyRound(i.totalRect.size.width,this.scaleFactor)+"px").style("height",MyRound(i.totalRect.size.height,this.scaleFactor)+"px").style("opacity",n?1:0).call(this.relationshipView.eventDrag),this.updateIndividualEventContent(t,e,i),this.updateIndividualEventSize(t,e,e,i)},ATRelationshipViewPainter.prototype.updateIndividualEvent=function(t,e){var i=d3.select(t),n=this.transitionDuration?i.transition().duration(this.transitionDuration):i;this.renderLevel>=this.RENDER_LEVEL_DATA&&this.updateIndividualEventContent(t,i,e),this.renderLevel>=this.RENDER_LEVEL_SIZE&&this.updateIndividualEventSize(t,i,n,e),this.renderLevel>=this.RENDER_LEVEL_POSITION&&this.updateIndividualEventPosition(t,n,e)},ATRelationshipViewPainter.prototype.updateIndividualEventContent=function(t,e,i){var n,a=this.relationshipView.timelineView.showEventDate;e.attr("pointer-events",i.visible?null:"none").classed("isFaded",i.isFaded).classed("expanded",i.showMore).classed("parent",i.showChildNodes),i.isLaneCollapsed?(e.select(".eventContentWrapper").remove(),e.select(".showMoreSpan").remove(),e.select(".relationshipEventDot").remove(),e.select(".relationshipEventParentToggle").remove()):(n=e.select(".eventContentWrapper"),n.empty()&&this.createIndividualEventContents(e,i),e.select(".eventTitle").text(i.displayTitle),e.select(".eventDate").text(i.dateString).style("display",a?null:"none"),e.select(".relationshipEventDot").style("background-color",i.isFaded?null:i.color),e.select(".relationshipEventParentToggle").style("visibility",function(t){return t.isParent?null:"hidden"}).style("display",window.mainApp.relationshipView.model.relationshipViewFlattenTree?"none":null).classed("fa-caret-right",function(t){return!t.showChildNodes}).classed("fa-caret-down",function(t){return!!t.showChildNodes}),d3ExpandedContent=e.select(".expandedWrapper").html(i.showMore?i.contentHTML:""),i.showMore&&this.listenToEventLinkClicks(d3ExpandedContent,i),e.select(".showMoreSpan").classed("fa-chevron-down",!i.showMore).classed("fa-chevron-up",i.showMore)),e.select(".markerRect").style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color)},ATRelationshipViewPainter.prototype.updateIndividualEventSize=function(t,e,i,n){i.style("width",MyCeil(n.totalRect.size.width,this.scaleFactor)+"px").style("height",MyCeil(n.totalRect.size.height,this.scaleFactor)+"px"),i.select(".eventContentWrapper").style("width",MyCeil(n.textRect.size.width,this.scaleFactor)+"px").style("height",MyCeil(n.textRect.size.height,this.scaleFactor)+"px"),e.select(".expandedWrapper").style("width",n.showMore?MyRound(n.textRect.size.width,this.scaleFactor)+"px":"0px"),i.select(".expandedWrapper").style("height",n.showMore?MyRound(n.textRect.size.height,this.scaleFactor)+"px":"0px")},ATRelationshipViewPainter.prototype.updateIndividualEventPosition=function(t,e,i){e.style("top",MyRound(i.totalRect.origin.y,this.scaleFactor)+"px").style("left",MyRound(i.totalRect.origin.x,this.scaleFactor)+"px").style("opacity",i.visible?1:0)},ATRelationshipViewPainter.prototype.createIndividualEventContents=function(t,e){var i=(t.append("span").classed("showMoreSpan fa",!0).on("click",function(t){window.mainApp.timelineView.toggleMoreEventInfo(t)}),t.append("span").classed("relationshipEventParentToggle fa",!0).on("click",function(t){window.mainApp.timelineView.toggleShowChildNodes(t.id,t.laneId)}),t.append("span").classed("relationshipEventDot",!0),t.append("div").classed("eventContentWrapper",!0));i.append("div").classed("eventTitle draggable",!0),i.append("div").classed("eventDate draggable",!0),i.append("div").classed("expandedWrapper draggable",!0),i.on("click",this.relationshipView.eventNodeClick.bind(this.relationshipView))},ATRelationshipViewPainter.prototype.listenToEventLinkClicks=function(t,e){t.selectAll(".externalLinkAnchor").on("click",function(t,i){if(window.isAeonWebExport)return!0;var n=d3.select(this),a=(n.attr("href"),[]);return _.each(e.links,function(t){a.push({filepath:t.path})}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(a),i),d3.event.stopPropagation(),d3.event.preventDefault(),!1}),t.select(".eventImage").on("dblclick",function(t,i){if(window.isAeonWebExport)return!0;var n=t.imagePath,a=[],o=0;return _.each(e.links,function(t){a.push({filepath:t.path})}),o=_.findIndex(a,function(t){return t.filepath==n}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(a),o),d3.event.stopPropagation(),d3.event.preventDefault(),!1})},ATRelationshipViewPainter.prototype.createIndividualLaneHeaderDiv=function(t,e){var i=d3.select(t).classed("laneHeaderDiv",!0).style("transform","translateY(0px)").call(this.relationshipView.laneDrag);i.append("span").classed("laneDivArrow fa",!0).on("click",function(t){window.mainApp.timelineView.toggleLane(t.id)}),i.append("span").classed("laneDivLabel",!0)},ATRelationshipViewPainter.prototype.renderIndividualLaneHeaderDiv=function(t,e){var i,n=d3.select(t),a=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)).y;a<TimelineDisplayConstants.relationshipViewEntityHeaderHeight&&(a+=Math.min(-a+TimelineDisplayConstants.relationshipViewEntityHeaderHeight,e.height-TimelineDisplayConstants.lifetimeHeight)),n.classed("collapsed",e.collapsed).classed("odd",e.odd),n.select(".laneDivArrow").classed("fa-chevron-up",!e.collapsed).classed("fa-chevron-down",e.collapsed),n.select(".laneDivLabel").text(e.entityName),this.transitionDuration?i=n.transition().duration(this.transitionDuration).style("top",a*this.scaleFactor+"px"):n.style("top",a*this.scaleFactor+"px")},ATRelationshipViewPainter.prototype.dataChangedLaneNav=function(t){this.renderLaneNav(t.transition().duration(this.transitionDuration)),this.renderLaneNav(t.enter().append("rect").attr("width",TimelineDisplayConstants.laneNavNodeWidth).attr("rx",TimelineDisplayConstants.laneNavNodeWidth/2).attr("ry",TimelineDisplayConstants.laneNavNodeWidth/2).attr("x",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).on("click",function(t){window.mainApp.relationshipView.scrollToLane(t)})),t.exit().transition().duration(this.transitionDuration).remove()},ATRelationshipViewPainter.prototype.renderLaneNav=function(t){var e=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,i=this.relationshipView.viewport.top()+e,n=this.relationshipView.viewport.size.height-e-TimelineDisplayConstants.relationshipNavFooterHeight,a=this.relationshipView.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight;return t.attr("class",function(t){return i>=t.top&&i<t.top+t.height?"laneNav current":"laneNav"}).attr("y",function(t){return t.top/a*n+e+1}).attr("height",function(t){return Math.max(0,t.height/a*n-2)}),t.each(function(t,e){var i=$(this),o=Math.max(0,t.height/a*n-2),r=i.data("opentips");r&&r[0]?window.mainApp.isMac||(r[0].options.offset=[0,o/2]):new Opentip(this,t.entityName,{style:"laneNodeTooltipStyle",offset:window.mainApp.isMac?[0,0]:[0,o/2]})}),t},ATRelationshipViewPainter.prototype.renderVerticalScrollBar=function(t,e){var i=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,n=this.relationshipView.viewport.top()+i,a=this.relationshipView.viewport.size.height-i-TimelineDisplayConstants.relationshipNavFooterHeight,o=this.relationshipView.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight,r=o>0?ATUtilities.floatToInt(n/o*a+i):0,s=o>0?ATUtilities.floatToInt(a/o*a):o,l=Math.max(.5,TimelineDisplayConstants.scrollKnobXPosition-2.5),h=(l+TimelineDisplayConstants.scrollTrackThickness,a>s);return e.attr("x",l).attr("y",i).attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("height",a).style("fill-opacity",h?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",h?null:0),s==a||r===this.verticalScrollKnobTop&&s==this.verticalScrollKnobHeight&&this.relationshipView.viewport.size.width==this.verticalScrollKnobRight||t.attr("x",TimelineDisplayConstants.scrollKnobXPosition).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobOpacity:0).attr("y",r).attr("height",s).transition().delay(1e3).duration(500).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.verticalScrollTrackHeight=a,this.verticalScrollKnobTop=r,this.verticalScrollKnobHeight=s,this.verticalScrollKnobRight=this.relationshipView.viewport.size.width,t},ATRelationshipViewPainter.prototype.renderHorizontalScrollBar=function(t,e){var i=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,n=this.relationshipView.viewport.left(),a=this.relationshipView.viewport.size.width-i,o=this.relationshipView.rangeX.max-i,r=o>0?ATUtilities.floatToInt(n/o*a+i):0,s=o>0?ATUtilities.floatToInt(a/o*a):o,l=Math.max(.5,TimelineDisplayConstants.scrollKnobDefaultXPosition-2.5),h=(l+TimelineDisplayConstants.scrollTrackNoLaneNavThickness,a>s);return e.attr("y",l).attr("x",0).attr("height",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).attr("width","100%").style("fill-opacity",h?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",h?null:0),s==a||r===this.horizontalScrollKnobLeft&&s==this.horizontalScrollKnobWidth&&this.relationshipView.viewport.size.height==this.horizontalScrollKnobBottom||t.attr("y",TimelineDisplayConstants.scrollKnobDefaultXPosition).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobOpacity:0).attr("x",r).attr("width",s).transition().delay(1e3).duration(500).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.horizontalScrollTrackWidth=a,this.horizontalScrollKnobLeft=r,this.horizontalScrollKnobWidth=s,this.horizontalScrollKnobBottom=this.relationshipView.viewport.size.height,t},module.exports=ATRelationshipViewPainter;
},{"../lib/hilitor2":7,"../lib/opentip":11,"./ATDisplayConstants":26,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATSize":79,"./ATUtilities":91,"d3":300,"jquery":307,"lodash":309}],76:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/searchDropdownTemplate.html"),ATSearchDropdown=Backbone.View.extend({initialize:function(){var t=this.$el.attr("id"),i=t+"-searchInput",e=t+"-label",s=t+"-caret",n=t+"-dropdown",h=t+"-list",o=_.template(templateHtml),l=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),ATSearchDropDownGlobalTimeout=null,this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.searchFunction=this.matchAnywhereSearch,this.d3El=d3.select("#"+t),this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(o({})),this.d3El.on("click",function(){l.open||l.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",e).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",s).on("click",this.toggle.bind(this)),this.$el.keydown(function(t){return l.divKeyDownHandler(t)}).on("focus",function(){l.focusHandler()}).on("blur",function(){l.blurHandler()}),this.$searchDiv=$(this.d3El.select(".bselect-search").node()),this.d3SearchInput=this.d3El.select(".bselect-search-input").attr("id",i).on("input",function(){l.inputHandler()}).on("blur",function(){l.blurHandler()}),this.$searchInput=$("#"+i),this.$searchInput.keydown(function(t){return l.searchKeyDownHandler(t)}),this.$searchInput.on("focus",this.searchFocus.bind(this)),this.d3El.select(".bselect-search-icon").on("click",function(){l.$searchInput.focus()}),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",n),this.$dropdown=$("#"+n),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",h),this.$list=$("#"+h),this.$list.on("scroll",this.listScrollHandler.bind(this)),this.updateTitle()},setSearchWordByWord:function(){this.searchFunction=this.wordByWordSearch},setOptions:function(t){this.rawOptions=t,this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(i){return i.value==t},this),this.updateTitle(),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.value:null},toggle:function(){this.disabled||this.open?this.hide():this.show(),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id"),i=t+"-list";this.selectedOption?i+"-"+this.selectedOption.value:null;if(!this.disabled){this.d3El.classed("open",!0),this.$dropdown.slideDown(250);var e=this.$searchInput.parent().width()-this.$searchInput.next().outerWidth();this.$searchInput.innerWidth(e),this.renderOptions(),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.scrollItemIntoView(),this.$searchInput.focus(),this.open=!0}},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.clearSearch(),this.open=!1},clearSearch:function(){this.$searchInput.val(""),this.visibleOptions=this.rawOptions.slice()},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id"),s=e+"-list";i.attr("id",function(t){return s+"-"+t.value}).classed("active",function(i){return t.selectedOption?i.value==t.selectedOption.value:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).select("span").text(function(t){return t.label}),i.enter().append("li").attr("id",function(t){return s+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return t.selectedOption?i.value==t.selectedOption.value:!1}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}).append("span").text(function(t){return t.label}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=t+"-list",e=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,s=e?i+"-"+e.value:null,n=null;if(s){n=$("#"+s);var h=this.$list.scrollTop(),o=this.$list.height(),l=n.position()?n.position().top:0,c=n.height(),a=this.$searchDiv.position().top+this.$searchDiv.height()+5;(a>l||l+c>o+a)&&this.$list.scrollTop(h-a+l-o/2+c/2)}},updateTitle:function(){this.selectedOption&&this.selectedOption.value>=0?this.d3Label.text(this.selectedOption.label):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(i){return i.value==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;switch(i){case 13:this.open||(this.$el.closest("form").submit(),e=!0);break;case 38:case 40:this.open||(this.show(),e=!0)}return this.renderOptions(),!e},searchKeyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;switch(i){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0}return this.renderOptions(),!e},inputHandler:function(){var t=this.$searchInput.val(),i=t.toLocaleLowerCase();if(this.$searchInput.data("lastval")!=this.$searchInput.val()){var t=this.$searchInput.val();this.visibleOptions=this.searchFunction(i,this.rawOptions),this.highlightIndex=0,this.renderOptions(),0==this.visibleOptions.length&&(this.highlightIndex=-1)}},wordByWordSearch:function(t,i){var e=[],s=t.split(" ");return 0==t.length?i.slice():(_.each(i,function(t){var i=t.label.toLocaleLowerCase().split(" "),n=0;_.each(s,function(t){t.length&&_.each(i,function(i){0==i.indexOf(t)&&n++})}),n>0&&(t.matchCount=n,e.push(t))}),e.sort(function(t,i){return i.matchCount-t.matchCount}),e)},matchAnywhereSearch:function(t,i){var e=[];return 0==t.length?i:(_.each(i,function(t){t.label.toLocaleLowerCase().indexOf(lowerStr)>-1&&e.push(t)}),e)},focusHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout&&clearTimeout(ATSearchDropDownGlobalTimeout),ATSearchDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},100)},searchFocus:function(){this.focusHasResumed=!0},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout=null}});module.exports=ATSearchDropdown;
},{"./templates/searchDropdownTemplate.html":164,"backbone":176,"d3":300,"jquery":307,"lodash":309}],77:[function(require,module,exports){
arguments[4][76][0].apply(exports,arguments)
},{"./templates/searchDropdownTemplate.html":164,"backbone":176,"d3":300,"dup":76,"jquery":307,"lodash":309}],78:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/searchableContextMenuTemplate.html");const CREATE_NEW_FLAG="__create_new__";var ATSearchableContextMenu=Backbone.View.extend({setSearchCallback:function(t){this.searchCallback=fn},setAllowNewItems:function(t){this.allowNewItems=t},setOptions:function(t){this.rawOptions=t.slice(),this.allowNewItems&&(this.createNewLabel={value:CREATE_NEW_FLAG,label:"Create New"},this.rawOptions.push(this.createNewLabel)),this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(e){return e.value==t},this),this.renderOptions()},getValue:function(){return this.selectedOption?this.wasNewItemSelected()?null:this.selectedOption.value:null},wasNewItemSelected:function(){return this.selectedOption?this.selectedOption.value==CREATE_NEW_FLAG:!1},getNewItemText:function(){return this.wasNewItemSelected()?this.createNewText:null},initialize:function(){var t=this.$el.attr("id"),e=t+"-searchInput",i=t+"-list",s=_.template(templateHtml),h=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),this.allowNewItems=!0,this.createNewText="",this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.searchCallback=null,this.$el.html(s({elementName:t})),this.d3El=d3.select("#"+t),this.d3El.classed("searchContextMenu bselect-dropdown",!0).style("display","none"),this.$el.keydown(function(t){return h.divKeyDownHandler(t)}).on("focus",function(){h.focusHandler()}).on("blur",function(){h.blurHandler()}),this.$searchDiv=$(this.d3El.select(".bselect-search").node()),this.d3SearchInput=this.d3El.select("#"+e).on("input",function(){h.inputHandler()}).on("blur",function(){h.blurHandler()}),this.$searchInput=$("#"+e),this.$searchInput.keydown(function(t){return h.searchKeyDownHandler(t)}),this.$searchInput.on("focus",this.searchFocus.bind(this)),this.d3El.select(".bselect-search-icon").on("click",function(){h.$searchInput.focus()}),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",i),this.$list=$("#"+i),this.$list.on("scroll",this.listScrollHandler.bind(this))},show:function(t,e,i){this.highlightIndex=-1,this.renderOptions();var s=this.$el.attr("id"),h=s+"-list",n=(this.selectedOption?h+"-"+this.selectedOption.value:null,t.offset()),l={width:t.outerWidth(),height:t.outerHeight()},o={width:$(window).width(),height:$(window).height()},a={width:this.$el.width(),height:this.$el.height()},c=isNaN(e)||isNaN(i)?{left:Math.min(n.left,o.width-a.width-5),top:n.top+l.height}:{left:Math.min(n.left+e,o.width-a.width-5),top:n.top+i};c.top+a.height>o.height-10?(this.d3El.style("left",c.left+"px"),this.d3El.style("bottom",o.height-n.top+4+"px"),this.d3El.style("top",null)):(this.d3El.style("left",c.left+"px"),this.d3El.style("top",c.top+"px"),this.d3El.style("bottom",null)),this.d3El.classed("open",!0),this.$el.slideDown(250);var r=this.$searchInput.parent().width()-this.$searchInput.next().outerWidth();this.$searchInput.innerWidth(r),this.$searchInput.attr("placeholder","Search"+(this.allowNewItems?" or create new":"")+"..."),this.$searchInput.focus(),this.open=!0},hide:function(){this.$el.slideUp(250),this.d3El.classed("open",!1),this.clearSearch(),this.open=!1},clearSearch:function(){this.$searchInput.val(""),this.visibleOptions=this.rawOptions.slice()},renderOptions:function(){var t=this,e=this.d3OptionList.selectAll("li").data(this.visibleOptions),i=this.$el.attr("id"),s=i+"-list";e.attr("id",function(t){return s+"-"+t.value}).classed("active",function(e){return t.selectedOption?e.value==t.selectedOption.value:!1}).classed("highlight",function(e,i){return i==t.highlightIndex}).select("span").text(function(t){return t.label}),e.enter().append("li").attr("id",function(t){return s+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(e){return t.selectedOption?e.value==t.selectedOption.value:!1}).classed("highlight",function(e,i){return i==t.highlightIndex}).on("click",function(e){return d3.event.stopPropagation(),t.optionClick(e.value)}).append("span").text(function(t){return t.label}).on("click",function(e){return d3.event.stopPropagation(),t.optionClick(e.value)}),e.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id"),e=t+"-list",i=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,s=i?e+"-"+i.value:null,h=null;if(s){h=$("#"+s);var n=this.$list.scrollTop(),l=this.$list.height(),o=h.position()?h.position().top:0,a=h.height(),c=this.$searchDiv.position().top+this.$searchDiv.height()+5;(c>o||o+a>l+c)&&this.$list.scrollTop(n-c+o-l/2+a/2)}},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(e){return e.value==t},this),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var e=t.keyCode||t.which,i=!1;switch(e){case 13:this.open||(this.show(),i=!0)}return this.renderOptions(),!i},searchKeyDownHandler:function(t){var e=t.keyCode||t.which,i=!1;switch(e){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0}return this.renderOptions(),!i},inputHandler:function(){var t=this.$searchInput.val(),e=t.toLocaleLowerCase();if(this.$searchInput.data("lastval")!=this.$searchInput.val()){var t=this.$searchInput.val();this.searchCallback?this.visibleOptions=this.searchCallback(t):0==t.length?(this.visibleOptions.length=0,_.each(this.rawOptions,function(t){t.value!=CREATE_NEW_FLAG&&this.visibleOptions.push(t)},this)):(this.visibleOptions.length=0,_.each(this.rawOptions,function(i){i.label.toLocaleLowerCase().indexOf(e)>-1&&this.visibleOptions.push(i),this.allowNewItems&&i.value==CREATE_NEW_FLAG&&(i.label='Create New: "'+t+'"',this.visibleOptions.push(i))},this)),this.createNewText=t,this.highlightIndex=0,this.renderOptions(),0==this.visibleOptions.length&&(this.highlightIndex=-1)}},focusHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout&&clearTimeout(ATSearchDropDownGlobalTimeout),ATSearchDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},200)},searchFocus:function(){this.focusHasResumed=!0},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout=null}});module.exports=ATSearchableContextMenu;
},{"./templates/searchableContextMenuTemplate.html":165,"backbone":176,"d3":300,"jquery":307,"lodash":309}],79:[function(require,module,exports){
var ATSize=function(t,i){this.width=t,this.height=i};ATSize.prototype.copy=function(){return new ATSize(this.width,this.height)},ATSize.prototype.scale=function(t){this.width*=t,this.height*=t},ATSize.prototype.debugAsString=function(){return"[ATSize w: "+this.width+", h: "+this.height+"]"},module.exports=ATSize;
},{}],80:[function(require,module,exports){
var ATStringSelection=function(t,e){this.text=t,this.selectionRange=e};module.exports=ATStringSelection;
},{}],81:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),jstree=require("jstree"),ATPoint=require("./ATPoint"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATSearchDropdown=require("./ATSearchDropdown"),ATViewMode=require("./ATViewMode"),ATUtilities=require("./ATUtilities"),templateHtml=require("./templates/syncBinderTemplate.html"),linkEventHtml=require("./templates/syncLinkWithEventTemplate.html"),dhtmlXMenuObject=require("../lib/dhtmlxmenu"),ATSyncBinderView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,n=_.template(templateHtml);this.minWidth=230,this.maxWidth=400,this.currentWidthWhenOpen=350,this.draggedEventsToCreate={},this.linkEventTemplate=_.template(linkEventHtml),this.d3El=d3.select("#"+e),this.d3El.html(n({})),this.d3ErrorDiv=d3.select("#syncBinderErrorDiv"),this.$errorMessageDiv=$("#syncBinderErrorMessage"),this.resizeDrag=d3.behavior.drag().on("dragstart",this.resizeDragStarted.bind(this)).on("drag",this.resizeDragged.bind(this)).on("dragend",this.resizeDragEnded.bind(this)),d3.select("#syncBinderResizeGrabber").call(this.resizeDrag),this.syncData={},this.jsonTreeData=[],this.settingsButtonsEnabled=!1,this.showUnchangedItems=!0,this.showIgnoredItems=!1,$("#syncBinderCloseButton").on("click",this.closeClicked.bind(this)),$("#syncBinderSyncButton").on("click",this.updateAllClicked.bind(this)),$("#syncBinderSettingsButton").on("click",this.syncSettingsClicked.bind(this)),$("#syncBinderTitle").on("click",function(){return t.syncData&&t.syncData.projectPath&&window.ApplicationInterface&&window.ApplicationInterface.revealExternalLink(window.timelineDocumentId,t.syncData.projectPath),!1}),$("#syncBinderTryAgainButton").on("click",this.tryAgainClicked.bind(this)),$("#syncBinderUnchangedCheckbox").on("click",this.unchangedCheckboxClicked.bind(this)),$("#syncBinderIgnoredCheckbox").on("click",this.ignoredCheckboxClicked.bind(this)),this.d3TreeContainer=d3.select("#syncBinderTreeContainer"),this.$treeContainer=$("#syncBinderTreeContainer"),this.$treeContainer.jstree({core:{check_callback:t.treeCallback.bind(t),data:function(e,n){return n.call(this,t.jsonTreeData)}},plugins:["questionmark","wholerow","dnd","types"],dnd:{large_drag_target:!0,large_drop_target:!0,is_draggable:function(e,t){for(var n=0,i=e.length;i>n;n++)if("draft"==e[n].type||"research"==e[n].type||"trash"==e[n].type)return t&&t.preventDefault(),!1;return!0}},types:{"default":{icon:"fa fa-file-text-o"},document:{icon:"fa fa-file-text-o"},folder:{icon:"fa fa-folder"},draft:{icon:"fa fa-book"},research:{icon:"fa fa-newspaper-o"},trash:{icon:"fa fa-trash-o"},image:{icon:"fa fa-file-image-o"},pdf:{icon:"fa fa-file-pdf-o"},media:{icon:"fa fa-movie"},web:{icon:"fa fa-file-archive-o"}}}),this.jsTreeInstance=this.$treeContainer.jstree(!0),$(document).on("dnd_move.vakata",t.binderDragAndDropMove.bind(t)).on("dnd_stop.vakata",t.binderDragAndDropRelease.bind(t)),this.openNodeIds=[],this.currentScrollTop=0,this.$treeContainer.on("move_node.jstree",t.binderMoveNode.bind(t)),this.$treeContainer.on("rename_node.jstree",t.binderRenameNode.bind(t)),this.$treeContainer.on("open_node.jstree",function(e,n){-1==_.indexOf(t.openNodeIds,n.node.id)&&t.openNodeIds.push(n.node.id)}),this.$treeContainer.on("close_node.jstree",function(e,n){t.openNodeIds=_.without(t.openNodeIds,n.node.id)}),this.$treeContainer.on("refresh.jstree",t.binderRefreshFinished.bind(t)),this.$treeContainer.on("contextmenu",".jstree-anchor",this.showContextMenu.bind(this)),this.eventSearchContextMenu=new ATSearchableContextMenu({el:"#syncBinderLinkEventSearch"}),this.eventSearchContextMenu.setAllowNewItems(!1),this.listenTo(this.eventSearchContextMenu,"change",this.contextEventLinkClick.bind(this))},resize:function(){},resizeDragStarted:function(e){},resizeDragged:function(e){var t,n=d3.event.sourceEvent.clientX;this.resizeDragStartX||(this.resizeDragStartX=n,this.resizeDragOriginalWidth=this.$el.innerWidth()),t=this.resizeDragOriginalWidth+(n-this.resizeDragStartX),t<this.minWidth?t=this.minWidth:t>this.maxWidth&&(t=this.maxWidth),this.currentWidthWhenOpen=t,window.mainApp.resizeSyncBinder(t),window.ApplicationInterface&&window.ApplicationInterface.setSyncBinderWidth(window.timelineDocumentId,t)},resizeDragEnded:function(e){this.resizeDragStartX=null,this.originalWidth=null},setSyncData:function(e){this.syncDataStr=e,this.currentScrollTop=this.$treeContainer.scrollTop();var t=ATUtilities.countOccurrencesOfSubstring(this.syncDataStr,'"status":"syncStatusConflict"');d3.select("#syncBinderSyncButton").attr("disabled",t?"disabled":null).attr("title",t?""+t+" conflict"+(1==t?"":"s")+" must be resolved":"Update All"),this.pruneTree(),this.d3ErrorDiv.style("display","none"),this.d3TreeContainer.style("display",null),this.settingsButtonsEnabled=!0,d3.select("#syncBinderSettingsButton").attr("disabled",null)},pruneTree:function(e){var t=this;this.waitingForRefresh=!0,this.syncData=JSON.parse(this.syncDataStr),d3.select("#syncBinderTitle").text("Project: "+this.syncData.projectName),this.jsonTreeData=this.syncData.binderTree,this.jsonTreeData=_.filter(this.jsonTreeData,function(e){return t.pruneItemNode(e)}),this.insideTreeRefresh=!0,this.jsTreeInstance.refresh(!0),this.insideTreeRefresh=!1,this.restoreStateAfterRefresh=!0},pruneItemNode:function(e){var t=this,n=!0;return e.children=_.filter(e.children,function(e){return t.pruneItemNode(e)}),"syncStatusIgnored"!=e.data.status||this.showIgnoredItems?"syncStatusUnchanged"!=e.data.status||this.showUnchangedItems||(n=!1):n=!1,e.children.length>0||n},binderRefreshFinished:function(){var e=this;this.waitingForRefresh=!1,this.restoreStateAfterRefresh&&_.each(this.openNodeIds,function(t){e.jsTreeInstance.open_node(t,null,!1)}),this.$treeContainer.scrollTop(this.currentScrollTop),this.editItemAfterRefresh&&this.editItemInBinder(this.editItemAfterRefresh),this.editItemAfterRefresh=!1},setErrorMessage:function(e){e&&(this.$errorMessageDiv.html(e),this.d3ErrorDiv.style("display",null),this.d3TreeContainer.style("display","none"),this.settingsButtonsEnabled=!1,d3.select("#syncBinderSyncButton").attr("disabled","disabled"),d3.select("#syncBinderSettingsButton").attr("disabled","disabled"),this.jsonTreeData=[],this.jsTreeInstance.refresh(!0))},expandItemInBinder:function(e){var t,n=e.split(","),i=n.length;for(t=0;i>t;t++)this.jsTreeInstance.open_all(n[t])},collapseItemInBinder:function(e){var t,n=e.split(","),i=n.length;for(t=0;i>t;t++)this.jsTreeInstance.close_all(n[t])},editItemInBinder:function(e){return this.waitingForRefresh?void(this.editItemAfterRefresh=e):(this.jsTreeInstance._data.core.li_height=24,void this.jsTreeInstance.edit(e))},binderRenameNode:function(e,t){window.ApplicationInterface&&window.ApplicationInterface.renameSyncItem(window.timelineDocumentId,t.node.id,t.text)},treeCallback:function(e,t,n,i,s){return"move_node"==e&&t.eventId&&_.contains(this.syncData.linkedEvents,t.eventId)?!1:"copy_node"==e?(t.eventId&&(_.contains(this.syncData.linkedEvents,t.eventId)||(_.isEmpty(this.draggedEventsToCreate)&&(this.draggedEventsToCreate.parent=n.id,this.draggedEventsToCreate.position=i,this.draggedEventsToCreate.eventIds=[]),this.draggedEventsToCreate.eventIds.push(t.eventId))),!1):!0},binderMoveNode:function(e,t){window.ApplicationInterface&&window.ApplicationInterface.moveSyncItemToParent(window.timelineDocumentId,t.node.id,t.parent,t.position)},binderDragAndDropMove:function(e,t){var n=this,i=!0;if(t.data.jstree&&t.data.origin){var s=$(t.event.target);nodeIds=t.data?t.data.nodes:[],_.each(nodeIds,function(e){var t=n.jsTreeInstance.get_node(e);t?"syncStatusNew"!=t.data.status&&"syncStatusIgnore"!=t.data.status?i=!1:"draft"!=t.type&&"research"!=t.type&&"trash"!=t.type||(i=!1):i=!1}),s.closest(".jstree").length||(s.closest(".contentDiv").length&&i&&0!=nodeIds.length?t.helper.find(".jstree-icon").removeClass("jstree-er").addClass("jstree-ok"):t.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"))}},binderDragAndDropRelease:function(e,t){var n,i=this,s=window.mainApp.timelineView,r=window.mainApp.relationshipView,o=$(t.event.target),a=(t.event.altKey,!0);return t.data.draggingEvents?(window.ApplicationInterface&&this.draggedEventsToCreate.eventIds&&this.draggedEventsToCreate.eventIds.length&&window.ApplicationInterface.createSyncItemsFromEvents(window.timelineDocumentId,this.draggedEventsToCreate.eventIds.join(),this.draggedEventsToCreate.parent,this.draggedEventsToCreate.position),void(this.draggedEventsToCreate={})):void(t.data.jstree&&t.data.origin&&(n=t.data.nodes,_.each(n,function(e){var t=i.jsTreeInstance.get_node(e);t?"syncStatusNew"!=t.data.status&&"syncStatusIgnore"!=t.data.status?a=!1:"draft"!=t.type&&"research"!=t.type&&"trash"!=t.type||(a=!1):a=!1}),a&&(o.closest(".jstree").length||o.closest(".contentDiv").length&&(s.viewMode==ATViewMode.TIMELINE_VIEW?s.dropSyncItem(n.join(),t.event.clientX,t.event.clientY):r.dropSyncItem(n.join(),t.event.clientX,t.event.clientY)))))},showContextMenu:function(e){var t=this.jsTreeInstance.get_node(e.target),n=t.id,i=this.jsTreeInstance.get_selected(),s=this.jsTreeInstance.get_selected(!0),r=t.data.status;0!=_.contains(i,n)&&0!=s.length||(s=[t],i=[n]),_.each(s,function(e){e.data.status!=r&&(r="syncStatusVariable")}),this.syncContextMenuMouseLocation=new ATPoint(e.clientX,e.clientY),this.syncContextMenuElement=$(e.target),window.ApplicationInterface&&(window.ApplicationInterface.showSyncContextMenu(window.timelineDocumentId,i.join(),r,window.mainApp.timelineView.centerRangeString()),window.mainApp.onboarding.removeOnboardingMessage("scriv-right-click-options"))},renderJsContextMenuWithItems:function(e){var t=this,n=e.split(","),i=[],s=null,r=[],o=0;_.each(n,function(e){"-"==e?null!=s&&r.push(s):i.push({id:e,text:e}),s=e}),this.syncContextMenu?(this.syncContextMenu.clearAll(),this.syncContextMenu.loadStruct(i),_.each(r,function(e){this.syncContextMenu.addNewSeparator(e,"sep"+o),o++},this)):(this.syncContextMenu=new dhtmlXMenuObject({context:!0,items:i}),_.each(r,function(e){this.syncContextMenu.addNewSeparator(e,"sep"+o),o++},this),this.syncContextMenu.setAutoShowMode(!1),this.syncContextMenu.setAutoHideMode(!0),this.syncContextMenu.setContextMenuHideAllMode(!1),this.syncContextMenu.attachEvent("onClick",this.syncContextMenuItemClick.bind(this))),setTimeout(function(){t.syncContextMenu.showContextMenu(t.syncContextMenuMouseLocation.x,t.syncContextMenuMouseLocation.y)})},syncContextMenuItemClick:function(e,t,n){var i=this.syncContextMenu.getItemText(e);return window.ApplicationInterface&&window.ApplicationInterface.syncContextMenuItemClicked(window.timelineDocumentId,i),!1},tryAgainClicked:function(){window.ApplicationInterface&&window.ApplicationInterface.reloadSyncBinder(window.timelineDocumentId)},unchangedCheckboxClicked:function(){this.showUnchangedItems=$("#syncBinderUnchangedCheckbox").prop("checked"),this.pruneTree()},ignoredCheckboxClicked:function(){this.showIgnoredItems=$("#syncBinderIgnoredCheckbox").prop("checked"),this.pruneTree()},syncSettingsClicked:function(){window.ApplicationInterface&&this.settingsButtonsEnabled&&window.ApplicationInterface.showSyncSettings(window.timelineDocumentId)},closeClicked:function(){window.ApplicationInterface&&window.ApplicationInterface.closeSyncBinder(window.timelineDocumentId)},updateAllClicked:function(){window.ApplicationInterface&&this.settingsButtonsEnabled&&window.ApplicationInterface.syncUpdateAll(window.timelineDocumentId)},showLinkEventPopoverForItem:function(e){this.linkContextEventWithSyncItem=e,this.updateEventSearchDropdown(),this.eventSearchContextMenu.show(this.syncContextMenuElement)},updateEventSearchDropdown:function(){var e=this.syncData.linkedEvents,t=this.model.get("events").models,n=[];_.each(t,function(e){n.push(e)}),this.addChildrenOfEventsToArray(n,t),n=_.filter(n,function(t){var n=_.contains(e,t.id);return!n}),options=[],_.each(n,function(e){options.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")})},this),options.sort(function(e,t){var n=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),i=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(n.length,i.length),r=0;for(r=0;s>r;r++)if(n[r]!=i[r])return n[r]-i[r];return n.length-i.length}),this.eventSearchContextMenu.setOptions(options)},contextEventLinkClick:function(){var e=this.eventSearchContextMenu.getValue();window.ApplicationInterface&&e&&window.ApplicationInterface.linkEventAndSyncItem(window.timelineDocumentId,e,this.linkContextEventWithSyncItem)},addChildrenOfEventsToArray:function(e,t){var n=this;_.each(t,function(t){t.children.each(function(t){e.push(t),n.addChildrenOfEventsToArray(e,[t])})},this)},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove()}});module.exports=ATSyncBinderView;
},{"../lib/dhtmlxmenu":5,"./ATPoint":67,"./ATSearchDropdown":77,"./ATSearchableContextMenu":78,"./ATUtilities":91,"./ATViewMode":92,"./templates/syncBinderTemplate.html":166,"./templates/syncLinkWithEventTemplate.html":167,"backbone":176,"d3":300,"jquery":307,"jstree":308,"lodash":309}],82:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/syncSettingsTemplate.html"),ATSyncSettingsView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id");this.dropdowns={},this.elTemplate=_.template(templateHtml),this.settings={fields:[{name:"title",displayName:"Title",options:["Title","Synopsis"]},{name:"location",displayName:"Location",options:["Title","Location","Synopsis"]}]},this.d3El=d3.select("#"+e),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template",this.renderTemplate),this.renderTemplate()},setScrivenerFields:function(e){this.settings=e,this.renderTemplate()},renderTemplate:function(){var e=this;console.log("called renderTemplate"),console.log("this.scrivenerFields printed"),console.dir(this.settings),this.d3El.html(this.elTemplate(this.settings)),_.each(this.settings.fields,function(t){var i=t.name,n=i.replace(/\s/g,"_").replace(/\[/g,"").replace(/\]/g,""),s="#syncSettingsOption"+n;e.dropdowns[i]=new ATDropdown({el:s}),e.listenTo(e.dropdowns[i],"change",e.validateForm.bind(e)),t.value?e.dropdowns[i].setValue(t.value):e.dropdowns[i].setValue("None")}),this.$submitButton=$("#syncSettingsSubmit"),this.$submitForm=$("#syncSettingsForm"),this.$submitForm.on("submit",this.okClickHandler.bind(this))},validateForm:function(){var e=this,t=[],i=[],n=!1,s=!0;if(_.each(this.settings.fields,function(o){var l=o.name,a=e.dropdowns[l],r=a.getValue();"None"!=r&&"New Custom Field"!==r&&(_.contains(i,r)&&(s=!1,n=!0,_.contains(t,a.getText())||t.push(a.getText())),i.push(r))}),n===!0){for(var o="Error: Duplicate copies of: ",l=0;l<t.length;l++)o+=l==t.length-1?'"'+t[l]+'".':'"'+t[l]+'", ';$("#errorFieldScrivener").text(o)}else $("#errorFieldScrivener").empty();return console.log("this.$submitButton"),console.dir(this.$submitButton),console.log("formValid = "+s),this.$submitButton.prop("disabled",!s),s},okClickHandler:function(e){var t=this;if(!this.validateForm())return e.preventDefault(),!1;var i={dateFormat:0,fields:[]};return _.each(this.settings.fields,function(e){var n=e.name,s=t.dropdowns[n],o=s.getValue();i.fields.push({name:e.name,displayName:e.displayName,type:e.type,value:o})}),window.mainApp.removeExistingModal(),window.ApplicationInterface&&window.ApplicationInterface.updateSyncSettings(window.timelineDocumentId,JSON.stringify(i)),e.preventDefault(),!1}});module.exports=ATSyncSettingsView;
},{"./ATDropdown":29,"./templates/syncSettingsTemplate.html":168,"backbone":176,"d3":300,"jquery":307,"lodash":309}],83:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/tagManagerTemplate.html");ignore=require("../lib/bootstrap-tokenfield");var ATTagManagerView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.d3El=d3.select("#"+t),this.d3El.html(e()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.currentEditTag=null,this.$tagField=$("#tagManagerText"),this.$tagField.tokenfield({}),d3.select("#tagManagerForm .tokenfield").classed("largeHeight",!0),this.$tagField.on("tokenfield:createtoken",this.testAddTagHandler.bind(this)),this.$tagField.on("tokenfield:createdtoken",this.addTagHandler.bind(this)),this.$tagField.on("tokenfield:removedtoken",this.removeTagHandler.bind(this)),this.$tagField.on("tokenfield:editedtoken",this.editTagHandler.bind(this))},setTags:function(t){this.tagList=t,this.tagsInitialized=!1,this.$tagField.tokenfield("enable"),this.$tagField.tokenfield("setTokens",t),this.tagsInitialized=!0},testAddTagHandler:function(t){var e=t.attrs.value;return this.tagsInitialized?this.currentEditTag?this.currentEditTag==e?!0:!_.contains(this.tagList,e):!1:!0},addTagHandler:function(t){var e=t.attrs.value;this.tagsInitialized&&(this.currentEditTag&&this.currentEditTag!=e&&(window.ApplicationInterface.editTagInAllEvents(window.timelineDocumentId,e,this.currentEditTag),this.tagList=_.without(this.tagList,this.currentEditTag),this.tagList.push(e)),this.currentEditTag=null)},removeTagHandler:function(t){var e=t.attrs.length;window.ApplicationInterface&&(e>1?_.each(t.attrs,function(t){window.ApplicationInterface.removeTagFromAllEvents(window.timelineDocumentId,t.value),this.tagList=_.without(this.tagList,t.value)},this):(window.ApplicationInterface.removeTagFromAllEvents(window.timelineDocumentId,t.attrs.value),this.tagList=_.without(this.tagList,t.attrs.value)))},editTagHandler:function(t){this.currentEditTag=t.attrs.value}});module.exports=ATTagManagerView;
},{"../lib/bootstrap-tokenfield":3,"./ATDropdown":29,"./templates/tagManagerTemplate.html":170,"backbone":176,"d3":300,"jquery":307,"lodash":309}],84:[function(require,module,exports){
var _=require("lodash"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=function(s,t,e,i,n,h,a){this.years=s,this.months=t,this.weeks=e,this.days=i,this.hours=n,this.minutes=h,this.seconds=a};ATTimeSpan.FromString=function(s){var t=new RegExp("\\b(\\d+)\\s*y","i"),e=new RegExp("\\b(\\d+)\\s*m(?!i)((o)||\\b)","i"),i=new RegExp("\\b(\\d+)\\s*w","i"),n=new RegExp("\\b(\\d+)\\s*d","i"),h=new RegExp("\\b(\\d+)\\s*h","i"),a=new RegExp("\\b(\\d+)\\s*mi","i"),m=new RegExp("\\b(\\d+)\\s*s","i"),r=new RegExp("\\b(\\d+)"),o=new RegExp("^\\s*-"),u=0,T=0,c=0,p=0,d=0,l=0,A=0,w=!1,y=s.match(o),g=!1;return null!=y&&(g=!0),y=s.match(t),null!=y&&(u=parseInt(y[1]),w=!0),y=s.match(e),null!=y&&(T=parseInt(y[1]),w=!0),y=s.match(i),null!=y&&(c=parseInt(y[1]),w=!0),y=s.match(n),null!=y&&(p=parseInt(y[1]),w=!0),y=s.match(h),null!=y&&(d=parseInt(y[1]),w=!0),y=s.match(a),null!=y&&(l=parseInt(y[1]),w=!0),y=s.match(m),null!=y&&(A=parseInt(y[1]),w=!0),0==w&&(y=s.match(r),null!=y&&(A=parseInt(y[1]))),1==g&&(u=-u,T=-T,c=-c,p=-p,d=-d,l=-l,A=-A),new ATTimeSpan(u,T,c,p,d,l,A)},ATTimeSpan.FromComponents=function(s){var t=0,e=0,i=0,n=0,h=0,a=0,m=0;return _.each(s,function(s){switch(s.precision){case ATTimeUnit.YEAR:t=s.value;break;case ATTimeUnit.MONTH:e=s.value;break;case ATTimeUnit.WEEK:i=s.value;break;case ATTimeUnit.DAY:n=s.value;break;case ATTimeUnit.HOUR:h=s.value;break;case ATTimeUnit.MINUTE:a=s.value;break;default:m=s.value}}),new ATTimeSpan(t,e,i,n,h,a,m)},ATTimeSpan.prototype.copy=function(){return new ATTimeSpan(this.years,this.months,this.weeks,this.days,this.hours,this.minutes,this.seconds)},ATTimeSpan.prototype.toString=function(){var s="";return this.years&&(s+=(s.length?", ":"")+this.years+" year"+(1!=this.years?"s":"")),this.months&&(s+=(s.length?", ":"")+this.months+" month"+(1!=this.months?"s":"")),this.weeks&&(s+=(s.length?", ":"")+this.weeks+" week"+(1!=this.weeks?"s":"")),this.days&&(s+=(s.length?", ":"")+this.days+" day"+(1!=this.days?"s":"")),this.hours&&(s+=(s.length?", ":"")+this.hours+" hour"+(1!=this.hours?"s":"")),this.minutes&&(s+=(s.length?", ":"")+this.minutes+" minute"+(1!=this.minutes?"s":"")),this.seconds&&(s+=(s.length?", ":"")+this.seconds+" second"+(1!=this.seconds?"s":"")),0==s.length&&(s="0 seconds"),s},ATTimeSpan.prototype.toShortString=function(){var s="";return this.years?(s+=this.years+"y",this.months&&(s+=" "+this.months+"m")):this.months?(s+=this.months+"m",this.weeks&&(s+=" "+this.weeks+"w")):this.weeks?(s+=this.weeks+"w",this.days&&(s+=" "+this.days+"d")):this.days?(s+=this.days+"d",this.hours&&(s+=" "+this.hours+"h")):this.hours?(s+=this.hours+"h",this.minutes&&(s+=" "+this.minutes+"min")):this.minutes?(s+=this.minutes+"min",this.seconds&&(s+=" "+this.seconds+"s")):this.seconds&&(s+=this.seconds+"s"),0==s.length&&(s="0s"),s},ATTimeSpan.prototype.toPrecision=function(){return this.seconds?ATTimeUnit.SECOND:this.minutes?ATTimeUnit.MINUTE:this.hours?ATTimeUnit.HOUR:this.days?ATTimeUnit.DAY:this.weeks?ATTimeUnit.WEEK:this.months?ATTimeUnit.MONTH:ATTimeUnit.YEAR},module.exports=ATTimeSpan;
},{"./ATTimeUnit":85,"lodash":309}],85:[function(require,module,exports){
module.exports={CENTURY:0,DECADE:1,YEAR:2,MONTH:3,WEEK:4,DAY:5,HOUR:6,MINUTE:7,SECOND:8};
},{}],86:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATRangeConversion=require("./ATRangeConversion"),ATCalendar=require("./ATCalendar"),ATEventList=require("./ATEventList"),ATUtilities=require("./ATUtilities"),ATEntityList=require("./ATEntityList"),ATTimeline=Backbone.Model.extend({defaults:function(){return{events:new ATEventList,entities:new ATEntityList,laneTypeName:null,laneIds:{},threadIds:{},bookmarks:[],filters:[]}},initialize:function(){this.selectedEvents=[]},update:function(e){var t,n,i=this.get("entities"),s=this.get("events"),a=!1;this.rangeConversion?(e.timelineType&&(this.rangeConversion.type=e.timelineType,a=!0),e.calendar&&(this.rangeConversion.calendar=new ATCalendar(e.calendar.eras,e.calendar.months,e.calendar.weekdays,e.calendar.hoursInDay,e.calendar.weekdayIndexAtZero,e.calendar.zeroDateTS),this.rangeConversion.calendar.setCalendarType(e.calendar.calendarType),this.rangeConversion.calendar.dateOrder=e.calendar.dateOrder,this.rangeConversion.calendar.dateFormat=e.calendar.dateFormat,this.rangeConversion.calendar.timeFormat=e.calendar.timeFormat,this.rangeConversion.calendar.monthFormat=e.calendar.monthFormat,this.rangeConversion.calendar.dayNameFormat=e.calendar.dayNameFormat,a=!0)):(e.timelineType||console.log("ERROR: First update() in timeline does not have timelineType"),"date"!=e.timelineType||e.calendar||console.log("ERROR: First update() in timeline for date type does not have calendar"),e.calendar&&(n=new ATCalendar(e.calendar.eras,e.calendar.months,e.calendar.weekdays,e.calendar.hoursInDay,e.calendar.weekdayIndexAtZero,e.calendar.zeroDateTS),n.setCalendarType(e.calendar.calendarType),n.dateOrder=e.calendar.dateOrder,n.dateFormat=e.calendar.dateFormat,n.timeFormat=e.calendar.timeFormat,n.monthFormat=e.calendar.monthFormat,n.dayNameFormat=e.calendar.dayNameFormat),this.rangeConversion=new ATRangeConversion(e.timelineType,n),a=!0),a&&this.trigger("rangeConversionChanged"),e.entityUpdates&&_.each(e.entityUpdates,function(e){var t=_.pick(e,"id","name","sortOrder","color","icon","visibleAsColumn","type","startTS","stopTS","hasStart","hasStop");i.set([t],{remove:!1}),i.get(e.id).update(e)},this),e.entityDeletes&&i.remove(e.entityDeletes),e.eventUpdates&&(t=[],_.each(e.eventUpdates,function(e){var n=_.pick(e,"id","title","displayId","startTS","endTS","precision","maxScale","dateString","color","links","tags","visible","isFaded","dependencies","successors","relationships");n.parentId=-1,t.push(n),s.set([n],{remove:!1}),s.get(e.id).update(e)},this)),e.eventDeletes&&s.remove(e.eventDeletes),(e.newLanes||e.deletedLanes)&&(newlanes=_.clone(this.get("laneIds")),_.each(e.newLanes,function(e,t){newlanes[t]=e}),_.each(e.deletedLanes,function(e){delete newlanes[e]}),this.set({laneIds:newlanes})),e.laneTypeName&&this.set("laneTypeName",e.laneTypeName),this.trigger("updateUnallocatedRequired"),this.trigger("nodeLayoutRequired"),e.bookmarks&&this.set("bookmarks",e.bookmarks),e.filters&&this.set("filters",e.filters)},appendAllEvents:function(e){var t=this.get("events");return e.push.apply(e,t.models),t.each(function(t){t.appendAllDescendants(e)}),e},clearSelection:function(e){_.each(this.selectedEvents,function(e){var t=this.get("events").findChild(e);t&&t.set("selected",!1)},this),this.selectedEvents=[],e||this.selectionChanged()},selectEventWithID:function(e,t){var n=this.get("events").findChild(e);n&&(n.set("selected",!0),this.selectedEvents.push(e)),t||this.selectionChanged()},selectEventsWithIDs:function(e,t){var n=this;this.clearSelection(!0),_.each(e,function(e){n.selectEventWithID(e,!0)}),t||this.selectionChanged()},unselectEventWithID:function(e,t){var n=this.get("events").findChild(e);n&&n.set("selected",!1);var i=this.selectedEvents.indexOf(e);i>-1&&this.selectedEvents.splice(i,1),t||this.selectionChanged()},isEventWithIdSelected:function(e){var t=this.get("events").findChild(e);return t?t.get("selected"):!1},selectionChanged:function(){var e,t=this;this.selectedEvents.sort(function(e,n){var i=t.get("events").findChild(e),s=t.get("events").findChild(n),a=i.attributes,r=s.attributes;return a.startTS==r.startTS?a.endTS==r.endTS?a.title<r.title?-1:a.title==r.title?0:1:a.endTS-r.endTS:a.startTS-r.startTS}),this.trigger("selectionChanged"),window.ApplicationInterface&&(e=this.selectedEvents.join(),window.ApplicationInterface.selectionChanged(window.timelineDocumentId,e))},selectedEventsDraggable:function(){var e=!0;return _.each(this.selectedEvents,function(t){this.isEventDraggable(t)||(e=!1)},this),e},isEventDraggable:function(e){var t,n=this.get("events").findChild(e),i=!1;if(n){if(t=_.keys(n.get("dependencies")),t.length>0)return!1;if(n.children.each(function(e){this.isEventDraggable(e.id)&&(i=!0)},this),n.children.length&&!i)return!1}return!0},dateAfterDraggingEvent:function(e,t){var n=this.get("events").findChild(e),i=n.get("startTS");return this.rangeConversion.valueByAddingSpanToValue(i,t)},endDateAfterDraggingEvent:function(e,t){var n=this.get("events").findChild(e),i=n.get("endTS");return this.rangeConversion.valueByAddingSpanToValue(i,t)},flattenedEventList:function(e){var t=[],n=this.get("events"),i=function(e,t){var n=e.attributes,i=t.attributes;return n.startTS==i.startTS?ATUtilities.versionNumberCompare(n.displayId,i.displayId):n.startTS-i.startTS},s=e?e:i;return n.each(function(e){t.push(e),this.addChildrenToFlattenedList(e,t)},this),t.sort(s),t},addChildrenToFlattenedList:function(e,t){e.children.each(function(e){t.push(e),this.addChildrenToFlattenedList(e,t)},this)},selectedEventsCanHaveParent:function(e){return this.canBeMadeChildren(this.selectedEvents,e)},canBeMadeChildren:function(e,t){var n=!0;return _.each(e,function(e){this.canBeMadeChild(e,t)||(n=!1)},this),n},canBeMadeChild:function(e,t){var n=this.get("events"),i=n.findChild(e),s=i.get("parentId");return!(this.isDependentOnEventChild(e,t)||this.isDependentOnEventChild(t,e)||this.isSuccessorOfEvent(e,t)||this.isSuccessorOfEventChild(t,e)||this.isEventAncestor(t,e)||s==t)},isEventAncestor:function(e,t){for(var n,i=this.get("events"),s=i.findChild(e),a=s.get("parentId");a>0;){if(a==t)return!0;n=i.findChild(a),a=n.get("parentId")}return!1},isDependentOnEvent:function(e,t){var n=this.get("events"),i=n.findChild(e),s=_.map(_.keys(i.get("dependencies")),function(e){return parseInt(e)}),a=!1;return _.each(s,function(e){(e==t||this.isDependentOnEvent(e,t))&&(a=!0)},this),a},isSuccessorOfEvent:function(e,t){var n=this.get("events"),i=n.findChild(e),s=_.map(i.get("successors"),function(e){return parseInt(e)}),a=!1;return _.each(s,function(e){(e==t||this.isSuccessorOfEvent(e,t))&&(a=!0)},this),a},isDependentOnEventChild:function(e,t){var n=this.get("events"),i=n.findChild(e),s=_.map(_.keys(i.get("dependencies")),function(e){return parseInt(e)}),a=!1;return _.each(s,function(e){(this.isEventAncestor(e,t)||e==t||this.isDependentOnEventChild(e,t))&&(a=!0)},this),a},isSuccessorOfEventChild:function(e,t){var n=this.get("events"),i=n.findChild(e),s=_.map(i.get("successors"),function(e){return parseInt(e)}),a=!1;return _.each(s,function(e){(this.isEventAncestor(e,t)||e==t||this.isSuccessorOfEventChild(e,t))&&(a=!0)},this),a},firstEventAfterTimestamp:function(e){var t=this.flattenedEventList(),n=_.find(t,function(t){return t.get("startTS")>e});return n}});module.exports=ATTimeline;
},{"./ATCalendar":17,"./ATEntityList":41,"./ATEventList":44,"./ATRangeConversion":71,"./ATUtilities":91,"backbone":176,"lodash":309}],87:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("./ATUtilities"),Opentip=require("../lib/opentip"),Hammer=require("hammerjs"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATTimelineViewPainter=require("./ATTimelineViewPainter"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATBounds=require("./ATBounds"),ATSize=require("./ATSize"),ATViewMode=require("./ATViewMode"),dhtmlXMenuObject=require("../lib/dhtmlxmenu"),expandedContentPreambleHtml=require("./templates/expandedEventContentPreamble.html"),expandedContentPostambleHtml=require("./templates/expandedEventContentPostamble.html"),expandedImageHtml=require("./templates/expandedEventImage.html"),expandedPropertyBooleanHtml=require("./templates/expandedEventPropertyBoolean.html"),expandedPropertyNumberHtml=require("./templates/expandedEventPropertyNumber.html"),expandedPropertyParagraphHtml=require("./templates/expandedEventPropertyParagraph.html"),expandedPropertyPercentageHtml=require("./templates/expandedEventPropertyPercentage.html"),expandedPropertyStringHtml=require("./templates/expandedEventPropertyString.html"),expandedRoleListHtml=require("./templates/expandedEventRoleList.html"),expandedTagListHtml=require("./templates/expandedEventTagList.html"),expandedLinkListHtml=require("./templates/expandedEventLinkList.html"),ATTimelineView=Backbone.View.extend({initialize:function(){var e,t=this,i=this.$el.attr("id");this.timeline=this.model.get("timeline"),this.d3El=d3.select("#"+i),this.viewMode=ATViewMode.RELATIONSHIP_VIEW,this.d3El.on("dblclick",this.dblClickHandler.bind(this)),this.renderFlags={viewport:!0,data:!0,selection:!1,calculate:!0},this.physicalScaleFactor=1,this.layers={},this.filterBarDiv=d3.select("#filterBarDiv"),this.bookmarksDiv=d3.select("#bookmarks"),this.layers.timeline_content_svg=this.d3El.selectAll(".timelineContent"),this.layers.lane_nav_svg=this.d3El.select(".laneNavSvg"),this.layers.header_svg=this.d3El.select(".header"),this.layers.contextBar_svg=this.d3El.select(".contextBar"),this.layers.context_layer=this.d3El.select(".contextLayer"),this.layers.context_lens_layer=this.d3El.select(".contextLens"),this.layers.lifetime_bg_layer=this.d3El.select(".lifetime_bg_layer"),this.layers.bg_layer=this.d3El.select(".bg_layer"),this.layers.dependency_layer=this.d3El.select(".dependency_layer"),this.layers.event_layer=this.d3El.select(".event_layer"),this.layers.lane_overlay_layer=this.d3El.select(".laneOverlay"),this.holdRenderingCount=1,this.moreTemplate="<div></div>",this.appendMeasurementDiv(),e=this.canvasSize(),this.viewport=new ATRect(0,-TimelineDisplayConstants.timeHeaderHeight,e.width,e.height),this.rangeX=new ATBounds(-Number.MAX_VALUE,Number.MAX_VALUE),this.rangeY=new ATBounds(-TimelineDisplayConstants.timeHeaderHeight,350),this.scrollBounceStartX=null,this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1,this.bounceRangeX=new ATBounds(-Number.MAX_VALUE,Number.MAX_VALUE),this.scrollBounceMaxOver=200,this.scrollBounceTreacleFactor=4;const n=632448e13;this.maximumRangeTS=new ATBounds(-632448e13,n),this.maximumUnitScale=316224e10,this.minimumUnitScale=1,this.minMarkerSeparation=200,this.calculateContextScale(),this.contextLeftTS=0,this.contextLeftLensPixel=0,this.contextRightLensPixel=0,this.dragStartPos=null,this.dragBoxBounds=null,this.grabScrollMoveOrigin=null,this.grabScrollViewOrigin=null,this.timelinePainter=new ATTimelineViewPainter(this),this.listenTo(this.model,"selectionChanged",function(){t.renderFlags.selection=!0,t.renderIfRequired(),window.mainApp.enableToolbarItemsForSelection()}),this.listenTo(this.timeline,"rangeConversionChanged",function(){t.calculateContextScale(),t.renderFlags.data=!0,t.renderFlags.viewport=!0}),this.listenTo(this.model,"change:unitScale",function(){t.calculateContextScale(),window.mainApp.unitScaleChanged(),t.renderFlags.calculate=!0,t.renderFlags.zoom=!0}),this.listenTo(this.timeline,"change:bookmarks",function(){t.renderFlags.data=!0}),this.listenTo(this.timeline,"change:filters",function(){t.renderFlags.data=!0}),this.listenTo(this.model.lanes,"add remove",function(){t.renderFlags.data=!0}),this.listenTo(this.timeline.get("events"),"add remove",function(){t.renderFlags.data=!0}),this.listenTo(this.model,"childNodeAdded",function(){t.renderFlags.data=!0}),this.listenTo(this.model,"laneCollapsed",function(){t.renderFlags.calculate=!0,t.renderFlags.data=!0,t.renderIfRequired()}),this.listenTo(this.timeline,"nodeLayoutRequired",function(){this.renderFlags.calculate=!0}),this.listenTo(this.model,"nodeLayoutChanged",this.calcScrollLimits.bind(this)),window.addEventListener("resize",this.resizeWindow.bind(this),!1),this.el.addEventListener("wheel",this.mouseWheel.bind(this),!1),this.el.addEventListener("contextmenu",function(e){window.ApplicationInterface&&(t.defaultContextMenuMouseLocation=new ATPoint(e.clientX,e.clientY),window.ApplicationInterface.showDefaultContextMenu(window.timelineDocumentId,t.timeline.selectedEvents.length))});var s=this.$el[0],o=new Hammer.Manager(s),r=new Hammer.Pinch,a=new Hammer.Pan,l=new Hammer.Tap({time:49});o.add(r),o.add(a),o.add(l),a.requireFailure(r),r.requireFailure(l),o.on("tap",function(e){if("mouse"!=e.pointerType){var t=this.rawMousePositionToScaledCanvasPosition(new ATPoint(e.center,x,e.center.y)),i=this.relativeToAbsolutePoint(t),n=(this.model.laneForAbsoluteY(i.y),this.model.eventNodeForAbsolutePosition(i,!0));this.timeline.selectEventWithID(n.id)}}),o.on("pinch",function(e){if("mouse"!=e.pointerType){t.disablePan=!0;var i=e.scale;i>1.5?i=1.5:.75>i&&(i=.75),t.zoomWithMagnification(i,e.center.x,e.center.y),t.enablePanTimeout&&window.clearTimeout(t.enablePanTimeout),t.enablePanTimeout=window.setTimeout(function(){t.disablePan=!1},100)}}),o.on("panmove",function(e){"mouse"!=e.pointerType&&(t.disablePan||t.grabScrolled(e.deltaX,e.deltaY))}),o.on("panend",function(e){"mouse"!=e.pointerType&&t.grabScrollEnded()}),o.on("pancancel",function(e){"mouse"!=e.pointerType&&t.grabScrollEnded()});var h=d3.behavior.drag().on("dragstart",this.viewDragStarted.bind(this)).on("drag",this.viewDragged.bind(this)).on("dragend",this.viewDragEnded.bind(this));this.d3El.call(h),this.eventDrag=d3.behavior.drag().on("dragstart",this.eventNodeDragStarted.bind(this)).on("drag",this.eventNodeDragged.bind(this)).on("dragend",this.eventNodeDragEnded.bind(this)),this.laneDrag=d3.behavior.drag().on("dragstart",this.laneDragStarted.bind(this)).on("drag",this.laneDragged.bind(this)).on("dragend",this.laneDragEnded.bind(this)),this.verticalScrollDrag=d3.behavior.drag().on("dragstart",this.verticalScrollDragStarted.bind(this)).on("drag",this.verticalScrollDragged.bind(this)).on("dragend",this.verticalScrollDragEnded.bind(this)),this.contextLensDrag=d3.behavior.drag().on("dragstart",this.contextLensDragStarted.bind(this)).on("drag",this.contextLensDragged.bind(this)).on("dragend",this.contextLensDragEnded.bind(this)),this.adjustWindowScale();this.checkBrowser()},setViewMode:function(e){this.holdRendering(),this.viewMode=e,this.d3El.style("display",e==ATViewMode.TIMELINE_VIEW?null:"none"),e==ATViewMode.TIMELINE_VIEW&&this.adjustWindowScale(),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},setRelationshipView:function(e){this.relationshipView=e,e.setTimelineView(this)},calcScrollLimits:function(){var e=this.model.findEarliestEventNode(),t=this.model.findLatestEventNode(!0);e&&t?(this.bounceRangeX.min=e.get("startPixel")-this.viewport.size.width/2,this.bounceRangeX.max=t.get("startPixel")+t.get("markerRect").size.width-this.viewport.size.width/2):(this.bounceRangeX.min=-Number.MAX_VALUE,this.bounceRangeX.max=Number.MAX_VALUE),"restrict"==this.scrollingBehaviour&&(this.rangeX.min=this.bounceRangeX.min-this.viewport.size.width/2,this.rangeX.max=this.bounceRangeX.max+3*this.viewport.size.width/2)},setDisplayTemplateSettings:function(e){var t="",i=/LABEL/g,n=e.size/100;this.holdRendering(),this.showEventId=e.showEventId,this.showEventDate=e.showEventDate,this.showEventImage=!0,this.skin=e.skin,this.scrollingBehaviour=window.isAeonWebExport?"restrict":e.scrollingBehaviour,d3.select("body").classed("dark","dark"===this.skin).classed("light","light"===this.skin).classed("writer","writer"===this.skin).classed("ocean","ocean"===this.skin).classed("borealis","borealis"===this.skin).classed("print","print"===this.skin),this.timelinePainter.skinChanged(),this.moreInfoColumnCount=0,e.moreInfoLeftColumn.length>0&&(this.moreInfoColumnCount++,t+=expandedContentPreambleHtml,_.each(e.moreInfoLeftColumn,function(e){var n;n="percentage"==e.type?expandedPropertyPercentageHtml:"multitext"==e.type||"richtext"==e.type?expandedPropertyParagraphHtml:"role"==e.type?expandedRoleListHtml:"number"==e.type||"currency"==e.type||"decimal"==e.type?expandedPropertyNumberHtml:"boolean"==e.type?expandedPropertyBooleanHtml:"image"==e.type?expandedImageHtml:"tags"==e.type?expandedTagListHtml:"links"==e.type?expandedLinkListHtml:expandedPropertyStringHtml,n=n.replace(i,e.name),t+=n}),t+=expandedContentPostambleHtml),e.moreInfoRightColumn.length>0&&(this.moreInfoColumnCount++,t+=expandedContentPreambleHtml,_.each(e.moreInfoRightColumn,function(e){var n;n="percentage"==e.type?expandedPropertyPercentageHtml:"multitext"==e.type||"richtext"==e.type?expandedPropertyParagraphHtml:"role"==e.type?expandedRoleListHtml:"number"==e.type||"currency"==e.type||"decimal"==e.type?expandedPropertyNumberHtml:"boolean"==e.type?expandedPropertyBooleanHtml:"image"==e.type?expandedImageHtml:"tags"==e.type?expandedTagListHtml:"links"==e.type?expandedLinkListHtml:expandedPropertyStringHtml,n=n.replace(i,e.name),t+=n}),t+=expandedContentPostambleHtml),this.setMoreTemplate(t),n!=this.physicalScaleFactor&&(this.physicalScaleFactor=n,this.relationshipView&&(this.relationshipView.physicalScaleFactor=n),this.adjustWindowScale()),this.calcScrollLimits(),this.releaseRendering()},setMoreTemplate:function(e){this.holdRendering(),this.oldMoreTemplate=e,this.moreTemplate=_.template(e),_.each(this.model.lanes.models,function(e){_.each(e.nodes.models,function(e){e.displayTemplateChanged()})}),this.releaseRendering()},holdRendering:function(){this.holdRenderingCount++},releaseRendering:function(){this.holdRenderingCount--,this.holdRenderingCount<=0&&(this.renderIfRequired(),this.holdRenderingCount=0)},setRenderFlag:function(e){this.renderFlags[e]=!0},renderIfRequired:function(){this.holdRenderingCount>0||(_.isEmpty(this.renderFlags)||(this.calculateIfRequired(),this.render(this.renderFlags)),this.renderFlags={})},calculateIfRequired:function(){var e=this;this.renderFlags.calculate&&(this.model.lanes.each(function(t){t.relationshipUpdatePending&&t.updateRelationshipNodes(),e.calcNodesIfRequired(t.nodes.models)}),this.model.calculateNodes(),this.renderFlags=_.omit(this.renderFlags,"calculate"),this.renderFlags.data=!0)},calcNodesIfRequired:function(e){var t=this;_.each(e,function(e){e.calcEventTextRequired?t.calcEventTextSize(e):e.calcRectsRequired&&e.calcRects(),t.calcNodesIfRequired(e.childNodes.models)})},pruneData:function(){var t,i,n,s,o,r,a,l,h=this,d=this.model,c=d.displayLanes.length,g=d.displayLanes[c-1],u=this.viewport,v=d.dependencyPaths.length,m=g.top+g.height,p=c>1&&m>u.size.height-TimelineDisplayConstants.timeHeaderHeight-TimelineDisplayConstants.contextHeight-TimelineDisplayConstants.bookmarksHeight,w=d.get("timeline").get("events").models,f=w.length,T=p?d.navigationLanes:[],x=[],n=[],D=[];for(TimelineDisplayConstants.scrollKnobXPosition=p?TimelineDisplayConstants.scrollKnobDefaultXPosition:TimelineDisplayConstants.scrollKnobNoLaneNavXPosition,TimelineDisplayConstants.scrollTrackThickness=p?TimelineDisplayConstants.scrollTrackDefaultThickness:TimelineDisplayConstants.scrollTrackNoLaneNavThickness,x=_.map(d.displayLanes,function(e){var t=_.clone(e),i=e.top;return e.top<=u.bottom()&&e.top+e.height>=u.top()?t.nodes=_.filter(t.nodes,function(e){var t,n,s,o=e.totalRect,r=e.markerRect,a=e.childRect;return t=new ATRect(o.origin.x,o.origin.y+i,o.size.width,o.size.height),t=a?new ATRect(t.origin.x,t.origin.y,Math.max(t.size.width,a.size.width),t.size.height+a.size.height):t,t.overlaps(u)?(e.selected=e.original.get("selected"),!h.isExport&&t.size.width>TimelineDisplayConstants.eventOptimiseMaxPolygonWidth?(s=t.origin.x+r.right(),s<u.right()?(pt=h.absoluteToRelativePoint(new ATPoint(s,0)),n=pt.x-TimelineDisplayConstants.eventOptimiseFurthestOffscreen,e.widthAdjustToOptimise=n-r.size.width,e.positionAdjustToOptimise=-e.widthAdjustToOptimise,e.translateMarkerX=r.size.width+e.widthAdjustToOptimise-TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft):(e.widthAdjustToOptimise=TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-r.size.width,pt=h.absoluteToRelativePoint(new ATPoint(t.origin.x,0)),pt.x<TimelineDisplayConstants.eventOptimiseFurthestOffscreen?e.positionAdjustToOptimise=TimelineDisplayConstants.eventOptimiseFurthestOffscreen-pt.x:e.positionAdjustToOptimise=0,e.translateMarkerX=0)):(e.positionAdjustToOptimise=0,e.widthAdjustToOptimise=0,e.translateMarkerX=0),!0):!1}):t.nodes=[],t.lifetimeMarks=h.lifetimeMarksForLaneBetweenStartAndStopPixel(e.original,h.viewport.left()+e.marginForLane,h.viewport.right(),h.viewport.left()+e.marginForLane),t}),t=0;v>t;t++)i=d.dependencyPaths[t],i.startPt.x<u.left()&&i.endPt.x<u.left()||i.startPt.x>u.right()&&i.endPt.x>u.right()||i.startPt.y<u.top()&&i.endPt.y<u.top()||i.startPt.y>u.bottom()&&i.endPt.y>u.bottom()||i.node1.get("lane").get("collapsed")||n.push({name:i.name,start:i.startPt,path:i.path,color:i.node1.get("event").get("color")});for(this.calculateContextScale(),a=this.contextLeftTS+this.viewport.size.width*this.contextUnitScale,e=0;e<f;e++)s=w[e],s.get("endTS")>=this.contextLeftTS&&s.get("startTS")<=a&&s.get("visible")&&(l=(s.get("startTS")-this.contextLeftTS)/this.contextUnitScale,-10>l&&(l=-10),endDotPix=(s.get("endTS")-this.contextLeftTS)/this.contextUnitScale,endDotPix>this.viewport.size.width+10&&(endDotPix=this.viewport.size.width+10),D.push({id:s.id,startPixel:l,stopPixel:endDotPix,color:s.get("color")}));return o=this.headerLabelsBetweenStartAndStopPixel(this.viewport.origin.x,this.viewport.right()),r=this.contextLabelsBetweenTimestamps(this.contextLeftTS,a),{lanes:x,dependencyPaths:n,navigationLanes:T,headerData:o,contextLabels:r,contextDots:D,bookmarks:this.model.get("timeline").get("bookmarks"),filters:this.model.get("timeline").get("filters")}},contextLabelsBetweenTimestamps:function(e,t){if(!this.timeline.rangeConversion)return[];var i=this.contextUnitScale,n=this.timeline.rangeConversion.labelsBetweenBounds(e,t,i,this.contextMarkers.mainMarkerSpacing,this.contextMarkers.mainMarkerFormat);return _.each(n,function(e){e.xPosition=ATUtilities.floatToInt(e.xPosition-this.contextLeftTS/i)},this),n},lifetimeMarksForLaneBetweenStartAndStopPixel:function(e,t,i,n){if(!this.timeline.rangeConversion)return[];var s,o,r=this.model.get("unitScale"),a=t*r,l=i*r,h=e.get("entity"),d=h.get("hasStart"),c=h.get("hasStop"),g="date"==this.timeline.rangeConversion.type?this.headerMarkers.subMarkerSpacing.copy():this.headerMarkers.subMarkerSpacing;return d&&(s=h.get("startTS")),c&&(o=h.get("stopTS")),this.timeline.rangeConversion.lifetimeMarks(a,l,r,d,s,c,o,g)},lifetimeBoundsForLane:function(e){var t,i,n=this.model.get("unitScale"),s=e.get("entity"),o=s.get("hasStart"),r=s.get("hasStop"),a=0,l=0;return o&&(t=e.get("entity").get("startTS"),a=t/n),r&&(i=e.get("entity").get("stopTS"),l=i/n),{hasStart:o,start:a,hasStop:r,stop:l}},headerLabelsBetweenStartAndStopPixel:function(e,t){var i=this.model.get("unitScale"),n=e*i,s=t*i,o={labels:[],sublabels:[]};return this.timeline.rangeConversion&&(o.labels=this.timeline.rangeConversion.labelsBetweenBounds(n,s,i,this.headerMarkers.mainMarkerSpacing,this.headerMarkers.mainMarkerFormat,this.headerMarkers.endMarkerFormat),o.sublabels=this.timeline.rangeConversion.labelsBetweenBounds(n,s,i,this.headerMarkers.subMarkerSpacing,this.headerMarkers.subMarkerFormat)),o},calcRangeMarkerSpacing:function(e,t){return this.timeline.rangeConversion?this.timeline.rangeConversion.calculateMarkerSpacing(e,t):[]},render:function(e){var t;this.viewMode==ATViewMode.TIMELINE_VIEW?(t=this.pruneData(this.model),this.timelinePainter.render(t,e)):this.relationshipView&&this.relationshipView.render(e)},addNewLayer:function(e){this.layers[e]=this.d3El.append("g").attr("class",e)},canvasSize:function(){var e=this.el.getBoundingClientRect();return new ATSize(e.width/this.physicalScaleFactor,e.height/this.physicalScaleFactor)},calculateContextScale:function(){this.contextUnitScale=this.model.get("unitScale")*this.viewport.size.width/TimelineDisplayConstants.contextLensWidth,this.headerMarkers=this.calcRangeMarkerSpacing(this.model.get("unitScale"),this.minMarkerSeparation),this.contextMarkers=this.calcRangeMarkerSpacing(this.contextUnitScale,this.minMarkerSeparation)},roundedDateForPixel:function(e){var t=this.model.get("unitScale"),i=e*t;return this.timeline.rangeConversion.roundedValueForValue(i,t)},centerTimestamp:function(){var e=this.viewport.origin.x+this.viewport.size.width/2,t=this.roundedDateForPixel(e);return t.timestamp?t.timestamp:t},centerRangeString:function(){return this.timeline.rangeConversion.naturalStringFromValue(this.centerTimestamp(),!1)},absoluteToRelativePoint:function(e){return new ATPoint(e.x-this.viewport.origin.x,e.y-this.viewport.origin.y)},relativeToAbsolutePoint:function(e){return new ATPoint(e.x+this.viewport.origin.x,e.y+this.viewport.origin.y)},clientXLeftOfSyncBinder:function(e){if(!window.mainApp.syncBinderVisible)return e;var t=$("#syncBinder").innerWidth();return e-t},clientYBelowFilterBar:function(e){return window.mainApp.filterBarVisible||window.appToolbar?window.appToolbar?window.mainApp.filterBarVisible?e-TimelineDisplayConstants.filterBarHeight-TimelineDisplayConstants.toolbarHeight:e-TimelineDisplayConstants.toolbarHeight:e-TimelineDisplayConstants.filterBarHeight:e},rawMousePositionToScaledCanvasPosition:function(e){var t=new ATPoint(e);return t.x=this.clientXLeftOfSyncBinder(e.x),t.y=this.clientYBelowFilterBar(e.y),t.x/=this.physicalScaleFactor,t.y/=this.physicalScaleFactor,t},scrollIncrement:function(e,t){return this.scrollTopLeftToPoint(this.viewport.origin.x+e,this.viewport.origin.y+t)},scrollTopLeftToPoint:function(e,t){var i=new ATBounds(this.rangeX.min,this.rangeX.max-this.viewport.size.width),n=new ATBounds(this.rangeY.min,Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height));this.viewport.origin.x=i.constrain(e),this.viewport.origin.y=n.constrain(t),this.adjustContextViewport(),this.renderFlags.viewport=!0,this.renderIfRequired()},scrollLeftToPoint:function(e){this.scrollTopLeftToPoint(e,this.viewport.top())},scrollTopToPoint:function(e){this.scrollTopLeftToPoint(this.viewport.left(),e)},scrollTopLeftToUnconstrainedPoint:function(e,t){var i=new ATBounds(this.rangeY.min,this.rangeY.max-this.viewport.size.height);this.viewport.origin.x=e,this.viewport.origin.y=i.constrain(t),this.renderFlags.viewport=!0,this.adjustContextViewport(),this.renderIfRequired()},scrollLeftToUnconstrainedPoint:function(e){this.scrollTopLeftToUnconstrainedPoint(e,this.viewport.top())},setContextLeftTS:function(e){this.contextLeftTS=e,this.adjustContextViewport(),this.renderFlags.viewport=!0,this.renderIfRequired()},adjustContextViewport:function(){var e,t=this.model.get("unitScale"),i=this.viewport.size.width,n=(this.contextLeftTS+i*this.contextUnitScale,this.viewport.left()*t),s=this.viewport.right()*t;this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale,e=i-this.contextRightLensPixel,this.contextLeftLensPixel<TimelineDisplayConstants.contextLensMinMargin?(this.contextLeftTS=n-TimelineDisplayConstants.contextLensMinMargin*this.contextUnitScale,n=this.viewport.left()*t,s=this.viewport.right()*t,this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale):e<TimelineDisplayConstants.contextLensMinMargin&&(this.contextLeftTS=this.contextLeftTS-(e-TimelineDisplayConstants.contextLensMinMargin)*this.contextUnitScale,n=this.viewport.left()*t,s=this.viewport.right()*t,this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale),window.mainApp&&window.mainApp.scrollPositionChanged()},immediateContextBarReturn:function(){var e=(this.viewport.origin.x+this.viewport.size.width/2)*this.model.get("unitScale"),t=e-this.viewport.size.width/2*this.contextUnitScale;this.setContextLeftTS(t)},animateContextBarReturn:function(e,t){function i(e,t){return function(){var i=d3.interpolateNumber(e,t);return function(e){o.setContextLeftTS(i(e))}}}var n,s,o=this;return e||t?(n=(this.viewport.origin.x+this.viewport.size.width/2)*this.model.get("unitScale"),s=n-this.viewport.size.width/2*this.contextUnitScale,void d3.transition().delay(e).duration(t).tween("animatedContextReturn",i(this.contextLeftTS,s))):(this.cancelAnimations(),void this.immediateContextBarReturn())},cancelAnimations:function(){d3.transition().delay(0).duration(0).tween("animatedContextReturn",null)},setUnitScale:function(e){return e>this.maximumUnitScale&&(e=this.maximumUnitScale),e<this.minimumUnitScale&&(e=this.minimumUnitScale),this.rangeX=new ATBounds(this.maximumRangeTS.min/e,this.maximumRangeTS.max/e),this.model.set("unitScale",e),e},zoomWithMagnification:function(e,t,i){var n,s,o=this.rawMousePositionToScaledCanvasPosition(new ATPoint(+t,+i)),r=o.x,a=o.y,l=r+this.viewport.left(),h=a+this.viewport.top(),d=this.model,c=d.get("unitScale"),g=l*c;this.holdRendering(),this.nearestLaneToMouse&&a==this.lastMagnifyMouseY||(this.nearestLaneToMouse=this.model.closestLaneTopToAbsoluteY(h),this.lastMagnifyMouseY=a,this.magnifyMouseOffsetFromLane=h-this.nearestLaneToMouse.get("top")),c=this.setUnitScale(c/e),this.calculateIfRequired(),n=g/c-r,this.timelinePainter.transitionDuration=0,s=this.nearestLaneToMouse.get("top")+this.magnifyMouseOffsetFromLane,this.scrollTopLeftToPoint(n,s-a),this.animateContextBarReturn(0,0),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToScaleAtPoint:function(e,t,i){var n,s=this.rawMousePositionToScaledCanvasPosition(new ATPoint(+t,+i)),o=s.x,r=(s.y,this.viewport.left()+o),a=this.model,l=a.get("unitScale"),h=r*l;e=this.setUnitScale(e),n=h/e-o,this.timelinePainter.transitionDuration=0,this.holdRendering(),this.scrollLeftToUnconstrainedPoint(n),this.immediateContextBarReturn(),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToScale:function(e){var t,i=this.viewport.size.width/2,n=this.viewport.centerX(),s=this.model,o=s.get("unitScale"),r=n*o;this.holdRendering(),e=this.setUnitScale(e),t=r/e-i,this.timelinePainter.transitionDuration=0,this.scrollLeftToUnconstrainedPoint(t),this.immediateContextBarReturn(),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToContextLensBounds:function(e,t){function i(e,t,i){return function(){var i=d3.interpolateNumber(e,t),o=d3.interpolateNumber(n.viewport.origin.x*r,s);return function(e){var t=o(e)/i(e);n.holdRendering(),n.zoomToScale(i(e)),n.scrollLeftToPoint(t),n.immediateContextBarReturn(),n.releaseRendering()}}}var n=this,s=e*this.contextUnitScale+this.contextLeftTS,o=t*this.contextUnitScale+this.contextLeftTS,r=this.model.get("unitScale"),a=(o-s)/this.viewport.size.width,l=s/a;d3.transition().duration(500).tween("animatedZoom",i(r,a,l))},mouseWheel:function(e){var e=window.event||e,t=e.wheelDeltaX||40*-e.deltaX,i=e.wheelDeltaY||40*-e.deltaY,n=e.clientX,s=e.clientY;return this.mouseWheelWorkaround(t,i,n,s,e.ctrlKey||e.metaKey),e.preventDefault(),!1},nativeGestureStarted:function(){var e=performance.now();this.gestureCallReceivedFromCpp=!0,this.bounceCompleteTime&&this.bounceCompleteTime<e+100&&this.restartBounceTracking()},restartBounceTracking:function(){performance.now();this.scrollBounceStartX=this.viewport.origin.x,"bounce"==this.scrollingBehaviour?(this.scrollMayBounceAtLeft=this.viewport.origin.x>this.bounceRangeX.min+this.viewport.size.width/8,this.scrollMayBounceAtRight=this.viewport.origin.x+this.viewport.size.width/8<this.bounceRangeX.max):"restrict"==this.scrollingBehaviour?(this.scrollMayBounceAtLeft=!0,this.scrollMayBounceAtRight=!0):(this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1),this.scrollBounceCrossoverTime=null,this.maxWheelInterval=0,this.minAbsDeltaX=1e3,this.blockFurtherScrolling=!1,this.bounceCompleteTime=null},mouseWheelWorkaround:function(e,t,i,n,s){var o,r,a=performance.now(),l=this.lastWheelTime?a-this.lastWheelTime:1e4;return this.holdRendering(),0!=i&&0!=n&&(canvasPos=this.rawMousePositionToScaledCanvasPosition(new ATPoint(+i,+n)),clientX=canvasPos.x,clientX<0||clientX>this.viewport.size.width)?void this.releaseRendering():s?(this.zoomWithMagnification(t>0?1.2:.8,i,n),void this.releaseRendering()):(this.maxWheelInterval=Math.max(l,this.maxWheelInterval),this.minAbsDeltaX=Math.min(this.minAbsDeltaX,Math.abs(e)),l>600&&this.restartBounceTracking(),this.lastWheelTime=a,this.blockFurtherScrolling?void this.releaseRendering():("bounce"==this.scrollingBehaviour?(this.scrollMayBounceAtLeft=this.scrollMayBounceAtLeft||this.viewport.origin.x>this.bounceRangeX.min+this.viewport.size.width/8,this.scrollMayBounceAtRight=this.scrollMayBounceAtRight||this.viewport.origin.x+this.viewport.size.width/8<this.bounceRangeX.max):"restrict"==this.scrollingBehaviour?(this.scrollMayBounceAtLeft=!0,this.scrollMayBounceAtRight=!0):(this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1),o=this.viewport.origin.x-e,r=this.viewport.origin.y-t,(this.scrollMayBounceAtLeft&&this.viewport.origin.x<this.bounceRangeX.min||this.scrollMayBounceAtRight&&this.viewport.origin.x>this.bounceRangeX.max)&&(this.scrollBounceCrossoverTime||(this.scrollBounceCrossoverTime=a),e/=this.scrollBounceTreacleFactor,this.viewport.origin.x<=this.bounceRangeX.min-this.scrollBounceMaxOver&&(this.blockFurtherScrolling=!0,o=this.bounceRangeX.min-this.scrollBounceMaxOver),this.viewport.origin.x>=this.bounceRangeX.max+this.scrollBounceMaxOver&&(this.blockFurtherScrolling=!0,o=this.bounceRangeX.max+this.scrollBounceMaxOver)),(this.scrollMayBounceAtLeft||this.scrollMayBounceAtRight)&&(this.scrollBounceTimeout&&window.clearTimeout(this.scrollBounceTimeout),this.scrollBounceTimeout=window.setTimeout(this.scrollBounceAsRequired.bind(this),80)),this.scrollTopLeftToPoint(o,r),this.animateContextBarReturn(0,0),void this.releaseRendering()))},scrollBounceAsRequired:function(){var e=performance.now(),t=Math.max(e-this.scrollBounceCrossoverTime,500);this.scrollMayBounceAtLeft&&this.viewport.origin.x<this.bounceRangeX.min?this.scrollToPixelXY(this.bounceRangeX.min,null,t):this.scrollMayBounceAtRight&&this.viewport.origin.x>this.bounceRangeX.max&&this.scrollToPixelXY(this.bounceRangeX.max,null,t),this.scrollBounceTimeout=null,this.bounceCompleteTime=e+t},adjustWindowScale:function(){var e=this.canvasSize(),t=10*this.physicalScaleFactor+"px";this.viewport=new ATRect(this.viewport.origin.x,this.viewport.origin.y,e.width,e.height),this.layers.timeline_content_svg.attr("viewBox","0 0 "+e.width+" "+e.height),this.d3El.select(".laneNavSvgWrap").attr("viewBox","0 0 28 "+e.height),this.layers.header_svg.attr("viewBox","0 0 "+e.width+" "+TimelineDisplayConstants.timeHeaderHeight),d3.select(".contextBarWrap").attr("viewBox","0 0 "+e.width+" "+TimelineDisplayConstants.contextHeight),d3.select("html").style("font-size",t),this.relationshipView&&this.relationshipView.adjustWindowScale()},resizeWindow:function(e,t){return this.holdRendering(),this.adjustWindowScale(),this.calculateContextScale(),this.immediateContextBarReturn(0,0),this.renderFlags.viewport=!0,this.renderIfRequired(),t||window.mainApp.adjustFilterBar(!1),window.mainApp.onboarding.repositionOnboardingElements(),this.calcScrollLimits(),this.releaseRendering(),e&&e.preventDefault(),!1},clickHandler:function(e){var t=this.rawMousePositionToScaledCanvasPosition(new ATPoint(e.clientX,e.clientY)),i=this.relativeToAbsolutePoint(t),n=this.model.laneForAbsoluteY(i.y);t.x<TimelineDisplayConstants.laneMarginWidth&&Math.abs(i.y-n.get("top"))<20&&this.toggleLane(n.id)},dblClickHandler:function(){var e=d3.event,t=isNaN(e.clientX)?new ATPoint(e.touches[0].clientX,e.touches[0].clientY):new ATPoint(e.clientX,e.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=this.relativeToAbsolutePoint(i),s=this.model.laneForAbsoluteY(n.y),o=this.model.eventNodeForAbsolutePosition(n,!0),r=this.viewport.size.height-TimelineDisplayConstants.navFooterHeight,a=this.model.eventNodeForAbsolutePosition(n,!0);if(!a&&0==window.isAeonWebExport)if(i.y>r);else if(i.x<TimelineDisplayConstants.laneMarginWidth);else{var l=this.roundedDateForPixel(n.x);window.mainApp.showAddEventModal(l,s.id,o?o.id:-1)}},toggleLane:function(e){var t,i,n=this,s=this.model.lanes.get(e);this.holdRendering(),this.timelinePainter.verticalAnimateToggledLaneIds.push(e),s.get("collapsed")?s.set("collapsed",!1):(s.set("collapsed",!0),t=this.absoluteToRelativePoint(new ATPoint(0,s.get("top"))),t.y<TimelineDisplayConstants.timeHeaderHeight&&(i=s.get("top")-TimelineDisplayConstants.timeHeaderHeight,n.scrollTopToPoint(i))),window.ApplicationInterface&&window.ApplicationInterface.setLaneCollapsedState(window.timelineDocumentId,parseInt(e),s.get("collapsed")),this.releaseRendering()},toggleMoreEventInfo:function(e){var t=this.model.lanes.get(e.laneId),i=t.nodes.findNode(e.id);this.holdRendering(),i.get("showMore")?i.set("showMore",!1):i.set("showMore",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},setShowMoreEventInfo:function(e,t){var i=this.model.lanes.get(t),n=i?i.nodes.findNode(e):null;i&&n&&(this.holdRendering(),n.set("showMore",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())},toggleShowChildNodes:function(e,t){function i(e,t,i,s){return function(){var o=d3.interpolateNumber(e,t);return function(r){d.holdRendering();var a=o(r);e>t&&t>a?a=t:t>e&&a>t&&(a=t),d.zoomToScaleAtPoint(a,i,s),d.releaseRendering(),a==t&&(d.holdRendering(),n.set("showChildNodes",!0),d.renderFlags.calculate=!0,d.renderFlags.data=!0,d.releaseRendering())}}}var n,s,o,r,a,l,h,d=this,c=isNaN(d3.event.clientX)?new ATPoint(d3.event.touches[0].clientX,d3.event.touches[0].clientY):new ATPoint(d3.event.clientX,d3.event.clientY),g=c,u=this.el.getBoundingClientRect().width,v=g.x<u/2,m=(this.relativeToAbsolutePoint(g),this.model.laneForEntityId(t));m&&(n=m.nodes.findNode(e),n&&(s=n.get("event"),s.children.length>0&&(n.get("showChildNodes")?(this.holdRendering(),n.set("showChildNodes",!1),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()):(o=s.get("endTS")-s.get("startTS"),r=this.model.get("unitScale"),a=0==o?r:o/TimelineDisplayConstants.animatedExpansionParentWidth,a<this.minimumUnitScale&&(a=this.minimumUnitScale),l=v?s.get("startTS")/r:s.get("endTS")/r,l-=this.viewport.origin.x,l*=this.physicalScaleFactor,h=g.y,r>a?d3.transition().duration(1e3).tween("animatedZoom",i(r,a,l,h)):(this.holdRendering(),n.set("showChildNodes",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()))),d3.event.sourceEvent&&(d3.event.sourceEvent.stopPropagation(),d3.event.sourceEvent.cancelBubble()),d3.event.stopPropagation()))},setShowChildNodes:function(e,t){var i=this.model.lanes.get(t),n=i?i.nodes.findNode(e):null;i&&n&&(this.holdRendering(),n.set("showChildNodes",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())},revealChildNode:function(e){function t(t,n){return function(){var s=d3.interpolateNumber(t,n);return function(o){h.holdRendering();var r=s(o);
if(t>n&&n>r?r=n:n>t&&r>n&&(r=n),h.zoomToScale(r),h.releaseRendering(),r==n){for(h.holdRendering(),i=m.length-1;i>=0;i--)h.setShowChildNodes(m[i],g.id);h.releaseRendering(),h.calculateIfRequired(),h.scrollToEventsIfOffScreen([e])}}}}for(var i,n,s,o,r,a,l,h=this,d=this.timeline.get("events"),c=this.model.findNodeForEventId(e),g=c.get("lane"),u=d.findChild(e),v=u.get("parentId"),m=[],r=this.model.get("unitScale");-1!=v&&(s=g.nodes.findNode(v),!s.get("showChildNodes"));)m.push(v),n=d.findChild(v),v=n.get("parentId");for(i=m.length-1;i>=0;i--)v=m[i],n=d.findChild(v),o=n.get("endTS")-n.get("startTS"),a=0==o?r:o/TimelineDisplayConstants.animatedExpansionParentWidth,a<this.minimumUnitScale&&(a=this.minimumUnitScale),(!l||l>a)&&(l=a);if(l&&l!=r)d3.transition().duration(1e3).tween("animatedZoom",t(r,l));else{for(i=m.length-1;i>=0;i--)this.setShowChildNodes(m[i],g.id);this.calculateIfRequired(),this.scrollToEventsIfOffScreen([e])}},collapseAllLanes:function(){var e=this;this.holdRendering(),this.model.lanes.each(function(t){t.get("collapsed")||e.toggleLane(t.id)}),this.releaseRendering()},expandAllLanes:function(){var e=this;this.holdRendering(),this.model.lanes.each(function(t){t.get("collapsed")&&e.toggleLane(t.id)}),this.releaseRendering()},hideSelectedEventDetails:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&i.set("showMore",!1)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},hideAllEventDetails:function(){this.holdRendering(),this.model.hideAllEventDetails(),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},showSelectedEventDetails:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&!i.get("showChildNodes")&&i.set("showMore",!0)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},expandSelectedParentEvents:function(){function e(e,n){return function(){var s=d3.interpolateNumber(e,n);return function(o){t.holdRendering();var a=s(o);e>n&&n>a?a=n:n>e&&a>n&&(a=n),t.zoomToScaleAtPoint(a,r.x,r.y),a==n&&(_.each(i,function(e){e.set("showChildNodes",!0)}),t.renderFlags.calculate=!0,t.renderFlags.data=!0),t.releaseRendering()}}}var t=this,i=[],n=this.model.get("unitScale"),s=this.timeline.get("events"),o=n,r=null;_.each(this.timeline.selectedEvents,function(e){var a=s.findChild(e);if(a.children.length){var l=a.get("endTS")-a.get("startTS"),h=l?l/TimelineDisplayConstants.animatedExpansionParentWidth:n;o>h&&(o=h),t.model.lanes.each(function(e){var n=e.nodes.findNode(a);n&&!n.get("showChildNodes")&&(i.push(n),r=t.absoluteToRelativePoint(n.get("totalRect").origin))})}}),i.length&&r&&(this.holdRendering(),n>o?d3.transition().duration(1e3).tween("animatedZoom",e(n,o)):(_.each(i,function(e){e.set("showChildNodes",!0)}),this.renderFlags.calculate=!0,this.renderFlags.data=!0),this.releaseRendering())},collapseSelectedParentEvents:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&i.get("showChildNodes")&&i.set("showChildNodes",!1)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},addBookmark:function(){window.mainApp.showAddBookmarkModal()},addFilter:function(){window.ApplicationInterface&&window.ApplicationInterface.addFilter(window.timelineDocumentId)},filterClick:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e.uniqueId)},boundsForAddFilterDiv:function(){var e=$("#filterBarAdd"),t=null;return e&&(t=e[0].getBoundingClientRect()),t?t.left+" "+t.right+" "+t.bottom+" "+t.top:""},boundsForManageFilterDiv:function(){var e=$("#filterBarManage"),t=null;return e&&(t=e[0].getBoundingClientRect()),t?t.left+" "+t.right+" "+t.bottom+" "+t.top:""},removeFilter:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilter(window.timelineDocumentId,e.scope+":"+e.value)},manageFilters:function(e){window.ApplicationInterface&&window.ApplicationInterface.manageFilters(window.timelineDocumentId)},viewDragStarted:function(e){d3.event.sourceEvent.touches||1!=window.isAeonWebExport&&(this.clearRequired=!0)},viewDragged:function(e){if(!d3.event.sourceEvent.touches){var t,i,n=null!=d3.event.sourceEvent.touches,s=n?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.x,d3.event.sourceEvent.y),o=this.rawMousePositionToScaledCanvasPosition(s),r=o.x,a=o.y,l=0;if(1==window.isAeonWebExport)return void this.grabScrolled(r,a);this.grabScrollDrag=!1,this.draggingEvent||(this.holdRendering(),this.clearRequired=!1,this.dragBoxBounds||(this.dragStartAbsPos=this.relativeToAbsolutePoint(new ATPoint(r,a)),this.dragBoxBounds=new ATRect(r,a,0,0)),this.updateViewDragBox(r,a),this.viewDragClientPos&&(l=r-this.viewDragClientPos.x),this.viewDragClientPos=new ATPoint(r,a),t=this.viewport.size.width,i=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,70>r&&0>=l&&(this.dragScrollIncrementX=-10),70>a&&(this.dragScrollIncrementY=-10),r>t-30&&l>=0&&(this.dragScrollIncrementX=10),a>i-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementX||this.dragScrollIncrementY?(this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.viewDragTick=this.viewDraggedNearEdge.bind(this),window.setTimeout(this.viewDragTick,5)):this.viewDragTick&&(this.viewDragTick=null),this.releaseRendering(),this.timelinePainter.drawDragBox())}},updateViewDragBox:function(e,t){var i,n,s,o=this.absoluteToRelativePoint(this.dragStartAbsPos),r=this.dragBoxBounds;r.origin.x=Math.min(e,o.x),r.origin.y=Math.min(t,o.y),r.size.width=Math.max(e,o.x)-r.origin.x,r.size.height=Math.max(t,o.y)-r.origin.y,i=this.relativeToAbsolutePoint(new ATPoint(r.left(),r.top())),n=this.relativeToAbsolutePoint(new ATPoint(r.right(),r.bottom())),s=new ATRect(i.x,i.y,n.x-i.x,n.y-i.y),this.model.selectEventsInRect(s)},viewDraggedNearEdge:function(){1!=window.isAeonWebExport&&this.viewDragTick&&(this.holdRendering(),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.updateViewDragBox(this.viewDragClientPos.x,this.viewDragClientPos.y),this.viewDragTick&&window.setTimeout(this.viewDragTick,15),this.releaseRendering(),this.timelinePainter.drawDragBox())},viewDragEnded:function(e){if(this.viewDragTick=null,!d3.event.sourceEvent.touches){if(this.grabScrollDrag)return void this.grabScrollEnded();this.holdRendering(),this.clearRequired&&this.timeline.clearSelection(),null!=this.dragBoxBounds&&(this.dragBoxBounds=null,this.timelinePainter.drawDragBox()),this.releaseRendering()}},grabScrolled:function(e,t,i){if(e&&t){var n=new ATPoint(e,t),s=new ATPoint(0,0);window.isAeonWebExport&&$("html,body").css("cursor","move"),this.grabScrollDrag=!0,this.holdRendering(),this.grabScrollViewOrigin||(this.grabScrollMoveOrigin=new ATPoint(e,t),this.grabScrollViewOrigin=new ATPoint(this.viewport.origin.x,this.viewport.origin.y)),i||(e=this.grabScrollMoveOrigin.x-n.x,t=this.grabScrollMoveOrigin.y-n.y),s.x=this.grabScrollViewOrigin.x+e,s.y=this.grabScrollViewOrigin.y+t,this.scrollTopLeftToPoint(s.x,s.y),this.releaseRendering()}},grabScrollEnded:function(){null!=this.grabScrollMoveOrigin&&(this.grabScrollMoveOrigin=null,this.grabScrollViewOrigin=null,$("html,body").css("cursor","default")),this.grabScrollDrag=!1},dropSyncItem:function(e,t,i){var n=this.clientXLeftOfSyncBinder(t),s=this.clientYBelowFilterBar(i),o=new ATPoint(n,s),r=this.relativeToAbsolutePoint(o),a=this.roundedDateForPixel(r.x),l=this.timeline.rangeConversion.naturalStringFromValue(a,!1),h=this.model.laneForAbsoluteY(r.y),d=h?parseInt(h.id):-1;window.ApplicationInterface&&window.ApplicationInterface.createEventsFromSyncItems(window.timelineDocumentId,e,l,d)},eventNodeDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches,i=d3.event.sourceEvent.altKey,n=d3.event.sourceEvent.shiftKey,s=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,o=i&&!n;if(this.eventNodeDragStartTimestamp=d3.event.sourceEvent.timeStamp,t&&d3.event.sourceEvent.touches.length>1||this.disablePan)return void(this.eventDragDisabled=!0);if(1!=window.isAeonWebExport){this.eventDragDisabled=!1;var r=this.model.lanes.get(e.laneId).get("top"),a=new ATPoint(o?e.stopPixel:e.startPixel,e.totalRect.origin.y+r),l=this.absoluteToRelativePoint(a),h=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),d=this.rawMousePositionToScaledCanvasPosition(h);this.holdRendering(),this.draggingEvent=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.dragEventForPositionAllowed=!1,this.draggingEventForEndPosition=!1,this.eventDragStartPos=null,this.eventDragEndPos=this.eventDragStartPos,this.eventDragOffsetX=l.x-d.x,this.eventDragOffsetY=l.y-d.y,this.eventDraggingNode=e,this.eventDragFarEnough=!1,n&&i?(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceStartPos=this.relativeToAbsolutePoint(d)):n||s?(this.clickedEventWasOriginallySelected=e.selected,e.selected?n&&this.timeline.unselectEventWithID(e.id):this.timeline.selectEventWithID(e.id)):t||e.selected||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)),this.eventDragStartedWithRightClick=2==d3.event.sourceEvent.button,this.eventDragStartedWithRightClick||(this.dragEventForPositionAllowed=this.timeline.selectedEventsDraggable(),this.eventDragTooltip||(this.eventDragTooltip=new Opentip($("#mainTimelineCanvas"),{style:"eventDragTooltipStyle"}))),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.releaseRendering()}},eventNodeDragged:function(e){var t=d3.event.sourceEvent.timeStamp-this.eventNodeDragStartTimestamp;if(!(this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan||this.eventDragStartedWithRightClick||2==d3.event.sourceEvent.button)){if(!this.timeline.isEventWithIdSelected(e.id)){if(t<TimelineDisplayConstants.touchEventMinimumHoldTimeBeforeMove)return void(this.eventDragDisabled=!0);this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)}if(this.eventDragDisabled=!1,1!=window.isAeonWebExport){var i,n,s,o,r,a,l,h,d,c,g=this,u=d3.event.sourceEvent.altKey,v=d3.event.sourceEvent.shiftKey,m=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,p=0;if(this.holdRendering(),this.draggingEvent){if(o=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),r=this.rawMousePositionToScaledCanvasPosition(o),a=r.x,l=r.y,i=new ATPoint(a+this.eventDragOffsetX,l+this.eventDragOffsetY),n=this.relativeToAbsolutePoint(i),s=this.relativeToAbsolutePoint(new ATPoint(a,l)),n.y=s.y,this.eventDragEndPos&&(p=n.x-this.eventDragEndPos.x),this.eventDragEndPos=n,this.eventDragEndLane=this.model.laneForAbsoluteY(s.y),this.eventDragStartPos||(this.eventDragStartPos=n,this.eventDragStartingLane=this.eventDragEndLane),window.mainApp.syncBinderVisible&&0>a){if(!this.eventDragIntoBinder){var w,f={jstree:!0,draggingEvents:!0,obj:$(this),nodes:[]};_.each(this.timeline.selectedEvents,function(e){var t=g.timeline.get("events").findChild(e);f.nodes.push({id:!0,text:t.get("title"),eventId:t.id}),w=t.get("title")}),this.timeline.selectedEvents.length>1&&(w="Sync "+this.timeline.selectedEvents.length+" new events"),$.vakata.dnd.start(d3.event.sourceEvent,f,'<div id="jstree-dnd" class="jstree-default"><i class="jstree-icon jstree-er"></i>'+w+"</div>"),this.eventDragIntoBinder=!0}this.eventDragTick=null,this.viewDragTick=null,this.eventNodeDragEnded(e),window.mainApp.onboarding.removeOnboardingMessage("scriv-dragevent-in")}else this.eventDragIntoBinder=!1,c=Math.abs(this.eventDragStartPos.x-n.x)+Math.abs(this.eventDragStartPos.y-n.y),c>5&&(this.eventDragFarEnough=!0),u&&v?(this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceFromNode||(this.eventDragMeasureDistanceFromNode=this.eventDragStartingLane.nodes.findNode(e.id)),this.eventDragMeasureDistanceToNode=this.model.eventNodeForAbsolutePosition(s,!0),this.eventDragMeasureDistanceEndPos=s,this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.eventDragMeasureDistanceToNode&&this.timeline.selectEventWithID(this.eventDragMeasureDistanceToNode.id)):this.draggingEventForEndPosition||u?(this.draggingEventForEndPosition=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1):m?(this.draggingEventForParent=!0,this.draggingEventForEndPosition=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragTargetEventDrop=this.model.eventNodeForAbsolutePosition(s,!0),!this.eventDragTargetEventDrop||this.eventDragTargetEventDrop.id!=e.id&&this.timeline.selectedEventsCanHaveParent(this.eventDragTargetEventDrop.id)||(this.eventDragTargetEventDrop=null),this.eventDragChangingParent=!0):(this.draggingEventForEndPosition=!1,this.draggingEventForParent=!1,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragEndLane!=this.eventDragStartingLane?(this.draggingEventForLane=!0,this.draggingEventForPosition=!1):(this.draggingEventForLane=!1,this.dragEventForPositionAllowed?this.draggingEventForPosition=!0:this.draggingEventForPosition=!1)),h=this.viewport.size.width,d=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,70>a&&0>=p&&(this.dragScrollIncrementX=-10),70>l&&(this.dragScrollIncrementY=-10),a>h-30&&p>=0&&(this.dragScrollIncrementX=10),l>d-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementX||this.dragScrollIncrementY?(this.draggingEventForParent&&(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1),this.d3EventPt=i,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.eventDragTick=this.eventNodeDraggedNearEdge.bind(this),window.setTimeout(this.eventDragTick,5)):this.eventDragTick&&(this.eventDragTick=null);d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()}this.eventDragFarEnough&&(this.eventNodeDraggedCalculateActions(),this.timelinePainter.drawMoveEventLine()),this.releaseRendering()}}},eventNodeDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e;this.holdRendering(),e=this.relativeToAbsolutePoint(this.d3EventPt),this.eventDragEndPos=e,this.eventDragEndLane=this.model.laneForAbsoluteY(e.y),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.draggingEventForParent?(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1):this.draggingEventForDistanceMeasure&&(this.eventDragMeasureDistanceToNode=null),this.eventDragTick&&window.setTimeout(this.eventDragTick,15),this.eventDragFarEnough&&(this.draggingEvent&&this.eventNodeDraggedCalculateActions(),this.timelinePainter.drawMoveEventLine()),this.releaseRendering()}},eventNodeDraggedCalculateActions:function(){var e,t,i,n,s,o,r,a,l,h,d,c,g,u,v,m="tooltipNormal",p=this.eventDraggingNode;if(this.draggingEventForDistanceMeasure)this.eventDragMeasureDistanceToNode?(d=this.eventDragMeasureDistanceFromNode.get("event"),c=this.eventDragMeasureDistanceToNode.get("event"),d!=c?(c.get("startTS")>d.get("endTS")?(g=this.timeline.rangeConversion.valueFromTimestamp(d.get("endTS")),t="end"):(g=this.timeline.rangeConversion.valueFromTimestamp(d.get("startTS")),t="start"),u=this.timeline.rangeConversion.valueFromTimestamp(c.get("startTS")),v=this.timeline.rangeConversion.spanBetweenValues(g,u),e="Distance from "+t+" of event: "+v.toString()):e="Hover over event to measure distance between events"):e="Hover over event to measure distance between events";else if(this.draggingEventForParent)e=this.eventDragTargetEventDrop?'Make child of "'+this.eventDragTargetEventDrop.get("event").get("title")+'"':"Drop on event to become child";else if(this.draggingEventForLane)e="Add relationship to "+this.eventDragEndLane.get("entity").get("name");else if(this.draggingEventForPosition||this.draggingEventForEndPosition)1==this.timeline.selectedEvents.length&&(o=this.model.eventNodeForSnapDrag(p.id,this.eventDragStartingLane.id,this.eventDragEndPos,this.viewport)),o?(r=this.timeline.get("events").findChild(o.node.id),a="start"==o.location?r.get("startTS"):r.get("endTS"),l=o.node.get("lane").get("top"),h=l+o.node.get("totalRect").origin.y+o.node.get("markerRect").centerY(),this.snapDragLine=new ATLine(o.xValue,h-TimelineDisplayConstants.snapDragLineLength/2,o.xValue,h+TimelineDisplayConstants.snapDragLineLength/2),this.snapDragLineColor=r.get("color"),e="Snap "+(this.draggingEventForEndPosition?"end ":"")+" to "+o.location+' of "'+r.get("title")+'"',e+="<br />New "+(this.draggingEventForEndPosition?"end ":"")+"date: "+this.timeline.rangeConversion.naturalStringFromValue(a,!0)):(this.snapDragLine=null,i=this.eventDragEndPos.x-this.eventDragStartPos.x,n=ATUtilities.floatToInt(i*this.model.get("unitScale")),s=this.timeline.rangeConversion.roundedSpanForUnitsAtScale(n,this.model.get("unitScale")),value=this.draggingEventForEndPosition?this.timeline.endDateAfterDraggingEvent(p.id,s):this.timeline.dateAfterDraggingEvent(p.id,s),e="Shift event "+(this.draggingEventForEndPosition?"end ":"")+"by "+s.toString()+" to "+this.timeline.rangeConversion.naturalStringFromValue(value,!0),this.timeline.selectedEvents.length>1&&(e+="<br />(Multiple events are selected)"));else{if(!this.draggingEvent||this.dragEventForPositionAllowed)return;e="Cannot drag dependent events. Move its predecessor instead.",m="tooltipError"}e='<span class="'+m+'">'+e+"</span>",this.eventDragTooltip.setContent(e),this.eventDragTooltip.prepareToShow()},eventNodeDragEnded:function(e){var t=(d3.event.sourceEvent.altKey,d3.event.sourceEvent.shiftKey),i=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey;if(this.eventDragStartedWithRightClick||this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan)return this.eventDragStartedWithRightClick=!1,this.eventDragDisabled=!1,this.eventDragTick=null,this.draggingEvent=!1,this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,void this.timelinePainter.drawMoveEventLine();if(this.eventDragDisabled=!1,1!=window.isAeonWebExport){if(this.eventDragTick=null,this.draggingEvent=!1,this.holdRendering(),!this.eventDragIntoBinder){var n,s,o,r,a,l,h,d=this.timeline.selectedEvents.join(),c=this.eventDragEndPos?this.eventDragEndPos.x-this.eventDragStartPos.x:null;if(this.eventDragIntoBinder=!1,this.eventDragFarEnough)if(this.draggingEventForParent&&this.eventDragChangingParent)window.ApplicationInterface&&(n=this.eventDragTargetEventDrop?this.eventDragTargetEventDrop.id:-1,window.mainApp.showNewParentPromptIfNeeded(n,function(e){window.ApplicationInterface.moveEventsWithIdsToParent(window.timelineDocumentId,d,n,e)}));else if(this.draggingEventForLane&&this.eventDragEndLane!=this.eventDragStartingLane)window.ApplicationInterface&&window.ApplicationInterface.copyEventsWithIdsToLane(window.timelineDocumentId,d,parseInt(this.eventDragEndLane.id));else if((this.draggingEventForEndPosition||this.draggingEventForPosition)&&c){if(window.ApplicationInterface)if(1==this.timeline.selectedEvents.length&&(s=this.model.eventNodeForSnapDrag(e.id,this.eventDragStartingLane.id,this.eventDragEndPos,this.viewport)),s){o=this.timeline.get("events").findChild(s.node.id),r="start"==s.location?o.get("startTS"):o.get("endTS"),a=o.get("precision");var g=""+r;this.draggingEventForPosition?window.ApplicationInterface.moveEventWithIdToTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],g,a):this.draggingEventForEndPosition&&window.ApplicationInterface.resizeEventWithIdToEndTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],g,a)}else l=ATUtilities.floatToInt(c*this.model.get("unitScale")),h=this.timeline.rangeConversion.roundedSpanForUnitsAtScale(l,this.model.get("unitScale")),this.draggingEventForPosition?h.hasOwnProperty("years")?window.ApplicationInterface.moveEventsWithIdsBySpan(window.timelineDocumentId,d,""+h.years,""+h.months,""+h.weeks,""+h.days,""+h.hours,""+h.minutes,""+h.seconds):window.ApplicationInterface.moveEventsWithIdsByValue(window.timelineDocumentId,d,h):this.draggingEventForEndPosition&&(h.hasOwnProperty("years")?window.ApplicationInterface.resizeEventsWithIdsBySpan(window.timelineDocumentId,d,""+h.years,""+h.months,""+h.weeks,""+h.days,""+h.hours,""+h.minutes,""+h.seconds):window.ApplicationInterface.resizeEventsWithIdsByValue(window.timelineDocumentId,d,h))}else t||i||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id));else i&&this.clickedEventWasOriginallySelected?this.timeline.unselectEventWithID(e.id):t||i||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id))}this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,this.timelinePainter.drawMoveEventLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.eventDragTooltip.hide(),this.eventDragTooltip.deactivate(),this.releaseRendering()}},laneDragStarted:function(e){var t=null!=d3.event.sourceEvent.touches;1==window.isAeonWebExport||t||e.id<0||(this.draggingLane=!0,this.laneDragStartPos=null,this.laneDragEndLane=null,this.laneDragEndPos=this.laneDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.holdRendering(),this.timeline.clearSelection(),this.releaseRendering())},laneDragged:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i,n,s,o,r,a,l;e.id<0||this.draggingLane&&(i=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),n=this.rawMousePositionToScaledCanvasPosition(i),s=this.relativeToAbsolutePoint(n),o=n.y,l=this.model.laneForAbsoluteY(s.y),l.id>=0&&(this.laneDragEndLane=l),this.laneDragEndPos=s,this.laneDragStartPos||(this.laneDragStartPos=s,this.laneDragStartingLane=this.laneDragEndLane),r=this.viewport.size.width,a=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,70>o&&(this.dragScrollIncrementY=-10),o>a-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.d3EventPt=n,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.laneDragTick=this.laneDraggedNearEdge.bind(this),window.setTimeout(this.laneDragTick,5)):this.laneDragTick&&(this.laneDragTick=null),this.timelinePainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},laneDraggedNearEdge:function(){if(1!=window.isAeonWebExport){var e,t;e=this.relativeToAbsolutePoint(this.d3EventPt),this.laneDragEndPos=e,t=this.model.laneForAbsoluteY(e.y),t.id>=0&&(this.laneDragEndLane=t),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.laneDragTick&&(this.timelinePainter.drawMoveLaneLine(),window.setTimeout(this.laneDragTick,15))}},laneDragEnded:function(e){var t=null!=d3.event.sourceEvent.touches;if(1!=window.isAeonWebExport&&!t){var i=e.id;e.id<0||(this.laneDragTick=null,this.draggingLane=!1,this.laneDragEndLane&&this.laneDragEndLane.id!=i&&window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,parseInt(i),parseInt(this.laneDragEndLane.id)),this.laneDragEndPos=null,this.laneDragStartingLane=null,this.laneDragEndLane=null,this.timelinePainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())}},clickInScrollTrack:function(){function e(e,i,n,s){return function(){var e=d3.interpolateNumber(n,s);return function(i){t.scrollTopToPoint(e(i))}}}var t=this,i=TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,n=(this.viewport.size.height-i-TimelineDisplayConstants.navFooterHeight,isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY),s=this.clientYBelowFilterBar(n)-i,o=this.rangeY.min+s/(this.viewport.size.height-i-TimelineDisplayConstants.navFooterHeight)*(this.rangeY.max-this.rangeY.min);d3.transition().duration(this.timelinePainter.transitionDuration).tween("animatedscroll",e(this.viewport.origin.x,this.viewport.origin.x,this.viewport.origin.y,o)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragStarted:function(e){this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragged:function(e){var t,i=this,n=isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY,s=this.clientYBelowFilterBar(n),o=TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,r=(i.viewport.top()+o,i.viewport.size.height-o-TimelineDisplayConstants.navFooterHeight),a=i.rangeY.max-TimelineDisplayConstants.navFooterHeight;this.verticalScrollDragStartY||(this.verticalScrollDragStartY=s?s:1,this.verticalScrollDragStartAbsY=i.viewport.top()),t=this.verticalScrollDragStartAbsY+(s-this.verticalScrollDragStartY)/this.physicalScaleFactor/r*a,this.scrollTopToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null},contextLensDragStarted:function(e){var t=this.contextRightLensPixel-this.contextLeftLensPixel,i=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),n=this.rawMousePositionToScaledCanvasPosition(i);this.contextDragOffsetX=n.x-this.contextLeftLensPixel,this.contextDragZoomFromLeft=!1,this.contextDragZoomFromRight=!1,this.contextDragOffsetX<TimelineDisplayConstants.contextLensResizeGrabWidth?this.contextDragZoomFromLeft=!0:this.contextDragOffsetX>t-TimelineDisplayConstants.contextLensResizeGrabWidth&&(this.contextDragZoomFromRight=!0),this.contextDragZoomMinPhysicalWidth=TimelineDisplayConstants.contextLensDragMinGap,this.contextDragZoomMaxPhysicalWidth=this.viewport.size.width/2,this.minimumUnitScale&&(this.contextDragZoomMinPhysicalWidth=Math.max(TimelineDisplayConstants.contextLensDragMinGap,this.minimumUnitScale*this.viewport.size.width/this.contextUnitScale)),this.maximumUnitScale&&(this.contextDragZoomMaxPhysicalWidth=Math.min(this.contextDragZoomMaxPhysicalWidth,this.maximumUnitScale*this.viewport.size.width/this.contextUnitScale)),window.mainApp.onboarding.hideOnboardingMessage("scrollContext"),d3.transition().delay(0).duration(0).tween("animatedContextReturn",null),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},contextLensDragged:function(e){var t,i,n,s,o,r,a,l;t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=i.x,r=this.viewport.size.width,a=this.viewport.size.height,l=this.contextRightLensPixel-this.contextLeftLensPixel,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,0>n?this.dragScrollIncrementX=-40:n<TimelineDisplayConstants.contextLensMinMargin+20?this.dragScrollIncrementX=-10:n>r?this.dragScrollIncrementX=40:n>r-TimelineDisplayConstants.contextLensMinMargin-l-20&&(this.dragScrollIncrementX=10),this.contextDragZoomFromLeft?(this.contextLeftLensPixel=Math.max(Math.min(n,this.contextRightLensPixel-this.contextDragZoomMinPhysicalWidth),this.contextRightLensPixel-this.contextDragZoomMaxPhysicalWidth),this.timelinePainter.redrawContextLens()):this.contextDragZoomFromRight?(this.contextRightLensPixel=Math.min(Math.max(n,this.contextLeftLensPixel+this.contextDragZoomMinPhysicalWidth),this.contextLeftLensPixel+this.contextDragZoomMaxPhysicalWidth),this.timelinePainter.redrawContextLens()):this.dragScrollIncrementX?(this.contextDragClientX=this.dragScrollIncrementX<0?TimelineDisplayConstants.contextLensMinMargin:r-TimelineDisplayConstants.contextLensMinMargin,this.contextLensDragTick=this.contextLensDraggedNearEdge.bind(this),window.setTimeout(this.contextLensDragTick,5)):this.contextLensDragTick?this.contextLensDragTick=null:(s=(n-this.contextDragOffsetX)*this.contextUnitScale+this.contextLeftTS,o=s/this.model.get("unitScale"),this.scrollLeftToPoint(o)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},contextLensDraggedNearEdge:function(){this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.contextLensDragTick&&(this.timelinePainter.drawMoveEventLine(),window.setTimeout(this.contextLensDragTick,15))},contextLensDragEnded:function(e){this.contextLensDragTick=null,this.contextDragZoomFromLeft||this.contextDragZoomFromRight?this.zoomToContextLensBounds(this.contextLeftLensPixel,this.contextRightLensPixel):this.animateContextBarReturn(500,1e3),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},scrollToLane:function(e){return this.viewMode==ATViewMode.RELATIONSHIP_VIEW?void this.relationshipView.scrollToLane(e):void this.scrollToPixelXY(null,e.top-TimelineDisplayConstants.timeHeaderHeight,this.timelinePainter.transitionDuration)},scrollToNode:function(e){return this.viewMode==ATViewMode.RELATIONSHIP_VIEW?void this.relationshipView.scrollToNode(e):void this.scrollToPixelXY(e.get("totalRect").origin.x-this.viewport.size.width/2,e.get("lane").get("top")+e.get("totalRect").origin.y-this.viewport.size.height/2,1e3)},scrollToNodeIfOffScreen:function(e){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.scrollToNodeIfOffScreen(e);var t,i,n=e.get("lane");n.get("collapsed")&&this.toggleLane(n.id),
t=this.viewport.deepCopy(),t.size.height-=TimelineDisplayConstants.navFooterHeight+TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.filterBarHeight,i=e.get("totalRect").deepCopy(),i.origin.y+=e.get("lane").get("top"),t.containsRect(i)||this.scrollToNode(e)},scrollToEventsIfOffScreen:function(e){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.scrollToEventsIfOffScreen(e);var t,i=this.model.findAllNodesForEventIds(e),n=!1,s=null;t=this.viewport.deepCopy(),t.size.height-=TimelineDisplayConstants.navFooterHeight+TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.filterBarHeight,_.each(i,function(e){var i=e.get("lane"),o=e.get("totalRect").deepCopy();o.origin.y+=e.get("lane").get("top"),i.get("collapsed")||(t.containsRect(o)?n=!0:s=e)},this),n||(s?this.scrollToNode(s):i.length>0&&(this.toggleLane(i[0].get("lane").id),this.scrollToNode(i[0])))},scrollToTimestamp:function(e){var t=this.model.get("unitScale");this.scrollToPixelXY(e/t-this.viewport.size.width/2,null,1e3)},scrollToPixelXY:function(e,t,i){function n(i,n,o,r){return function(){var a=d3.interpolateNumber(i,n),l=d3.interpolateNumber(o,r);return function(i){s.holdRendering(),s.scrollTopLeftToPoint(a(i),l(i)),s.immediateContextBarReturn(),a(i)==e&&l(i)==t&&(s.gestureCallReceivedFromCpp||(s.lastWheelTime=null)),s.releaseRendering()}}}var s=this;null==e&&(e=this.viewport.origin.x),null==t&&(t=this.viewport.origin.y),i||(i=1e3),d3.transition().duration(i).tween("animatedscroll",n(this.viewport.origin.x,e,this.viewport.origin.y,t)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},scrollPageDown:function(){var e=this.viewport.size.height-TimelineDisplayConstants.navFooterHeight-TimelineDisplayConstants.timeHeaderHeight-TimelineDisplayConstants.lifetimeHeight;this.scrollToPixelXY(null,this.viewport.origin.y+e)},scrollPageUp:function(){var e=this.viewport.size.height-TimelineDisplayConstants.navFooterHeight-TimelineDisplayConstants.timeHeaderHeight-TimelineDisplayConstants.lifetimeHeight;this.scrollToPixelXY(null,this.viewport.origin.y-e)},animatedZoomToUnitScale:function(e,t){function i(e,t){return function(){var i=d3.interpolateNumber(e,t);return function(s){n.holdRendering();var o=i(s);e>t&&t>o?o=t:t>e&&o>t&&(o=t),n.zoomToScale(o),n.releaseRendering()}}}var n=this,s=this.model.get("unitScale");t||(t=1e3),e!=s&&(d3.transition().duration(t).tween("animatedZoom",i(s,e)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()))},animatedZoomToFit:function(){function e(e,t){return function(){var n=d3.interpolateNumber(e,t);return function(s){var o=n(s);i.holdRendering(),e>t&&t>o?o=t:t>e&&o>t&&(o=t),i.zoomToScale(o),i.releaseRendering()}}}function t(e){return function(){var t=d3.interpolateNumber(i.viewport.origin.x,e);return function(e){i.holdRendering(),i.scrollLeftToPoint(t(e)),i.immediateContextBarReturn(),i.releaseRendering()}}}var i=this,n=this.model.findEarliestEventNode(),s=this.model.findLatestEventNode(!0),o=s.get("totalRect").size.width,r=n.get("event").get("startTS"),a=s.get("event").get("endTS"),l=a-r,h=this.viewport.size.width-o-80,d=this.model.get("unitScale"),c=l/h,g=(r+a)/2+o*c/2;targetPixel=g/d-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedScrollToPoint",t(targetPixel)).transition().duration(1e3).tween("animatedZoom",e(d,c))},contextBarClick:function(){var e,t,i,n;e=this.rawMousePositionToScaledCanvasPosition(new ATPoint(d3.event.clientX,d3.event.clientY)),t=e.x-(this.contextRightLensPixel-this.contextLeftLensPixel)/2,i=t*this.contextUnitScale+this.contextLeftTS,n=i/this.model.get("unitScale"),this.scrollToPixelXY(n,null,500)},bookmarkClick:function(e){function t(e,t){return function(){var i=d3.interpolateNumber(e,t);return function(n){var o=i(n);s.holdRendering(),e>t&&t>o?o=t:t>e&&o>t&&(o=t),s.zoomToScale(o),s.releaseRendering()}}}function i(e){return function(){var t=d3.interpolateNumber(s.viewport.origin.x,e);return function(e){s.holdRendering(),s.scrollLeftToPoint(t(e)),s.immediateContextBarReturn(),s.releaseRendering()}}}if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.bookmarkClick(e);var n,s=this,o=e.timestamp,r=e.scale,a=this.model.get("unitScale");r==a?(n=o/r-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedScrollToPoint",i(n))):r>=a?(n=o/r-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedZoom",t(a,r)).transition().duration(1e3).tween("animatedScrollToPoint",i(n))):(n=o/a-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedScrollToPoint",i(n)).transition().duration(1e3).tween("animatedZoom",t(a,r))),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoFirstBookmark:function(){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.gotoFirstBookmark();var e=this.model.findEarliestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoLastBookmark:function(){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.gotoLastBookmark();var e=this.model.findLatestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoPreviousEvent:function(){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.gotoPreviousEvent();var e=this.model.findPreviousEventNodeBeforeTS(this.viewport.origin.x*this.model.get("unitScale"));e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoNextEvent:function(){if(this.viewMode==ATViewMode.RELATIONSHIP_VIEW)return void this.relationshipView.gotoNextEvent();var e=this.model.findNextEventNodeAfterTS(this.viewport.right()*this.model.get("unitScale"));e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},appendMeasurementDiv:function(){this.measurementDiv||(this.boundsElement=d3.select("#bounds"),this.measurementDiv=this.boundsElement.append("div").attr("class","eventContentWrapper measurement").attr("id","contentMeasurement"),this.measureDivDOM=document.getElementById("contentMeasurement"),this.d3MeasureDivTitle=this.measurementDiv.append("div").attr("class","eventTitle draggable").attr("id","contentMeasurementTitle").text(""),this.measureTitleDOM=document.getElementById("contentMeasurementTitle"),this.d3MeasureDivDate=this.measurementDiv.append("div").attr("class","eventDate draggable").attr("id","contentMeasurementDate").text("1 January 2014"),this.measureDateDOM=document.getElementById("contentMeasurementDate"),this.d3MeasureDivContent=this.measurementDiv.append("div").attr("class","expandedWrapper draggable").attr("id","contentMeasurementContent").text(""),this.measureContentDOM=document.getElementById("contentMeasurementContent"),this.entityMeasureDiv=this.boundsElement.append("div").attr("class","laneLabel measurement").attr("id","entityMeasurement"),this.entityMeasureDivDOM=document.getElementById("entityMeasurement"))},removeMeasurementDiv:function(){this.measurementDiv.remove(),this.measurementDiv=null,this.measureDivDOM=null,this.d3MeasureDivTitle=null,this.d3MeasureDivDate=null,this.d3MeasureDivContent=null,this.measureTitleDOM=null,this.entityMeasureDiv.remove(),this.entityMeasureDiv=null,this.entityMeasureDivDOM=null},calcEntityTextWidth:function(e){return this.entityMeasureDiv.text(e),this.entityMeasureDivDOM.offsetWidth},calcEventTextSize:function(e){var t,i,n,s=TimelineDisplayConstants.eventTextWrapSafetyBuffer*this.physicalScaleFactor;this.d3MeasureDivTitle.text(e.get("displayTitle")),this.d3MeasureDivDate.text(e.get("event").get("dateString")),this.d3MeasureDivContent.html(""),this.measurementDiv.classed("expanded",!1),t=new ATSize(this.measureTitleDOM.offsetWidth+s,this.measureTitleDOM.offsetHeight),i=t.copy(),i.height+=TimelineDisplayConstants.eventDateTextHeight*this.physicalScaleFactor,e.calcBigTextRequired&&e.get("showMore")&&(this.d3MeasureDivContent.html(e.get("contentHTML")),this.measurementDiv.classed("expanded",!0),n=new ATSize(this.measureDivDOM.offsetWidth+s,this.measureDivDOM.offsetHeight),n.scale(1/this.physicalScaleFactor),e.calcBigTextRequired=!1,e.set("bigTextSize",n)),t.scale(1/this.physicalScaleFactor),i.scale(1/this.physicalScaleFactor),e.set("smallTextSize",i),e.set("parentTextSize",t),e.calcEventTextRequired=!1,e.calcRects()},checkBrowser:function(){var e;return e=navigator.BrowserInfo=function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===i[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i.join(" "))}()},findFirst:function(e,t){this.searchString=e,this.currentSearchIndex=-1,this.eventList=[];var i=-1;if(this.eventList.length>0||(this.eventList=this.timeline.flattenedEventList(t)),!e)return this.timeline.clearSelection(),this.timelinePainter.highlightString=null,this.renderFlags.selection=!0,void this.renderIfRequired();if(this.timeline.rangeConversion){var n,s=this.timeline.rangeConversion.valueForPartialString(e,e.length,!1);if(s.matchFound)return n=this.timeline.rangeConversion.calendar?s.value.timestamp:s.value,this.scrollToTimestamp(n),this.timeline.clearSelection(),void(this.timelinePainter.highlightString=null)}for(var o=0;o<this.eventList.length;o++)if(this.eventList[o].matchString(e)){this.currentSearchIndex=o,i=this.eventList[o].id;break}if(this.searchString.length>0){var r={highlightString:this.searchString,scrollPosition:null,selectEventId:i};window.mainApp.applySearchResult(JSON.stringify(r),!0)}},findNext:function(){if(this.searchString&&this.eventList){var e=-1;for(this.currentSearchIndex++;this.currentSearchIndex<this.eventList.length;this.currentSearchIndex++)if(this.eventList[this.currentSearchIndex].matchString(this.searchString)){e=this.eventList[this.currentSearchIndex].id;break}if(this.searchString.length>0){var t={highlightString:this.searchString,scrollPosition:null,selectEventId:e};window.mainApp.applySearchResult(JSON.stringify(t),!0)}}},findPrevious:function(){if(this.searchString&&this.eventList){var e=-1;for(0!=this.currentSearchIndex&&this.currentSearchIndex--;this.currentSearchIndex>0;--this.currentSearchIndex)if(this.eventList[this.currentSearchIndex].matchString(this.searchString)){e=this.eventList[this.currentSearchIndex].id;break}if(this.searchString.length>0){var t={highlightString:this.searchString,scrollPosition:null,selectEventId:e};window.mainApp.applySearchResult(JSON.stringify(t),!0)}}},renderJsContextMenuWithItems:function(e){var t=this,i=JSON.parse(e),n=[],s=null,o=[],r=0;_.each(i,function(e){"-"==e.name?null!=s&&o.push(s):n.push({id:e.name,text:e.name,disabled:e.disabled}),s=e.name}),this.defaultContextMenu?(this.defaultContextMenu.clearAll(),this.defaultContextMenu.loadStruct(n),_.each(o,function(e){this.defaultContextMenu.addNewSeparator(e,"sep"+r),r++},this)):(this.defaultContextMenu=new dhtmlXMenuObject({context:!0,items:n}),_.each(o,function(e){this.defaultContextMenu.addNewSeparator(e,"sep"+r),r++},this),this.defaultContextMenu.setAutoShowMode(!1),this.defaultContextMenu.setAutoHideMode(!0),this.defaultContextMenu.setContextMenuHideAllMode(!1),this.defaultContextMenu.attachEvent("onClick",this.defaultContextMenuItemClick.bind(this))),setTimeout(function(){t.defaultContextMenu.showContextMenu(t.defaultContextMenuMouseLocation.x,t.defaultContextMenuMouseLocation.y)})},defaultContextMenuItemClick:function(e,t,i){var n=this.defaultContextMenu.getItemText(e);return window.ApplicationInterface&&window.ApplicationInterface.defaultContextMenuItemClicked(window.timelineDocumentId,n),!1},linkToAeonHome:function(){var e=window.open("https://github.com/kerim/anthro-timeline/","_blank");e?e.focus():alert("Please visit https://github.com/kerim/anthro-timeline/ for more information.")}});module.exports=ATTimelineView;
},{"../lib/dhtmlxmenu":5,"../lib/opentip":11,"./ATBounds":16,"./ATDisplayConstants":26,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATSize":79,"./ATTimelineViewPainter":89,"./ATUtilities":91,"./ATViewMode":92,"./templates/expandedEventContentPostamble.html":128,"./templates/expandedEventContentPreamble.html":129,"./templates/expandedEventImage.html":130,"./templates/expandedEventLinkList.html":131,"./templates/expandedEventPropertyBoolean.html":132,"./templates/expandedEventPropertyNumber.html":133,"./templates/expandedEventPropertyParagraph.html":134,"./templates/expandedEventPropertyPercentage.html":135,"./templates/expandedEventPropertyString.html":136,"./templates/expandedEventRoleList.html":137,"./templates/expandedEventTagList.html":138,"backbone":176,"d3":300,"hammerjs":301,"jquery":307,"lodash":309}],88:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEntityLaneList=require("./ATEntityLaneList"),ATEntity=require("./ATEntity"),ATDependencyPath=require("./ATDependencyPath"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATViewMode=require("./ATViewMode"),ATBounds=require("./ATBounds"),ATSize=require("./ATSize"),ATTimelineViewModel=Backbone.Model.extend({defaults:function(){return{timeline:null,inspectorModel:null,unitScale:1e6,contentXMinimum:0,contentXMaximum:0,contentXAverage:0}},initialize:function(){this.lanes=new ATEntityLaneList,this.threadIds=[],this.dependencyPaths=[],this.changeObservers=[],this.selectionObservers=[],this.displayLanes=[],this.navigationLanes=[],this.displayColumnGroups=[],this.unallocatedEntity=null,this.relationshipViewFlattenTree=!1,this.relationshipViewShowOffsets=!0;var e="",t=this.get("timeline"),i=t.get("entities"),n=(t.get("events"),this.lanes),s=t.get("laneTypeName"),o=[];i.each(function(e){o.push({id:e.id,timeline:t,entity:e})}),n.set(o,{remove:!1}),e=s&&"None"!=s?"No "+t.get("laneTypeName"):"All Events",this.unallocatedEntity=new ATEntity({name:e,color:null,sortOrder:9999999}),this.updateUnallocatedEvents(),this.listenTo(t,"updateUnallocatedRequired",this.updateUnallocatedEvents),this.listenTo(t,"change:laneTypeName",function(){var e="All Events",i=t.get("laneTypeName");i&&"None"!=i&&(e="No "+i),this.unallocatedEntity.set("name",e)}),this.listenTo(t,"change:laneIds",this.laneIdsChanged),this.listenTo(t,"change:threadIds",this.threadIdsChanged),this.listenTo(t,"selectionChanged",function(){this.trigger("selectionChanged")}),this.listenTo(this,"change:unitScale",this.scaleChanged),this.listenTo(n,"childNodeAdded",this.trigger("childNodeAdded")),this.listenTo(n,"laneCollapsed",function(){this.trigger("laneCollapsed")})},destroy:function(){},threadIdsChanged:function(e,t,i){this.threadIds=t},laneIdsChanged:function(e,t,i){var n=this,s=this.lanes,o=_.keys(t),l=this.get("timeline"),a=l.get("entities"),r=[],d=[];s.each(function(e){_.contains(o,""+e.id)||r.push(e)}),s.remove(r),_.each(o,function(e){s.get(e)||d.push({id:e,timeline:l,entity:0>e?n.unallocatedEntity:a.get(e),collapsed:t[e]})}),s.set(d,{remove:!1}),this.updateUnallocatedEvents()},updateUnallocatedEvents:function(){var e,t=this.get("timeline"),i=[],n=this.lanes,s={};t.appendAllEvents(i),e=_.pluck(i,"id"),n.each(function(t){if(t.id>0){var i=_.keys(t.get("entity").get("relationships"));e=_.reject(e,function(e){return _.contains(i,""+e)})}}),_.each(e,function(e){s[e]="Unallocated"}),this.unallocatedEntity.set("relationships",s)},scaleChanged:function(){var e=this.get("unitScale");this.lanes.each(function(t){t.scaleChanged(e)})}});ATTimelineViewModel.prototype.addChangeObserver=function(e){this.changeObservers.push(e)},ATTimelineViewModel.prototype.removeChangeObserver=function(e){var t=this.changeObservers.indexOf(e);t>-1&&this.changeObservers.splice(t,1)},ATTimelineViewModel.prototype.notifyChangeObservers=function(e){var t,i=this.changeObservers.length;for(t=0;i>t;t++)this.changeObservers[t]()},ATTimelineViewModel.prototype.addSelectionObserver=function(e){this.selectionObservers.push(e)},ATTimelineViewModel.prototype.removeSelectionObserver=function(e){var t=this.selectionObservers.indexOf(e);t>-1&&this.selectionObservers.splice(t,1)},ATTimelineViewModel.prototype.notifySelectionObservers=function(e){var t,i=this.selectionObservers.length;for(t=0;i>t;t++)this.selectionObservers[t]()},ATTimelineViewModel.prototype.threadForID=function(e){var t,i=this.threads.length;for(t=0;i>t;t++)if(this.threads[t].id==e)return this.threads[t];return null},ATTimelineViewModel.prototype.deleteThreadWithID=function(e){var t,i=this.threads.length;for(t=0;i>t;t++)if(this.threads[t].id==e)return this.threads[t]=this.threads[i-1],void this.threads.pop()},ATTimelineViewModel.prototype.setEventTitle=function(e,t){var i,n;for(key in this.lanes)if(this.lanes.hasOwnProperty(key)){var s=this.lanes[key].events;for(n=s.length,i=0;n>i;i++){var o=s[i];o.id==e&&(o.title=t)}}this.notifyChangeObservers()},ATTimelineViewModel.prototype.selectEventsInRect=function(e){var t=this.get("timeline");t.clearSelection(!0),this.lanes.each(function(i){var n=i.get("top");this.selectEventsFromGroupInRect(i.nodes,e,n,t)},this),t.selectionChanged()},ATTimelineViewModel.prototype.selectEventsFromGroupInRect=function(e,t,i,n){e.each(function(e){var s=e.get("totalRect");s=new ATRect(s.origin.x,s.origin.y,s.size.width,s.size.height),s.origin.y+=i,s.overlaps(t)&&n.selectEventWithID(e.id,!0),e.childNodes.length>0&&e.get("showChildNodes")&&this.selectEventsFromGroupInRect(e.childNodes,t,i,n)},this)},ATTimelineViewModel.prototype.findEarliestEventNode=function(){var e=null,t=0;return this.lanes.each(function(i){i.nodes.each(function(i){var n=i.get("event").get("startTS");(null==e||t>n)&&(e=i,t=n)})}),e},ATTimelineViewModel.prototype.findLatestEventNode=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=e?n.get("event").get("endTS"):n.get("event").get("startTS");(null==t||s>i)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.findEarliestEventPixel=function(){var e=!1,t=0;return this.lanes.each(function(i){i.nodes.each(function(i){var n=i.get("totalRect").left();(!e||t>n)&&(t=n,e=!0)})}),t},ATTimelineViewModel.prototype.findLatestEventPixel=function(){var e=this,t=!1,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("totalRect").right();if((!t||s>i)&&(i=s,t=!0),n.get("showChildNodes")){var o=e.findLatestEventPixelInChildren(n);null!==o&&o>i&&(i=o)}})}),i},ATTimelineViewModel.prototype.findLatestEventPixelInChildren=function(e){var t=this,i=!1,n=0;return e.childNodes.each(function(e){var s=e.get("totalRect").right();if((!i||s>n)&&(n=s,i=!0),e.get("showChildNodes")){var o=t.findLatestEventPixelInChildren(e);null!==o&&o>n&&(n=o)}}),i?n:null},ATTimelineViewModel.prototype.findPreviousEventNodeBeforeTS=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("event").get("startTS"),o=n.get("event").get("visible");o&&e>s&&(null==t||s>i)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.findNextEventNodeAfterTS=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("event").get("startTS"),o=n.get("event").get("visible");o&&s>e&&(null==t||i>s)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.allOpenEventNodes=function(e){var t=[];return this.lanes.each(function(i){i.get("collapsed")||i.nodes.each(function(i){i.get("event").get("visible")&&(t.push(i),(e||i.get("showChildNodes"))&&this.appendOpenChildNodes(i,t,e))},this)},this),t},ATTimelineViewModel.prototype.appendOpenChildNodes=function(e,t,i){e.childNodes.each(function(e){e.get("event").get("visible")&&(t.push(e),(i||e.get("showChildNodes"))&&this.appendOpenChildNodes(e,t))},this)},ATTimelineViewModel.prototype.selectAll=function(e){var t=this.allOpenEventNodes(e),i=_.uniq(_.pluck(t,"id"));this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(i)},ATTimelineViewModel.prototype.selectAllAfter=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=!1,l=[];for(s.sort(t),i=s.length,n=0;i>n;n++)s[n].get("event").get("selected")?(l=[],o=!0):o&&s[n].get("event").get("visible")&&l.push(s[n].id);this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(_.uniq(l))},ATTimelineViewModel.prototype.selectAllBefore=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=!1,l=[];for(s.sort(t),i=s.length,n=i-1;n>=0;n--)s[n].get("event").get("selected")?(l=[],o=!0):o&&s[n].get("event").get("visible")&&l.push(s[n].id);this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(_.uniq(l))},ATTimelineViewModel.prototype.selectNextEvent=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=null;for(s.sort(t),i=s.length,n=i-1;n>=0&&!s[n].get("event").get("selected");n--)s[n].get("event").get("visible")&&(o=s[n]);return o&&(this.get("timeline").clearSelection(!0),this.get("timeline").selectEventWithID(o.id)),o},ATTimelineViewModel.prototype.selectPreviousEvent=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=null;for(s.sort(t),i=s.length,n=0;i>n&&!s[n].get("event").get("selected");n++)s[n].get("event").get("visible")&&(o=s[n]);return o&&(this.get("timeline").clearSelection(!0),this.get("timeline").selectEventWithID(o.id)),o},ATTimelineViewModel.prototype.hideAllEventDetails=function(e){var t,i=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),n=i.length;for(t=0;n>t;t++)i[t].get("showMore")&&i[t].set("showMore",!1)},ATTimelineViewModel.prototype.findNodeForEventId=function(e){var t=null;return this.lanes.each(function(i){null==t&&(t=i.nodes.findNode(e))}),t},ATTimelineViewModel.prototype.findAllNodesForEventId=function(e){var t=[];return this.lanes.each(function(i){i.nodes.each(function(i){i.get("event").id==e&&t.push(i),this.addAllChildNodesWithEventId(i,t,e)},this)},this),t},ATTimelineViewModel.prototype.addAllChildNodesWithEventId=function(e,t,i){e.childNodes.each(function(e){e.get("event").id==i&&t.push(e),this.addAllChildNodesWithEventId(e,t,i)},this)},ATTimelineViewModel.prototype.findAllNodesForEventIds=function(e){var t=[];return this.lanes.each(function(i){i.nodes.each(function(i){_.contains(e,i.get("event").id)&&t.push(i),this.addAllChildNodesWithEventIds(i,t,e)},this)},this),t},ATTimelineViewModel.prototype.addAllChildNodesWithEventIds=function(e,t,i){e.childNodes.each(function(e){_.contains(i,e.get("event").id)&&t.push(e),this.addAllChildNodesWithEventIds(e,t,i)},this)},ATTimelineViewModel.prototype.eventNodeForAbsolutePosition=function(e,t){var i,n=this.laneForAbsoluteY(e.y);return i=new ATPoint(e.x,e.y-n.get("top")),this.eventNodeForAbsolutePositionInGroup(n.nodes.models,i,t)},ATTimelineViewModel.prototype.eventNodeForAbsolutePositionInGroup=function(e,t,i){var n,s,o,l,a,r=e.length;for(s=0;r>s;s++){if(n=e[s],n.get("showChildNodes")&&(a=this.eventNodeForAbsolutePositionInGroup(n.childNodes.models,t,i)))return a;if(o=n.get("totalRect"),o.contains(t))return n;if(i&&(l=n.childRect,o=new ATRect(o.origin.x+l.origin.x,o.origin.y+l.origin.y,l.size.width,l.size.height),o.contains(t)))return n}return null},ATTimelineViewModel.prototype.eventNodeForSnapDrag=function(e,t,i,n){var s,n,o,l,a=this.get("timeline").get("events").findChild(e),r=this.lanes.get(t),d=a.get("parentId"),h=d>0?r.nodes.findNode(d):null,p=null;if(h?s=h.childNodes.models:(s=[],this.lanes.each(function(e){var t=e.get("top"),i=t+e.get("height"),o=n.top(),l=n.bottom(),a=n.deepCopy();a.origin.y=Math.max(t,o),a.size.height=Math.min(i,l)-a.origin.y,a.origin.y=0,!e.get("collapsed")&&a.size.height>0&&(s=_.union(s,e.nodes.filter(function(e){return e.get("totalRect").overlaps(a)})))})),s.length>0&&(p=_.min(s,function(t){return t.id==e?1e3:Math.min(Math.abs(t.get("startPixel")-i.x),Math.abs(t.get("stopPixel")-i.x))})),p&&p.id!=e)if(o=Math.abs(p.get("startPixel")-i.x),l=Math.abs(p.get("stopPixel")-i.x),l>=o){if(o<TimelineDisplayConstants.snapDragMinDist)return{node:p,location:"start",xValue:p.get("startPixel")}}else if(l<TimelineDisplayConstants.snapDragMinDist)return{node:p,location:"end",xValue:p.get("stopPixel")};return null},ATTimelineViewModel.prototype.laneForAbsoluteY=function(e){var t;return t=this.lanes.find(function(t){var i=t.get("top"),n=i+t.get("height");return e>=i&&n>e}),t?t:this.lanes.last()},ATTimelineViewModel.prototype.relationshipColumnForAbsoluteX=function(e,t){var i,n,s=null,o=null;return _.each(this.displayColumnGroups,function(l){t&&l.name!=t||_.each(l.entityColumns,function(t){i||(i=t,o=t.xPixel),t.xPixel>=e&&t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing<e&&(s=t),n=t})}),s||(s=o>e?i:n),s},ATTimelineViewModel.prototype.laneForEntityId=function(e){return this.lanes.find(function(t){return t.id==e})},ATTimelineViewModel.prototype.columnForEntityId=function(e){var t=null;return _.each(this.displayColumnGroups,function(i){var n=_.find(i.entityColumns,function(t){return t.id==e});n&&(t=n)}),t},ATTimelineViewModel.prototype.lastLane=function(){return this.lanes.last()},ATTimelineViewModel.prototype.closestLaneTopToAbsoluteY=function(e){var t=null,i=1e4;return this.lanes.each(function(n){var s=n.get("top"),o=Math.abs(s-e);(null==t||i>o)&&(t=n,i=o)}),t?t:this.lanes.last()},ATTimelineViewModel.prototype.calculateNodes=function(){window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.calculateNodesTimelineView():this.calculateNodesRelationshipView()},ATTimelineViewModel.prototype.calculateNodesTimelineView=function(){var e,t,i,n,s,o,l,a=_.values(this.lanes.models),r="cascade"==window.mainApp.displaySettings.layout?this.layoutNodeGroupCascade.bind(this):this.layoutNodeGroupTwoPass.bind(this),d=a.length;for(this.displayLanes=[],this.navigationLanes=[],s=0,o=0,e=0;d>e;e++)t=a[e],t.layoutRequired=!1,i=t.nodes,i.sortRequired&&(i.sort(),i.sortRequired=!1),n=t.get("collapsed"),this.displayLanes.push({original:t,id:t.id,entityName:t.get("entity").get("name"),marginForLane:TimelineDisplayConstants.laneLabelOffsetX+t.get("nameWidth")+TimelineDisplayConstants.lifetimeLeftMarginToText,lifetimeMarks:[],lifetimeBounds:this.lifetimeBoundsForLane(t),nodes:[],collapsed:t.get("collapsed"),odd:e%2==1}),l=this.displayLanes[this.displayLanes.length-1],s=r(t.id,n,i.models,0,0,null,!1,l),s+=20,s<TimelineDisplayConstants.minimumExpandedLaneHeight&&(s=TimelineDisplayConstants.minimumExpandedLaneHeight),n&&(s=TimelineDisplayConstants.collapsedLaneHeight),t.set("top",o),t.set("height",s),o+=s,l.top=t.get("top"),l.height=t.get("height"),this.navigationLanes.push(_.pick(l,"id","entityName","top","height"));this.contentXMinimum=0,this.contentXMaximum=0,this.contentXAverage=0,window.mainApp.timelineView.rangeY=new ATBounds(-TimelineDisplayConstants.timeHeaderHeight,o+TimelineDisplayConstants.navFooterHeight),this.calculateDependencyPaths(),this.notifyChangeObservers(),this.trigger("nodeLayoutChanged")},ATTimelineViewModel.prototype.updateRelationshipViewColumns=function(){var e=this,t=this.get("inspectorModel").get("template").types,i=this.get("timeline").get("entities"),n=1;return this.displayColumnGroups=[],_.each(t,function(t){colGroup={name:t.name,sortOrder:n,entityColumns:[]},e.displayColumnGroups.push(colGroup),n++}),i.each(function(t){if(t.get("visibleAsColumn")){var i=t.get("type"),n=_.find(e.displayColumnGroups,function(e){return e.name==i});n||(console.log("updateRelationshipViewColumns ERROR"),console.log("cannot find colGroup for type: "+i),console.log("Printing self.displayColumnGroups, entity"),console.dir(e.displayColumnGroups),console.dir(t)),n.entityColumns.push({id:t.id,type:i,name:t.get("name"),sortOrder:t.get("sortOrder"),icon:t.get("icon"),color:t.get("color")})}}),this.displayColumnGroups=this.displayColumnGroups.filter(function(e){return e.entityColumns.length>0}),this.calculateRelationshipViewColumns(!0,!0)},ATTimelineViewModel.prototype.calculateRelationshipViewColumns=function(e,t){var i,n=!1;return i=TimelineDisplayConstants.relationshipViewDateOffsetWidth+TimelineDisplayConstants.relationshipViewEventAreaWidth+TimelineDisplayConstants.relationshipViewEntityColumnSpacing,_.each(this.displayColumnGroups,function(s){e?s.xPixel=i:i=s.xPixel,n=!1,s.entityColumns.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(s.entityColumns,function(e){e.xPixel=i,e.isOdd=n,i+=TimelineDisplayConstants.relationshipViewEntityColumnSpacing,t&&(n=!n)}),i+=TimelineDisplayConstants.relationshipViewEntityGroupSpacing}),i},ATTimelineViewModel.prototype.calculateNodesRelationshipView=function(e){var t,i,n,s,o,l,a,r,d,h=_.values(this.lanes.models),p=h.length;for(this.displayLanes=[],this.navigationLanes=[],e?(l=this.displayColumnGroups[this.displayColumnGroups.length-1],o=l.entityColumns[l.entityColumns.length-1].xPixel+TimelineDisplayConstants.relationshipViewEntityColumnSpacing+TimelineDisplayConstants.relationshipViewEntityGroupSpacing):o=this.updateRelationshipViewColumns(),a=0,r=0,t=0;p>t;t++)i=h[t],i.layoutRequired=!1,this.relationshipViewFlattenTree?(n=this.flattenedEventNodeListForLane(i.id),n.sort(i.nodes.comparator)):(i.nodes.sortChildren(),i.nodes.sortRequired=!1,n=i.nodes.models),s=i.get("collapsed"),this.displayLanes.push({original:i,id:i.id,entityName:i.get("entity").get("name"),marginForLane:TimelineDisplayConstants.laneLabelOffsetX+i.get("nameWidth")+TimelineDisplayConstants.lifetimeLeftMarginToText,lifetimeMarks:[],lifetimeBounds:this.lifetimeBoundsForLane(i),nodes:[],intersections:[],collapsed:i.get("collapsed"),odd:t%2==1}),d=this.displayLanes[this.displayLanes.length-1],a=this.layoutRelationshipNodeGroup(i.id,s,n,0,0,d,this.displayColumnGroups,TimelineDisplayConstants.lifetimeHeight,!1,!1,null),a<TimelineDisplayConstants.minimumExpandedLaneHeight&&(a=TimelineDisplayConstants.minimumExpandedLaneHeight),s&&(a=TimelineDisplayConstants.collapsedLaneHeight),i.set("top",r),i.set("height",a),r+=a,d.top=i.get("top"),d.height=i.get("height"),this.navigationLanes.push(_.pick(d,"id","entityName","top","height"));this.contentXMinimum=0,this.contentXMaximum=0,this.contentXAverage=0,window.mainApp.relationshipView.rangeY=new ATBounds(-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,r+TimelineDisplayConstants.scrollTrackNoLaneNavThickness+TimelineDisplayConstants.bookmarksHeight),window.mainApp.relationshipView.rangeX=new ATBounds(0,o+20),this.notifyChangeObservers(),this.trigger("nodeLayoutChanged")},ATTimelineViewModel.prototype.layoutNodeGroupTwoPass=function(e,t,i,n,s,o,l,a){var r,d="compact"==window.mainApp.displaySettings.layout?this.layoutCompactNodes.bind(this):this.layoutWaterfallNodes.bind(this);return d(e,t,i,n,s,o,l,a),r=_.clone(i),r.sort(function(e,t){var i=e.get("smallTotalRect"),n=t.get("smallTotalRect");return i.origin.y==n.origin.y?i.origin.x-n.origin.x:i.origin.y-n.origin.y}),this.expandTwoPassNodes(e,t,r,n,s,o,l,a)},ATTimelineViewModel.prototype.layoutCompactNodes=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,v=i.length,T=!0,C=0,w=[],A=10,N=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane;for(r=0;v>r;r++)if(d=i[r],h=d.get("event"),p=d.get("smallTotalRect"),h.get("visible"))if(f=p.right()+TimelineDisplayConstants.eventXOffsetFromPreviousEvent,(T||f>y)&&(y=f),T=!1,d.color=h.get("color"),d.laneId=e,c=0,m=!1,t||l)p.origin.y=N;else do if(c>=w.length){for(m=!0,p.origin.y=c?w[c-1].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent:N,g=Math.floor(p.bottom()/A);g>c;c++)w.push({x:f,y:(c+1)*A});w.push({x:f,y:p.bottom()}),m=!0}else if(p.origin.x>=w[c].x){for(p.origin.y=c?w[c-1].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent:N,g=Math.floor(p.bottom()/A),u=c,m=!0;g>=c&&c<w.length;c++)p.origin.x<w[c].x&&(m=!1);if(m){for(c=u;g>c;c++)c<w.length?w[c]={x:f,y:(c+1)*A}:w.push({x:f,y:(c+1)*A});c<w.length?w[c]={x:f,y:p.bottom()}:w.push({x:f,y:p.bottom()})}}else c++;while(!m);return C=w.length?w[w.length-1].y:0,o&&y>o.right()&&(o.size.width=y-o.origin.x),C},ATTimelineViewModel.prototype.layoutWaterfallNodes=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,v,T,C,w,A,N,V,D,M=i.length,x=!0,E=0,P=[],L=10,R=0,b=0,O=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane,F=0;for(p=0;M>p;p++)if(c=i[p],u=c.get("event"),g=c.get("smallTotalRect"),u.get("visible"))if(V=g.right()+TimelineDisplayConstants.eventXOffsetFromPreviousEvent,(x||V>D)&&(D=V),x=!1,c.color=u.get("color"),c.laneId=e,t||l)g.origin.y=O;else{if(r=p>=R)for(b=O,y=Math.min(M,p+P.length),m=p;y>m&&(f=i[m].get("smallTotalRect"),A=Math.floor(b/L),N=Math.floor((b+f.size.height)/L),!(A>P.length));m++){for(d=!1,w=A;N>=w&&!(w>=P.length);w++)if(f.origin.x<P[w].x){if(!P[w].isLong){for(r=!1,C=0,R=M,v=m+1;M>v;v++)if(T=i[v].get("smallTotalRect"),T.origin.x>P[w].x){R=v;break}for(;R>0&&w*L>=C;)R--,C+=i[R].get("smallTotalRect").size.height+TimelineDisplayConstants.eventYOffsetFromPreviousEvent;R++;break}d=!0,b=P[w].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent}if(!r)break;d?m--:b+=f.size.height+TimelineDisplayConstants.eventYOffsetFromPreviousEvent}r?(g.origin.y=O,A=0,F=g.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,N=Math.floor(F/L)):(g.origin.y=F,A=Math.floor(g.origin.y/L),F=g.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,N=Math.floor(F/L));do{for(d=!1,w=A;N>=w&&!(w>=P.length);w++)g.origin.x<P[w].x&&P[w].isLong&&(d=!0,F=P[w].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent);d&&(g.origin.y=F,A=Math.floor(g.origin.y/L)+1,F=g.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,N=Math.floor(F/L))}while(d);for(h=c.get("markerRect").size.width>TimelineDisplayConstants.longEventMinWidth,w=A;N>w;w++)w<P.length?P[w]={x:V,y:(w+1)*L,isLong:h}:P.push({x:V,y:(w+1)*L,isLong:h});N<P.length?P[N]={x:V,y:F,isLong:h}:P.push({x:V,y:F,isLong:h})}return E=P.length?P[P.length-1].y:0,o&&D>o.right()&&(o.size.width=D-o.origin.x),E},ATTimelineViewModel.prototype.expandTwoPassNodes=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,v,T,C=[],w=[],A=i.length,N=0,V={nodes:[]};for(r=0;A>r;r++)if(d=i[r],h=d.get("event"),h.get("visible")){if(p=d.get("totalRect"),c=d.get("smallTotalRect"),p.origin.y=c.origin.y,u=p.deepCopy(),V.nodes=[],!t){for(d.childNodes.length>0&&(markerRect=d.get("markerRect"),d.isParent=!0,d.childNodes.sortRequired&&(d.childNodes.sort(),d.childNodes.sortRequired=!1),d.get("showChildNodes")?(this.layoutNodeGroupTwoPass(e,t,d.childNodes.models,0,u.bottom()+TimelineDisplayConstants.eventYOffsetFromOwnParentEvent,u,!1,V),u.origin.x-=TimelineDisplayConstants.eventChildRectPaddingLeft,u.size.height+=TimelineDisplayConstants.eventChildRectPaddingBottom,u.size.width+=TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,d.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,markerRect.origin.y+markerRect.size.height/2,u.size.width,u.size.height-markerRect.size.height/2)):(u.origin.x-=TimelineDisplayConstants.eventChildRectPaddingLeft,u.size.height+=TimelineDisplayConstants.eventChildRectPaddingBottom,u.size.width+=TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,d.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,u.size.width,0))),u.size.height+=TimelineDisplayConstants.eventYOffsetFromPreviousEvent,u.size.width+=TimelineDisplayConstants.eventXOffsetFromPreviousEvent,m=-1,g=C.length,f=0;g>f;f++)if(u.overlaps(C[f].bounds))for(y=C[f].rects,v=y.length,T=0;v>T;T++)u.overlaps(y[T])&&(u.origin.y=y[T].bottom(),m=f);if(-1!=m)C[m].bounds=C[m].bounds.union(u,0),C[m].rects.push(u.deepCopy()),C[m].rects.sort(function(e,t){return e.origin.y==t.origin.y?e.origin.x-t.origin.x:e.origin.y-t.origin.y});else if(d.get("showMore")||d.get("showChildNodes")){for(v=w.length,T=0;v>T;T++)u.overlaps(w[T])&&(u.origin.y=w[T].bottom());C.push({bounds:u.deepCopy(),rects:[u.deepCopy()]})}else w.push(u.deepCopy());u.bottom()>N&&(N=u.bottom()),_.each(V.nodes,function(e){e.totalRect.origin.y+=u.origin.y-p.origin.y}),p.origin.y=u.origin.y}a&&(displayNode=_.extend({original:d,laneId:e,childRect:d.childRect,color:d.color,isParent:d.isParent,isLaneCollapsed:t,startYPosition:o?o.origin.y:0,visible:!0,widthAdjustToOptimise:0,translateMarkerX:0},_.extend(_.pick(d.attributes,"contentHTML","startPixel","stopPixel","markerRect","markerPoints","bulletPos","textSize","totalRect","scale","displayTitle","showMore","showChildNodes"),_.pick(d.get("event").attributes,"id","dateString","selected","isFaded","imagePath","links"))),a.nodes.push(displayNode),_.each(V.nodes,function(e){a.nodes.push(e)}))}return o&&(0==N&&(N=o.bottom()+20),o.size.height=N-o.origin.y),N},ATTimelineViewModel.prototype.layoutNodeGroupCascade=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,v,T,C,w,A,N,V,D=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane;2*TimelineDisplayConstants.eventMarkerCornerRadius;for(d=i.length,T=!0,N=0,r=0;d>r;r++)h=i[r],p=h.get("event"),f=h.get("totalRect"),c=h.get("startPixel"),u=h.get("stopPixel"),g=u-c,m=p.get("endTS")-p.get("startTS"),p.get("visible")&&(h.color=p.get("color"),h.laneId=e,T||t||l?(f.origin.y=D,A=f.origin.x):f.origin.x>A+TimelineDisplayConstants.eventXOffsetFromPreviousEvent?f.origin.y=D:f.origin.y=w+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,T=!1,h.childNodes.length>0?(v=h.get("markerRect"),h.isParent=!0,h.childNodes.sortRequired&&(h.childNodes.sort(),h.childNodes.sortRequired=!1),y=new ATRect(f.origin.x,f.origin.y,f.size.width,f.size.height),h.get("showChildNodes")?(this.layoutNodeGroupCascade(e,t,h.childNodes.models,0,y.bottom()+TimelineDisplayConstants.eventYOffsetFromOwnParentEvent,y,!1,a),h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,v.origin.y+v.size.height/2,y.size.width+TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,y.size.height-v.size.height/2+TimelineDisplayConstants.eventChildRectPaddingBottom),C=y.right(),w=y.top()+h.childRect.size.height+TimelineDisplayConstants.eventYOffsetFromPreviousParentEvent):(l||this.layoutNodeGroupCascade(e,t,h.childNodes.models,0,y.top(),y,!0,null),C=f.right(),w=f.top()+f.size.height,h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,y.size.width,0))):(C=f.right(),w=f.top()+f.size.height,h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,0,0),h.isParent=!1),w>N&&(N=w),C>A&&(A=C),a&&(V=_.extend({original:h,laneId:e,childRect:h.childRect,color:h.color,isParent:h.isParent,isLaneCollapsed:t,startYPosition:o?o.origin.y:0,visible:!0,widthAdjustToOptimise:0,translateMarkerX:0},_.extend(_.pick(h.attributes,"contentHTML","startPixel","stopPixel","markerRect","markerPoints","bulletPos","textSize","totalRect","scale","displayTitle","showMore","showChildNodes"),_.pick(h.get("event").attributes,"id","dateString","selected","isFaded","imagePath","links"))),a.nodes.push(V)));return o&&(0==N&&(N=o.bottom()+20),o.size.height=N-o.origin.y,A>o.right()&&(o.size.width=A-o.origin.x)),N},ATTimelineViewModel.prototype.layoutRelationshipNodeGroup=function(e,t,i,n,s,o,l,a,r,d,h){var p,c,u,g,m,f,y,v,T,C,w,A,N,V,D,M,x=this.get("timeline"),E=null,P=null,D=null,L=[],R=!!r,b=a?a:null,O={y:null,lastWasOdd:!1};if(!t){for(M=!1,c=i.length,v=Math.max(s,TimelineDisplayConstants.lifetimeHeight),prevTop=null,p=0;c>p;p++)if(g=i[p],u=g.get("event"),u.get("visible")){g.isParent=this.relationshipViewFlattenTree?!1:g.childNodes.length>0,y=g.get("textSize"),f=g.get("relationshipTotalRect"),m=new ATRect(TimelineDisplayConstants.relationshipViewEventTextXOffset,TimelineDisplayConstants.relationshipViewEventVerticalPadding,y.width,y.height),f.size.width=TimelineDisplayConstants.relationshipViewEventAreaWidth-n,f.size.height=y.height+2*TimelineDisplayConstants.relationshipViewEventVerticalPadding,f.origin.x=TimelineDisplayConstants.relationshipViewDateOffsetWidth+n,f.origin.y=v,v=f.bottom(),w=f.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop,g.color=u.get("color"),g.laneId=e,A=x.rangeConversion.valueFromTimestamp(u.get("startTS")),P&&(V=x.rangeConversion.spanBetweenValues(N,A),D=x.rangeConversion.shortStringFromSpanValue(V));var C=u.get("relationships");_.each(l,function(e,t){_.each(e.entityColumns,function(e){var t=_.find(C,function(t){return t.entityId==e.id});t&&o.intersections.push({icon:t.icon,color:t.color,age:t.age,shortAge:t.shortAge,role:t.role,xPixel:e.xPixel,yPixel:w,id:""+g.id+"-"+e.id})})}),o&&(T=_.extend({original:g,laneId:e,color:g.color,isParent:g.isParent,isLaneCollapsed:t,textRect:m,totalRect:f,offsetText:M?D:"",offsetTextX:f.origin.x-TimelineDisplayConstants.relationshipViewDateOffsetWidth,offsetTextY:(w+b)/2,lineY:w,prevLineY:b,lineWidth:this.relationshipViewFlattenTree?TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthFlattenedTree:g.isParent?TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthParent:TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthNoChildren,lineX:f.origin.x+TimelineDisplayConstants.relationshipViewDateEventLeftLineXOffset-TimelineDisplayConstants.relationshipViewDateEventLeftLineWidth,isOdd:R,relationshipValues:L,visible:!0},_.extend(_.pick(g.attributes,"contentHTML","displayTitle","showMore","showChildNodes"),_.pick(g.get("event").attributes,"id","dateString","selected","isFaded","imagePath","links"))),this.relationshipViewFlattenTree&&(T.showChildNodes=!1),T.verticalLineX=T.lineX,d&&p==c-1&&(T.lineWidth+=TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthLastChildAddition,T.lineX-=TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthLastChildAddition),o.nodes.push(T)),!this.relationshipViewFlattenTree&&g.childNodes.length>0&&g.get("showChildNodes")?(v=this.layoutRelationshipNodeGroup(e,t,g.childNodes.models,n+TimelineDisplayConstants.relationshipViewParentIndent,v,o,l,f.origin.y+m.origin.y+m.size.height/2+4,!R,p!=c-1,O),b=O.y,R=O.lastWasOdd):b=w,M=this.relationshipViewShowOffsets,P=g,E=u,N=A,R=!R}return h&&(h.y=w,h.lastWasOdd=!R),v}},ATTimelineViewModel.prototype.flattenedEventNodeList=function(){var e=[];return this.lanes.each(function(t){t.nodes.each(function(t){e.push(t),this.addChildNodesToFlattenedList(t,e)},this)},this),e},ATTimelineViewModel.prototype.addChildNodesToFlattenedList=function(e,t){e.childNodes.each(function(e){t.push(e),this.addChildNodesToFlattenedList(e,t)},this)},ATTimelineViewModel.prototype.flattenedEventNodeListForLane=function(e){var t=[];return this.lanes.get(e).nodes.each(function(e){t.push(e),this.addChildNodesToFlattenedList(e,t)},this),t},ATTimelineViewModel.prototype.lifetimeBoundsForLane=function(e){var t,i,n=this.get("unitScale"),s=e.get("entity"),o=s.get("hasStart"),l=s.get("hasStop"),a=0,r=0;return o&&(t=e.get("entity").get("startTS"),a=t/n),l&&(i=e.get("entity").get("stopTS"),r=i/n),{hasStart:o,start:a,hasStop:l,stop:r}},ATTimelineViewModel.prototype.calculateDependencyPaths=function(){var e,t=this,i=this.get("timeline"),n=i.get("events"),s=this.flattenedEventNodeList();this.lanes.models;this.dependencyPaths=[],e=this.dependencyPaths,_.each(s,function(i){var s=i.get("event"),o=i.get("lane"),l=s.get("dependencies"),a=s.get("parentId"),r=a>0?o.nodes.findNode(a):null;_.isEmpty(l)||!s.get("visible")||o.get("collapsed")||r&&!r.get("showChildNodes")||_.each(l,function(s,l){var a=t.findAllNodesForEventId(l),r=n.findChild(l),d=!1;if(r.get("visible")){var h=_.min(a,function(e){var t=e.get("lane"),i=e.get("event").get("parentId"),n=i>0?t.nodes.findNode(i):null;return t.get("collapsed")?1e6:n&&!n.get("showChildNodes")?1e6:(d=!0,Math.abs(o.get("top")-t.get("top")))});d&&!h.get("lane").get("collapsed")&&e.push(new ATDependencyPath(h,i,s))}})})},ATTimelineViewModel.freeze=function(e){return{_class:"ATTimelineViewModel",lanes:e.lanes,threads:e.threads,deleted_lanes:e.deleted_lanes,deleted_threads:e.deleted_threads,deleted_events:e.deleted_events}},ATTimelineViewModel.thaw=function(e){return new ATTimelineViewModel(e.lanes,e.threads,e.deleted_lanes,e.deleted_threads,e.deleted_events)},module.exports=ATTimelineViewModel;
},{"./ATBounds":16,"./ATDependencyPath":25,"./ATDisplayConstants":26,"./ATEntity":38,"./ATEntityLaneList":40,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATSize":79,"./ATViewMode":92,"backbone":176,"lodash":309}],89:[function(require,module,exports){
function ColorLuminance(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var i,n,a="#";for(n=0;3>n;n++)i=parseInt(t.substr(2*n,2),16),i=Math.round(Math.min(Math.max(0,i+i*e),255)).toString(16),a+=("00"+i).substr(i.length);return a}function MyRound(t,e){return Math.round(t*e)}function MyCeil(t,e){return Math.ceil(t*e)}var $=require("jquery"),d3=require("d3"),_=require("lodash"),Hilitor2=require("../lib/hilitor2"),ATUtilities=require("./ATUtilities"),Opentip=require("../lib/opentip"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATPoint=require("./ATPoint"),ATLine=require("./ATLine"),ATRect=require("./ATRect"),ATSize=require("./ATSize"),ATTimelineViewPainter=function(t){this.timelineView=t,this.scaleFactor=this.timelineView.physicalScaleFactor,this.lifetimeBgLayer=t.layers.lifetime_bg_layer,this.bgLayer=t.layers.bg_layer,this.dependencyLayer=t.layers.dependency_layer,this.eventLayer=t.layers.event_layer,this.laneOverlayLayer=t.layers.lane_overlay_layer,this.laneNavSvg=t.layers.lane_nav_svg,this.headerSvg=t.layers.header_svg,this.uiDrawingSvg=d3.select("#ui_drawing_svg"),this.bookmarksDiv=t.bookmarksDiv,this.bookmarkFirst=this.bookmarksDiv.select(".bookmarkFirst").on("click",function(t){window.mainApp.timelineView.gotoFirstBookmark()}),this.bookmarkLast=this.bookmarksDiv.select(".bookmarkLast").on("click",function(t){window.mainApp.timelineView.gotoLastBookmark()}),this.bookmarkPrevious=this.bookmarksDiv.select(".bookmarkPrevious").on("click",function(t){window.mainApp.timelineView.gotoPreviousEvent()}),this.bookmarkNext=this.bookmarksDiv.select(".bookmarkNext").on("click",function(t){window.mainApp.timelineView.gotoNextEvent()}),this.bookmarkAdd=this.bookmarksDiv.select(".bookmarkAdd").on("click",function(t){window.mainApp.timelineView.addBookmark()}),this.bookmarkGroup=this.bookmarksDiv.select(".bookmarkGroup"),this.filtersDiv=t.filterBarDiv,this.filterAdd=this.filtersDiv.select(".filterBarAdd").on("click",function(t){window.mainApp.timelineView.addFilter()}),this.filterManage=this.filtersDiv.select(".filterBarManage").on("click",function(t){window.mainApp.timelineView.manageFilters()}),this.filterGroup=this.filtersDiv.select(".filterGroup"),this.verticalAnimateToggledLaneIds=[],this.bookmarksConfigured=!1,this.contextLayer=t.layers.context_layer,this.contextLensLayer=t.layers.context_lens_layer,this.dependencyG=this.dependencyLayer.append("g").attr("class","dependencyG"),this.staticTimeHeaderG=this.headerSvg.append("g").attr("class","timeHdrG"),this.staticTimeHeader=this.staticTimeHeaderG.append("rect").attr("class","timeHdr").attr("width","100%").attr("height",TimelineDisplayConstants.timeHeaderHeight).attr("x",0).attr("y",0),this.staticTimeHeader=this.staticTimeHeaderG.append("line").attr("class","timeHdrBottomLine").attr("x1",0).attr("y1",TimelineDisplayConstants.timeHeaderHeight-.5).attr("x2","100%").attr("y2",TimelineDisplayConstants.timeHeaderHeight-.5),this.contextBarG=this.contextLayer.append("g").attr("class","contextBarG"),this.contextBarRect=this.contextBarG.append("rect").attr("class","contextBar").attr("width","100%").attr("height",TimelineDisplayConstants.contextHeight).attr("x",0).attr("y",0).on("click",function(){window.mainApp.timelineView.contextBarClick()}),this.hilitor=new Hilitor2("event_layer"),this.hilitor.setMatchType("open"),this.highlightString=null,this.defaultTransitionDuration=300,this.transitionDuration=this.defaultTransitionDuration;var e=0;this.RENDER_LEVEL_SELECTION=e++,this.RENDER_LEVEL_POSITION=e++,this.RENDER_LEVEL_VIEWPORT=e++,this.RENDER_LEVEL_SIZE=e++,this.RENDER_LEVEL_ZOOM=e++,this.RENDER_LEVEL_DATA=e++};ATTimelineViewPainter.prototype.drawDragBox=function(){var t=this.timelineView.dragBoxBounds;t?(this.selectionDragBox||(this.selectionDragBox=this.uiDrawingSvg.append("rect").attr("class","dragBox")),this.selectionDragBox.attr("width",t.size.width).attr("height",t.size.height).attr("x",0).attr("y",0),this.uiDrawingSvg.attr("width",t.size.width*this.scaleFactor).attr("height",t.size.height*this.scaleFactor).attr("viewBox","0 0 "+t.size.width+" "+t.size.height).style("left",t.origin.x*this.scaleFactor).style("top",t.origin.y*this.scaleFactor)):this.selectionDragBox&&(this.selectionDragBox.remove(),this.selectionDragBox=null)},ATTimelineViewPainter.prototype.drawMoveEventLine=function(){var t,e,i,n,a,r,s,o,l,c=this.timelineView.draggingEventForLane,d=this.timelineView.draggingEventForParent,h=this.timelineView.draggingEventForDistanceMeasure,p=this.timelineView.draggingEventForPosition,u=this.timelineView.draggingEventForEndPosition;d?(e=this.timelineView.eventDragTargetEventDrop,e?(this.moveEventDragTargetBox||(this.moveEventDragTargetBox=this.uiDrawingSvg.append("rect").attr("class","dragEventTargetDrop")),n=e.get("totalRect"),a=n.top()+this.timelineView.eventDragEndLane.get("top"),i=this.timelineView.absoluteToRelativePoint(new ATPoint(n.left(),a)),this.moveEventDragTargetBox.attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",n.size.width).attr("height",n.size.height),this.uiDrawingSvg.attr("width",n.size.width*this.scaleFactor).attr("height",n.size.height*this.scaleFactor).attr("viewBox","0 0 "+n.size.width+" "+n.size.height).style("left",i.x*this.scaleFactor).style("top",i.y*this.scaleFactor)):this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null),this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null)):c||p||u||h?(t=this.timelineView.eventDragEndPos,r=this.timelineView.absoluteToRelativePoint(t),this.moveEventDragLine||(this.moveEventDragLine=this.uiDrawingSvg.append("line").attr("class","dragEventLine")),h?(s=this.timelineView.absoluteToRelativePoint(this.timelineView.eventDragMeasureDistanceStartPos),o=this.timelineView.absoluteToRelativePoint(this.timelineView.eventDragMeasureDistanceEndPos)):c?(s=new ATPoint(0,r.y),o=new ATPoint(this.timelineView.viewport.size.width,r.y)):this.timelineView.snapDragLine?(s=this.timelineView.absoluteToRelativePoint(this.timelineView.snapDragLine.origin),o=this.timelineView.absoluteToRelativePoint(this.timelineView.snapDragLine.destination)):(s=new ATPoint(r.x,0),o=new ATPoint(r.x,this.timelineView.viewport.size.height)),l=new ATRect(0,0,0,0),l.origin.x=Math.min(s.x,o.x)-2,l.origin.y=Math.min(s.y,o.y)-2,l.size.width=Math.max(Math.abs(s.x-o.x)+2,5),l.size.height=Math.max(Math.abs(s.y-o.y)+2,5),s.x-=l.origin.x,s.y-=l.origin.y,o.x-=l.origin.x,o.y-=l.origin.y,this.moveEventDragLine.attr("x1",Math.floor(s.x)+.5).attr("y1",Math.floor(s.y)+.5).attr("x2",Math.floor(o.x)+.5).attr("y2",Math.floor(o.y)+.5),this.uiDrawingSvg.attr("width",l.size.width?l.size.width*this.scaleFactor:1).attr("height",l.size.height?l.size.height*this.scaleFactor:1).attr("viewBox","0 0 "+l.size.width+" "+l.size.height).style("left",l.origin.x*this.scaleFactor).style("top",l.origin.y*this.scaleFactor),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null)):(this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null))},ATTimelineViewPainter.prototype.drawMoveLaneLine=function(){var t,e;this.timelineView.laneDragEndLane!=this.timelineView.laneDragStartingLane?(t=this.timelineView.laneDragEndPos.y<this.timelineView.laneDragStartPos.y?new ATPoint(0,this.timelineView.laneDragEndLane.get("top")+1):new ATPoint(0,this.timelineView.laneDragEndLane.get("top")+this.timelineView.laneDragEndLane.get("height")),e=this.timelineView.absoluteToRelativePoint(t),this.moveLaneDragLine||(this.moveLaneDragLine=this.uiDrawingSvg.append("line").attr("class","dragLaneLine")),this.uiDrawingSvg.attr("width","100%").attr("height",5).attr("viewBox","0 0 100% 5").style("left",0).style("top",e.y*this.scaleFactor-2),this.moveLaneDragLine.attr("x1",0).attr("y1",2).attr("x2","100%").attr("y2",2)):this.moveLaneDragLine&&(this.moveLaneDragLine.remove(),this.moveLaneDragLine=null)},ATTimelineViewPainter.prototype.redrawContextLens=function(t){this.renderContextLens(this.contextLensLeftArrow,this.contextLensMiddle,this.contextLensRightArrow)},ATTimelineViewPainter.prototype.setHighlightString=function(t){this.highlightString=ATUtilities.regexEscapedString(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove()},ATTimelineViewPainter.prototype.render=function(t,e){this.timelineView.model&&!_.isEmpty(e)&&(this.renderFlags=e,this.renderLevel=this.RENDER_LEVEL_SELECTION,this.renderFlags.position&&(this.renderLevel=this.RENDER_LEVEL_POSITION),this.renderFlags.viewport&&(this.renderLevel=this.RENDER_LEVEL_VIEWPORT),this.renderFlags.size&&(this.renderLevel=this.RENDER_LEVEL_SIZE),this.renderFlags.zoom&&(this.renderLevel=this.RENDER_LEVEL_ZOOM),this.renderFlags.data&&(this.renderLevel=this.RENDER_LEVEL_DATA),(this.renderFlags.viewport||this.renderFlags.zoom)&&(this.transitionDuration=0),this.scaleFactor=this.timelineView.physicalScaleFactor,this.renderFlags.data?(this.dataChangedLifetimeBgLayer(t),this.dataChangedAboveLayer(t),this.dataChangedOverlayLayer(t),(this.renderFlags.viewport||this.renderFlags.zoom)&&(this.scrollBackgroundLayer(t),this.scrollOverlayLayer(t)),window.isAeonWebExport&&this.bookmarkAdd.style("display","none")):(this.renderFlags.viewport||this.renderFlags.zoom)&&(this.scrollLifetimeBgLayer(t),this.scrollBackgroundLayer(t),this.scrollAboveLayer(t),this.scrollOverlayLayer(t)),this.updateEventLayer(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove(),this.verticalAnimateToggledLaneIds=[],this.transitionDuration=this.defaultTransitionDuration)},ATTimelineViewPainter.prototype.scrollBackgroundLayer=function(t){var e;globalCanvas=this.timelineView,e=this.bgLayer.selectAll(".bgDateLine").data(t.headerData.sublabels),this.renderBackgroundDateLines(e),globalCanvas=null},ATTimelineViewPainter.prototype.scrollLifetimeBgLayer=function(t){var e;globalCanvas=this.timelineView,e=this.lifetimeBgLayer.selectAll(".laneG").data(_.values(t.lanes),function(t){return t.id}),this.transformLaneG(e),this.renderLifetimeBoundsStart(e.select(".bgBoundsStart"),0),this.renderLifetimeBoundsEnd(e.select(".bgBoundsEnd"),0),this.renderNewBgLanes(e.enter().append("g")),e.exit().remove(),globalCanvas=null},ATTimelineViewPainter.prototype.dataChangedLifetimeBgLayer=function(t){var e;globalCanvas=this.timelineView,e=this.lifetimeBgLayer.selectAll(".laneG").data(_.values(t.lanes),function(t){return t.id}),this.transformLaneG(e.transition().duration(this.transitionDuration)),this.renderLifetimeBoundsStart(e.select(".bgBoundsStart"),this.transitionDuration),this.renderLifetimeBoundsEnd(e.select(".bgBoundsEnd"),this.transitionDuration),this.renderNewBgLanes(e.enter().append("g")),e.exit().remove(),globalCanvas=null},ATTimelineViewPainter.prototype.renderNewBgLanes=function(t){this.transformLaneG(t.attr("class","laneG")),this.renderLifetimeBoundsStart(t.append("rect").attr("class","bgBoundsStart").attr("x",0).attr("y",0)),this.renderLifetimeBoundsEnd(t.append("rect").attr("class","bgBoundsEnd").attr("y",0).attr("width","100%"))},ATTimelineViewPainter.prototype.renderLifetimeBoundsStart=function(t,e){return e>0?t.transition().duration(e).attr("width",function(t){if(t.lifetimeBounds.hasStart){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.start,0));return Math.max(0,Math.round(e.x))}return 0}).attr("height",function(t){return t.height}):t.attr("width",function(t){if(t.lifetimeBounds.hasStart){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.start,0));return Math.max(0,Math.round(e.x))}return 0}).attr("height",function(t){return t.height}),t},ATTimelineViewPainter.prototype.renderLifetimeBoundsEnd=function(t,e){return e>0?t.transition().duration(e).attr("x",function(t){if(t.lifetimeBounds.hasStop){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.stop,0));return Math.max(0,Math.round(e.x))}return 1e5}).attr("height",function(t){return t.height}):t.attr("x",function(t){if(t.lifetimeBounds.hasStop){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.stop,0));return Math.max(0,Math.round(e.x))}return 1e5}).attr("height",function(t){return t.height}),t},ATTimelineViewPainter.prototype.updateEventLayer=function(t){var e,i=this;e=this.eventLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),e.each(function(t,e){i.renderIndividualLaneEventGroup(this,t)}),e.exit().remove()},ATTimelineViewPainter.prototype.renderIndividualLaneEventGroup=function(t,e){var i,n=this,a=d3.select(t),r=this.timelineView.absoluteToRelativePoint(new ATPoint(0,e.top)),s=a.selectAll(".eventDivWrapper").data(e.nodes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_SELECTION&&(i=this.transitionDuration?a.transition().duration(this.transitionDuration):a,a.classed("collapsed",e.collapsed),i.style("top",Math.round(r.y*this.scaleFactor)+"px"),s.each(function(t){n.updateIndividualEvent(this,t)}),s.enter().append("div").each(function(t){var e=d3.select(this),i=n.transitionDuration?e.transition().duration(n.transitionDuration):e;n.createIndividualEvent(this,e,t),n.updateIndividualEventPosition(this,i,t)})),this.renderFlags.selection&&s.classed("selected",function(t){return t.selected&&!t.isLaneCollapsed}),this.renderLevel>this.RENDER_LEVEL_SELECTION&&s.exit().remove()},ATTimelineViewPainter.prototype.createIndividualEvent=function(t,e,i){var n,a=this.timelineView.absoluteToRelativePoint(new ATPoint(i.totalRect.left(),0)),r=this.verticalAnimateToggledLaneIds.length,s=i.totalRect.top();e.classed("eventDivWrapper",!0).style("top",MyRound(s,this.scaleFactor)+"px").style("left",MyRound(a.x,this.scaleFactor)+"px").style("width",MyRound(i.totalRect.size.width,this.scaleFactor)+"px").style("height",MyRound(i.totalRect.size.height,this.scaleFactor)+"px").style("opacity",r?1:0).call(this.timelineView.eventDrag),n=e.append("svg").classed("markerSvg",!0).attr("xmlns","http://www.w3.org/2000/svg"),n.append("polygon").classed("markerRect",!0),this.updateIndividualEventContent(t,e,i),this.updateIndividualEventSize(t,e,e,i)},ATTimelineViewPainter.prototype.updateIndividualEvent=function(t,e){var i=d3.select(t),n=this.transitionDuration?i.transition().duration(this.transitionDuration):i;this.renderLevel>=this.RENDER_LEVEL_DATA&&this.updateIndividualEventContent(t,i,e),this.renderLevel>=this.RENDER_LEVEL_SIZE&&this.updateIndividualEventSize(t,i,n,e),this.renderLevel>=this.RENDER_LEVEL_POSITION&&this.updateIndividualEventPosition(t,n,e)},ATTimelineViewPainter.prototype.updateIndividualEventContent=function(t,e,i){var n,a,r,s=this.timelineView.showEventDate,o=e.select(".markerSvg");e.attr("pointer-events",i.visible?null:"none").classed("isFaded",i.isFaded).classed("expanded",i.showMore).classed("parent",i.showChildNodes).classed("selected",i.selected&&!i.isLaneCollapsed),i.isLaneCollapsed?(e.select(".eventContentWrapper").remove(),e.select(".showMoreSpan").remove()):(a=e.select(".eventContentWrapper"),a.empty()&&this.createIndividualEventContents(e,i),e.select(".eventTitle").text(i.displayTitle),e.select(".eventDate").text(i.dateString).classed("parent",i.showChildNodes).style("display",i.showMore||s?null:"none"),d3ExpandedContent=e.select(".expandedWrapper").html(i.showMore?i.contentHTML:""),i.showMore&&this.listenToEventLinkClicks(d3ExpandedContent,i),e.select(".showMoreSpan").classed("fa-chevron-circle-right",!i.showMore).classed("fa-chevron-circle-left",i.showMore)),n=e.select(".markerSvg").selectAll(".markerRect").data(i.markerPoints).style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.enter().append("polygon").classed("markerRect",!0).style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.exit().remove(),i.isParent&&!i.isLaneCollapsed?(r=e.select(".childRectDiv"),r.empty()&&this.createIndividualParentComponents(e,o,i),e.select(".childRectDiv").style("opacity",i.showChildNodes?1:0).style("border-color",i.color),n=e.select(".markerSvg").selectAll(".parentStack2").data(i.markerPoints).style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.enter().insert("polygon",":first-child").classed("parentStack2",!0).attr("transform","translate(6,6)").style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.exit().remove(),n=e.select(".markerSvg").selectAll(".parentStack1").data(i.markerPoints).style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.enter().insert("polygon",".markerRect").classed("parentStack1",!0).attr("transform","translate(3,3)").style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color),n.exit().remove(),e.select(".parentBulletSpan").classed("fa-plus-circle",i.visible&&!i.showChildNodes).classed("fa-minus-circle",i.visible&&i.showChildNodes)):this.removeIndividualParentComponents(e,o)},ATTimelineViewPainter.prototype.updateIndividualEventSize=function(t,e,i,n){i.style("width",MyCeil(n.totalRect.size.width+n.widthAdjustToOptimise,this.scaleFactor)+"px").style("height",MyCeil(n.totalRect.size.height,this.scaleFactor)+"px"),i.select(".eventContentWrapper").style("width",MyCeil(n.textSize.width,this.scaleFactor)+"px").style("height",MyCeil(n.textSize.height,this.scaleFactor)+"px"),e.select(".expandedWrapper").style("width",n.showMore?MyRound(n.textSize.width,this.scaleFactor)+"px":"0px"),i.select(".expandedWrapper").style("height",n.showMore?MyRound(n.textSize.height,this.scaleFactor)+"px":"0px"),i.select(".markerSvg").attr("viewBox","0 0 "+(n.markerRect.size.width+n.widthAdjustToOptimise)+" "+n.markerRect.size.height).attr("width",MyCeil(n.markerRect.size.width+n.widthAdjustToOptimise,this.scaleFactor)+"px").attr("height",MyCeil(n.markerRect.size.height,this.scaleFactor)+"px"),this.transitionDuration?e.select(".markerSvg").selectAll(".markerRect").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+n.translateMarkerX+",0)"):e.select(".markerSvg").selectAll(".markerRect").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+n.translateMarkerX+",0)"),n.isParent&&!n.isLaneCollapsed&&(i.select(".childRectDiv").style("width",n.childRect.size.width>0?MyRound(n.childRect.size.width+n.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px").style("height",MyRound(n.childRect.size.height,this.scaleFactor)+"px"),this.transitionDuration?(e.selectAll(".parentStack2").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+6)+",6)"),e.selectAll(".parentStack1").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+3)+",3)")):(e.selectAll(".parentStack2").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+6)+",6)"),e.selectAll(".parentStack1").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+3)+",3)")),i.select(".parentBulletSpan").style("left",n.bulletPos?MyRound(n.bulletPos.x+n.widthAdjustToOptimise,this.scaleFactor)+"px":null))},ATTimelineViewPainter.prototype.updateIndividualEventPosition=function(t,e,i){var n=this.timelineView.absoluteToRelativePoint(new ATPoint(i.totalRect.left(),0));if(n.x+=i.positionAdjustToOptimise,e.style("top",MyRound(i.totalRect.top(),this.scaleFactor)+"px").style("left",MyRound(n.x,this.scaleFactor)+"px").style("opacity",i.visible?1:0),(i.widthAdjustToOptimise||i.translateMarkerX)&&(e.style("width",MyRound(i.totalRect.size.width+i.widthAdjustToOptimise,this.scaleFactor)+"px"),e.select(".markerSvg").attr("viewBox","0 0 "+(i.markerRect.size.width+i.widthAdjustToOptimise)+" "+i.markerRect.size.height).attr("width",MyRound(i.markerRect.size.width+i.widthAdjustToOptimise,this.scaleFactor)+"px"),e.select(".markerRect").attr("transform","translate("+i.translateMarkerX+",0)"),i.isParent&&!i.isLaneCollapsed)){i.childRect.size.width>0?MyRound(i.childRect.size.width+i.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px",e.select(".childRectDiv");e.select(".childRectDiv").style("width",i.childRect.size.width>0?MyRound(i.childRect.size.width+i.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px"),e.select(".parentStack2").attr("transform","translate("+(i.translateMarkerX+6)+",6)"),e.select(".parentStack1").attr("transform","translate("+(i.translateMarkerX+3)+",3)"),e.select(".parentBulletSpan").style("left",i.bulletPos?MyRound(i.bulletPos.x+i.widthAdjustToOptimise,this.scaleFactor)+"px":null)}},ATTimelineViewPainter.prototype.createIndividualEventContents=function(t,e){var i=(t.append("span").classed("showMoreSpan fa",!0).on("click",function(t){window.mainApp.timelineView.toggleMoreEventInfo(t)}),t.append("div").classed("eventContentWrapper",!0));i.append("div").classed("eventTitle draggable",!0),i.append("div").classed("eventDate draggable",!0),i.append("div").classed("expandedWrapper draggable",!0)},ATTimelineViewPainter.prototype.createIndividualParentComponents=function(t,e,i){t.insert("div",".markerSvg").classed("childRectDiv",!0).style("left",MyRound(i.childRect.origin.x,this.scaleFactor)+"px").style("width",i.childRect.size.width>0?MyRound(i.childRect.size.width-i.widthAdjustToOptimise+10,this.scaleFactor)+"px":"10px").style("height",0).style("opacity",0);e.insert("polygon",".markerRect").classed("parentStack2",!0).attr("transform","translate(6,6)"),e.insert("polygon",".markerRect").classed("parentStack1",!0).attr("transform","translate(3,3)"),e.on("dblclick",function(){i.visible&&(window.mainApp.timelineView.toggleShowChildNodes(i.id,i.laneId),d3.event.stopPropagation())}),t.insert("span",".showMoreSpan").classed("parentBulletSpan fa",!0).on("click",function(){window.mainApp.timelineView.toggleShowChildNodes(i.id,i.laneId),d3.event.stopPropagation()}).on("dblclick",function(){d3.event.stopPropagation()})},ATTimelineViewPainter.prototype.removeIndividualParentComponents=function(t,e){t.select(".childRectDiv").remove(),e.selectAll(".parentStack2").remove(),e.selectAll(".parentStack1").remove(),t.select(".parentBulletSpan").remove(),e.on("dblclick",null)},ATTimelineViewPainter.prototype.listenToEventLinkClicks=function(t,e){t.selectAll(".externalLinkAnchor").on("click",function(t,i){if(window.isAeonWebExport)return!0;var n=d3.select(this),a=(n.attr("href"),[]);return _.each(e.links,function(t){a.push({filepath:t.path})}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(a),i),d3.event.stopPropagation(),d3.event.preventDefault(),!1}),t.select(".eventImage").on("dblclick",function(t,i){if(window.isAeonWebExport)return!0;var n=t.imagePath,a=[],r=0;return _.each(e.links,function(t){a.push({filepath:t.path})}),r=_.findIndex(a,function(t){return t.filepath==n}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(a),r),d3.event.stopPropagation(),d3.event.preventDefault(),!1})},ATTimelineViewPainter.prototype.createIndividualLaneHeaderDiv=function(t,e){var i=d3.select(t).classed("laneHeaderDiv",!0).style("transform","translateY(0px)").call(this.timelineView.laneDrag);i.append("span").classed("laneDivArrow fa",!0).on("click",function(t){window.mainApp.timelineView.toggleLane(t.id)}),i.append("span").classed("laneDivLabel",!0)},ATTimelineViewPainter.prototype.renderIndividualLaneHeaderDiv=function(t,e){var i,n,a=this,r=d3.select(t),s=r.selectAll(".lifetimeMarkerSpan").data(e.lifetimeMarks),o=globalCanvas.absoluteToRelativePoint(new ATPoint(0,e.top)).y;o<TimelineDisplayConstants.timeHeaderHeight&&(o+=Math.min(-o+TimelineDisplayConstants.timeHeaderHeight,e.height-TimelineDisplayConstants.lifetimeHeight)),r.classed("collapsed",e.collapsed).classed("odd",e.odd),r.select(".laneDivArrow").classed("fa-chevron-up",!e.collapsed).classed("fa-chevron-down",e.collapsed),r.select(".laneDivLabel").text(e.entityName),s.enter().append("span").classed("lifetimeMarkerSpan",!0).style("transform","translateX(0px)"),s.classed("lifetimeMarkerDot",function(t){return t.showDot}).text(function(t){return t.text}),s.exit().remove(),this.transitionDuration?(i=r.transition().duration(this.transitionDuration).style("top",o*this.scaleFactor+"px"),n=s.transition().duration(this.transitionDuration).style("left",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return e.x*a.scaleFactor+"px"})):(r.style("top",o*this.scaleFactor+"px"),s.style("left",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return e.x*a.scaleFactor+"px"}))},ATTimelineViewPainter.prototype.transformLaneG=function(t){return lifetime_g=t.select(".lifetimeG"),this.transformLifetimeG(lifetime_g),t.attr("class",function(t){return t.collapsed?"laneG collapsed":"laneG"}).attr("transform",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(0,t.top));return"translate(0,"+Math.round(e.y)+")"})},ATTimelineViewPainter.prototype.transformLifetimeG=function(t){return t.attr("transform",function(t){var e,i=globalCanvas.absoluteToRelativePoint(new ATPoint(0,t.top));return e=i.y<TimelineDisplayConstants.timeHeaderHeight?Math.min(-i.y+TimelineDisplayConstants.timeHeaderHeight,t.height-TimelineDisplayConstants.lifetimeHeight):0,"translate(0,"+Math.round(e)+")"})},ATTimelineViewPainter.prototype.scrollAboveLayer=function(t){var e;globalCanvas=this.timelineView,e=this.dependencyG.selectAll(".dependencyPath").data(t.dependencyPaths,function(t){return t.name}),this.renderDependencyPaths(e,0),globalCanvas=null},ATTimelineViewPainter.prototype.dataChangedAboveLayer=function(t){var e;globalCanvas=this.timelineView,e=this.dependencyG.selectAll(".dependencyPath").data(t.dependencyPaths,function(t){return t.name}),this.renderDependencyPaths(e,this.transitionDuration),globalCanvas=null},ATTimelineViewPainter.prototype.renderDependencyPaths=function(t,e){return e>0?t.transition().duration(e).style("stroke",function(t){return t.color}).attr("d",function(t){var e=globalCanvas.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}):t.style("stroke",function(t){return t.color}).attr("d",function(t){var e=globalCanvas.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}),t.enter().append("path").attr("class","dependencyPath").style("stroke",function(t){return t.color}).attr("d",function(t){var e=globalCanvas.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}),t.exit().remove(),t},ATTimelineViewPainter.prototype.scrollOverlayLayer=function(t){var e,i,n,a,r,s,o,l,c,d,h=this;globalCanvas=this.timelineView,e=this.laneOverlayLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id}),e.enter().append("div").each(function(t,e){h.createIndividualLaneHeaderDiv(this,t,e)}),e.each(function(t,e){h.renderIndividualLaneHeaderDiv(this,t,e)}),e.exit().remove(),i=this.staticTimeHeaderG.selectAll(".timeHdrLabel").data(t.headerData.labels),this.renderHeaderLabels(i,t.headerData.labels),n=this.staticTimeHeaderG.selectAll(".timeHdrLine").data(t.headerData.labels),this.renderHeaderLines(n),a=this.staticTimeHeaderG.selectAll(".timeHdrSubLabel").data(t.headerData.sublabels),this.renderSubHeaderLabels(a),r=this.staticTimeHeaderG.selectAll(".timeHdrSubDot").data(t.headerData.sublabels),this.renderSubHeaderDots(r),laneNav=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id}),this.renderLaneNav(laneNav),this.verticalScrollKnob||(this.verticalScrollTrack=this.laneNavSvg.append("rect").attr("class","scrollTrack").attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("rx",0).attr("ry",0).on("click",function(t){return h.timelineView.clickInScrollTrack()}),this.verticalScrollKnob=this.laneNavSvg.append("rect").attr("class","scrollknob").attr("width",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2).call(this.timelineView.verticalScrollDrag),this.$verticalScrollKnob=$(".timelineContentDiv .scrollknob"),this.contextLensG=this.contextLensLayer.append("g").attr("class","contextLensG"),this.lastDisplayedSkin=this.timelineView.skin,d=TimelineDisplayConstants.contextLensRootFolder+this.timelineView.skin+"/",this.contextLensLeftArrow=this.contextLensG.append("image").attr("width",13).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",d+TimelineDisplayConstants.contextLensImageLeftArrowHref).attr("preserveAspectRatio","none").attr("class","contextLensImage resizable").call(this.timelineView.contextLensDrag),this.contextLensMiddle=this.contextLensG.append("image").attr("width",24).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",d+TimelineDisplayConstants.contextLensImageMiddleHref).attr("preserveAspectRatio","none").attr("class","contextLensImage").call(this.timelineView.contextLensDrag),this.contextLensRightArrow=this.contextLensG.append("image").attr("width",13).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",d+TimelineDisplayConstants.contextLensImageRightArrowHref).attr("preserveAspectRatio","none").attr("class","contextLensImage resizable").call(this.timelineView.contextLensDrag)),this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack),c=this.timelineView.viewport.size.height-TimelineDisplayConstants.navFooterHeight,s=this.contextBarG.selectAll(".contextBarLabel").data(t.contextLabels,function(t){return t.text}),this.renderContextBarLabels(s),o=this.contextBarG.selectAll(".contextBarDot").data(t.contextDots,function(t){return t.id}),this.renderContextBarDots(o,0),l=this.contextBarG.selectAll(".contextBarLine").data(t.contextLabels,function(t){return t.text}),this.renderContextBarLines(l),this.renderContextLens(this.contextLensLeftArrow,this.contextLensMiddle,this.contextLensRightArrow),globalCanvas=null},ATTimelineViewPainter.prototype.skinChanged=function(){this.lastDisplayedSkin&&this.lastDisplayedSkin!=this.timelineView.skin&&(this.lastDisplayedSkin=this.timelineView.skin,skinPath=TimelineDisplayConstants.contextLensRootFolder+this.timelineView.skin+"/",this.contextLensLeftArrow.attr("xlink:href",skinPath+TimelineDisplayConstants.contextLensImageLeftArrowHref),this.contextLensMiddle.attr("xlink:href",skinPath+TimelineDisplayConstants.contextLensImageMiddleHref),this.contextLensRightArrow.attr("xlink:href",skinPath+TimelineDisplayConstants.contextLensImageRightArrowHref))},ATTimelineViewPainter.prototype.dataChangedOverlayLayer=function(t){var e,i,n,a,r=this;globalCanvas=this.timelineView,lane_div=this.laneOverlayLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id}),lane_div.enter().append("div").each(function(t,e){r.createIndividualLaneHeaderDiv(this,t,e)}),lane_div.each(function(t,e){r.renderIndividualLaneHeaderDiv(this,t,e)}),lane_div.exit().remove(),e=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id}),this.renderLaneNav(e.transition().duration(this.transitionDuration)),this.renderLaneNav(e.enter().append("rect").attr("width",TimelineDisplayConstants.laneNavNodeWidth).attr("rx",TimelineDisplayConstants.laneNavNodeWidth/2).attr("ry",TimelineDisplayConstants.laneNavNodeWidth/2).attr("x",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).on("click",function(t){window.mainApp.timelineView.scrollToLane(t)})),e.exit().transition().duration(this.transitionDuration).remove(),label_g=this.staticTimeHeaderG.selectAll(".timeHdrLabel").data(t.headerData.labels),this.renderHeaderLabels(label_g,t.headerData.labels),line_g=this.staticTimeHeaderG.selectAll(".timeHdrLine").data(t.headerData.labels),
this.renderHeaderLines(line_g),sub_label_g=this.staticTimeHeaderG.selectAll(".timeHdrSubLabel").data(t.headerData.sublabels),this.renderSubHeaderLabels(sub_label_g),n=this.staticTimeHeaderG.selectAll(".timeHdrSubDot").data(t.headerData.sublabels),this.renderSubHeaderDots(n),i=this.bookmarkGroup.selectAll(".bookmarkItem").data(t.bookmarks),i.select("span.bookmarkName").text(function(t){return t.name}),i.select("span.bookmarkItemRemove").classed("fa",!0),this.renderNewBookmarks(i.enter().append("div")),i.exit().remove(),a=this.filterGroup.selectAll(".filterBarWrapper").data(t.filters,function(t){return t.uniqueId}),this.renderExistingFilters(a),this.renderNewFilters(a.enter().append("div")),a.exit().remove(),context_dot_g=this.contextBarG.selectAll(".contextBarDot").data(t.contextDots,function(t){return t.id}),this.renderContextBarDots(context_dot_g,this.transitionDuration),this.verticalScrollKnob&&this.verticalScrollTrack&&this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack),globalCanvas=null},ATTimelineViewPainter.prototype.renderHeaderLabels=function(t,e){var i;return t.attr("x",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition+5,0));return e.x}).text(function(t){return t.text}),i=t.enter().append("text").text(function(t){return t.text}).attr("class","timeHdrLabel").attr("x",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition+5,0));return e.x}).attr("y",TimelineDisplayConstants.mainTickTextOffsetY),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderHeaderLines=function(t){var e;return t.attr("x1",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)+.5}).attr("x2",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)+.5}),e=t.enter().append("line").attr("class","timeHdrLine").attr("x1",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)+.5}).attr("x2",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)+.5}).attr("y1",0).attr("y2",TimelineDisplayConstants.mainTickLineHeight),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderSubHeaderLabels=function(t){var e;return t.attr("x",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return e.x}).text(function(t){return t.text}),e=t.enter().append("text").text(function(t){return t.text}).attr("class","timeHdrSubLabel").attr("x",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return e.x}).attr("y",TimelineDisplayConstants.subTickTextOffsetY).style("text-anchor","middle"),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderSubHeaderDots=function(t){var e;return t.attr("cx",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)}),e=t.enter().append("circle").attr("class","timeHdrSubDot").attr("cx",function(t){var e=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(e.x)}).attr("cy",TimelineDisplayConstants.subTickCircleOffsetY).attr("r",TimelineDisplayConstants.subTickCircleRadius),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderBackgroundDateLines=function(t){var e;return t.attr("x1",function(t,e){var i=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return i.x+.5}).attr("x2",function(t,e){var i=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return i.x+.5}),e=t.enter().append("line").attr("class","bgDateLine").attr("x1",function(t,e){var i=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return i.x+.5}).attr("x2",function(t,e){var i=globalCanvas.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return i.x+.5}).attr("y1",TimelineDisplayConstants.timeHeaderHeight).attr("y2","100%"),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderLaneNav=function(t){var e=TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,i=globalCanvas.viewport.top()+e,n=globalCanvas.viewport.size.height-e-TimelineDisplayConstants.navFooterHeight;return rangeDiff=globalCanvas.rangeY.max-TimelineDisplayConstants.navFooterHeight,t.attr("class",function(t){return i>=t.top&&i<t.top+t.height?"laneNav current":"laneNav"}).attr("y",function(t){return t.top/rangeDiff*n+e+1}).attr("height",function(t){return Math.max(0,t.height/rangeDiff*n-2)}),t.each(function(t,e){var i=$(this),a=Math.max(0,t.height/rangeDiff*n-2),r=i.data("opentips");r&&r[0]?window.mainApp.isMac||(r[0].options.offset=[0,a/2]):new Opentip(this,t.entityName,{style:"laneNodeTooltipStyle",offset:window.mainApp.isMac?[0,0]:[0,a/2]})}),t},ATTimelineViewPainter.prototype.renderVerticalScrollBar=function(t,e){var i=TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,n=globalCanvas.viewport.top()+i,a=globalCanvas.viewport.size.height-i-TimelineDisplayConstants.navFooterHeight,r=globalCanvas.rangeY.max-TimelineDisplayConstants.navFooterHeight,s=r>0?ATUtilities.floatToInt(n/r*a+i):0,o=r>0?ATUtilities.floatToInt(a/r*a):r,l=Math.max(.5,TimelineDisplayConstants.scrollKnobXPosition-2.5),c=(l+TimelineDisplayConstants.scrollTrackThickness,a>o);return e.attr("x",l).attr("y",i).attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("height",a).style("fill-opacity",c?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",c?null:0),o==a||s===this.verticalScrollKnobTop&&o==this.verticalScrollKnobHeight&&this.timelineView.viewport.size.width==this.verticalScrollKnobRight||t.attr("x",TimelineDisplayConstants.scrollKnobXPosition).style("fill-opacity",c?TimelineDisplayConstants.scrollKnobOpacity:0).attr("y",s).attr("height",o).transition().delay(1e3).duration(500).style("fill-opacity",c?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.verticalScrollTrackHeight=a,this.verticalScrollKnobTop=s,this.verticalScrollKnobHeight=o,this.verticalScrollKnobRight=this.timelineView.viewport.size.width,t},ATTimelineViewPainter.prototype.renderContextBarLabels=function(t){var e;return t.attr("x",function(t){return t.xPosition+TimelineDisplayConstants.contextBarLabelOffsetX}),e=t.enter().append("text").text(function(t){return t.text}).on("click",function(){window.mainApp.timelineView.contextBarClick()}).attr("class","contextBarLabel").attr("x",function(t){return t.xPosition+TimelineDisplayConstants.contextBarLabelOffsetX}).attr("y",TimelineDisplayConstants.contextBarLabelOffsetY),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextBarDots=function(t,e){var i;return e>0?t.transition().duration(e).attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}).style("fill",function(t){return t.color}):t.attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}).style("fill",function(t){return t.color}),i=t.enter().append("rect").on("click",function(){window.mainApp.timelineView.contextBarClick()}).attr("class","contextBarDot").attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}).attr("y",TimelineDisplayConstants.contextDotOffsetY).attr("height",2*TimelineDisplayConstants.contextDotRadius).attr("rx",TimelineDisplayConstants.contextDotRadius).attr("ry",TimelineDisplayConstants.contextDotRadius).style("fill",function(t){return t.color}),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextBarLines=function(t){var e;return t.attr("x1",function(t){return t.xPosition+.5}).attr("x2",function(t){return t.xPosition+.5}),e=t.enter().append("line").attr("class","contextBarLine").attr("x1",function(t){return t.xPosition+.5}).attr("x2",function(t){return t.xPosition+.5}).attr("y1",0).attr("y1",TimelineDisplayConstants.contextHeight),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextLens=function(t,e,i){t.attr("x",this.timelineView.contextLeftLensPixel-TimelineDisplayConstants.contextLensImageArrowWidth).attr("width",TimelineDisplayConstants.contextLensImageArrowWidth),e.attr("x",this.timelineView.contextLeftLensPixel).attr("width",Math.max(0,this.timelineView.contextRightLensPixel-this.timelineView.contextLeftLensPixel)),i.attr("x",this.timelineView.contextRightLensPixel).attr("width",TimelineDisplayConstants.contextLensImageArrowWidth)},ATTimelineViewPainter.prototype.renderNewBookmarks=function(t){return t.attr("class","bookmarkItem").on("click",function(t){window.mainApp.timelineView.bookmarkClick(t)}).append("span").classed("bookmarkName",!0).text(function(t){return t.name}),t.append("span").classed("bookmarkItemRemove fa fa-times-circle",!0).on("click",function(t){return window.ApplicationInterface?(window.ApplicationInterface.removeBookmark(window.timelineDocumentId,t.id),d3.event.stopPropagation(),!1):void 0}),t},ATTimelineViewPainter.prototype.renderExistingFilters=function(t){},ATTimelineViewPainter.prototype.renderNewFilters=function(t){},module.exports=ATTimelineViewPainter;
},{"../lib/hilitor2":7,"../lib/opentip":11,"./ATDisplayConstants":26,"./ATLine":60,"./ATPoint":67,"./ATRect":73,"./ATSize":79,"./ATUtilities":91,"d3":300,"jquery":307,"lodash":309}],90:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),Backbone=require("backbone"),dhtmlXToolbarObject=require("../lib/dhtmlxconcat"),dhtmlXSlider=require("../lib/dhtmlxslider"),dhtmlXMenuObject=require("../lib/dhtmlxmenu");ignore4=require("mousetrap"),ignore5=require("../lib/mousetrap-global-bind");var ATToolbar=Backbone.View.extend({initialize:function(){var i=this.$el.attr("id");this.sliders={},this.textfields={},this.windowMenu=new dhtmlXMenuObject({parent:"menuDiv",icons_path:"../../../Images/"}),this.windowMenu.setOpenMode("win"),this.toolbar=new dhtmlXToolbarObject({parent:i,icons_path:"images/"}),this.sliderMinValue=0,this.sliderMaxValue=100,this.toolbar.attachEvent("onClick",this.itemClick.bind(this)),this.toolbar.attachEvent("onStateChange",this.itemStateChange.bind(this)),this.toolbar.attachEvent("onEnter",this.itemTextInput.bind(this)),this.toolbar.attachEvent("onValueChange",this.itemSliderChange.bind(this)),this.windowMenu.attachEvent("onClick",this.itemClick.bind(this)),this.shortcutMap={},this.flattenedMenuCommands=[],window.addEventListener("resize",this.resize.bind(this),!1)},setMenuCommands:function(i){var t=null;this.menuCommands=i,this.windowMenu.clearAll(),this.menuSepId=0,_.each(i,function(i){this.addTopLevelMenu(i,t),t=i.identifier},this),this.mapAllShortcuts(),this.resize()},addTopLevelMenu:function(i,t){var e=0,n=null;this.windowMenu.addNewSibling(t,i.identifier,i.text,!1,null,null),i.shortcut&&(i.shortcut instanceof Array?this.windowMenu.setHotKey(i.identifier,i.shortcut[0]):this.windowMenu.setHotKey(i.identifier,i.shortcut)),_.each(i.options,function(t){this.addSubMenu(i.identifier,e,n,t),e++,n=t.identifier},this)},addSubMenu:function(i,t,e,n){var o=0,s=null;return"-"==n.identifier?(this.windowMenu.addNewSeparator(e,"sep"+this.menuSepId),void this.menuSepId++):(this.windowMenu.addNewChild(i,t,n.identifier,n.text,!1,null,null),this.flattenedMenuCommands.push(n.identifier),n.shortcut&&(n.shortcut instanceof Array?this.windowMenu.setHotKey(n.identifier,n.shortcut[0]):this.windowMenu.setHotKey(n.identifier,n.shortcut)),void(n.options&&_.each(n.options,function(i){this.addSubMenu(n.identifier,o,s,i),o++,s=i.identifier},this)))},setToolbarCommands:function(i){var t=!0;this.commands=i,this.toolbar.clearAll(),this.position=0,this.sepId=0,this.spacerId=0,this.gapId=0,this.sliders={},this.textfields={},_.each(i,function(i){t||!i.type||i.noSep||this.toolbar.addSeparator("sep"+this.sepId++,this.position++),t=!1,"button"==i.type?this.addButton(i):"buttonSelect"==i.type?this.addButtonSelect(i):"buttonTwoState"==i.type?this.addButtonTwoState(i):"input"==i.type?this.addInput(i):"slider"==i.type?this.addSlider(i):(this.toolbar.addText("spacer"+this.spacerId++,this.position++,'<div style="width: 25px;">&nbsp;</div>'),t=!0),i.center&&(this.toolbar.addSpacer(i.identifier),t=!0)},this),this.mapAllShortcuts(),this.resize()},updateOptionsForIdentifier:function(i,t){var e=this,n=this.toolbar.getPosition(i),o=null,s=null;_.each(this.commands,function(t){t.identifier==i&&(o=t)},this),o&&(o.options=t,this.toolbar.removeItem(i),this.addButtonSelect(o,n)),o=null,_.each(this.menuCommands,function(t){t.identifier==i&&(o=t),_.each(t.options,function(t){t.identifier==i&&(o=t)})}),o&&(_.each(o.options,function(i){e.windowMenu.removeItem(i.identifier)}),o.options=t,n=0,_.each(o.options,function(i){this.addSubMenu(o.identifier,n,s,i),n++,s=i.identifier},this)),this.mapAllShortcuts()},mapAllShortcuts:function(){this.shortcutMap={},Mousetrap.reset(),_.each(this.commands,function(i){var t;i.shortcut&&(t="buttonTwoState"==i.type?this.itemStateChange.bind(this):this.itemClick.bind(this),i.shortcut instanceof Array?_.each(i.shortcut,function(e){this.mapShortcut(e,i.identifier,t)},this):this.mapShortcut(i.shortcut,i.identifier,t)),"buttonSelect"==i.type&&_.each(i.options,function(t){t.shortcut&&this.mapShortcut(t.shortcut,t.identifier,this.itemClick.bind(this),i.global)},this)},this),_.each(this.menuCommands,function(i){i.shortcut&&this.mapShortcut(i.shortcut,i.identifier,this.itemClick.bind(this),i.global),this.mapChildShortcuts(i)},this)},mapChildShortcuts:function(i){_.each(i.options,function(i){i.shortcut&&(i.shortcut instanceof Array?_.each(i.shortcut,function(t){this.mapShortcut(t,i.identifier,this.itemClick.bind(this),i.global)},this):this.mapShortcut(i.shortcut,i.identifier,this.itemClick.bind(this),i.global)),this.mapChildShortcuts(i)},this)},mapShortcut:function(i,t,e,n){var o=this,s=function(i){var n,s=!1,a=_.find(o.commands,function(i){return i.identifier==t}),r=_.find(o.flattenedMenuCommands,function(i){return i==t});return r?s=o.windowMenu.isItemEnabled(t):a?s=o.toolbar.isEnabled(t):(n=o.toolbar.getParentId(t),n&&(s=o.toolbar.isListOptionEnabled(n,t))),s?(e(t),!1):!0};n?Mousetrap.bindGlobal(i.toLowerCase(),s):Mousetrap.bind(i.toLowerCase(),s),window.mainApp&&window.mainApp.bindKeyEvents()},addButton:function(i){this.toolbar.addButton(i.identifier,this.position++,window.isAeonWebExport?i.text:"",i.image,i.disabledImage),this.toolbar.setItemToolTip(i.identifier,i.text)},addButtonSelect:function(i,t){var e=[],n=t?t:this.position++;_.each(i.options,function(i){var t,n;"-"==i.identifier?e.push(["sep"+this.sepId++,"sep"]):(n=i.shortcut?'<div class="menuShortcut">'+i.shortcut+"</div>":"",t=i.text+n,e.push([i.identifier,"obj",t,i.image]))},this),this.toolbar.addButtonSelect(i.identifier,n,"",e,i.image,i.disabledImage,i.selectable,!0),this.toolbar.setItemToolTip(i.identifier,i.text)},addButtonTwoState:function(i){this.toolbar.addButtonTwoState(i.identifier,this.position++,"",i.image,i.disabledImage),this.toolbar.setItemToolTip(i.identifier,i.text)},addInput:function(i){var t,e,n=this,o="toolbarText-"+i.identifier,s=o+"-input",a=o+"-clear",r="searchClearHidden";this.toolbar.addText(i.identifier,this.position++,'<div class="toolbarSearch" id="'+o+'"><span class="toolbarSearchIcon fa fa-search"></span><input id="'+s+'" placeholder="'+(i.placeholder?i.placeholder:"")+'"><span id="'+a+'" class="toolbarSearchClear fa fa-times-circle '+r+'"></span></div>'),t=$("#"+s),e=$("#"+a),this.textfields[i.identifier]=t,t.on("focus",function(i){t.select()}),t.on("keydown",function(e){var o=e.keycode||e.which;13===o?(n.itemTextInput(i.identifier,t.val()),t.select()):27===o&&(t.val(""),t.blur(),n.itemTextInput(i.identifier,""),t.removeClass("searchError"))}),t.on("input",function(i){t.val()?e.removeClass(r):e.hasClass(r)||e.addClass(r),t.removeClass("searchError")}),e.on("click",function(e){t.val(""),t.blur(),n.itemTextInput(i.identifier,""),t.removeClass("searchError")})},focusTextItem:function(i){var t=this.textfields[i];t&&(t.select(),t.focus())},markErrorTextItem:function(i,t){var e=this.textfields[i];e&&(t&&!e.hasClass("searchError")?e.addClass("searchError"):t||e.removeClass("searchError"))},addSlider:function(i,t,e,n,o){var s=this,a=t?t:this.position++,r=n?n:i.maxWidth?i.maxWidth:250,d=e?e:50,l="";sliderId="toolbarSlider-"+i.identifier,this.toolbar.addText(i.identifier,a,l+' <span id="'+sliderId+'"></span>'),this.toolbar.setItemToolTip(i.identifier,i.text),this.toolbar.setItemToolTipTemplate(i.identifier,""),this.sliders[i.identifier]=new dhtmlXSlider(sliderId,r,"",!1,this.sliderMinValue,this.sliderMaxValue,d,1),this.sliders[i.identifier].attachEvent("onChange",function(t,e){s.itemSliderChange(i.identifier,t)})},setDisabled:function(i,t){_.each(i,function(i){var e;"-"!=i&&(_.contains(this.flattenedMenuCommands,i)&&(t?this.windowMenu.setItemDisabled(i):this.windowMenu.setItemEnabled(i)),e=_.find(this.commands,function(t){return t.identifier==i}),e&&("input"==e.type?this.textfields[e.identifier]&&this.textfields[e.identifier].prop("disabled",t):"slider"==e.type?this.sliders[e.identifier]&&(t?this.sliders[e.identifier].disable():this.sliders[e.identifier].enable()):t?this.toolbar.disableItem(i):this.toolbar.enableItem(i)))},this)},setSelectionCount:function(i){_.each(this.commands,function(t){t.minSelectionCount&&(t.minSelectionCount>i?this.toolbar.disableItem(t.identifier):this.toolbar.enableItem(t.identifier)),"buttonSelect"==t.type&&_.each(t.options,function(e){e.minSelectionCount>i?this.toolbar.disableListOption(t.identifier,e.identifier):this.toolbar.enableListOption(t.identifier,e.identifier)},this)},this),_.each(this.menuCommands,function(t){t.minSelectionCount&&(t.minSelectionCount>i?this.windowMenu.setItemDisabled(t.identifier):this.windowMenu.setItemEnabled(t.identifier)),this.testSelectionCountForChildren(t,i)},this)},testSelectionCountForChildren:function(i,t){_.each(i.options,function(i){i.minSelectionCount&&(i.minSelectionCount>t?this.windowMenu.setItemDisabled(i.identifier):this.windowMenu.setItemEnabled(i.identifier)),this.testSelectionCountForChildren(i,t)},this)},setState:function(i,t){var e=_.find(this.commands,function(t){return t.identifier==i});e?this.toolbar.setItemState(i,t):t&&(e=_.find(this.commands,function(t){return _.find(t.options,function(t){return t.identifier==i})}),e&&this.toolbar.setListItemSelected(e.identifier,i))},setValue:function(i,t){this.toolbar.setValue(i,t,!1)},resize:function(){if(this.toolbar){var i,t,e,n,o=this.$el.attr("id"),s=this.$el.outerWidth(),a=this.$el.outerHeight(),r=$("#"+o+" .dhxtoolbar_float_left"),d=$("#"+o+" .dhxtoolbar_float_right"),l=20,h=[];_.each(this.commands,function(i){var t,e,n;"input"==i.type?(this.toolbar.setWidth(i.identifier,i.maxWidth),h.push(i.identifier)):"slider"==i.type?(t=this.toolbar.getPosition(i.identifier),e=this.sliders[i.identifier].getValue(),n=this.sliders[i.identifier]?this.sliders[i.identifier].isEnabled():!0,this.toolbar.removeItem(i.identifier),this.addSlider(i,t,e),h.push(i.identifier),n||this.sliders[i.identifier].disable()):i.type&&i.text},this),r=$("#"+o+" .dhxtoolbar_float_left"),d=$("#"+o+" .dhxtoolbar_float_right"),i=r?r.outerWidth():0,t=r?r.outerHeight():0,e=d?d.outerWidth():0,n=d?d.outerHeight():0,s-l>=i+e&&a>=t&&a>=n||(_.each(this.commands,function(i){"input"==i.type&&this.toolbar.setWidth(i.identifier,i.minWidth)},this),r=$("#"+o+" .dhxtoolbar_float_left"),d=$("#"+o+" .dhxtoolbar_float_right"),i=r?r.outerWidth():0,t=r?r.outerHeight():0,e=d?d.outerWidth():0,n=d?d.outerHeight():0,s-l>=i+e&&a>=t&&a>=n||_.each(this.commands,function(i){var t,e,n;"slider"==i.type&&(t=this.toolbar.getPosition(i.identifier),e=this.toolbar.getValue(i.identifier),n=this.sliders[i.identifier]?this.sliders[i.identifier].isEnabled():!0,this.toolbar.removeItem(i.identifier),this.addSlider(i,t,e,i.minWidth,!0),n||this.sliders[i.identifier].disable())},this))}},itemClick:function(i){var t=window.mainApp?window.mainApp.formInputHasFocus():!1;window.ApplicationInterface?window.ApplicationInterface.toolbarItemClick&&window.setTimeout(function(){window.ApplicationInterface.toolbarItemClick(window.timelineDocumentId,i,t)},10):window.isAeonWebExport&&("zoomIn"==i?window.mainApp.zoomIn():"zoomOut"==i?window.mainApp.zoomOut():"findPrevious"==i?window.mainApp.timelineView.findPrevious():"findNext"==i?window.mainApp.timelineView.findNext():"expandAllLanes"==i?window.mainApp.timelineView.expandAllLanes():"collapseAllLanes"==i?window.mainApp.timelineView.collapseAllLanes():"hideAllDetails"==i?window.mainApp.timelineView.hideAllEventDetails():"aeonLink"==i&&window.mainApp.timelineView.linkToAeonHome())},itemStateChange:function(i,t){window.ApplicationInterface&&window.ApplicationInterface.toolbarItemStateChange&&window.ApplicationInterface.toolbarItemStateChange(window.timelineDocumentId,i,t)},itemTextInput:function(i,t){window.ApplicationInterface?window.ApplicationInterface.toolbarItemTextInput&&window.ApplicationInterface.toolbarItemTextInput(window.timelineDocumentId,i,t):window.isAeonWebExport&&(i="search")&&window.mainApp.findFirst(t)},itemSliderChange:function(i,t){window.mainApp&&window.mainApp.setUnitScale(this.sliderPositionToValue(t))},setItemSliderValue:function(i,t){this.sliders[i].setValue(this.sliderValueToPosition(t))},adjustItemSliderValue:function(i,t){var e=this.sliders[i].getValue();e+=t,1>e&&(e=1),e>100&&(e=100),this.sliders[i].setValue(e),this.itemSliderChange("zoom",e)},setSliderPositionRange:function(i,t){var e=this.sliderMaxValue-this.sliderMinValue,n=1/e;this.sliderMinPosition=i,this.sliderMaxPosition=t,this.sliderSValue=Math.pow(this.sliderMaxPosition/this.sliderMinPosition,n)},sliderPositionToValue:function(i){var t=this.sliderMaxValue-i,e=this.sliderMinPosition*Math.pow(this.sliderSValue,t);return e},sliderValueToPosition:function(i){var t=Math.round(Math.log(i/this.sliderMinPosition)/Math.log(this.sliderSValue));return this.sliderMaxValue-t}});module.exports=ATToolbar;
},{"../lib/dhtmlxconcat":4,"../lib/dhtmlxmenu":5,"../lib/dhtmlxslider":6,"../lib/mousetrap-global-bind":10,"backbone":176,"jquery":307,"lodash":309,"mousetrap":310}],91:[function(require,module,exports){
exports.floatToInt=function(t){return 0>t?Math.ceil(t):Math.floor(t)},exports.numberToTwoDigitString=function(t){return t>=0&&9>=t?"0"+t.toString():t.toString()},exports.numberToFourDigitString=function(t){return t>=0&&9>=t?"000"+t.toString():99>=t?"00"+t.toString():999>=t?"0"+t.toString():t.toString()},exports.replaceStringBetween=function(t,e,r,n){return-1==e||-1==r?t:t.substring(0,e)+n+t.substring(r)},exports.replaceCharactersWithWhitespace=function(t,e,r){for(var n="",o=0;e>o;o++)n+=" ";return r.replace(t,n)},exports.replaceLocationWithWhitespace=function(t,e,r){for(var n="",o=0;e>o;o++)n+=" ";return r.replace(r.substring(t,t+e),n)},exports.caseInsensitiveCompare=function(t,e){return t.toLocaleLowerCase()==e.toLocaleLowerCase()},exports.versionNumberCompare=function(t,e){var r,n,o,i=t.split("."),s=e.split("."),a=Math.min(i.length,s.length);for(r=0;a>r;r++)if(n=parseInt(i[r]),o=parseInt(s[r]),n!=o)return n-o;return i.length-s.length},exports.caseInsensitiveStartsWith=function(t,e){return 0===t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase(),0)},exports.regexStrippedString=function(t){return t?t.replace(/[-[\]{}()*+?.,\\^$|#]/g,""):t},exports.regexEscapedString=function(t){return t?t.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"):t},exports.countOccurrencesOfSubstring=function(t,e){if(t+="",e+="",e.length<=0)return t.length+1;for(var r=0,n=0,o=e.length;;){if(n=t.indexOf(e,n),!(n>=0))break;++r,n+=o}return r};
},{}],92:[function(require,module,exports){
module.exports={TIMELINE_VIEW:1,RELATIONSHIP_VIEW:2};
},{}],93:[function(require,module,exports){
var ATWeekday=function(e,t,a){this.index=e,this.name=t,this.shortName=a};module.exports=ATWeekday;
},{}],94:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned" id="addDependency-form">\n	<div class="pure-modal-group">\n		<div class="pure-modal-field">\n		    <label for="Event">Event:</label>\n		    <div id="addDependencyEvent"></div>\n		</div>	\n		<div class="pure-modal-field">\n    		<label for="offset">Offset:</label>\n    		<input type="text" class="offsetBox" name="offset" id="addDependency-offset" value="0 seconds" />\n		</div>	\n		<div class="pure-modal-field">\n   			<label for="fromSelect">From:</label>\n			<select name="from" class="fromSelect" id="addDependency-from">\n				<option value="0">End</option>\n				<option value="1">Start</option>\n			</select>\n		</div>\n	</div>\n<div class="popover-footer">\n	<div class="pure-modal-field">\n		<input type="button" class="btn btn-danger" name="deleteButton" value="Delete" style="float: left;" id="addDependency-delete" />\n    	<input type="submit" class="btn btn-primary" name="addButton" value="OK" id="addDependency-submit"/>\n	</div>	\n</div>\n</form>';
},{}],95:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="addEntityWindowTitle"><%= windowTitle %></h4>\n      </div>\n		<form id="addEntityForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n			<div class="pure-modal-group">\n				<div class="pure-modal-field">\n					<label for="addEntityInput">Name</label>\n					        <input id="addEntityInput" type="text" placeholder="Enter Name...">\n				</div>		\n				<div class="pure-modal-field">\n					<label>&nbsp;</label>\n					<span class="textDisplay" id="addEntityWindowBelowMessage"></span>\n				</div>\n			</div>\n		  	<div id="addEntityBirthInput">\n					<div class="pure-modal-group alternate">\n						<div class="pure-modal-heading">Birth / Creation</div>\n						<div class="pure-modal-field">\n						    <label for="addEntityCreateEvent">Event</label>\n						    <div id="addEntityCreateEvent"></div>\n						</div>\n						<div class="pure-modal-field sideBySide">\n						    <label for="addEntityCreateOffset">Offset</label>\n							<input type="text" id="addEntityCreateOffset" />\n						    <select id="addEntityCreateOffsetFrom">\n						    	<option value="start">from start</option>\n						    	<option value="end">from end</option>\n						    </select>\n						</div>\n					</div>\n					<div class="pure-modal-group alternate">\n						<div class="pure-modal-field">\n						    <label for="addEntityCreateDate">Date</label>\n						    <div id="addEntityCreateDate"></div>\n						</div>\n					</div>\n		  </div>\n		</div>\n      <div class="modal-footer">\n	    <input class="btn btn-primary" name="commit" type="submit" id="addEntitySubmit" value="OK" />\n      </div>\n		</form>\n\n    </div>\n  </div>';
},{}],96:[function(require,module,exports){
module.exports='<% var loopCount = 0;\n	_.each(roles,function(role) { \n		loopCount++;\n%>\n	<div class="pure-modal-group <%= (loopCount%2==0)?\'alternate\':\'\' %>">\n		<div class="pure-modal-field">\n		    <label for="addEvent-<%= role.roleId %>"><%= role.name %></label>\n		    <% if(role.multiplePerEvent) { %>\n				<div class="valueList" id="addEvent-<%= role.roleId%>"></div>\n			<% } else { %>\n				<div id="addEvent-<%= role.roleId%>"></div>\n			<% } %>\n		</div>\n	</div>						\n<% }); %>';
},{}],97:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title" id="addEventWindowTitle">Add Event</h4>\n		</div>\n		<form id="addEventForm" class="pure-form pure-form-aligned">\n			<div class="modal-body">\n				<div class="pure-modal-group">\n					<div class="pure-modal-field">\n						<label for="addEventTitle">Title </label>\n						<input id="addEventTitle" type="text" placeholder="Title">\n					</div>\n					<div class="pure-modal-field">\n							<label for="addEventColor">Color</label>\n							<div id="addEventColor"></div>\n					</div>\n					<div class="pure-modal-field">\n							<label for="addEventParent">Parent</label>\n							<div id="addEventParent"></div>\n					</div>\n				</div>	\n				<div class="pure-modal-group alternate">\n					<div class="pure-modal-field">\n							<label for="addEventStartDate">Start</label>\n							<div id="addEventStartDate"></div>										\n					</div>\n					<div class="pure-modal-field">\n							<label for="addEventDuration">Duration</label>\n							<input type="text" name="duration" id="addEventDuration" value="">\n					</div>\n					<div class="pure-modal-field">\n							<label for="addEventEndDate">End</label>\n							<div id="addEventEndDate"></div>\n					</div>\n				</div>		\n				<div id="addEventRoleDiv"></div>\n				<div id="addEventEntitySearch"></div>	\n<!--				<div class="pure-modal-group">\n					<div class="pure-modal-field">\n						<label for="addEventLane">Lane</label>\n						<div id="addEventLane"></div>\n					</div>\n				</div>-->\n			</div>\n			<div class="modal-footer">\n				<input id="addEventSubmit" class="btn btn-primary" name="commit" type="submit" value="Add Event" />\n			</div>\n		</form>\n	</div>\n</div>';
},{}],98:[function(require,module,exports){
module.exports='<form id="addLink-form" class="pure-form pure-form-aligned">\n	<div class="pure-modal-group">\n		<div class="pure-modal-field">\n			<label>Title</label>\n			<input name="description" id="addLinkDescription" type="text" />\n		</div>\n		<div class="pure-modal-field">\n			<label>Link</label>\n			<input name="url" id="addLinkPath" type="text" placeholder="Type URL or file path" />\n		</div>\n		<div>\n			<label></label>\n			<a class="btn btn-default" id="addLink-browse">Browse for file</a>\n		</div>\n<!--		<div class="pure-modal-field">\n			<label></label>\n			<input type="radio" name="pathtype" value="web">Web\n			<input type="radio" name="pathtype" value="file" checked="true">File\n		</div>-->\n	</div>\n	<div class="popover-footer">\n		<div class="pure-modal-field">\n			<input type="button" class="btn btn-danger" name="deleteButton" value="Delete Link" style="float: left;" id="addLink-delete" />\n			<input type="submit" class="btn btn-primary" name="addButton" value="OK" id="addLink-submit" />\n		</div>	\n	</div>\n</form>';
},{}],99:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned">\n	<div class="pure-modal-group">\n		<div class="pure-modal-field">\n		    <label for="entitySearchField"><%= typeName %>:</label>\n	    	<div id="entitySearchField"></div>\n		</div>	\n	</div>\n	<div class="popover-footer">\n		<div class="pure-modal-field">\n		    <input type="button" class="btn btn-primary" name="addButton" value="Add" id="addRole-submit"/>\n		</div>	\n	</div>\n</form>';
},{}],100:[function(require,module,exports){
module.exports='<input type="text" autocomplete="off" spellcheck="false" class="autosuggestPlaceholder" readonly="" tabindex="-1" placeholder="<%= placeholder ? placeholder : \'\' %>"/>\n<input type="text" autocomplete="off" spellcheck="false" class="autosuggestBehind" readonly="" tabindex="-1" />\n<input type="text" autocomplete="off" spellcheck="false" class="autosuggestFront" type="text" />\n<div class="bselect-dropdown" style="display: none;">\n    <ul class="bselect-option-list" role="listbox">\n    </ul>\n</div>';
},{}],101:[function(require,module,exports){
module.exports='<!-- Assuming the outer div is created dynamically and the content inside is then read. -->\n<!-- TODO : Need to switch from id to class so that we can have multiple calendar pickers loaded? -->\n<!--div id="calendar"-->\n	<div id="yearDiv">\n		<span id="yearDivLower" class="fa fa-caret-left"></span>\n		<input type="text" id="calendarYearInput" />\n		<span id="yearDivHigher" class="fa fa-caret-right"></span>\n	</div>\n	<div id="restrictions">\n		<div id="yearOnly">Year Only</div>\n		<div id="monthYearOnly">Month + Year Only</div>\n		<div id="months"></div>\n	</div>\n	<table>\n		<thead>\n			<tr id="headerRow">\n			</tr> \n		</thead>\n	</table>\n	<div id="scrollbody">\n		<table>\n			<tbody id="tableBody"></tbody>\n		</table>\n	</div>\n<!--/div-->';
},{}],102:[function(require,module,exports){
module.exports='	<span class="bselect-label"><div class="colorSquareLabel" style="background: red;"></div><span>&nbsp;</span></span>\n	<button type="button" class="bselect-caret" tabindex="-1">\n		<span class="fa fa-chevron-down"></span>\n	</button>\n	<div class="bselect-dropdown" style="display: none;">\n		<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n		</ul>\n	</div>';
},{}],103:[function(require,module,exports){
module.exports='<img class="eventImage" style="pointer-events: none;" src="images/placeholder.jpg" />\n';
},{}],104:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">EXTERNAL LINKS</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none">file://path/to/file1</span></li>\n	<li style="pointer-events: none"><span style="pointer-events: none">http://address.to/url</span></li>\n</ul>\n';
},{}],105:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">Yes</div>\n</div>";
},{}],106:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">50</div>\n</div>\n";
},{}],107:[function(require,module,exports){
module.exports="<div class='eventMoreParagraph' style=\"pointer-events: none\">LABEL: Lorem ipsum dolor sit amet, consectetur adipiscing elit.</div>\n";
},{}],108:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style='pointer-events: none'>\n    <div class='eventMoreHeading' style='pointer-events: none'>LABEL</div>\n    <div class='eventMoreProgressValue' style='pointer-events: none'>80%</div>\n    <div class='eventProgressBar' style='pointer-events: none'>\n        <span style='width: 80%; pointer-events: none'></span>\n    </div>\n</div>\n";
},{}],109:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">Lorem Ipsum.</div>\n</div>";
},{}],110:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">LABEL</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">TYPE 1</strong></span></li>\n	<li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">TYPE 2</strong></span></li>\n</ul>\n';
},{}],111:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">TAGS</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">Tag 1</strong></span></li>\n	<li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">Tag 2</strong></span></li>\n</ul>\n';
},{}],112:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content" id="displaySettingsWindow">\n		<div class="modal-header">\n	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title" id="displaySettingsWindowTitle">Display Settings</h4>\n		</div>\n		<form id="displaySettingsForm" class="pure-form pure-form-aligned">\n			<div class="modal-body">\n				<div class="pure-modal-group">\n					<div class="pure-modal-field">\n						<label for="displaySettingsSkin">Skin</label>\n						<select id="displaySettingsSkin">\n						    <option value="dark">Dark</option>\n						    <option value="light">Light</option>\n						    <option value="writer">Writer</option>\n						    <option value="ocean">Ocean</option>\n						    <option value="borealis">Borealis</option>\n						    <option value="print">Print</option>\n						</select>\n					</div>\n					<div class="pure-modal-field">\n						<label for="displaySettingsSize">Size</label>\n						<select id="displaySettingsSize">\n						    <option value="80">80%</option>\n						    <option value="90">90%</option>\n						    <option value="100">100%</option>\n						    <option value="110">110%</option>\n						    <option value="120">120%</option>\n						    <option value="130">130%</option>\n						    <option value="150">150%</option>\n						</select>\n					</div>\n					<div class="pure-modal-field">\n						<label for="displaySettingsScrollingBounds">Scrolling</label>\n						<select id="displaySettingsScrollingBounds">\n							<option value="free">Do not constrain scrolling</option>\n							<option value="bounce">Bounce once at first/last event, then continue</option>\n							<option value="restrict">Restrict scrolling to first/last event</option>\n						</select>\n					</div>\n					<div class="pure-modal-field">\n						<label for="displaySettingsLayout">Layout</label>\n						<select id="displaySettingsLayout">\n							<option value="compact">Use minimum space possible</option>\n							<option value="waterfall">Cascade unbroken groups from top</option>\n							<option value="cascade">Only return to top when clear of all previous</option>\n						</select>\n					</div>\n					<div class="pure-modal-field">\n						<label for="displaySettingsOptions">Options</label>\n						<div class="settingsCheckboxDiv">\n						    <input id="displaySettingsShowIds" type="checkbox" /> Show event IDs on timeline\n						</div>\n						<div class="settingsCheckboxDiv">\n						    <input id="displaySettingsShowDates" type="checkbox" /> Show event dates\n						</div>\n					</div>\n<!--\n					<div class="pure-modal-field">\n						<label></label>\n					</div>\n-->\n                    <!--\n					<div class="settingsCheckboxDiv">\n					    <input id="displaySettingsShowDependencies" type="checkbox" /> Draw dependencies\n					</div>\n					<div class="settingsCheckboxDiv">\n					    <input id="displaySettingsExpandAll" type="checkbox" /> Permanently expand all events\n					</div> \n					-->\n				</div>\n				<div class="pure-modal-group alternate no-border">\n					<div class="pure-modal-heading">Display contents for expanded events</div>\n					<div class="expandedView">\n						<div class="columnWrapper">\n							<div class="displayColumn" id="leftDisplayColumn">\n							</div>\n							<div class="displayColumnDropTarget" id="leftAddDropTarget"><span class="fa fa-plus-circle"></span>DROP TO ADD AN ITEM</div>\n						</div>\n						<div class="columnWrapper">\n							<div class="displayColumn" id="rightDisplayColumn">\n							</div>\n							<div class="displayColumnDropTarget" id="rightAddDropTarget"><span class="fa fa-plus-circle"></span>DROP TO ADD AN ITEM</div>\n						</div>\n					</div>\n				</div>\n				<div class="pure-modal-group">\n					<div class="pure-modal-field" id="availableGroup">\n						<label for="available">Other</label> \n						<div id="available"></div>	\n					</div>\n				</div>\n			</div>		\n			<div class="modal-footer">\n				<!--<input id="displaySettingsCancel" class="btn" name="commit" type="button" value="Cancel" />-->\n				<input id="displaySettingsApply" class="btn" name="commit" type="button" value="Apply" />\n				<input id="displaySettingsOk" class="btn btn-primary" name="commit" type="submit" value="Save" />\n			</div>\n		</form>\n	</div>\n</div>';
},{}],113:[function(require,module,exports){
module.exports='	<span class="bselect-label">&nbsp;</span>\n	<button type="button" class="bselect-caret" tabindex="-1">\n		<span class="fa fa-chevron-down"></span>\n	</button>\n	<div class="bselect-dropdown" style="display: none;">\n		<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n		</ul>\n	</div>';
},{}],114:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<h4 class="modal-title" id="editCalendarWindowTitle">Edit Calendar</h4>\r\n		</div>\r\n		<form id="editCalendarForm" class="pure-form pure-form-aligned" onsubmit="return false;">\r\n			<div class="modal-body">\r\n				<div class="masterDetailWindow">      \r\n					<div class="masterView withControls">\r\n						<div class="masterViewList"></div>\r\n						<div class="masterViewControls">\r\n							<i id="editCalendarRemoveButton" class="fa fa-minus-circle"></i>\r\n							<i id="editCalendarMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\r\n							<i id="editCalendarMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\r\n						</div>\r\n					</div>\r\n					<div class="detailView" id="editCalendarDetailView"></div>\r\n				</div>\r\n			</div>  \r\n			\r\n			<div class="modal-footer">\r\n				<input id="editCalendarCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\r\n				<input id="editCalendarOk" class="btn btn-primary" name="commit" type="submit" value="OK" />\r\n                \r\n			</div>\r\n		</form>\r\n	</div>\r\n</div>';
},{}],115:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n	<div class="pure-modal-field">\n	    <label for="editColorName">Name</label>\n	    <input id="editColorName" type="text" placeholder="Name" />\n	</div>\n	<div class="pure-modal-field">\n	    <label for="editColorColor">Color</label>\n		<input id="editColorColor" type="text" />\n	</div>\n</div>';
},{}],116:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n	<div class="pure-modal-field longLabelName">\r\n	    <label for="editEraName">Name</label>\r\n	    <input id="editEraName" type="text" placeholder="Name" />\r\n	</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editEraShortName">Short Name</label>\r\n        <input id="editEraShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for ="editEraDuration"> Duration</label>\r\n        <input id="editEraDuration" type="number" placeholder="Duration" /><span>years</span>\r\n    </div>\r\n    <div class="pure-modal-field">\r\n        <input type="checkbox" id="editEraBackwards" /> Years counted Backwards\r\n    </div>\r\n    <div class = "pure-modal-field">\r\n        <input type = "checkbox" id = "editEraLeapYear" /> Era contains leap years\r\n    </div>\r\n     \r\n</div>';
},{}],117:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n	<div class="pure-modal-field longLabelName">\r\n	    <label for="editMonthName">Name</label>\r\n	    <input id="editMonthName" type="text" placeholder="Name" />\r\n	</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editMonthShortName">Short Name</label>\r\n        <input id="editMonthShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for = "editMonthRegularYearDuration"> Regular Year</label>\r\n        <input id = "editMonthRegularYearDuration" type="number" placeholder="Regular Year Duration"/><span>days</span>\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for = "editMonthLeapYearDuration"> Leap Year</label>\r\n        <input id = "editMonthLeapYearDuration" type="number" placeholder="Leap Year Duration"/><span>days</span>\r\n    </div>\r\n</div>';
},{}],118:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n	<div class="pure-modal-field">\n	    <label for="name">Name</label>\n	    <input id="editPropertyName" type="text" placeholder="Name" />\n	</div>\n	<div class="pure-modal-field">\n	    <label for="name">Type</label>\n		<select id="editPropertyType">\n			<option value="text">Single-line Text</option>\n			<option value="multitext">Multi-line Text</option>\n			<option value="number">Integer Number</option>\n			<option value="decimal">Decimal Number</option>\n			<option value="percentage">Percentage</option>\n			<option value="currency">Currency</option>\n			<option value="boolean">Yes / No</option>\n		</select>\n	</div>\n</div>\n<div class="pure-modal-group alternate">\n	<div class="pure-modal-field">\n	    <!--<label for="name">Calc</label>-->\n        <input type="checkbox" id="editPropertyCalculate" /> Automatically calculate parent\'s value from children.\n    </div>\n	<div class="pure-modal-field">\n	    <label for="name">Mode</label>\n		<select id="editPropertyCalcMode"></select>\n    </div>\n</div>\n<div class="pure-modal-group">\n	<div class="pure-modal-field">\n        <input type="checkbox" id="editPropertyFadeCheckbox" /> Fade events based on this property\n    </div>\n</div>';
},{}],119:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n	<div class="pure-modal-heading">Range Type: <span id="editRangePropertyType">None Selected</span></div>\n	<div class="pure-modal-field">\n	    <label for="name">Name</label>\n	    <input id="editRangePropertyName" type="text" placeholder="Name" />\n	</div>\n<!--    <div class="pure-modal-field">\n    	<label for="editRangePropertyType">Type</label>\n    <select id="editRangePropertyType">\n        <option value = "date">Date</option>\n        <option value = "integer">Number</option>\n    </select>\n	</div>-->\n</div>\n<div id = \'editRangePropertyDateOptions\'>\n	<div class="pure-modal-group">\n		<div class="pure-modal-field">\n		    <label for="editRangePropertyCalendarType">Style</label>\n			<select id="editRangePropertyCalendarType">\n				<option value = "0">Regular Dates</option>\n				<option value = "1">Weekly (Week 1, Week 2)</option>\n				<option value = "2">Daily (Day 1, Day 2)</option>\n				<option value = "3">Time (2:25:30)</option>\n			</select>\n		</div>\n	</div>\n	<div class="pure-modal-group alternate">\n		<div class="pure-modal-heading">Zoom Limits</div>\n		<div class="pure-modal-field">\n		    <label for="editRangePropertyDateMinZoom">From</label>\n			<select id="editRangePropertyDateMinZoom">\n				<option value = "second">Seconds</option>\n				<option value = "minute">Minutes</option>\n				<option value = "hour">Hours</option>\n				<option value = "day" selected="selected">Days</option>\n				<option value = "week">Weeks</option>\n				<option value = "month">Months</option>\n				<option value = "year">Years</option>\n				<option value = "decade">Ten Years</option>\n				<option value = "century">Hundred Years</option>\n				<option value = "thousand">Thousand Years</option>\n				<option value = "million">Million Years</option>\n				<option value = "billion">Billion Years</option>\n			</select>\n		</div>\n		<div class="pure-modal-field">\n		    <label for="editRangePropertyDateMaxZoom">To</label>\n			<select id="editRangePropertyDateMaxZoom">\n				<option value = "second">Seconds</option>\n				<option value = "minute">Minutes</option>\n				<option value = "hour">Hours</option>\n				<option value = "day">Days</option>\n				<option value = "week">Weeks</option>\n				<option value = "month">Months</option>\n				<option value = "year" selected="selected">Years</option>\n				<option value = "decade">Ten Years</option>\n				<option value = "century">Hundred Years</option>\n				<option value = "thousand">Thousand Years</option>\n				<option value = "million">Million Years</option>\n				<option value = "billion">Billion Years</option>\n			</select>\n		</div>\n	</div>\n	<div class="pure-modal-group">\n	    <div class = "pure-modal-field">\n	     <button id="editCalendarButton" class="btn btn-xs btn-default" type="button">Edit Calendar</button>\n	    </div>\n	     <div id="editCalendarDisableExplanation">Note: Calendars can only be edited for empty timelines.</div>\n	</div>\n</div>\n<div id = \'editRangePropertyNumericOptions\'>\n	<div class="pure-modal-group alternate">\n		<div class="pure-modal-heading">Zoom Limits</div>\n		<div class="pure-modal-field">\n		    <label for="editRangePropertyNumericMinZoom">From</label>\n		    <input id="editRangePropertyNumericMinZoom" type="number" placeholder="Minimum Zoom" value="10" />\n		</div>\n		<div class="pure-modal-field">\n		    <label for="editRangePropertyNumericMaxZoom">To</label>\n		    <input id="editRangePropertyNumericMaxZoom" type="number" placeholder="Maximum Zoom" value="1000"/>\n		</div>\n	</div>\n</div>';
},{}],120:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n	<div class="editRoleList">\n		<a type="button" class="imageButton fa fa-minus-circle remove-<%= item.id %>" href="#"></a>\n		<input type="text" class="edit-name-<%= item.id %>" value="<%= item.title %>" />\n		<button class="btn btn-default iconpicker edit-role-icon-<%= item.id %>" role="iconpicker"></button>\n		<span class="multipleOption"><input type="checkbox" class="edit-multiple-<%= item.id %>" <% if(item.multiplePerEvent) { %>checked="checked" <% } %> /> Allow multiple per event</span>\n	</div>\n<% }); %>\n\n<div>\n	<a type="button" tabIndex="7" class="addButton imageButton fa fa-plus-circle" href="#"></a>\n</div>';
},{}],121:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title" id="editTemplateWindowTitle">Timeline Settings</h4>\n		</div>\n		<form id="editTemplateForm" class="pure-form pure-form-aligned" onsubmit="return false;">\n			<div class="modal-body">\n				<div class="masterDetailWindow">      \n					<div class="masterView withControls">\n						<div class="masterViewList"></div>\n						<div class="masterViewControls">\n							<i id="editTemplateRemoveButton" class="fa fa-minus-circle"></i>\n							<i id="editTemplateMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\n							<i id="editTemplateMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\n						</div>\n					</div>\n					<div class="detailView" id="editTemplateDetailView"></div>\n				</div>\n			</div>  \n			\n			<div class="modal-footer">\n				<a id="editTemplateSave" style="float: left;" class="btn btn-default"> Save As Custom Template...</a>\n				<input id="editTemplateCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\n				<input id="editTemplateOk" class="btn btn-primary" name="commit" type="submit" value="OK" />\n			</div>\n		</form>\n	</div>\n</div>';
},{}],122:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n	<div class="pure-modal-field alongsideButton">\n	    <label for="name">Name</label>\n	    <input id="editTypeName" type="text" placeholder="Name" />\n		<button class="btn btn-default iconpicker" id="editTypeIcon" role="iconpicker"></button>\n	</div>\n	<div class="pure-modal-field">\n	    <label for="persistent">Bounds</label>\n	    <input id="editTypePersistent" type="checkbox" /> Allow start/end events and age calculations\n	</div>\n</div>\n<div class="pure-modal-group alternate">\n	<div class="pure-modal-field">	\n	    <label for="roles">Roles</label>\n	    <div class="valueList" id="editRangeRoles" style="max-height: 30.0rem; overflow: auto;"></div>\n	</div>							\n</div>';
},{}],123:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n	<div class="pure-modal-field longLabelName">\r\n	    <label for="editWeekdayName">Name</label>\r\n	    <input id="editWeekdayName" type="text" placeholder="Name" />\r\n	</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editWeekdayShortName">Short Name</label>\r\n        <input id="editWeekdayShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class="pure-modal-field">\r\n        <input type="radio" id="firstDayFinalEra" />This is the first day of the final era\r\n    </div>\r\n     <div class = "modal-footer">\r\n        <label for ="editHoursInDay"> Hours in Day</label>\r\n        <input id="editHoursInDay" type = "number" placeholder = "Hours in Day" />\r\n       \r\n    </div>\r\n    \r\n</div>';
},{}],124:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title">Add New Parent Event</h4>\n		</div>\n		<form id="embedInParentForm" class="pure-form pure-form-aligned">\n			<div class="modal-body">\n				<div class="pure-modal-group">\n					<div class="pure-modal-field">\n						<label for="embedInParentTitle">Title </label>\n						<input id="embedInParentTitle" type="text" placeholder="Title">\n					</div>\n					<div class="pure-modal-field">\n							<label for="embedInParentColor">Color</label>\n							<div id="embedInParentColor"></div>\n					</div>\n					<div class="pure-modal-field">\n							<label for="embedInParentParent">Parent</label>\n							<div id="embedInParentParent"></div>\n					</div>\n				</div>	\n			</div>\n			<div class="modal-footer">\n				<input id="embedInParentSubmit" class="btn btn-primary" name="commit" type="submit" value="Create New Parent" />\n			</div>\n		</form>\n	</div>\n</div>';
},{}],125:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterDateWindowTitle"><%= windowTitle %></h4>\n      </div>\n		<form id="enterDateForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n			<div class="pure-modal-group">\n			    <label id="enterDateWindowAboveMessage"></label>\n			</div>\n			<div class="pure-modal-group no-border">\n				<div class="pure-modal-field">\n					<label for="enterDatePicker">Date</label>\n					<div id="enterDatePicker"></div>\n				</div>		\n			</div>	\n			<div class="pure-modal-group">\n			    <label id="enterDateWindowBelowMessage"></label>\n			</div>\n      <div class="modal-footer">\n	    <input class="btn btn-primary" name="commit" type="submit" id="enterDateSubmit" value="OK" />\n      </div>\n		</form>\n\n    </div>\n  </div>';
},{}],126:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterDurationWindowTitle"><%= windowTitle %></h4>\n      </div>\n		<form id="enterDurationForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n			<div class="pure-modal-group no-border">\n				<div class="pure-modal-field">\n					<label for="enterDurationPicker">Duration</label>\n					<input type="text" id="enterDurationPicker" name="duration" class="duration" value="">\n				</div>		\n			</div>	\n      <div class="modal-footer">\n	    <input class="btn btn-primary" name="commit" type="submit" id="enterDurationSubmit" value="OK" />\n      </div>\n		</form>\n\n    </div>\n  </div>';
},{}],127:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterNameWindowTitle"><%= windowTitle %></h4>\n      </div>\n		<form id="enterNameForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n			<div class="pure-modal-group">\n			    <label id="enterNameWindowAboveMessage"></label>\n			</div>\n			<div class="pure-modal-group no-border">\n				<div class="pure-modal-field">\n					<label for="enterNameInput">Name</label>\n					        <input id="enterNameInput" type="text" placeholder="Enter Name...">\n				</div>		\n			</div>	\n			<div class="pure-modal-group">\n			    <label id="enterNameWindowBelowMessage"></label>\n			</div>\n      <div class="modal-footer">\n	    <input class="btn btn-primary" name="commit" type="submit" id="enterNameSubmit" value="OK" />\n      </div>\n		</form>\n\n    </div>\n  </div>';
},{}],128:[function(require,module,exports){
module.exports="</div>";
},{}],129:[function(require,module,exports){
module.exports="<div class='eventContentColumn expanded'>\n";
},{}],130:[function(require,module,exports){
module.exports="<% if(event.get('imagePath')) { %>\n<img class=\"eventImage\" src=\"<%= event.get('imagePath').replace(/\\s/g,'%20') %>\" />\n<% } %>";
},{}],131:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>EXTERNAL LINKS</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('links'),function(link) {\n                listCount++;\n        %>\n            <li><span><a href=\"<%= link.path %>\" <% if(window.isAeonWebExport) { %> target=\"_blank\" <% } %> class=\"externalLinkAnchor\"><%= link.title %></a></span></li>\n        <%}); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";
},{}],132:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= (parseInt(event.get('values')['LABEL']) ? 'Yes' : 'No')%></div>\n</div>";
},{}],133:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= (event.get('values')['LABEL'] ? event.get('values')['LABEL']  : 0)%></div>\n</div>\n";
},{}],134:[function(require,module,exports){
module.exports="<% if(event.get('values')['LABEL'] && event.get('values')['LABEL'].length > 0) { %>\n<div class='eventMoreParagraph'><%= event.get('values')['LABEL'].replace(/\\n/g,'<br />') %></div>\n<% } %>";
},{}],135:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreProgressValue'><%= (event.get('values')['LABEL'] ? parseInt(event.get('values')['LABEL']) : '0') %>%</div>\n    <div class='eventProgressBar'>\n        <span style='width: <%= (event.get('values')['LABEL'] ? event.get('values')['LABEL'] : '0') %>%'></span>\n    </div>\n</div>\n";
},{}],136:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= event.get('values')['LABEL'] %></div>\n</div>";
},{}],137:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>LABEL</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('relationships'),function(relationship) {\n            if(relationship.role == 'LABEL') {\n                listCount++;\n        %>\n            <li><span><strong><%= relationship.entityName %></strong>\n            <% if(relationship.age) { %>\n                is <%= relationship.age %>\n            <% } %>\n            </span></li>\n        <% }\n        }); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";
},{}],138:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>TAGS</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('tags'),function(tag) {\n                listCount++;\n        %>\n            <li><span><%= tag %></span></li>\n        <%}); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";
},{}],139:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title" id="exportCSVWindowTitle"><%= windowTitle %></h4>\r\n		</div>\r\n		<form id="exportCSVForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">		\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="delimiter">Delimiter</label>\r\n                        <input id="delimiterInputComma" type="radio" name="Delimiter" value="0" checked>Comma\r\n                        <input id="delimiterInputTab" type="radio" name="Delimiter" value="1">Tab\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="dateFormatInput">Date Format</label>\r\n                        <select id="dateFormatInput">\r\n                            <option value="0">27 November 1940</option>\r\n                            <option value="1">1940-11-27</option>\r\n                            <option value="2">27/11/1940</option>\r\n                            <option value="3">11/27/1940</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="timeFormat">Time Format</label>\r\n                        <select id="timeFormatInput">\r\n                            <option value="0">5:43PM</option>\r\n                            <option value="1">17:43</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n			</div>\r\n			<div class="modal-footer">\r\n				<input class="btn btn-primary" name="commit" type="submit" id="exportCSVSubmit" value="OK" />\r\n			</div>\r\n		</form>\r\n	\r\n	</div>\r\n</div>';
},{}],140:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title" id="exportImageWindowTitle"><%= windowTitle %></h4>\r\n		</div>\r\n		<form id="exportImageForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="Format">Format</label>\r\n                        <input id="formatCurrentImage" type="radio" name="Format" value="Current" checked />Current Window\r\n                        <input id="entireTimelineImage" type="radio" name="Format" value="All" />Entire Timeline\r\n                        <input id="betweenDatesImage" type="radio" name="Format" value="Interval" />Between Dates\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="startDateInputImage">Start Date</label>\r\n                        <div id="startDateInputImage"></div>\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="endDateInputImage">End Date</label>\r\n                        <div id="endDateInputImage"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group">\r\n                    <div>\r\n                        <label>Image Dimensions</label>\r\n                        <div>\r\n                            <span id="widthLabelImage"></span><span> x </span><span id="heightLabelImage"></span><span> pixels</span>\r\n                        </div>\r\n                        <div>\r\n                            <span id="exportImageWarningLabel" style="color: red;"></span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n			</div>\r\n			<div class="modal-footer">\r\n				<input class="btn btn-primary" name="commit" type="submit" id="exportImageSubmit" value="OK" />\r\n			</div>\r\n		</form>\r\n	</div>\r\n</div>';
},{}],141:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n	<div>\n		<a type="button" class="imageButton fa fa-pencil-square-o edit-<%= item.id %>" href="#" tabIndex="0" title="Edit/Delete"></a>\n		<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n		<% if(item.extra) { %>\n			<span class="list-item-extra"><%= item.extra %></span>\n		<% } %>\n		<span class="list-item-actions">\n			<a type="button" class="imageButton fa fa-eye quicklook-<%= item.id %>" href="#" tabIndex="0" <% if(item.quicklookDisabled) { %>disabled="disabled" <% } %> title="Quicklook Document"></a>\n			<a type="button" class="imageButton fa fa-folder-open reveal-<%= item.id %>" href="#" tabIndex="0" <% if(item.revealDisabled) { %>disabled="disabled" <% } %> title="Open Folder Location"></a>\n			<a type="button" class="imageButton fa fa-external-link open-<%= item.id %>" href="#" tabIndex="0" <% if(item.openDisabled) { %>disabled="disabled" <% } %> title="Open Document"></a>\n		</span>\n	</div>\n<% }); %>\n\n<div>\n	<a type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n</div>';
},{}],142:[function(require,module,exports){
module.exports='<% var index = 0;\n	_.each(items, function(item) { \n		if(index > 0) { %>\n		<div class="filterBarLogic"><%= item.logic %></div>\n		<!--<div class="filterBarLogic"><a class="filterBarLogicSpan"><%= item.logic %> <i class="fa fa-caret-down"></i></a></div>-->\n<% } %>\n		<div class="filterBarItem">\n<% if(item.negate) {%>\n			<span class="filterNegate"><%= item.negate %></span>\n<% } %>\n			<span class="filterScope"><%= item.scope %></span>\n			<span class="filterValue"><%= item.value %></span>\n			<a href="#" class="remove" tabindex="-1">×</a>\n		</div>\n<% index++; }); %>';
},{}],143:[function(require,module,exports){
module.exports='<div class="filterControl">\n	<span class="fa fa-cog filterIcon manageFilterIcon"></span>\n	<div class="filterBarWrapper">\n		<div id="filterBarItems" class="filterBarItems"></div>\n		<div id="filterBarInlineAdd" class="filterBarInlineAdd">\n			<form id="filterBarInlineAddForm">\n				<div class="filterBarInlineAddLogic" id="filterBarInlineAddLogic">\n					<div class="logicValue" id="filterBarInlineAddLogicValue">AND</div>\n					<div class="bselect-dropdown" id="filterBarInlineAddLogicList" style="display: none;">\n					    <ul class="bselect-option-list" role="listbox">\n					    	<li id="filterBarInlineAddLogicValue-AND" class="bselect-option" role="option"><span>AND</span></li>\n					    	<li id="filterBarInlineAddLogicValue-OR"  class="bselect-option" role="option"><span>OR</span></li>\n					    </ul>\n					</div>\n				</div>\n				<div class="filterBarInlineAddLogic" id="filterBarInlineAddNegate">\n					<div class="logicValue" id="filterBarInlineAddNegateValue">HAS</div>\n					<div class="bselect-dropdown" id="filterBarInlineAddNegateList" style="display: none;">\n					    <ul class="bselect-option-list" role="listbox">\n					    	<li id="filterBarInlineAddNegateValue-HAS" class="bselect-option" role="option"><span>HAS</span></li>\n					    	<li id="filterBarInlineAddNegateValue-NOT"  class="bselect-option" role="option"><span>NOT</span></li>\n					    </ul>\n					</div>\n				</div>\n				<div id="filterBarInlineAddScope" class="filterBarInlineAddScope autosuggestDiv"></div>\n				<span class="filterBarSeparator">:</span>\n				<div id="filterBarInlineAddValue" class="filterBarInlineAddValue autosuggestDiv"></div>\n				<button id="filterBarInlineAddButton" type="submit" tabIndex="0"><i class="imageButton fa fa-plus-circle" tabIndex="0"></i></button>\n				<input type="submit" value="" style="display:none" />\n			</form>\n		</div>\n	</div>\n	<span class="fa fa-times-circle filterIcon filterClear clearFilterIcon"></span>\n</div>';
},{}],144:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title" id="findReplaceWindowTitle">Find And Replace</h4>\r\n		</div>\r\n		<form id="findReplaceForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">\r\n				<div class="pure-modal-group no-border">\r\n					<div class="pure-modal-field">\r\n						<label for="findInput">Find:</label>\r\n						<input id="findInput" type="text" placeholder="Enter Text...">\r\n					</div>		\r\n				</div>\r\n				<div class="pure-modal-group no-border">\r\n					<div class="pure-modal-field">\r\n						<label for="replaceInput">Replace:</label>\r\n						<input id="replaceInput" type="text" placeholder="Enter Text...">\r\n					</div>		\r\n				</div>	\r\n				\r\n				<div class="pure-modal-group alternate">\r\n					<div class="pure-modal-field">\n						<label>Include:</label>\n						<div class="checkboxGroup">\n							<span class="checkboxColumn"><input type="checkbox" id="eventTitlesCheckbox" /> Titles</span>\n							<span class="checkboxColumn"><input type="checkbox" id="eventPropertiesCheckbox" /> Properties</span>\n							<span class="checkboxColumn"><input type="checkbox" id="tagsCheckbox" /> Tags</span>\n							<span class="checkboxColumn"><input type="checkbox" id="entityNamesCheckbox" /> Entities</span>\n							<span class="checkboxColumn"><input type="checkbox" id="bookmarksCheckbox" /> Bookmarks</span>\n						</div>\n					</div>\n				</div>\n			</div>\r\n			<div class="modal-footer">\r\n				<input id="findReplaceCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\r\n				<input class="btn btn-primary" name="commit" type="submit" id="findReplaceSubmit" value="Replace All" />\r\n			</div>\r\n		</form>\r\n	</div>\r\n</div>';
},{}],145:[function(require,module,exports){
module.exports='	<form id="<%= elementName %>-form" class="pure-form">\n		<ul class="bselect-option-list"   id="<%= elementName %>-list" role="listbox">\n		</ul>\n	</form>\n';
},{}],146:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n	<div class="pure-modal-field">\r\n		<label for="delimiter">Delimiter</label>\r\n		<input id="importCsvDelimiterInputComma" type="radio" name="Delimiter" value="0" checked> Comma&nbsp;&nbsp;&nbsp;\r\n		<input id="importCsvDelimiterInputTab" type="radio" name="Delimiter" value="1"> Tab\r\n	</div>\r\n	<div class="pure-modal-field">\r\n		<label for="importCsvHeaderRow">Headers</label>\n		<input id="importCsvHeaderRow" type="checkbox" name="Header" value="1"> First row of CSV file contains column names\r\n	</div>\r\n</div>';
},{}],147:[function(require,module,exports){
module.exports='<div class="pure-modal-group alternate">\r\n    <label>For each column in your CSV file, specify what you want to do with the data. At a minimum, you must specify Start and Title.</label>\r\n</div>\r\n\r\n<div class="pure-modal-group" id="importHeaderContainer">\r\n<% _.each(headers,function(header) { %>\r\n	<div class="pure-modal-field">\r\n		<label for="csvImportOption_<%= header.replace(/\\W/g, "_") %>"><%= header %></label>\r\n		<select id="csvImportOption_<%= header.replace(/\\W/g, "_") %>">\r\n		<% _.each(options,function(option) { %>\r\n			<option><%= option %></option>	\r\n		<% }); %>\r\n		</select>\r\n	</div>\r\n<% }); %>\r\n    <div id="errorFieldImportCsv" class="modalErrorMessage"></div>\r\n</div>	\r\n';
},{}],148:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title">Import CSV File</h4>\r\n		</div>\r\n		<form id="importCsvForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">\r\n				<div id="importCsvContent"></div>\n			</div>\r\n			<div class="modal-footer">\r\n				<input class="btn btn-default" name="cancel" type="button" id="importCsvCancel" value="Cancel" />\r\n				<input class="btn btn-default" name="previous" type="button" id="importCsvPrevious" value="Previous" />\n				<input class="btn btn-primary" name="commit" type="submit" id="importCsvNext" value="Next" />\r\n			</div>\r\n		</form>\r\n	\r\n	</div>\r\n</div>';
},{}],149:[function(require,module,exports){
module.exports='<div id="inspectorResizeWrapper">\n	<div id="inspectorResizeGrabber"></div>\n	<div id="inspectorContent">\n		<form id="inspectorForm" class="pure-form pure-form-aligned">\n		 	<div id="inspectorTopBox">\n		 		<div class="pure-inspector-group">\n				   <h4 id="inspectorHeader"><span id="inspectorHeaderText">Event:</span> <span id="inspectorHeaderEventID"></span> <i id="inspectorCloseArrow" class="fa fa-chevron-right"></i></h4>\n				</div>\n				<div class="pure-inspector-group no-border">\n					<div class="pure-inspector-field">\n				        <label for="name">Title</label>\n				        <input id="inspectorTitle" type="text">\n				    </div>\n					<div class="pure-inspector-field">\n						<label for="color">Color</label>\n					    <div id="inspectorColor"></div>\n				    </div>\n					<div class="pure-inspector-field">\n					    <label for="parent">Parent</label>\n					    <div id="inspectorParent"></div>\n					</div>\n				</div>\n			</div>\n			<div id="inspectorTabGroup"></div>					\n		</form>	\n	</div>\n</div>';
},{}],150:[function(require,module,exports){
module.exports='<!--<fieldset>-->\n<div class="pure-inspector-group">\n	<div class="pure-inspector-field">\n	    <label for="links">Links</label>\n		<div class="valueList links"></div>\n	</div>						\n</div>\n<!--</fieldset>-->';
},{}],151:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n	<div>\n		<a type="button" class="imageButton fa fa-minus-circle remove-<%= item.id %>" style="display: none;" href="#"></a>\n		<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n		<% if(item.extra) { %>\n			<span class="list-item-extra">\n				<% if(item.actionIcon) { %>\n						<a type="button" class="imageButton fa fa-<%= item.actionIcon %> edit-<%= item.id %>" href="#"></a>\n				<% } %>\n						<%= item.extra %></span>\n		<% } %>\n	</div>\n<% }); %>';
},{}],152:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n	<div>\n		<% if(item.actionIcon) { %>\n			<a type="button" class="imageButton fa fa-<%= item.actionIcon %> edit-<%= item.id %>" href="#" tabIndex="0" title="Edit/Delete"></a>\n		<% } else { %>\n			<a type="button" class="imageButton fa fa-minus-square remove-<%= item.id %>" href="#" tabIndex="0" title="Delete"></a>\n		<% } %>\n		<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n		<% if(item.extra) { %>\n			<span class="list-item-extra"><%= item.extra %></span>\n		<% } %>\n	</div>\n<% }); %>\n\n<div>\n	<a type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n</div>';
},{}],153:[function(require,module,exports){
module.exports='<div id="syncBinder" style="width: 0px;"></div>\n<div id="inspector" style="width: 0px;"></div>\n<div id="mainTimelineCanvas">\n    <div id="filterBarDiv" class="filterBar" style="height: 0px;"></div>\n    <div class="contentDiv" id="mainTimelineContentDiv" style="top: 0px;">\n		<img class="backgroundImage" />	\n	    <div class="backgroundOvercoat"></div>\n	            	\n		<svg xmlns = "http://www.w3.org/2000/svg" class="timelineSvgWrapper" width="100%" height="100%" style="overflow: visible">\n	        <svg  xmlns = "http://www.w3.org/2000/svg" class="timelineContent svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" style="overflow: visible">\n	            <g class="lifetime_bg_layer" />\n	            <g class="bg_layer" />\n	            <g class="dependency_layer" />\n	        </svg>\n		</svg>\n	\n		<div id="event_layer" class="event_layer"></div>	\n		<div class="laneOverlay"></div>\n		<svg id="ui_drawing_svg"></svg>\n\n        <svg class="laneNavSvgWrap svgViewport" width="24" height="100%" viewbox="0 0 1 1" preserveAspectRatio="xMaxYMin meet" style="overflow: visible">\n        	<g class="laneNavSvg" />\n        </svg>\n        <svg class="header svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" />\n        <svg class="contextBarWrap svgViewport" x="0" y="100%" viewbox="0 0 1 1" preserveAspectRatio="xMinYMax meet" style="overflow: visible">\n			<g class="contextBar">\n	            <g class="contextLayer" />\n	            <g class="contextLens" />\n	        </g>\n        </svg>\n    </div>\n    \n    <div class="contentDiv" id="relationshipContentDiv" style="top: 0px;">\n		<img class="backgroundImage" />	\n	    <div class="backgroundOvercoat"></div>\n		<div id="relationship_bg_layer"></div>\n		<div id="relationship_intersection_layer"></div>\n		<div id="relationship_offset_layer"></div>\n		<div id="relationship_event_layer"></div>\n		<div id="relationship_lane_layer"></div>\n		<div id="relationship_entity_header"></div>\n		<svg id="relationship_ui_drawing_svg"></svg>\n		<div id="relationship_settings_layer">\n			<div id="relationshipSettingsButton" class="fa fa-cog" title="Settings"></div>	\n			<div id="relationshipOffsetButtonGroup" class="btn-group" role="group" aria-label="...">\n	    	    <button id="relationshipOffsetButton" type="button" title="Show/hide offsets" class="btn btn-default"><i class="fa fa-list-ol"></i></button>\n			</div>\n			<div id="relationshipNestingButtonGroup" class="btn-group" role="group" aria-label="...">\n			  <button id="relationshipTreeNestingButton" type="button" title="Nest parent/child events" class="btn btn-default"><i class="fa fa-indent"></i></button>\n			  <button id="relationshipFlattenNestingButton" type="button" title="Flatten parent/child events" class="btn btn-default"><i class="fa fa-align-justify"></i></button>\n			</div>\n		</div>\n	    <svg class="laneNavSvgWrap svgViewport" width="24" height="100%" viewbox="0 0 1 1" preserveAspectRatio="xMaxYMin meet" style="overflow: visible">\n	    	<g class="laneNavSvg" />\n	    </svg>\n	    <svg class="xScrollSvgWrap svgViewport" width="100%" height="24" viewbox="0 0 1 1" preserveAspectRatio="xMinYMax meet" style="overflow: visible">\n	    	<g class="xScrollSvg" />\n	    </svg>\n    </div>\n    \n    <div id="bookmarks" class="bookmarks">\n        <div class=\'bookmarkFirst\'>First</div>\n        <div class=\'bookmarkPrevious\'>Previous</div>\n        <div class="bookmarkGroup"></div>\n        <div class=\'bookmarkLast\'>Last</div>\n        <div class=\'bookmarkNext\'>Next</div>\n        <div class=\'bookmarkAdd\'>Add</div>\n    </div>\n    \n<!--\n	<svg xmlns = "http://www.w3.org/2000/svg" id="relationshipModeSvgWrapper" width="100%" height="100%" style="overflow: visible">\n	    <svg  xmlns = "http://www.w3.org/2000/svg" id="relationshipModeContent" class="svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" style="overflow: visible">\n	    </svg>\n	</svg>\n-->\n    \n</div>\n\n<div id="onboardingModal"></div>\n<div id="relationshipViewRoleContextMenu"></div>\n<div id="addEventModal"></div>\n<div id="addEntityModal"></div>\n<div id="embedInNewParentModal"></div>\n<div id="manageEntitiesModal"></div>\n<div id="editTemplateModal"></div>\n<div id="displaySettingsModal"></div>\n<div id="tagManagerModal"></div>\n<div id="syncSettingsModal"></div>\n<div id="exportCsvModal"></div>\n<div id="importCsvModal"></div>\n<div id="exportImageModal"></div>\n<div id="findReplaceModal"></div>\n<div id="printModal"></div>\n<div id="newParentModal"></div> <!-- must be below others as it may be used over top -->\n<div id="enterNameModal"></div> <!-- must be below others as it is used over top -->\n<div id="enterDateModal"></div> <!-- must be below others as it is used over top -->\n<div id="enterDurationModal"></div> <!-- must be below others as it is used over top -->\n<div id="editCalendarModal"></div> <!-- must be below others as it is used over top -->\n<input type="text" id="modalInputCatcher" /> \n';
},{}],154:[function(require,module,exports){
module.exports='<!--<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">-->\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="manageEntitiesWindowTitle">Manage Entities</h4>\n      </div>\n		<form id="manageEntitiesForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n      	<div class="masterDetailWindow">      \n			<div class="masterView withControls">\n				<div class="masterViewList"></div>\n				<div class="masterViewControls">\n					<i id="manageEntitiesSortAlphaButton" class="fa fa-sort-alpha-asc"></i>			\n					<i id="manageEntitiesMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\n					<i id="manageEntitiesMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\n				</div>\n				\n			</div>\n			<div class="detailView">\n				<div class="pure-modal-group">\n					<div class="pure-modal-field alongsideButton">\n						<label for="manageEntitiesName">Name</label>\n						<input id="manageEntitiesName" type="text" placeholder="Name">\n						<input id="manageEntitiesColor" type="text" />\n					</div>\n					<div class="pure-modal-field">\n						<label for="manageEntitiesNotes">Notes</label>\n                        <textarea id="manageEntitiesNotes"></textarea>\n					</div>\n				</div>\n				<div id="manageEntitiesAgeGroup">\n					<div class="pure-modal-group alternate">\n						<div class="pure-modal-heading">Birth / Creation</div>\n						<div class="pure-modal-field">\n						    <label for="manageEntitiesCreateEvent">Event</label>\n						    <div id="manageEntitiesCreateEvent"></div>\n						</div>\n						<div class="pure-modal-field sideBySide">\n						    <label for="manageEntitiesCreateOffset">Offset</label>\n							<input type="text" id="manageEntitiesCreateOffset" />\n						    <select id="manageEntitiesCreateOffsetFrom">\n						    	<option value="start">from start</option>\n						    	<option value="end">from end</option>\n						    </select>\n						</div>\n					</div>\n					<div class="pure-modal-group alternate">\n						<div class="pure-modal-field">\n						    <label for="manageEntitiesCreateDate">Date</label>\n						    <div id="manageEntitiesCreateDate"></div>\n						</div>\n					</div>\n					<div class="pure-modal-group">\n						<div class="pure-modal-heading">Death / Destruction</div>\n						<div class="pure-modal-field">\n						    <label for="manageEntitiesDestroyEvent">Event</label>\n						    <div id="manageEntitiesDestroyEvent"></div>\n						</div>\n						<div class="pure-modal-field sideBySide">\n						    <label for="manageEntitiesDestroyOffset">Offset</label>\n							<input type="text" id="manageEntitiesDestroyOffset" />\n						    <select id="manageEntitiesDestroyOffsetFrom">\n								<option value="start">from start</option>\n								<option value="end">from end</option>\n						    </select>\n						</div>\n					</div>\n					<div class="pure-modal-group">\n						<div class="pure-modal-field">\n						    <label for="manageEntitiesDestroyDate">Date</label>\n						    <div id="manageEntitiesDestroyDate"></div>\n						</div>\n					</div>\n				</div>\n				<div class="detailViewControls">\n				    <button  type="button" id="manageEntitiesRemoveButton" class="btn btn-delete">Delete entity</button>\n				</div>\n			</div>\n	      </div>\n      </div>  \n		</form>\n\n    </div>\n  </div>\n<!--</div>-->';
},{}],155:[function(require,module,exports){
module.exports='<!--<div class="masterViewList">-->\n<% _.each(groups, function(group) { %>\n	<div class="group expanded">\n		<div class="groupHeading"><%= group.name %></div>\n		<ul>\n	<% _.each(group.items, function(item) { %>\n			<li><i class="fa fa-<%= group.icon %>"></i> <%= item.name %></li>\n	<% }); %>\n		</ul>\n	</div>\n<% }); %>\n<!--</div>-->';
},{}],156:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">Convert "<span id="newParentEventTitle"><%= eventTitle %></span>" to Parent</h4>\n      </div>\n      <div class="modal-body modalForm">\n      	<div class="pure-modal-group">\n	      	<label>\n		      	<p>You are converting this event to a parent container. The start and end positions of parent container events are determined by their child positions.</p>\n		      	<p>Do you wish to create new start and end child events to preserve the current start and end positions of this event?</p>\n		    </label>\n      	</div>\n	  </div>\n      <div class="modal-footer">\n	    <input class="btn" name="commit" type="button" id="newParentNoButton" value="No" />\n	    <input class="btn btn-primary" name="commit" type="button" id="newParentYesButton" value="Yes" />\n      </div>\n    </div>\n  </div>\n';
},{}],157:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content" id="onboardingWindow">\n		<div class="modal-header">\n	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title" id="displaySettingsWindowTitle"><span id="onboardingCategory">Tip</span> <span id="onboardingPage">1</span>/<span id="onboardingPages">5</span>: <span id="onboardingTitle">Arcs are Entities</span></h4>\n		</div>\n		<div class="modal-body">\n			<div class="pure-modal-group">\n				<div id="onboardingContent"></div>\n			</div>\n		</div>\n		<div class="modal-footer">\n		  <a id="btnOnboardingHelp" style="float: left;" class="btn btn-default">Online Help</a>\n		  <input class="btn btn-default" name="previous" type="button" id="onboardingPrev" value="Previous" />\n		  <input class="btn btn-primary" name="commit" type="button" id="onboardingNext" value="Next" />\n		</div>\n	</div>\n</div>';
},{}],158:[function(require,module,exports){
module.exports='<% _.each(options, function(option) { %>\n	<option value="<%= option[valueProperty] %>"><%= option[textProperty] %></option>\n<% }); %>\n';
},{}],159:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title" id="printWindowTitle"><%= windowTitle %></h4>\r\n		</div>\r\n		<form id="printForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">\r\n				<div class="pure-modal-group">\r\n					<div class="pure-modal-field">\r\n						<label for="printSettingsSkin">Skin</label>\r\n						<select id="printSettingsSkin">\r\n						    <option value="dark">Dark</option>\r\n						    <option value="light">Light</option>\r\n						    <option value="writer">Writer</option>\r\n						    <option value="ocean">Ocean</option>\r\n						    <option value="borealis">Borealis</option>\r\n						    <option value="print">Print</option>\r\n						</select>\r\n					</div>\r\n					<div class="pure-modal-field">\r\n						<label for="printSettingsSize">Size</label>\r\n						<select id="printSettingsSize">\r\n						    <option value="50">50%</option>\r\n						    <option value="60">60%</option>\r\n						    <option value="70">70%</option>\r\n						    <option value="80">80%</option>\r\n						    <option value="90">90%</option>\r\n						    <option value="100">100%</option>\r\n						    <option value="110">110%</option>\r\n						    <option value="120">120%</option>\r\n						    <option value="130">130%</option>\r\n						    <option value="150">150%</option>\r\n						    <option value="150">175%</option>\r\n						    <option value="200">200%</option>\r\n						</select>\r\n					</div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="Format">Format</label>\r\n                        <input id="formatCurrentPrint" type="radio" name="Format" value="Current" checked />&nbsp;&nbsp;Current Window&nbsp;&nbsp;&nbsp;\r\n                        <input id="entireTimelinePrint" type="radio" name="Format" value="All" />&nbsp;&nbsp;Entire Timeline&nbsp;&nbsp;&nbsp;\r\n                        <input id="betweenDatesPrint" type="radio" name="Format" value="Interval" />&nbsp;&nbsp;Between Dates\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="printSettingsOmitCollapsedLanes">Include</label>\r\n                        <input type="checkbox" id="printSettingsOmitCollapsedLanes" checked="checked" />&nbsp;&nbsp;Print expanded groups only\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="startDateInputPrint">Start Date</label>\r\n                        <div id="startDateInputPrint"></div>\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="endDateInputPrint">End Date</label>\r\n                        <div id="endDateInputPrint"></div>\r\n                    </div>\r\n                </div>\r\n			</div>\r\n			<div class="modal-footer">\r\n				<input class="btn btn-primary" name="commit" type="submit" id="printSubmit" value="OK" />\r\n			</div>\r\n		</form>\r\n	</div>\r\n</div>';
},{}],160:[function(require,module,exports){
module.exports='<div class="pure-inspector-group">\n	<div class="pure-inspector-field">\n	    <label for="Tags">Tags</label>\n		<input type="text" class="form-control" id="inspectorTagsField" name="inspectorTags" value="" />\n	</div>\n</div>\n<% _.each(properties,function(prop) { %>\n<div class="pure-inspector-group">\n	<div class="pure-inspector-field">\n	    <label for="<%= prop.name %>"><%= prop.name %></label>\n	    <% if(prop.type == \'text\' || prop.type == \'string\') { %>\n			<input type="text" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } else if(prop.type == \'multitext\' || prop.type == \'richtext\') { %>\n			<textarea id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>"></textarea>\n		<% } else if(prop.type == \'number\') { %>\n			<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } else if(prop.type == \'decimal\') { %>\n			<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } else if(prop.type == \'percentage\') { %>\n			<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } else if(prop.type == \'currency\') { %>\n			<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } else if(prop.type == \'boolean\') { %>\n			<input type="checkbox" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n		<% } %>\n	</div>						\n</div>\n<% }); %>\n';
},{}],161:[function(require,module,exports){
module.exports='<!--<fieldset>-->\n	<div class="pure-inspector-group">\n		<div class="pure-inspector-field">\n		    <label for="basedOn">Based on</label>\n			<div class="valueList basedOn"></div>\n		</div>\n	</div>						\n	<div class="pure-inspector-group">\n		<div class="pure-inspector-field">\n		    <label for="startDate">Start</label>\n		    <div class="startDate"></div>										\n		</div>\n		<div class="pure-inspector-field">\n		    <label for="duration">Duration</label>\n			<input type="text" name="duration" class="duration" value="">\n		</div>\n		<div class="pure-inspector-field">\n		    <label for="endDate">End</label>\n		    <div class="endDate"></div>\n		</div>\n	</div>\n	<div class="pure-inspector-group">\n		<div class="pure-inspector-field">\n		    <label for="name">Followers</label>\n			<div class="valueList successor"></div>\n		</div>\n	</div>	\n<!--</fieldset>-->';
},{}],162:[function(require,module,exports){
module.exports='<div class="pure-modal-limit-height">\n	<% _.each(groups,function(group) { %>\n		<div class="selectColumnsGroupWrap-<%= group.name %>">\n			<div class="checkboxGroupHeading pure-modal-group">\n				<span class="fa fa-caret-down selectColumnGroupDisplayToggle collapse-group-<%= group.name %>" data-groupName="<%= group.name %>"></span>\n				<input type="checkbox" value="<%= group.name%>" class="selectColumnGroupCheckbox show-group-<%= group.name %>" /> \n				<span><%= group.name %></span>\n			</div>\n			<div class="selectColumnsRowWrap">\n				<% _.each(group.items,function(item) { %>\n					<div class="pure-modal-group checkboxRow">\n						<div class="pure-modal-field">\n							<input type="checkbox" value="<%= item.id%>" class="selectColumnListItemCheckbox show-column-<%= item.id %>" <%= item.isChecked ? \'checked="checked"\' : \'\' %> /> <%= item.name %>\n						</div>\n					</div>\n				<% }); %>\n			</div>\n		</div>\n	<% }); %>\n</div>\n<div class="popover-footer">\n	<div class="pure-modal-field">\n		<input type="button" class="btn btn-default" name="noneButton" value="None" id="selectColumnNoneBtn" />\n		<input type="button" class="btn btn-default" name="allButton" value="All" id="selectColumnAllBtn" />\n	</div>	\n</div>\n';
},{}],163:[function(require,module,exports){
module.exports='<% _.each(roles,function(role) { %>\n	<div class="pure-inspector-group">\n		<div class="pure-inspector-field">\n		    <label for="<%= role.roleId %>"><%= role.name %></label>\n		    <% if(role.multiplePerEvent) { %>\n				<div class="valueList role_<%= role.roleId %>"></div>\n			<% } else { %>\n				<div class="role_<%= role.roleId %>" ></div>\n			<% } %>\n		</div>\n	</div>						\n<% }); %>\n	<div id="inspectorRoleEntitySearch"></div>	\n';
},{}],164:[function(require,module,exports){
module.exports='<span class="bselect-label">&nbsp;</span>\n<button type="button" class="bselect-caret" tabindex="-1">\n	<span class="fa fa-chevron-down"></span>\n</button>\n<div class="bselect-dropdown" style="display: none;">\n	<div class="bselect-search">\n		<input type="text" class="bselect-search-input" role="combobox" tabindex="0" aria-expanded="false" aria-owns="bselect-option-list-1" style="width: 169px;">\n		<span class="bselect-search-icon" style="margin-left: -6px;">\n			<i class="fa fa-search"></i>\n		</span>\n	</div>\n	<div class="bselect-message" role="status" style="display: none;">No matches</div>\n	<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n	</ul>\n</div>\n';
},{}],165:[function(require,module,exports){
module.exports='<!--<div id="<%= elementName %>" class="searchContextMenu bselect-dropdown" style="display: none;">-->\n	<form id="<%= elementName %>-form" class="pure-form">\n		<div class="bselect-search">\n			<input   id="<%= elementName %>-searchInput" type="text" class="bselect-search-input" role="combobox" tabindex="1" aria-expanded="false" aria-owns="bselect-option-list-1" style="width: 169px;">\n			<span class="bselect-search-icon" style="margin-left: -6px;">\n				<i class="fa fa-search"></i>\n			</span>\n		</div>\n		<div class="bselect-message"   id="<%= elementName %>-noMatchMessage" role="status" style="display: none;">No matches</div>\n		<ul class="bselect-option-list"   id="<%= elementName %>-list" role="listbox">\n		</ul>\n	</form>\n<!--</div>-->\n';
},{}],166:[function(require,module,exports){
module.exports='<div id="syncBinderResizeWrapper">\n	<div id="syncBinderResizeGrabber"></div>\n	<div id="syncBinderContent">\n		<form id="syncBinderForm">\n			<div id="syncBinderTopRow"> \n				<i id="syncBinderSettingsButton" class="fa fa-cog" title="Settings"></i>\n		        <i id="syncBinderCloseButton" class="fa fa-times-circle" title="Close"></i>\n		        <i id="syncBinderSyncButton" class="fa fa-refresh" title="Update All"></i>\n		        <span id="syncBinderTitle">Scrivener Project</span>\n			</div>\n		    <div id="syncBinderTreeContainer">\n		    </div>   \n			<div id="syncBinderErrorDiv">\n				<div>\n					<p id="syncBinderErrorMessage"></p>\n					<p>If the problem persists, open and close the project in its default application.</p>\n					</div>\n				<div id="syncBinderTryAgainDiv">\n					<button id="syncBinderTryAgainButton" class="btn btn-default btn-xs" type="button">Try Again</button>\n		   		</div>\n			</div>   \n			<div id="syncBinderBottomRow"> \n				<span id="syncBinderFilter">\n					Show: <label><input type="checkbox" id="syncBinderUnchangedCheckbox" checked="checked" /> Unchanged</label> <label><input type="checkbox" id="syncBinderIgnoredCheckbox" /> Ignored</label>\n				</span>\n			</div>\n		\n		</form>	\n	</div>\n</div>\n<div id="syncBinderLinkEventSearch"></div>	\n';
},{}],167:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned">\n	<div class="pure-modal-group">\n		<div class="pure-modal-field">\n			<label for="syncLinkEvent">Event:</label>\n			<div id="syncLinkEvent"></div>\n		</div>	\n	</div>\n	<div class="popover-footer">\n		<div class="pure-modal-field">\n		    <input type="button" class="btn btn-primary" name="addButton" value="Add" id="syncLink-submit"/>\n		</div>	\n	</div>\n</form>';
},{}],168:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n			<h4 class="modal-title">Project Sync Settings</h4>\n		</div>\n		<form id="syncSettingsForm" class="pure-form pure-form-aligned">\n			<div class="modal-body">\n\n				<div class="pure-modal-group alternate">\n					<label>Sync timeline event fields with project properties:</label>\n				</div>\n				\n				<div class="pure-modal-group" id="syncSettingsFieldOptionsDiv">\n				\n				<% _.each(fields,function(field) { \n					var cleanName = field.name.replace(/\\s/g,\'_\').replace(/\\[/g,\'\').replace(/\\]/g,\'\');\n				%>\n					<div class="pure-modal-field">\n						<label for="syncSettingsOption<%= cleanName %>"><%= field.displayName %></label>\n						<select id="syncSettingsOption<%= cleanName %>">\n						<% _.each(field.options,function(opt) { %>\n							<option value="<%= opt.value %>"><%= opt.displayName %></option>	\n						<% }); %>\n						</select>\n					</div>\n				<% }); %>\n                 <div id="errorFieldScrivener" class="modalErrorMessage"></div>\n				</div>\n<!--				<legend>Use date format in project:</legend>\n				<div class="pure-modal-group">\n					<div class="pure-modal-field">\n						<label for="syncSettingsDateFormat">Format</label>\n						<select id="syncSettingsDateFormat">\n							<option>Long format (23 November 2014)</option>	\n							<option>Short format (03/05/2014)</option>	\n							<option>Sortable (2014-09-23)</option>	\n						</select>\n					</div>\n				</div>-->\n			</div>\n			<div class="modal-footer">\n				<input id="syncSettingsSubmit" class="btn btn-primary" name="commit" type="submit" value="OK" />\n			</div>\n		</form>\n	</div>\n</div>';
},{}],169:[function(require,module,exports){
module.exports='<!-- Assume div for tabGroup already exists -->\n<!--div class="tabGroup" id="inspectorTabGroup"-->\n	<ul class="tabs">\n	<% _.each(tabs,function(tab) { %>\n	    <li id="<%= tab.name %>-tab-button">\n	    	<span class="fa fa-<%= tab.icon %>"></span><span class="tabGroupName"><%= tab.name %></span>\n	    </li>\n	<% }); %>\n	</ul>\n\n	<div class="tabContentGroup">\n	<% _.each(tabs,function(tab) { %>\n		<div class="tabcontent" id="<%= tab.name %>-page">\n		</div>\n	<% }); %>\n	</div>\n\n<!--/div-->	';
},{}],170:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n	<div class="modal-content">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n			<h4 class="modal-title" id="tagManagerTitle">Tag Manager</h4>\r\n		</div>\r\n		<form id="tagManagerForm" class="pure-form pure-form-aligned">\r\n			<div class="modal-body">		\r\n				<div class="pure-modal-group">\n				    <label>Delete or rename existing tags to apply those changes to all associated events.</label>\n				</div>\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <!--<textarea id="tagManagerText" name"tagText" rows="10" cols="50"></textarea> -->\n                        <input type="text" class="form-control" id="tagManagerText" name="tagText" value="" />\r\n                    </div>\r\n                </div>\r\n				<div class="pure-modal-group">\n				    <label>Note: new tags can only be created in the Inspector.</label>\n				</div>\n			</div>\r\n		</form>\r\n	\r\n	</div>\r\n</div>';
},{}],171:[function(require,module,exports){
module.exports=[{identifier:"tools",type:"buttonSelect",image:"Cog.png",selectable:!0,options:[{identifier:"expandAllLanes",text:"Expand All Groups",shortcut:"Ctrl+Shift+Down",global:!0},{identifier:"collapseAllLanes",text:"Collapse All Groups",shortcut:"Ctrl+Shift+Up",global:!0},{identifier:"hideAllDetails",text:"Hide All Event Details",shortcut:"Shift+Ctrl+Left",global:!0}]},{identifier:"search",type:"input",text:"Search",minWidth:150,maxWidth:300,placeholder:"Enter search term...",noSep:!0},{identifier:"findPrevious",type:"button",text:"",image:"FindPrevious.png",noSep:!0},{identifier:"findNext",type:"button",text:"",image:"FindNext.png",noSep:!0},{identifier:"zoomOut",type:"button",text:"Zoom",image:"ZoomOut.png",shortcut:"Ctrl+-",global:!0},{identifier:"zoom",type:"slider",text:"",minWidth:50,maxWidth:150,minValue:1,maxValue:100,noSep:!0},{identifier:"zoomIn",type:"button",text:"",image:"ZoomIn.png",noSep:!0,center:!0,shortcut:"Ctrl+=",global:!0},{identifier:"aeonLink",type:"button",text:"History of Anthropology Timeline - by Alex Golub",image:""}];
},{}],172:[function(require,module,exports){
function ATWelcomeScreen(){this.navMode=ATWelcomeNavMode.RECENT,d3.select("body").classed("welcomeScreen",!0),this.standardTemplates=[],this.customTemplates=[],this.exampleTimelines=[],this.recentTimelines=[],this.clickedIndex=-99,this.clickedNavMode=-99,d3.select("#bounds").html(welcomeHtml),this.templatesDiv=d3.select("#navItemTemplates"),this.customDiv=d3.select("#navItemCustom"),this.examplesDiv=d3.select("#navItemExamples"),this.recentDiv=d3.select("#navItemRecent"),this.standardCollectionDiv=d3.select("#standardCollection .collection"),this.customCollectionDiv=d3.select("#customCollection .collection"),this.d3FileListDiv=d3.select("#fileListRecent");var e=this;this.examplesDiv.on("click",function(t){e.exampleNavClicked()}),this.recentDiv.on("click",function(t){e.recentNavClicked()}),$("#openFileButton").on("click",function(){window.ApplicationInterface&&window.ApplicationInterface.openFile(window.timelineDocumentId)}),this.updateDisplay()}var $=require("jquery"),_=require("lodash"),d3=require("d3"),utf8=require("utf8"),Opentip=require("../lib/opentip"),Backbone=require("backbone"),ATToolbar=require("../timeline/ATToolbar"),welcomeHtml=require("./templates/welcomeWindow.html"),ATWelcomeNavMode={TEMPLATES:0,CUSTOM:1,EXAMPLES:2,RECENT:3};ATWelcomeScreen.prototype.findClickedItem=function(e){switch(e){case ATWelcomeNavMode.TEMPLATES:return this.standardTemplates[this.clickedIndex];case ATWelcomeNavMode.CUSTOM:return this.customTemplates[this.clickedIndex];case ATWelcomeNavMode.EXAMPLES:return this.exampleTimelines[this.clickedIndex];case ATWelcomeNavMode.RECENT:return this.recentTimelines[this.clickedIndex]}return null},ATWelcomeScreen.prototype.setStandardTemplates=function(e){this.standardTemplates=JSON.parse(e),_.each(this.standardTemplates,function(e){e.navMode=ATWelcomeNavMode.TEMPLATES}),this.updateDisplay()},ATWelcomeScreen.prototype.setCustomTemplates=function(e){this.customTemplates=JSON.parse(e),_.each(this.customTemplates,function(e){e.navMode=ATWelcomeNavMode.CUSTOM}),this.updateDisplay()},ATWelcomeScreen.prototype.setRecentFiles=function(e){var t=utf8.decode(atob(e));if(this.recentTimelines=JSON.parse(t),_.each(this.recentTimelines,function(e){e.navMode=ATWelcomeNavMode.RECENT}),this.updateDisplay(),window.appToolbar){var o=[],n=0;_.each(this.recentTimelines,function(e){o.push({identifier:"openRecent_"+n,text:e.name}),n++}),window.appToolbar.updateOptionsForIdentifier("openRecent",o)}},ATWelcomeScreen.prototype.setExampleFiles=function(e){this.exampleTimelines=JSON.parse(e),this.updateDisplay()},ATWelcomeScreen.prototype.enableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!1):console.log("enableToolbarItem FAILED because toolbar does not exist yet")},ATWelcomeScreen.prototype.disableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!0):console.log("disableToolbarItem FAILED because toolbar does not exist yet")},ATWelcomeScreen.prototype.exampleNavClicked=function(e){this.navMode!=ATWelcomeNavMode.EXAMPLES&&(this.navMode=ATWelcomeNavMode.EXAMPLES,this.examplesDiv.classed("selected",!0),this.recentDiv.classed("selected",!1),this.updateDisplay())},ATWelcomeScreen.prototype.recentNavClicked=function(e){this.navMode!=ATWelcomeNavMode.RECENT&&(this.navMode=ATWelcomeNavMode.RECENT,this.examplesDiv.classed("selected",!1),this.recentDiv.classed("selected",!0),this.updateDisplay())},ATWelcomeScreen.prototype.itemDblClicked=function(e,t){this.itemChooseClicked(e,t)},ATWelcomeScreen.prototype.itemClicked=function(e,t){this.clickedNavMode=e.navMode,this.clickedIndex=t,this.updateDisplay()},ATWelcomeScreen.prototype.itemChooseClicked=function(e,t){if(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),window.ApplicationInterface){var o=this.findClickedItem(e.navMode);e.navMode==ATWelcomeNavMode.TEMPLATES||e.navMode==ATWelcomeNavMode.CUSTOM?window.ApplicationInterface.chooseTemplate(window.timelineDocumentId,e.navMode,o.name,!1):window.ApplicationInterface.chooseFile(window.timelineDocumentId,e.navMode,o.url)}},ATWelcomeScreen.prototype.itemCustomizeClicked=function(e,t){if(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),window.ApplicationInterface){var o=this.findClickedItem(e.navMode);e.navMode!=ATWelcomeNavMode.TEMPLATES&&e.navMode!=ATWelcomeNavMode.CUSTOM||window.ApplicationInterface.chooseTemplate(window.timelineDocumentId,e.navMode,o.name,!0)}},ATWelcomeScreen.prototype.itemCancelClicked=function(e,t){this.clickedIndex=-99,this.clickedNavMode=-99,this.updateDisplay(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},ATWelcomeScreen.prototype.itemDeleteClicked=function(e){window.ApplicationInterface&&window.ApplicationInterface.deleteCustomTemplate(window.timelineDocumentId,e),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},ATWelcomeScreen.prototype.updateNavDisplay=function(){var e=this,t=this.navMode==ATWelcomeNavMode.EXAMPLES?this.exampleTimelines:this.recentTimelines,o=this.d3FileListDiv.selectAll(".fileListItem").data(t);o.text(function(e){return e.name}).attr("title",function(e){return e.url}),o.enter().append("div").classed("fileListItemWrapper",!0).append("div").classed("fileListItem",!0).text(function(e){return e.name}).attr("title",function(e){return e.url}).on("click",function(t){return window.ApplicationInterface&&window.ApplicationInterface.chooseFile(window.timelineDocumentId,e.navMode,t.url),!1}),o.exit().remove()},ATWelcomeScreen.prototype.updateDisplay=function(){this.updateCollectionDisplay(this.standardCollectionDiv,this.standardTemplates,!1),this.updateCollectionDisplay(this.customCollectionDiv,this.customTemplates,!0),this.updateNavDisplay(),d3.select("#customCollection").style("display",this.customTemplates.length?null:"none")},ATWelcomeScreen.prototype.updateCollectionDisplay=function(e,t,o){var n=!0,i="128px",c="40px",a="64px",l="32px",d="75px",s=n?"46px":"86px",p="16px",r="16px",m=this,u=e.selectAll(".templateItem").data(t,function(e){return e.name});u.select(".templateItemIcon").select("span").attr("class",function(e){return"fa "+e.icon}),u.select(".templateItemLabel").text(function(e){return e.name}),u.classed("clicked",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode}),u.select(".templateItemIcon").transition().delay(250).duration(500).style("height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?c:i}).style("line-height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?c:i}).style("font-size",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?l:a}),u.select(".templateItemLabel").transition().delay(250).duration(500).style("height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?s:d}).style("font-size",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?r:p});var v=u.enter().append("div").attr("class","templateItem").classed("clicked",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode}).on("dblclick",function(e,t){m.itemDblClicked(e,t)}).on("click",function(e,t){m.itemClicked(e,t)}),T=v.append("div").attr("class","templateItemIcon").style("height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?c:i}).style("line-height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?c:i}).style("font-size",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?l:a});T.append("span").attr("class",function(e){return"fa "+e.icon}),v.append("div").attr("class","templateItemLabel").text(function(e){return e.name}).style("height",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?s:d}).style("font-size",function(e,t){return t==m.clickedIndex&&e.navMode==m.clickedNavMode?r:p}),v.append("div").attr("class","templateItemAction choose").text("Choose").on("click",function(e,t){m.itemChooseClicked(e,t)}),n&&v.append("div").attr("class","templateItemAction customize").text("Customise").on("click",function(e,t){m.itemCustomizeClicked(e,t)}),v.append("div").attr("class","templateItemAction cancel").text("Cancel").on("click",function(e,t){m.itemCancelClicked(e,t)}),o?v.append("div").attr("class","templateItemDelete").on("click",function(e,t){m.itemDeleteClicked(e.name)}).append("i").attr("class","fa fa-times-circle").on("click",function(e,t){m.itemDeleteClicked(e.name)}):v.append("div").attr("class","templateItemInfo").append("i").attr("class","fa fa-info-circle").each(function(e){new Opentip($(this),e.description,{style:"welcomeTooltipStyle",showOn:"mouseover",group:"templateInfo"})}),u.exit().remove()},ATWelcomeScreen.prototype.createToolbar=function(){if(!window.appToolbar){$("#toolbarDiv");window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.toolbarCommands),window.appToolbar.setMenuCommands(window.menuCommands)}d3.select("#bounds").classed("underToolbar",!0),window.appToolbar.setDisabled(_.pluck(window.toolbarCommands,"identifier"),!0),window.appToolbar.setDisabled(_.pluck(window.menuCommands[0].options,"identifier"),!0),window.appToolbar.setDisabled(["newDoc","openDoc","openRecent","checkUpdates","preferences","exit"],!1),window.appToolbar.setDisabled(_.pluck(window.menuCommands[1].options,"identifier"),!0),window.appToolbar.setDisabled(_.pluck(window.menuCommands[2].options,"identifier"),!0),window.appToolbar.setDisabled(_.pluck(window.menuCommands[3].options,"identifier"),!0),window.appToolbar.setDisabled(_.pluck(window.menuCommands[4].options,"identifier"),!0),window.appToolbar.setDisabled(["checkUpdates","about","support","registration","deactivate"],!1)},module.exports=ATWelcomeScreen;
},{"../lib/opentip":11,"../timeline/ATToolbar":90,"./templates/welcomeWindow.html":173,"backbone":176,"d3":300,"jquery":307,"lodash":309,"utf8":312}],173:[function(require,module,exports){
module.exports='<div id="welcomeNav">\n	<div id="appIconWrapper"><img id="appIcon" src="images/aeonIcon.png" /></div>\n	\n<!--	<div id="navHeaderNew" class="navHeader">Create New from Template:</div>\n	<div id="navItemTemplates" class="navItem selected"><span class="icon">&#128196;</span>Standard Templates</div>\n	<div id="navItemCustom" class="navItem"><span class="icon">&#9733;</span>Custom Templates</div>\n-->\n<!--	<div id="navItemExamples" style="display:  none;" class="navItem"><span class="icon">&#128196;</span>Example Timelines</div>-->\n	\n<!--	<div id="navHeaderNew" class="navItem">Recent Files:</div>-->\n	<div id="navItemWrapper">\n		<div id="navItemRecent" class="navItem selected"><i class="fa fa-clock-o"></i>Recent</div><div id="navItemExamples" class="navItem"><i class="fa fa-file-o"></i>Examples</div>\n	</div>\n	<div id="fileListRecent">\n	</div>\n	\n	<div id="openButtonDiv">\n		<button id="openFileButton" class="btn btn-sm btn-default">Open Existing File...</button>\n	</div>\n</div>\n\n<div id="right">\n	<div id="createNewHeading">Create New Timeline</div>\n<!-- 	<div id="instructions">Select a template as a starting point for your new timeline... don\'t panic, you can edit the template later via Timeline Settings.</div> -->\n	<div id="standardCollection">\n		<div class="collectionHeading">Standard Templates</div>\n		<div class="collection"></div>\n	</div>\n	<div id="customCollection">\n		<div class="collectionHeading">Custom Templates</div>\n		<div id="customCollection" class="collection"></div>\n	</div>\n</div>\n';
},{}],174:[function(require,module,exports){
module.exports=[{identifier:"file",text:"File",options:[{identifier:"newDoc",text:"New",shortcut:"Ctrl+Shift+N",global:!0},{identifier:"openDoc",text:"Open...",shortcut:"Ctrl+O",global:!0},{identifier:"openRecent",text:"Open Recent",options:[]},{identifier:"-"},{identifier:"closeDoc",text:"Close",shortcut:"Ctrl+F4",global:!0},{identifier:"saveDoc",text:"Save",shortcut:"Ctrl+S",global:!0},{identifier:"saveAsDoc",text:"Save As...",shortcut:"Ctrl+Shift+S",global:!0},{identifier:"-"},{identifier:"preferences",text:"Options..."},{identifier:"-"},{identifier:"import",text:"Import",options:[{identifier:"importCsv",text:"CSV/Text...",shortcut:"Ctrl+Shift+I",global:!0}]},{identifier:"export",text:"Export",options:[{identifier:"exportImage",text:"Image/PDF"},{identifier:"exportWeb",text:"Web"},{identifier:"exportCsv",text:"CSV/Text"}]},{identifier:"sync",text:"Project Sync",options:[{identifier:"syncLatest",text:"Latest",shortcut:"Ctrl+Shift+Y",global:!0},{identifier:"syncChoose",text:"Choose Project...",shortcut:"Ctrl+Alt+Shift+Y",global:!0},{identifier:"-"},{identifier:"syncClose",text:"Close Project"}]},{identifier:"-"},{identifier:"print",text:"Print...",shortcut:"Ctrl+P"},{identifier:"-"},{identifier:"exit",text:"Exit",shortcut:"Alt+F4",global:!0}]},{identifier:"edit",text:"Edit",options:[{identifier:"undo",text:"Undo",shortcut:"Ctrl+Z"},{identifier:"redo",text:"Redo",shortcut:"Ctrl+Y"},{identifier:"-"},{identifier:"cut",text:"Cut",shortcut:"Ctrl+X"},{identifier:"copy",text:"Copy",shortcut:"Ctrl+C"},{identifier:"paste",text:"Paste",shortcut:"Ctrl+V"},{identifier:"delete",text:"Delete",shortcut:["Del","Ctrl-Backspace"],minSelectionCount:1},{identifier:"-"},{identifier:"selectAll",text:"Select All",shortcut:"Ctrl+A"},{identifier:"selectPreviousEvent",text:"Select Previous Event",shortcut:"Ctrl+[",global:!0,minSelectionCount:1},{identifier:"selectNextEvent",text:"Select Next Event",shortcut:"Ctrl+]",global:!0,minSelectionCount:1},{identifier:"selectAllBefore",text:"Select All Before Current Selection",shortcut:"Shift+Ctrl+[",global:!0,minSelectionCount:1},{identifier:"selectAllAfter",text:"Select All After Current Selection",shortcut:"Shift+Ctrl+]",global:!0,minSelectionCount:1},{identifier:"-"},{identifier:"findParent",text:"Find",options:[{identifier:"find",text:"Find...",shortcut:"Ctrl+F",global:!0},{identifier:"findNext",text:"Find Next",shortcut:"F3",global:!0},{identifier:"findPrevious",text:"Find Previous",shortcut:"Shift+F3",global:!0},{identifier:"-"},{identifier:"findReplace",text:"Find and Replace...",shortcut:"Ctrl+H",global:!0}]}]},{identifier:"timeline",text:"Timeline",options:[{identifier:"addEvent",text:"Add Event",shortcut:"Ctrl+N",global:!0},{identifier:"addEntityMenu",text:"Add Entity",options:[]},{identifier:"-"},{identifier:"makeConsecutive",text:"Make Events Consecutive",shortcut:"Ctrl+\\",global:!0,minSelectionCount:2},{identifier:"makeDependent",text:"Make Events Dependent",shortcut:"Shift+Ctrl+D",global:!0,minSelectionCount:2},{identifier:"moveEventsByDuration",text:"Shift Events By...",shortcut:"Ctrl+>",global:!0,minSelectionCount:1},{identifier:"embedInNewParent",text:"Embed in New Parent Event...",minSelectionCount:1},{identifier:"-"},{identifier:"bookmarks",text:"Bookmarks",shortcut:"Shift+Ctrl+B",global:!0,options:[{identifier:"addBookmark",text:"Add Bookmark"},{identifier:"sortBookmarksByName",text:"Sort by Name"},{identifier:"sortBookmarksByDate",text:"Sort by Date"}]},{identifier:"-"},{identifier:"manageEntities",text:"Manage Entities...",shortcut:"Ctrl+E",global:!0},{identifier:"entities",text:"Sort Entities",global:!0,options:[{identifier:"sortEntitiesByName",text:"By Name"},{identifier:"sortEntitiesByAge",text:"By Age"},{identifier:"sortEntitiesByFirstAppearance",text:"By First Appearance"},{identifier:"sortEntitiesByFrequency",text:"By Frequency"}]},{identifier:"-"},{identifier:"tagManager",text:"Tag Manager...",shortcut:"Shift+Ctrl+T",global:!0},{identifier:"editTemplate",text:"Timeline Settings...",shortcut:"Ctrl+T",global:!0}]},{identifier:"view",text:"View",options:[{identifier:"displaySettings",text:"Display Settings"},{identifier:"-"},{identifier:"timelineView",text:"Timeline View",shortcut:"Ctrl+Shift+1",global:!0},{identifier:"relationshipView",text:"Relationship View",shortcut:"Ctrl+Shift+2",global:!0},{identifier:"-"},{identifier:"expandAllLanes",text:"Expand All Groups",shortcut:"Ctrl+Shift+Down",global:!0},{identifier:"collapseAllLanes",text:"Collapse All Groups",shortcut:"Ctrl+Shift+Up",global:!0},{identifier:"-"},{identifier:"showDetails",text:"Show Event Details",shortcut:"Ctrl+Right",global:!0,minSelectionCount:1},{identifier:"hideDetails",text:"Hide Event Details",shortcut:"Ctrl+Left",global:!0,minSelectionCount:1},{identifier:"hideAllDetails",text:"Hide All Event Details",shortcut:"Shift+Ctrl+Left",global:!0},{identifier:"-"},{identifier:"expandParents",text:"Expand Parent Events",shortcut:"Ctrl+Down",global:!0,minSelectionCount:1},{identifier:"collapseParents",text:"Collapse Parent Events",shortcut:"Ctrl+Up",global:!0,minSelectionCount:1},{identifier:"-"},{identifier:"revealInTimeline",text:"Scroll to Selected Event",minSelectionCount:1},{identifier:"-"},{identifier:"toggleInspector",text:"Toggle Inspector",shortcut:"Ctrl+I",global:!0},{identifier:"toggleFilter",text:"Toggle Filter",shortcut:"Ctrl+R",global:!0},{identifier:"-"},{identifier:"zoom",text:"Zoom",options:[{identifier:"zoomIn",text:"Zoom In",shortcut:"Ctrl+=",global:!0},{identifier:"zoomOut",text:"Zoom Out",shortcut:"Ctrl+-",global:!0},{identifier:"zoomToFit",text:"Zoom To Fit",shortcut:"Alt+Ctrl+=",global:!0}]}]},{identifier:"help",text:"Help",options:[{identifier:"support",text:"Online Help and User Manual"},{identifier:"-"},{identifier:"showGettingStartedTips",text:"Getting Started Tips"},{identifier:"showUpgradingTips",text:"Upgrading from Version 1 Tips"},{identifier:"showFilteringTips",text:"Filtering Tips"},{identifier:"showSyncingTips",text:"Scrivener Syncing Tips"},{identifier:"-"},{identifier:"checkUpdates",text:"Check for updates..."},{identifier:"-"},{identifier:"registration",text:"Registration..."},{identifier:"deactivate",text:"Deactivate License..."},{identifier:"about",text:"About Aeon Timeline"}]}];
},{}],175:[function(require,module,exports){
module.exports=[{identifier:"addEvent",type:"button",text:"Add Event",image:"AddEvent.png",disabledImage:"AddEvent_disabled.png",shortcut:"Ctrl+N"},{identifier:"addEntity",type:"buttonSelect",text:"Add Entity",image:"AddEntity.png",disabledImage:"AddEntity_disabled.png",selectable:!1,options:[]},{identifier:"delete",type:"button",text:"Delete",image:"Delete.png",disabledImage:"Delete_disabled.png",minSelectionCount:1},{identifier:"-"},{identifier:"editTemplate",type:"button",text:"Timeline Settings",image:"Cog.png",disabledImage:"Cog_disabled.png"},{identifier:"manageEntities",type:"button",text:"Manage Entities",image:"Entities.png",disabledImage:"Entities_disabled.png"},{identifier:"displaySettings",type:"button",text:"Display Settings",image:"Paintbrush.png",disabledImage:"Paintbrush_disabled.png"},{identifier:"-"},{identifier:"search",type:"input",text:"Search",minWidth:150,maxWidth:300,placeholder:"Enter date or search term..."},{identifier:"findPrevious",type:"button",text:"Find Previous",image:"FindPrevious.png",disabledImage:"FindPrevious_disabled.png",noSep:!0},{identifier:"findNext",type:"button",text:"Find Next",image:"FindNext.png",disabledImage:"FindNext_disabled.png",center:!0,noSep:!0},{identifier:"zoomOut",type:"button",text:"Zoom Out",image:"ZoomOut.png",disabledImage:"ZoomOut_disabled.png",noSep:!0},{identifier:"zoom",type:"slider",text:"Zoom",minWidth:50,maxWidth:150,minValue:1,maxValue:100,noSep:!0},{identifier:"zoomIn",type:"button",text:"Zoom In",image:"ZoomIn.png",disabledImage:"ZoomIn_disabled.png",noSep:!0},{identifier:"-"},{identifier:"timelineView",type:"buttonTwoState",text:"Timeline View",image:"TimelineView.png",disabledImage:"TimelineView_disabled.png",noSep:!0},{identifier:"relationshipView",type:"buttonTwoState",text:"Relationship View",image:"RelationshipView.png",disabledImage:"RelationshipView_disabled.png"},{identifier:"lane",type:"buttonSelect",text:"Group by",image:"Lane.png",disabledImage:"Lane_disabled.png",selectable:!0,options:[{identifier:"laneNone",text:"None",shortcut:"Ctrl+0"},{identifier:"-"}]},{identifier:"filter",type:"buttonTwoState",text:"Filter",image:"Filter.png",disabledImage:"Filter_disabled.png",shortcut:"Ctrl+Shift+F"},{identifier:"inspector",type:"buttonTwoState",text:"Inspector",image:"Inspector.png",disabledImage:"Inspector_disabled.png",shortcut:"Ctrl+Shift+I"}];
},{}],176:[function(require,module,exports){
!function(t,e){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,s){t.Backbone=e(t,s,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");e(t,exports,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,i,n){var s=t.Backbone,r=[],a=(r.push,r.slice);r.splice;e.VERSION="1.1.2",e.$=n,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1;var o=e.Events={on:function(t,e,i){if(!c(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var s=this,r=i.once(function(){s.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var s,r,a,o,h,u,l,d;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(o=t?[t]:i.keys(this._events),h=0,u=o.length;u>h;h++)if(t=o[h],a=this._events[t]){if(this._events[t]=s=[],e||n)for(l=0,d=a.length;d>l;l++)r=a[l],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&s.push(r);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&u(i,e),n&&u(n,arguments),this},stopListening:function(t,e,n){var s=this._listeningTo;if(!s)return this;var r=!e&&!n;n||"object"!=typeof e||(n=this),t&&((s={})[t._listenId]=t);for(var a in s)t=s[a],t.off(e,n,this),(r||i.isEmpty(t._events))&&delete this._listeningTo[a];return this}},h=/\s+/,c=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(h.test(i)){for(var r=i.split(h),a=0,o=r.length;o>a;a++)t[e].apply(t,[r[a]].concat(n));return!1}return!0},u=function(t,e){var i,n=-1,s=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a,o);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}},l={listenTo:"on",listenToOnce:"once"};i.each(l,function(t,e){o[e]=function(e,n,s){var r=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=i.uniqueId("l"));return r[a]=e,s||"object"!=typeof n||(s=this),e[t](n,s,this),this}}),o.bind=o.on,o.unbind=o.off,i.extend(e,o);var d=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var s,r,a,o,h,c,u,l;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;a=n.unset,h=n.silent,o=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),l=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)e=r[s],i.isEqual(l[s],e)||o.push(s),i.isEqual(u[s],e)?delete this.changed[s]:this.changed[s]=e,a?delete l[s]:l[s]=e;if(!h){o.length&&(this._pending=n);for(var d=0,f=o.length;f>d;d++)this.trigger("change:"+o[d],this,l[o[d]],n)}if(c)return this;if(!h)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in t)i.isEqual(s[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},U(this,t),this.sync("read",this,t)},save:function(t,e,n){var s,r,a,o=this.attributes;if(null==t||"object"==typeof t?(s=t,n=e):(s={})[t]=e,n=i.extend({validate:!0},n),s&&!n.wait){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;s&&n.wait&&(this.attributes=i.extend({},o,s)),void 0===n.parse&&(n.parse=!0);var h=this,c=n.success;return n.success=function(t){h.attributes=o;var e=h.parse(t,n);return n.wait&&(e=i.extend(s||{},e)),i.isObject(e)&&!h.set(e,n)?!1:(c&&c(h,t,n),void h.trigger("sync",h,t,n))},U(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=s),a=this.sync(r,this,n),s&&n.wait&&(this.attributes=o),a},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&s(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;U(this,t);var r=this.sync("delete",this,t);return t.wait||s(),r},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||j();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];i.each(f,function(t){d.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};i.extend(p.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,v))},remove:function(t,e){var n=!i.isArray(t);t=n?[t]:i.clone(t),e||(e={});var s,r,a,o;for(s=0,r=t.length;r>s;s++)o=t[s]=this.get(t[s]),o&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,e.silent||(e.index=a,o.trigger("remove",o,this,e)),this._removeReference(o,e));return n?t[0]:t},set:function(t,e){e=i.defaults({},e,g),e.parse&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?t?[t]:[]:i.clone(t);var s,r,a,o,h,c,u,l=e.at,f=this.model,p=this.comparator&&null==l&&e.sort!==!1,v=i.isString(this.comparator)?this.comparator:null,m=[],y=[],_={},b=e.add,w=e.merge,x=e.remove,E=!p&&b&&x?[]:!1;for(s=0,r=t.length;r>s;s++){if(h=t[s]||{},a=h instanceof d?o=h:h[f.prototype.idAttribute||"id"],c=this.get(a))x&&(_[c.cid]=!0),w&&(h=h===o?o.attributes:h,e.parse&&(h=c.parse(h,e)),c.set(h,e),p&&!u&&c.hasChanged(v)&&(u=!0)),t[s]=c;else if(b){if(o=t[s]=this._prepareModel(h,e),!o)continue;m.push(o),this._addReference(o,e)}o=c||o,!E||!o.isNew()&&_[o.id]||E.push(o),_[o.id]=!0}if(x){for(s=0,r=this.length;r>s;++s)_[(o=this.models[s]).cid]||y.push(o);y.length&&this.remove(y,e)}if(m.length||E&&E.length)if(p&&(u=!0),this.length+=m.length,null!=l)for(s=0,r=m.length;r>s;s++)this.models.splice(l+s,0,m[s]);else{E&&(this.models.length=0);var k=E||m;for(s=0,r=k.length;r>s;s++)this.models.push(k[s])}if(u&&this.sort({silent:!0}),!e.silent){for(s=0,r=m.length;r>s;s++)(o=m[s]).trigger("add",o,this,e);(u||E&&E.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null!=t?this._byId[t]||this._byId[t.id]||this._byId[t.cid]:void 0},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var s=t.reset?"reset":"set";n[s](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},U(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,s=e.success;return e.success=function(t,i){e.wait&&n.add(t,e),s&&s(t,i,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var m=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(m,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(t){p.prototype[t]=function(e,n){var s=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,s,n)}});var _=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var s=e.match(b),r=s[1],a=s[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===a?this.$el.on(r,n):this.$el.on(r,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,s){var r=E[t];i.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:r,dataType:"json"};if(s.url||(a.url=i.result(n,"url")||j()),null!=s.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",s.emulateJSON&&(a.data._method=r);var o=s.beforeSend;s.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===a.type||s.emulateJSON||(a.processData=!1),"PATCH"===a.type&&x&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var h=s.xhr=e.ajax(i.extend(a,s));return n.trigger("request",n,h,s),h};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),E={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,$=/(\(\?)?:\w+/g,S=/\*\w+/g,H=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,o,{initialize:function(){},route:function(t,n,s){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var r=this;return e.history.route(t,function(i){var a=r._extractParameters(t,i);r.execute(s,a),r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),e.history.trigger("route",r,n,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(H,"\\$&").replace(T,"(?:$1)?").replace($,function(t,e){return e?t:"([^/?]+)"}).replace(S,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var A=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,N=/^\/+|\/+$/g,R=/msie [\w.]+/,O=/\/$/,P=/#.*$/;A.started=!1,i.extend(A.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(O,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(I,"")},start:function(t){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),s=document.documentMode,r=R.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(N,"/"),r&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!A.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new A;var C=function(t,e){var n,s=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,e);var r=function(){this.constructor=n};return r.prototype=s.prototype,n.prototype=new r,t&&i.extend(n.prototype,t),n.__super__=s.prototype,n};d.extend=p.extend=k.extend=_.extend=A.extend=C;var j=function(){throw new Error('A "url" property or function must be specified')},U=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};return e});
},{"underscore":311}],177:[function(require,module,exports){
require("../../js/transition.js"),require("../../js/alert.js"),require("../../js/button.js"),require("../../js/carousel.js"),require("../../js/collapse.js"),require("../../js/dropdown.js"),require("../../js/modal.js"),require("../../js/tooltip.js"),require("../../js/popover.js"),require("../../js/scrollspy.js"),require("../../js/tab.js"),require("../../js/affix.js");
},{"../../js/affix.js":178,"../../js/alert.js":179,"../../js/button.js":180,"../../js/carousel.js":181,"../../js/collapse.js":182,"../../js/dropdown.js":183,"../../js/modal.js":184,"../../js/popover.js":185,"../../js/scrollspy.js":186,"../../js/tab.js":187,"../../js/tooltip.js":188,"../../js/transition.js":189}],178:[function(require,module,exports){
+function(t){"use strict";function i(i){return this.each(function(){var o=t(this),f=o.data("bs.affix"),n="object"==typeof i&&i;f||o.data("bs.affix",f=new e(this,n)),"string"==typeof i&&f[i]()})}var e=function(i,o){this.options=t.extend({},e.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};e.VERSION="3.3.6",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getState=function(t,i,e,o){var f=this.$target.scrollTop(),n=this.$element.offset(),s=this.$target.height();if(null!=e&&"top"==this.affixed)return e>f?"top":!1;if("bottom"==this.affixed)return null!=e?f+this.unpin<=n.top?!1:"bottom":t-o>=f+s?!1:"bottom";var a=null==this.affixed,h=a?f:n.top,r=a?s:i;return null!=e&&e>=f?"top":null!=o&&h+r>=t-o?"bottom":!1},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),o=this.options.offset,f=o.top,n=o.bottom,s=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(n=f=o),"function"==typeof f&&(f=o.top(this.$element)),"function"==typeof n&&(n=o.bottom(this.$element));var a=this.getState(s,i,f,n);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var h="affix"+(a?"-"+a:""),r=t.Event(h+".bs.affix");if(this.$element.trigger(r),r.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:s-i-n})}};var o=t.fn.affix;t.fn.affix=i,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),o=e.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),i.call(e,o)})})}(jQuery);
},{}],179:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var a=t(this),n=a.data("bs.alert");n||a.data("bs.alert",n=new r(this)),"string"==typeof e&&n[e].call(a)})}var a='[data-dismiss="alert"]',r=function(e){t(e).on("click",a,this.close)};r.VERSION="3.3.6",r.TRANSITION_DURATION=150,r.prototype.close=function(e){function a(){o.detach().trigger("closed.bs.alert").remove()}var n=t(this),s=n.attr("data-target");s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var o=t(s);e&&e.preventDefault(),o.length||(o=n.closest(".alert")),o.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",a).emulateTransitionEnd(r.TRANSITION_DURATION):a())};var n=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=r,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",a,r.prototype.close)}(jQuery);
},{}],180:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),a=n.data("bs.button"),o="object"==typeof e&&e;a||n.data("bs.button",a=new s(this,o)),"toggle"==e?a.toggle():e&&a.setState(e)})}var s=function(e,n){this.$element=t(e),this.options=t.extend({},s.DEFAULTS,n),this.isLoading=!1};s.VERSION="3.3.6",s.DEFAULTS={loadingText:"loading..."},s.prototype.setState=function(e){var s="disabled",n=this.$element,a=n.is("input")?"val":"html",o=n.data();e+="Text",null==o.resetText&&n.data("resetText",n[a]()),setTimeout(t.proxy(function(){n[a](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(s).attr(s,s)):this.isLoading&&(this.isLoading=!1,n.removeClass(s).removeAttr(s))},this),0)},s.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var s=this.$element.find("input");"radio"==s.prop("type")?(s.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==s.prop("type")&&(s.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),s.prop("checked",this.$element.hasClass("active")),t&&s.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=s,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(s){var n=t(s.target);n.hasClass("btn")||(n=n.closest(".btn")),e.call(n,"toggle"),t(s.target).is('input[type="radio"]')||t(s.target).is('input[type="checkbox"]')||s.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery);
},{}],181:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var s=t(this),n=s.data("bs.carousel"),a=t.extend({},i.DEFAULTS,s.data(),"object"==typeof e&&e),r="string"==typeof e?e:a.slide;n||s.data("bs.carousel",n=new i(this,a)),"number"==typeof e?n.to(e):r?n[r]():a.interval&&n.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.6",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e),s="prev"==t&&0===i||"next"==t&&i==this.$items.length-1;if(s&&!this.options.wrap)return e;var n="prev"==t?-1:1,a=(i+n)%this.$items.length;return this.$items.eq(a)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(e,s){var n=this.$element.find(".item.active"),a=s||this.getItemForDirection(e,n),r=this.interval,o="next"==e?"left":"right",l=this;if(a.hasClass("active"))return this.sliding=!1;var h=a[0],c=t.Event("slide.bs.carousel",{relatedTarget:h,direction:o});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=t(this.$indicators.children()[this.getItemIndex(a)]);d&&d.addClass("active")}var u=t.Event("slid.bs.carousel",{relatedTarget:h,direction:o});return t.support.transition&&this.$element.hasClass("slide")?(a.addClass(e),a[0].offsetWidth,n.addClass(o),a.addClass(o),n.one("bsTransitionEnd",function(){a.removeClass([e,o].join(" ")).addClass("active"),n.removeClass(["active",o].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(u)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(u)),r&&this.cycle(),this}};var s=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=s,this};var n=function(i){var s,n=t(this),a=t(n.attr("data-target")||(s=n.attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,""));if(a.hasClass("carousel")){var r=t.extend({},a.data(),n.data()),o=n.attr("data-slide-to");o&&(r.interval=!1),e.call(a,r),o&&a.data("bs.carousel").to(o),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",n).on("click.bs.carousel.data-api","[data-slide-to]",n),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery);
},{}],182:[function(require,module,exports){
+function(t){"use strict";function e(e){var a,s=e.attr("data-target")||(a=e.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"");return t(s)}function a(e){return this.each(function(){var a=t(this),i=a.data("bs.collapse"),n=t.extend({},s.DEFAULTS,a.data(),"object"==typeof e&&e);!i&&n.toggle&&/show|hide/.test(e)&&(n.toggle=!1),i||a.data("bs.collapse",i=new s(this,n)),"string"==typeof e&&i[e]()})}var s=function(e,a){this.$element=t(e),this.options=t.extend({},s.DEFAULTS,a),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};s.VERSION="3.3.6",s.TRANSITION_DURATION=350,s.DEFAULTS={toggle:!0},s.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},s.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(i&&i.length&&(e=i.data("bs.collapse"),e&&e.transitioning))){var n=t.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){i&&i.length&&(a.call(i,"hide"),e||i.data("bs.collapse",null));var l=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[l](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var o=function(){this.$element.removeClass("collapsing").addClass("collapse in")[l](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return o.call(this);var r=t.camelCase(["scroll",l].join("-"));this.$element.one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(s.TRANSITION_DURATION)[l](this.$element[0][r])}}}},s.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var a=this.dimension();this.$element[a](this.$element[a]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[a](0).one("bsTransitionEnd",t.proxy(i,this)).emulateTransitionEnd(s.TRANSITION_DURATION):i.call(this)}}},s.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},s.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(a,s){var i=t(s);this.addAriaAndCollapsedClass(e(i),i)},this)).end()},s.prototype.addAriaAndCollapsedClass=function(t,e){var a=t.hasClass("in");t.attr("aria-expanded",a),e.toggleClass("collapsed",!a).attr("aria-expanded",a)};var i=t.fn.collapse;t.fn.collapse=a,t.fn.collapse.Constructor=s,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(s){var i=t(this);i.attr("data-target")||s.preventDefault();var n=e(i),l=n.data("bs.collapse"),o=l?"toggle":i.data();a.call(n,o)})}(jQuery);
},{}],183:[function(require,module,exports){
+function(t){"use strict";function e(e){var o=e.attr("data-target");o||(o=e.attr("href"),o=o&&/#[A-Za-z]/.test(o)&&o.replace(/.*(?=#[^\s]*$)/,""));var n=o&&t(o);return n&&n.length?n:e.parent()}function o(o){o&&3===o.which||(t(r).remove(),t(a).each(function(){var n=t(this),r=e(n),a={relatedTarget:this};r.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&t.contains(r[0],o.target)||(r.trigger(o=t.Event("hide.bs.dropdown",a)),o.isDefaultPrevented()||(n.attr("aria-expanded","false"),r.removeClass("open").trigger(t.Event("hidden.bs.dropdown",a)))))}))}function n(e){return this.each(function(){var o=t(this),n=o.data("bs.dropdown");n||o.data("bs.dropdown",n=new d(this)),"string"==typeof e&&n[e].call(o)})}var r=".dropdown-backdrop",a='[data-toggle="dropdown"]',d=function(e){t(e).on("click.bs.dropdown",this.toggle)};d.VERSION="3.3.6",d.prototype.toggle=function(n){var r=t(this);if(!r.is(".disabled, :disabled")){var a=e(r),d=a.hasClass("open");if(o(),!d){"ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",o);var i={relatedTarget:this};if(a.trigger(n=t.Event("show.bs.dropdown",i)),n.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),a.toggleClass("open").trigger(t.Event("shown.bs.dropdown",i))}return!1}},d.prototype.keydown=function(o){if(/(38|40|27|32)/.test(o.which)&&!/input|textarea/i.test(o.target.tagName)){var n=t(this);if(o.preventDefault(),o.stopPropagation(),!n.is(".disabled, :disabled")){var r=e(n),d=r.hasClass("open");if(!d&&27!=o.which||d&&27==o.which)return 27==o.which&&r.find(a).trigger("focus"),n.trigger("click");var i=" li:not(.disabled):visible a",s=r.find(".dropdown-menu"+i);if(s.length){var p=s.index(o.target);38==o.which&&p>0&&p--,40==o.which&&p<s.length-1&&p++,~p||(p=0),s.eq(p).trigger("focus")}}}};var i=t.fn.dropdown;t.fn.dropdown=n,t.fn.dropdown.Constructor=d,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=i,this},t(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",a,d.prototype.toggle).on("keydown.bs.dropdown.data-api",a,d.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",d.prototype.keydown)}(jQuery);
},{}],184:[function(require,module,exports){
+function(t){"use strict";function e(e,i){return this.each(function(){var s=t(this),n=s.data("bs.modal"),a=t.extend({},o.DEFAULTS,s.data(),"object"==typeof e&&e);n||s.data("bs.modal",n=new o(this,a)),"string"==typeof e?n[e](i):a.show&&n.show(i)})}var o=function(e,o){this.options=o,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};o.VERSION="3.3.6",o.TRANSITION_DURATION=300,o.BACKDROP_TRANSITION_DURATION=150,o.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},o.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},o.prototype.show=function(e){var i=this,s=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var s=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),s&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var n=t.Event("shown.bs.modal",{relatedTarget:e});s?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(n)}).emulateTransitionEnd(o.TRANSITION_DURATION):i.$element.trigger("focus").trigger(n)}))},o.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(o.TRANSITION_DURATION):this.hideModal())},o.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},o.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},o.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},o.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},o.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},o.prototype.backdrop=function(e){var i=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&s;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+s).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},o.prototype.handleUpdate=function(){this.adjustDialog()},o.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},o.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},o.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},o.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},o.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},o.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=o,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(o){var i=t(this),s=i.attr("href"),n=t(i.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),a=n.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},n.data(),i.data());i.is("a")&&o.preventDefault(),n.one("show.bs.modal",function(t){t.isDefaultPrevented()||n.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(n,a,this)})}(jQuery);
},{}],185:[function(require,module,exports){
+function(t){"use strict";function o(o){return this.each(function(){var n=t(this),r=n.data("bs.popover"),i="object"==typeof o&&o;!r&&/destroy|hide/.test(o)||(r||n.data("bs.popover",r=new e(this,i)),"string"==typeof o&&r[o]())})}var e=function(t,o){this.init("popover",t,o)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.3.6",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),o=this.getTitle(),e=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](o),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof e?"html":"append":"text"](e),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,o=this.options;return t.attr("data-content")||("function"==typeof o.content?o.content.call(t[0]):o.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=t.fn.popover;t.fn.popover=o,t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery);
},{}],186:[function(require,module,exports){
+function(t){"use strict";function s(e,i){this.$body=t(document.body),this.$scrollElement=t(t(e).is(document.body)?window:e),this.options=t.extend({},s.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function e(e){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),r="object"==typeof e&&e;o||i.data("bs.scrollspy",o=new s(this,r)),"string"==typeof e&&o[e]()})}s.VERSION="3.3.6",s.DEFAULTS={offset:10},s.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},s.prototype.refresh=function(){var s=this,e="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(e="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var s=t(this),o=s.data("target")||s.attr("href"),r=/^#./.test(o)&&t(o);return r&&r.length&&r.is(":visible")&&[[r[e]().top+i,o]]||null}).sort(function(t,s){return t[0]-s[0]}).each(function(){s.offsets.push(this[0]),s.targets.push(this[1])})},s.prototype.process=function(){var t,s=this.$scrollElement.scrollTop()+this.options.offset,e=this.getScrollHeight(),i=this.options.offset+e-this.$scrollElement.height(),o=this.offsets,r=this.targets,l=this.activeTarget;if(this.scrollHeight!=e&&this.refresh(),s>=i)return l!=(t=r[r.length-1])&&this.activate(t);if(l&&s<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)l!=r[t]&&s>=o[t]&&(void 0===o[t+1]||s<o[t+1])&&this.activate(r[t])},s.prototype.activate=function(s){this.activeTarget=s,this.clear();var e=this.selector+'[data-target="'+s+'"],'+this.selector+'[href="'+s+'"]',i=t(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},s.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=e,t.fn.scrollspy.Constructor=s,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var s=t(this);e.call(s,s.data())})})}(jQuery);
},{}],187:[function(require,module,exports){
+function(t){"use strict";function a(a){return this.each(function(){var n=t(this),i=n.data("bs.tab");i||n.data("bs.tab",i=new e(this)),"string"==typeof a&&i[a]()})}var e=function(a){this.element=t(a)};e.VERSION="3.3.6",e.TRANSITION_DURATION=150,e.prototype.show=function(){var a=this.element,e=a.closest("ul:not(.dropdown-menu)"),n=a.data("target");if(n||(n=a.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var i=e.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:a[0]}),s=t.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(r),a.trigger(s),!s.isDefaultPrevented()&&!r.isDefaultPrevented()){var d=t(n);this.activate(a.closest("li"),e),this.activate(d,d.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:a[0]}),a.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},e.prototype.activate=function(a,n,i){function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),a.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),d?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu").length&&a.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=n.find("> .active"),d=i&&t.support.transition&&(s.length&&s.hasClass("fade")||!!n.find("> .fade").length);s.length&&d?s.one("bsTransitionEnd",r).emulateTransitionEnd(e.TRANSITION_DURATION):r(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=a,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var i=function(e){e.preventDefault(),a.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery);
},{}],188:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.tooltip"),s="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||o.data("bs.tooltip",n=new i(this,s)),"string"==typeof e&&n[e]())})}var i=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};i.VERSION="3.3.6",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,o){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),s=n.length;s--;){var r=n[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),i.isInStateTrue()?void 0:(clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide())},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var o=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!o)return;var n=this,s=this.tip(),r=this.getUID(this.type);this.setContent(),s.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&s.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,p=l.test(a);p&&(a=a.replace(l,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),f=s[0].offsetWidth,c=s[0].offsetHeight;if(p){var u=a,d=this.getPosition(this.$viewport);a="bottom"==a&&h.bottom+c>d.bottom?"top":"top"==a&&h.top-c<d.top?"bottom":"right"==a&&h.right+f>d.width?"left":"left"==a&&h.left-f<d.left?"right":a,s.removeClass(u).addClass(a)}var v=this.getCalculatedOffset(a,h,f,c);this.applyPlacement(v,a);var g=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(i.TRANSITION_DURATION):g()}},i.prototype.applyPlacement=function(e,i){var o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,r=parseInt(o.css("margin-top"),10),a=parseInt(o.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top+=r,e.left+=a,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var l=o[0].offsetWidth,p=o[0].offsetHeight;"top"==i&&p!=s&&(e.top=e.top+s-p);var h=this.getViewportAdjustedDelta(i,e,l,p);h.left?e.left+=h.left:e.top+=h.top;var f=/top|bottom/.test(i),c=f?2*h.left-n+l:2*h.top-s+p,u=f?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][u],f)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function o(){"in"!=n.hoverState&&s.detach(),n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}var n=this,s=t(this.$tip),r=t.Event("hide.bs."+this.type);return this.$element.trigger(r),r.isDefaultPrevented()?void 0:(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(i.TRANSITION_DURATION):o(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var s=o?{top:0,left:0}:e.offset(),r={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},a=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,r,a,s)},i.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-s-r.scroll,l=e.top+s-r.scroll+o;a<r.top?n.top=r.top-a:l>r.top+r.height&&(n.top=r.top+r.height-l)}else{var p=e.left-s,h=e.left+s+i;p<r.left?n.left=r.left-p:h>r.right&&(n.left=r.left+r.width-h)}return n},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var o=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=o,this}}(jQuery);
},{}],189:[function(require,module,exports){
+function(n){"use strict";function t(){var n=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==n.style[i])return{end:t[i]};return!1}n.fn.emulateTransitionEnd=function(t){var i=!1,r=this;n(this).one("bsTransitionEnd",function(){i=!0});var o=function(){i||n(r).trigger(n.support.transition.end)};return setTimeout(o,t),this},n(function(){n.support.transition=t(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){return n(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery);
},{}],190:[function(require,module,exports){
"use strict";function requireDependencies(e,r,i,n){function u(u){var o,t=i&&i[u],s=n&&n[u];try{o=t?path.resolve(r,t):s?resolve.sync(u,{basedir:r}):u}catch(d){o=u}return{alias:o,exports:e[u]||null}}return e?Object.keys(e).map(u).reduce(function(e,r){var i=r.alias.replace(/\\/g,"\\\\");return r.exports?e+r.exports+" = global."+r.exports+' = require("'+i+'");\n':e+'require("'+i+'");\n'},"\n; "):""}function bindWindowWithExports(e,r){return r+"; var "+shimRequire+"=require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {\n"+e+"\n}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) { module.exports = ex; });\n"}function bindWindowWithoutExports(e,r){return r+"; var "+shimRequire+"=require;(function browserifyShim(module, define, require) {\n"+e+"\n}).call(global, module, undefined, undefined);\n"}function moduleExport(e){return format('\n; browserify_shim__define__module__export__(typeof %s != "undefined" ? %s : window.%s);\n',e,e,e)}function wrap(e,r,i,n){var u=r.exports?e+moduleExport(r.exports):e,o=requireDependencies(r.depends,i,n),t=r.exports?bindWindowWithExports(u,o):bindWindowWithoutExports(u,o);return t}var util=require("util"),resolve=require("resolve"),exposify=require("exposify"),format=require("util").format,path=require("path"),through=require("through"),resolveShims=require("./lib/resolve-shims"),rename=require("rename-function-calls"),debug=require("./lib/debug"),shimRequire="__browserify_shim_require__";module.exports=function(e){function r(e){n+=e}function i(){var r=[];resolveShims(e,r,function(i,o){if(i)return u.emit("error",i),u.queue(null);debug(""),debug.inspect({file:e,info:o,messages:r});var t=o.exposeGlobals;if(t&&Object.keys(t)&&(n=exposify.expose(t,n)),o.shim){n=rename("require",shimRequire,n);var s=wrap(n,o.shim,o.packageDir,o.browser);u.queue(s)}else u.queue(n);u.queue(null)})}var n="",u=through(r,i);return u};
},{"./lib/debug":191,"./lib/resolve-shims":193,"exposify":195,"path":282,"rename-function-calls":251,"resolve":265,"through":272,"util":298}],191:[function(require,module,exports){
(function (process){
"use strict";function inspect(s,e){return require("util").inspect(s,!1,e||5,!0)}var diagnostics=process.env.BROWSERIFYSHIM_DIAGNOSTICS;exports=module.exports=function(){diagnostics&&console.error.apply(console,arguments)},exports.inspect=function(s,e){diagnostics&&console.error(inspect(s,e))};
}).call(this,require('_process'))

},{"_process":283,"util":298}],192:[function(require,module,exports){
"use strict";function parseDepends(e){return e?(e=Array.isArray(e)?e:[e],e.reduce(function(e,r){var t=r.split(":");if(!t||t.length>2||t.length<1||!t[0])throw new Error('Invalid depends specification: "'+r+'". Needs to have format: "nameORpath:export"');return t=t.map(function(e){return"string"==typeof e?e.trim():e}),e[t[0]]=t[1]||null,e},{})):void 0}var go=module.exports=function(e){return Object.keys(e).reduce(function(r,t){var n=e[t];"string"==typeof n&&(n={exports:n});var o=n.exports&&n.exports.length?n.exports.trim():null;return r[t.trim()]={exports:o,depends:parseDepends(n.depends)},r},{})};
},{}],193:[function(require,module,exports){
"use strict";function inspect(e,s){return util.inspect(e,!1,s||5,!0)}function isPath(e){return/^[.]{0,2}[/\\]/.test(e)}function validate(e,s,r){var o,i='When evaluating shim "'+e+'": '+inspect(s)+"\ninside "+r+"\n";if(!s.hasOwnProperty("exports"))throw o="browserify-shim needs at least a path and exports to do its job, you are missing the exports. \nIf this module has no exports, specify exports as null.",new Error(i+o)}function updateCache(e,s,r,o){shimsCache[e]={pack:s,shims:r,exposeGlobals:o},Object.keys(r).forEach(function(s){var o=r[s];validate(s,o,e),shimsByPath[s]=o})}function resolveDependsRelativeTo(e,s,r,o,i){var n;if(r)return Object.keys(r).reduce(function(t,a){return s[a]?(t[a]=r[a],i.push(format('Found depends "%s" exposed in browser field',a))):isPath(a)?(n=path.resolve(e,a),t[n]=r[a],i.push(format('Depends "%s" was resolved to be at [%s]',a,n))):(t[a]=r[a],o[a]?i.push(format('Found depends "%s" as an installed dependency of the package',a)):i.push(format('WARNING, depends "%s" is not a path, nor is it exposed in the browser field, nor was it found in package dependencies.',a))),t},{})}function resolvePaths(e,s,r,o,i,n){return Object.keys(o).reduce(function(t,a){var l,p=o[a],h=r[a];h?(l=path.resolve(e,h),n.push(format('Found "%s" in browser field referencing "%s" and resolved it to "%s"',a,h,l))):s?(l=path.resolve(s,a),n.push(format('Resolved "%s" found in shim file to "%s"',a,l))):(l=path.resolve(e,a),n.push(format('Resolved "%s" found in package.json to "%s"',a,l)));var u=resolveDependsRelativeTo(s||e,r,p.depends,i,n);return t[l]={exports:p.exports,depends:u},t},{})}function mapifyExposeGlobals(e){return Object.keys(e).reduce(function(s,r){var o=e[r],i=o.split(":");if(i.length<2||!i[1].length)throw new Error('Expose Globals need to have the format "global:expression.\n"'+inspect({key:r,value:o})+"does not.");return i.shift(),s[r]=i.join(":"),s},{})}function separateExposeGlobals(e){var s={},r={};return Object.keys(e).forEach(function(o){var i=e[o],n=i&&i.exports;n&&/^global\:/.test(n)?r[o]=n:s[o]=i}),{shims:s,exposeGlobals:mapifyExposeGlobals(r)}}function resolveFromShimFile(e,s,r,o){var i=path.join(e,r),n=path.dirname(i),t=require(i),a=separateExposeGlobals(t),l=resolvePaths(e,n,s.browser||{},a.shims,s.dependencies||{},o);return{shims:l,exposeGlobals:a.exposeGlobals}}function resolveInlineShims(e,s,r,o){var i=parseInlineShims(r),n=separateExposeGlobals(i),t=resolvePaths(e,null,s.browser||{},n.shims,s.dependencies||{},o);return{shims:t,exposeGlobals:n.exposeGlobals}}var path=require("path"),fs=require("fs"),util=require("util"),parseInlineShims=require("./parse-inline-shims"),mothership=require("mothership"),format=require("util").format,shimsCache={},shimsByPath={},resolve=module.exports=function(e,s,r){mothership(e,function(e){return!!e["browserify-shim"]},function(o,i){if(o)return r(o);if(!i||!i.pack)return r(new Error("Unable to find a browserify-shim config section in the package.json for "+e));var n=i.pack,t=i.path,a=path.dirname(t),l=shimsCache[a];if(l)return r(null,{package_json:t,packageDir:a,resolvedPreviously:!0,shim:shimsByPath[e],exposeGlobals:l.exposeGlobals,browser:n.browser,"browserify-shim":n["browserify-shim"],dependencies:n.dependencies});try{n=require(t);var p=n["browserify-shim"];if(!p)return r(null,{package_json:t,shim:void 0});var h="string"==typeof p?resolveFromShimFile(a,n,p,s):resolveInlineShims(a,n,p,s);s.push({resolved:h.shims}),updateCache(a,n,h.shims,h.exposeGlobals),r(null,{package_json:t,packageDir:a,shim:shimsByPath[e],exposeGlobals:h.exposeGlobals,browser:n.browser,"browserify-shim":n["browserify-shim"],dependencies:n.dependencies})}catch(o){return console.trace(),r(o)}})};
},{"./parse-inline-shims":192,"fs":273,"mothership":249,"path":282,"util":298}],194:[function(require,module,exports){
"use strict";var mapObject=require("map-obj"),replaceRequires=require("replace-requires"),globalize=require("globo");module.exports=function(e,r){return e=mapObject(e,function(e,r){return[e,globalize(r)]}),replaceRequires(r,e)};
},{"globo":196,"map-obj":201,"replace-requires":202}],195:[function(require,module,exports){
(function (process){
"use strict";var transformify=require("transformify"),through=require("through2"),expose=require("./expose");exports=module.exports=function(e,r){if(r=r||{},r.filePattern=r.filePattern||exports.filePattern,r.expose=r.expose||exports.config,r.filePattern&&!r.filePattern.test(e))return through();if("object"!=typeof r.expose)throw new Error("Please pass { expose: { ... } } to transform, set exposify.config or $EXPOSIFY_CONFIG so exposify knows what to expose");var o=transformify(expose.bind(null,r.expose));return o(e)},exports.config=function(){if(process.env.EXPOSIFY_CONFIG)try{return JSON.parse(process.env.EXPOSIFY_CONFIG)}catch(e){console.error("Invalid exposify config!"),console.error(e.stack)}}(),exports.filePattern=/\.js$/,exports.expose=expose;
}).call(this,require('_process'))

},{"./expose":194,"_process":283,"through2":237,"transformify":238}],196:[function(require,module,exports){
"use strict";function parenthesize(e){return"("+e+")"}var ternary=require("ternary"),isDefined=require("is-defined"),access=require("accessory");module.exports=function(e){return parenthesize(ternary(isDefined("window"),access("window",e),ternary(isDefined("global"),access("global",e),null)))};
},{"accessory":197,"is-defined":199,"ternary":200}],197:[function(require,module,exports){
"use strict";function accumulate(t,u){return t+"['"+u+"']"}var split=require("dot-parts");module.exports=function(t,u){return split(u).reduce(accumulate,t)};
},{"dot-parts":198}],198:[function(require,module,exports){
"use strict";module.exports=function(r){for(var t=[],e=r.split("."),s=0;s<e.length;s++){for(var l=e[s];"\\"===l[l.length-1];)l=l.slice(0,-1)+".",l+=e[++s];t.push(l)}return t};
},{}],199:[function(require,module,exports){
"use strict";module.exports=function(e){return"typeof "+e+' !== "undefined"'};
},{}],200:[function(require,module,exports){
"use strict";module.exports=function(t,e,r){return t+" ? "+e+" : "+r};
},{}],201:[function(require,module,exports){
"use strict";module.exports=function(e,r){for(var t={},n=Object.keys(e),o=0;o<n.length;o++){var s=n[o],u=r(s,e[s],e);t[u[0]]=u[1]}return t};
},{}],202:[function(require,module,exports){
"use strict";function requireLiteral(e){var r=e.arguments[0];return r&&"Literal"===r.type}var detective=require("detective"),patch=require("patch-text"),hasRequire=require("has-require"),extend=require("xtend");module.exports=function(e,r){var t=new hasRequire.Checker(e),n=Object.keys(r);return n.some(t.has,t)?patch(e,detective.find(e,{nodes:!0}).nodes.filter(requireLiteral).map(function(e){return extend(e,{replacement:r[e.arguments[0].value]})}).filter(function(e){return null!=e.replacement})):e};
},{"detective":203,"has-require":218,"patch-text":220,"xtend":221}],203:[function(require,module,exports){
function parse(e,r){return r||(r={}),aparse(e,{ecmaVersion:defined(r.ecmaVersion,6),sourceType:r.sourceType,ranges:defined(r.ranges,r.range),locations:defined(r.locations,r.loc),allowReserved:defined(r.allowReserved,!0),allowReturnOutsideFunction:defined(r.allowReturnOutsideFunction,!0),allowHashBang:defined(r.allowHashBang,!0)})}var aparse=require("acorn").parse,escodegen=require("escodegen"),defined=require("defined"),requireRe=/\brequire\b/,traverse=function(e,r){if(Array.isArray(e))for(var n=0;n<e.length;n++)null!=e[n]&&(e[n].parent=e,traverse(e[n],r));else if(e&&"object"==typeof e){r(e);for(var s in e)e.hasOwnProperty(s)&&"parent"!==s&&e[s]&&(e[s].parent=e,traverse(e[s],r))}},walk=function(e,r,n){var s=parse(e,r);traverse(s,n)},exports=module.exports=function(e,r){return exports.find(e,r).strings};exports.find=function(e,r){r||(r={});var n=void 0===r.word?"require":r.word;"string"!=typeof e&&(e=String(e));var s=r.isRequire||function(e){var r=e.callee;return r&&"CallExpression"===e.type&&"Identifier"===r.type&&r.name===n},a={strings:[],expressions:[]};r.nodes&&(a.nodes=[]);var t="require"===n?requireRe:RegExp("\\b"+n+"\\b");return t.test(e)?(walk(e,r.parse,function(e){s(e)&&(e.arguments.length&&("Literal"===e.arguments[0].type?a.strings.push(e.arguments[0].value):a.expressions.push(escodegen.generate(e.arguments[0]))),r.nodes&&a.nodes.push(e))}),a):a};
},{"acorn":204,"defined":205,"escodegen":206}],204:[function(require,module,exports){
(function (global){
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.acorn=t()}}(function(){return function t(e,s,i){function r(o,a){if(!s[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(n)return n(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var c=s[o]={exports:{}};e[o][0].call(c.exports,function(t){var s=e[o][1][t];return r(s?s:t)},c,c.exports,t,e,s,i)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,s){"use strict";function i(t,e){var s=o(e,t),i=s.pos,r=s.options.locations&&s.curPosition();return s.nextToken(),s.parseTopLevel(s.options.program||s.startNodeAt(i,r))}function r(t,e,s){var i=o(s,t,e);return i.nextToken(),i.parseExpression()}function n(t,e){return o(e,t)}function o(t,e){return new h(c(t),String(e))}s.parse=i,s.parseExpressionAt=r,s.tokenizer=n,s.__esModule=!0;var a=t("./state"),h=a.Parser,p=t("./options"),c=p.getOptions;t("./parseutil"),t("./statement"),t("./lval"),t("./expression"),s.Parser=a.Parser,s.plugins=a.plugins,s.defaultOptions=p.defaultOptions;var u=t("./location");s.SourceLocation=u.SourceLocation,s.getLineInfo=u.getLineInfo,s.Node=t("./node").Node;var l=t("./tokentype");s.TokenType=l.TokenType,s.tokTypes=l.types;var f=t("./tokencontext");s.TokContext=f.TokContext,s.tokContexts=f.types;var d=t("./identifier");s.isIdentifierChar=d.isIdentifierChar,s.isIdentifierStart=d.isIdentifierStart,s.Token=t("./tokenize").Token;var m=t("./whitespace");s.isNewLine=m.isNewLine,s.lineBreak=m.lineBreak,s.lineBreakG=m.lineBreakG;var x="1.2.2";s.version=x},{"./expression":6,"./identifier":7,"./location":8,"./lval":9,"./node":10,"./options":11,"./parseutil":12,"./state":13,"./statement":14,"./tokencontext":15,"./tokenize":16,"./tokentype":17,"./whitespace":19}],2:[function(t,e,s){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t}},{}],3:[function(t,e,s){function i(){if(!a){a=!0;for(var t,e=o.length;e;){t=o,o=[];for(var s=-1;++s<e;)t[s]();e=o.length}a=!1}}function r(){}var n=e.exports={},o=[],a=!1;n.nextTick=function(t){o.push(t),a||setTimeout(i,0)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],4:[function(t,e,s){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],5:[function(t,e,s){(function(e,i){function r(t,e){var i={seen:[],stylize:o};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&s._extend(i,e),k(i.showHidden)&&(i.showHidden=!1),k(i.depth)&&(i.depth=2),k(i.colors)&&(i.colors=!1),k(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=n),h(i,t,i.depth)}function n(t,e){var s=r.styles[e];return s?"["+r.colors[s][0]+"m"+t+"["+r.colors[s][1]+"m":t}function o(t,e){return t}function a(t){var e={};return t.forEach(function(t,s){e[t]=!0}),e}function h(t,e,i){if(t.customInspect&&e&&A(e.inspect)&&e.inspect!==s.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return g(r)||(r=h(t,r,i)),r}var n=p(t,e);if(n)return n;var o=Object.keys(e),m=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),C(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return c(e);if(0===o.length){if(A(e)){var x=e.name?": "+e.name:"";return t.stylize("[Function"+x+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(S(e))return t.stylize(Date.prototype.toString.call(e),"date");if(C(e))return c(e)}var y="",v=!1,b=["{","}"];if(d(e)&&(v=!0,b=["[","]"]),A(e)){var k=e.name?": "+e.name:"";y=" [Function"+k+"]"}if(w(e)&&(y=" "+RegExp.prototype.toString.call(e)),S(e)&&(y=" "+Date.prototype.toUTCString.call(e)),C(e)&&(y=" "+c(e)),0===o.length&&(!v||0==e.length))return b[0]+y+b[1];if(0>i)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=v?u(t,e,i,m,o):o.map(function(s){return l(t,e,i,m,s,v)}),t.seen.pop(),f(E,y,b)}function p(t,e){if(k(e))return t.stylize("undefined","undefined");if(g(e)){var s="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(s,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):x(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,s,i,r){for(var n=[],o=0,a=e.length;a>o;++o)I(e,String(o))?n.push(l(t,e,s,i,String(o),!0)):n.push("");return r.forEach(function(r){r.match(/^\d+$/)||n.push(l(t,e,s,i,r,!0))}),n}function l(t,e,s,i,r,n){var o,a,p;if(p=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},p.get?a=p.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):p.set&&(a=t.stylize("[Setter]","special")),I(i,r)||(o="["+r+"]"),a||(t.seen.indexOf(p.value)<0?(a=x(s)?h(t,p.value,null):h(t,p.value,s-1),a.indexOf("\n")>-1&&(a=n?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),k(o)){if(n&&r.match(/^\d+$/))return a;o=JSON.stringify(""+r),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function f(t,e,s){var i=0,r=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?s[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+s[1]:s[0]+e+" "+t.join(", ")+" "+s[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function x(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function k(t){return void 0===t}function w(t){return E(t)&&"[object RegExp]"===L(t)}function E(t){return"object"==typeof t&&null!==t}function S(t){return E(t)&&"[object Date]"===L(t)}function C(t){return E(t)&&("[object Error]"===L(t)||t instanceof Error)}function A(t){return"function"==typeof t}function N(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function L(t){return Object.prototype.toString.call(t)}function _(t){return 10>t?"0"+t.toString(10):t.toString(10)}function T(){var t=new Date,e=[_(t.getHours()),_(t.getMinutes()),_(t.getSeconds())].join(":");return[t.getDate(),B[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var O=/%[sdj%]/g;s.format=function(t){if(!g(t)){for(var e=[],s=0;s<arguments.length;s++)e.push(r(arguments[s]));return e.join(" ")}for(var s=1,i=arguments,n=i.length,o=String(t).replace(O,function(t){if("%%"===t)return"%";if(s>=n)return t;switch(t){case"%s":return String(i[s++]);case"%d":return Number(i[s++]);case"%j":try{return JSON.stringify(i[s++])}catch(e){return"[Circular]"}default:return t}}),a=i[s];n>s;a=i[++s])o+=x(a)||!E(a)?" "+a:" "+r(a);return o},s.deprecate=function(t,r){function n(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return t.apply(this,arguments)}if(k(i.process))return function(){return s.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var o=!1;return n};var P,R={};s.debuglog=function(t){if(k(P)&&(P=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(P)){var i=e.pid;R[t]=function(){var e=s.format.apply(s,arguments);console.error("%s %d: %s",t,i,e)}}else R[t]=function(){};return R[t]},s.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=d,s.isBoolean=m,s.isNull=x,s.isNullOrUndefined=y,s.isNumber=v,s.isString=g,s.isSymbol=b,s.isUndefined=k,s.isRegExp=w,s.isObject=E,s.isDate=S,s.isError=C,s.isFunction=A,s.isPrimitive=N,s.isBuffer=t("./support/isBuffer");var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];s.log=function(){console.log("%s - %s",T(),s.format.apply(s,arguments))},s.inherits=t("inherits"),s._extend=function(t,e){if(!e||!E(e))return t;for(var s=Object.keys(e),i=s.length;i--;)t[s[i]]=e[s[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,_process:3,inherits:2}],6:[function(t,e,s){"use strict";var i=t("./tokentype").types,r=t("./state").Parser,n=t("./identifier").reservedWords,o=t("./util").has,a=r.prototype;a.checkPropClash=function(t,e){if(!(this.options.ecmaVersion>=6)){var s=t.key,i=void 0;switch(s.type){case"Identifier":i=s.name;break;case"Literal":i=String(s.value);break;default:return}var r=t.kind||"init",n=void 0;if(o(e,i)){n=e[i];var a="init"!==r;(!this.strict&&!a||!n[r])&&a^n.init||this.raise(s.start,"Redefinition of property")}else n=e[i]={init:!1,get:!1,set:!1};n[r]=!0}},a.parseExpression=function(t,e){var s=this.start,r=this.startLoc,n=this.parseMaybeAssign(t,e);if(this.type===i.comma){var o=this.startNodeAt(s,r);for(o.expressions=[n];this.eat(i.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return n},a.parseMaybeAssign=function(t,e,s){if(this.type==i._yield&&this.inGenerator)return this.parseYield();var r=void 0;e?r=!1:(e={start:0},r=!0);var n=this.start,o=this.startLoc;this.type!=i.parenL&&this.type!=i.name||(this.potentialArrowAt=this.start);var a=this.parseMaybeConditional(t,e);if(s&&(a=s.call(this,a,n,o)),this.type.isAssign){var h=this.startNodeAt(n,o);return h.operator=this.value,h.left=this.type===i.eq?this.toAssignable(a):a,e.start=0,this.checkLVal(a),this.next(),h.right=this.parseMaybeAssign(t),this.finishNode(h,"AssignmentExpression")}return r&&e.start&&this.unexpected(e.start),a},a.parseMaybeConditional=function(t,e){var s=this.start,r=this.startLoc,n=this.parseExprOps(t,e);if(e&&e.start)return n;if(this.eat(i.question)){var o=this.startNodeAt(s,r);return o.test=n,o.consequent=this.parseMaybeAssign(),this.expect(i.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return n},a.parseExprOps=function(t,e){var s=this.start,i=this.startLoc,r=this.parseMaybeUnary(e);return e&&e.start?r:this.parseExprOp(r,s,i,-1,t)},a.parseExprOp=function(t,e,s,r,n){var o=this.type.binop;if(Array.isArray(e)&&this.options.locations&&void 0===n&&(n=r,r=s,s=e[1],e=e[0]),null!=o&&(!n||this.type!==i._in)&&o>r){var a=this.startNodeAt(e,s);a.left=t,a.operator=this.value;var h=this.type;this.next();var p=this.start,c=this.startLoc;return a.right=this.parseExprOp(this.parseMaybeUnary(),p,c,o,n),this.finishNode(a,h===i.logicalOR||h===i.logicalAND?"LogicalExpression":"BinaryExpression"),this.parseExprOp(a,e,s,r,n)}return t},a.parseMaybeUnary=function(t){if(this.type.prefix){var e=this.startNode(),s=this.type===i.incDec;return e.operator=this.value,e.prefix=!0,this.next(),e.argument=this.parseMaybeUnary(),t&&t.start&&this.unexpected(t.start),s?this.checkLVal(e.argument):this.strict&&"delete"===e.operator&&"Identifier"===e.argument.type&&this.raise(e.start,"Deleting local variable in strict mode"),this.finishNode(e,s?"UpdateExpression":"UnaryExpression")}var r=this.start,n=this.startLoc,o=this.parseExprSubscripts(t);if(t&&t.start)return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var e=this.startNodeAt(r,n);e.operator=this.value,e.prefix=!1,e.argument=o,this.checkLVal(o),this.next(),o=this.finishNode(e,"UpdateExpression")}return o},a.parseExprSubscripts=function(t){var e=this.start,s=this.startLoc,i=this.parseExprAtom(t);return t&&t.start?i:this.parseSubscripts(i,e,s)},a.parseSubscripts=function(t,e,s,r){for(Array.isArray(e)&&this.options.locations&&void 0===r&&(r=s,s=e[1],e=e[0]);;)if(this.eat(i.dot)){var n=this.startNodeAt(e,s);n.object=t,n.property=this.parseIdent(!0),n.computed=!1,t=this.finishNode(n,"MemberExpression")}else if(this.eat(i.bracketL)){var n=this.startNodeAt(e,s);n.object=t,n.property=this.parseExpression(),n.computed=!0,this.expect(i.bracketR),t=this.finishNode(n,"MemberExpression")}else if(!r&&this.eat(i.parenL)){var n=this.startNodeAt(e,s);n.callee=t,n.arguments=this.parseExprList(i.parenR,!1),t=this.finishNode(n,"CallExpression")}else{if(this.type!==i.backQuote)return t;var n=this.startNodeAt(e,s);n.tag=t,n.quasi=this.parseTemplate(),t=this.finishNode(n,"TaggedTemplateExpression")}},a.parseExprAtom=function(t){var e=void 0,s=this.potentialArrowAt==this.start;switch(this.type){case i._this:case i._super:var r=this.type===i._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,r);case i._yield:this.inGenerator&&this.unexpected();case i.name:var n=this.start,o=this.startLoc,a=this.parseIdent(this.type!==i.name);return s&&!this.canInsertSemicolon()&&this.eat(i.arrow)?this.parseArrowExpression(this.startNodeAt(n,o),[a]):a;case i.regexp:var h=this.value;return e=this.parseLiteral(h.value),e.regex={pattern:h.pattern,flags:h.flags},e;case i.num:case i.string:return this.parseLiteral(this.value);case i._null:case i._true:case i._false:return e=this.startNode(),e.value=this.type===i._null?null:this.type===i._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case i.parenL:return this.parseParenAndDistinguishExpression(s);case i.bracketL:return e=this.startNode(),this.next(),this.options.ecmaVersion>=7&&this.type===i._for?this.parseComprehension(e,!1):(e.elements=this.parseExprList(i.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression"));case i.braceL:return this.parseObj(!1,t);case i._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case i._class:return this.parseClass(this.startNode(),!1);case i._new:return this.parseNew();case i.backQuote:return this.parseTemplate();default:this.unexpected()}},a.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},a.parseParenExpression=function(){this.expect(i.parenL);var t=this.parseExpression();return this.expect(i.parenR),t},a.parseParenAndDistinguishExpression=function(t){var e=this.start,s=this.startLoc,r=void 0;if(this.options.ecmaVersion>=6){if(this.next(),this.options.ecmaVersion>=7&&this.type===i._for)return this.parseComprehension(this.startNodeAt(e,s),!0);for(var n=this.start,o=this.startLoc,a=[],h=!0,p={start:0},c=void 0,u=void 0;this.type!==i.parenR;){if(h?h=!1:this.expect(i.comma),this.type===i.ellipsis){c=this.start,a.push(this.parseParenItem(this.parseRest()));break}this.type!==i.parenL||u||(u=this.start),a.push(this.parseMaybeAssign(!1,p,this.parseParenItem))}var l=this.start,f=this.startLoc;if(this.expect(i.parenR),t&&!this.canInsertSemicolon()&&this.eat(i.arrow))return u&&this.unexpected(u),this.parseParenArrowList(e,s,a);a.length||this.unexpected(this.lastTokStart),c&&this.unexpected(c),p.start&&this.unexpected(p.start),a.length>1?(r=this.startNodeAt(n,o),r.expressions=a,this.finishNodeAt(r,"SequenceExpression",l,f)):r=a[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var d=this.startNodeAt(e,s);return d.expression=r,this.finishNode(d,"ParenthesizedExpression")}return r},a.parseParenItem=function(t){return t},a.parseParenArrowList=function(t,e,s){return this.parseArrowExpression(this.startNodeAt(t,e),s)};var h=[];a.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(i.dot))return t.meta=e,t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raise(t.property.start,"The only valid meta property for new is new.target"),this.finishNode(t,"MetaProperty");var s=this.start,r=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),s,r,!0),this.eat(i.parenL)?t.arguments=this.parseExprList(i.parenR,!1):t.arguments=h,this.finishNode(t,"NewExpression")},a.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.start,this.end),cooked:this.value},this.next(),t.tail=this.type===i.backQuote,this.finishNode(t,"TemplateElement")},a.parseTemplate=function(){var t=this.startNode();this.next(),t.expressions=[];var e=this.parseTemplateElement();for(t.quasis=[e];!e.tail;)this.expect(i.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(i.braceR),t.quasis.push(e=this.parseTemplateElement());return this.next(),this.finishNode(t,"TemplateLiteral")},a.parseObj=function(t,e){var s=this.startNode(),r=!0,n={};for(s.properties=[],this.next();!this.eat(i.braceR);){if(r)r=!1;else if(this.expect(i.comma),this.afterTrailingComma(i.braceR))break;var o=this.startNode(),a=void 0,h=void 0,p=void 0;this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(t||e)&&(h=this.start,p=this.startLoc),t||(a=this.eat(i.star))),this.parsePropertyName(o),this.parsePropertyValue(o,t,a,h,p,e),this.checkPropClash(o,n),s.properties.push(this.finishNode(o,"Property"))}return this.finishNode(s,t?"ObjectPattern":"ObjectExpression")},a.parsePropertyValue=function(t,e,s,r,o,a){this.eat(i.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init"):this.options.ecmaVersion>=6&&this.type===i.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(s)):this.options.ecmaVersion>=5&&!t.computed&&"Identifier"===t.key.type&&("get"===t.key.name||"set"===t.key.name)&&this.type!=i.comma&&this.type!=i.braceR?((s||e)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1)):this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?(t.kind="init",e?((this.isKeyword(t.key.name)||this.strict&&(n.strictBind(t.key.name)||n.strict(t.key.name))||!this.options.allowReserved&&this.isReservedWord(t.key.name))&&this.raise(t.key.start,"Binding "+t.key.name),t.value=this.parseMaybeDefault(r,o,t.key)):this.type===i.eq&&a?(a.start||(a.start=this.start),t.value=this.parseMaybeDefault(r,o,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected()},a.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(i.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(i.bracketR),t.key;t.computed=!1}return t.key=this.type===i.num||this.type===i.string?this.parseExprAtom():this.parseIdent(!0)},a.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1)},a.parseMethod=function(t){var e=this.startNode();this.initFunction(e),this.expect(i.parenL),e.params=this.parseBindingList(i.parenR,!1,!1);var s=void 0;return this.options.ecmaVersion>=6?(e.generator=t,s=!0):s=!1,this.parseFunctionBody(e,s),this.finishNode(e,"FunctionExpression")},a.parseArrowExpression=function(t,e){return this.initFunction(t),t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.finishNode(t,"ArrowFunctionExpression")},a.parseFunctionBody=function(t,e){var s=e&&this.type!==i.braceL;if(s)t.body=this.parseMaybeAssign(),t.expression=!0;else{var r=this.inFunction,n=this.inGenerator,o=this.labels;this.inFunction=!0,this.inGenerator=t.generator,this.labels=[],t.body=this.parseBlock(!0),t.expression=!1,this.inFunction=r,this.inGenerator=n,this.labels=o}if(this.strict||!s&&t.body.body.length&&this.isUseStrict(t.body.body[0])){var a={},h=this.strict;this.strict=!0,t.id&&this.checkLVal(t.id,!0);for(var p=0;p<t.params.length;p++)this.checkLVal(t.params[p],!0,a);this.strict=h}},a.parseExprList=function(t,e,s,r){for(var n=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(i.comma),e&&this.afterTrailingComma(t))break;s&&this.type===i.comma?n.push(null):this.type===i.ellipsis?n.push(this.parseSpread(r)):n.push(this.parseMaybeAssign(!1,r))}return n},a.parseIdent=function(t){var e=this.startNode();return t&&"never"==this.options.allowReserved&&(t=!1),this.type===i.name?(!t&&(!this.options.allowReserved&&this.isReservedWord(this.value)||this.strict&&n.strict(this.value)&&(this.options.ecmaVersion>=6||-1==this.input.slice(this.start,this.end).indexOf("\\")))&&this.raise(this.start,"The keyword '"+this.value+"' is reserved"),e.name=this.value):t&&this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"Identifier")},a.parseYield=function(){var t=this.startNode();return this.next(),this.type==i.semi||this.canInsertSemicolon()||this.type!=i.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(i.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")},a.parseComprehension=function(t,e){for(t.blocks=[];this.type===i._for;){var s=this.startNode();this.next(),this.expect(i.parenL),s.left=this.parseBindingAtom(),this.checkLVal(s.left,!0),this.expectContextual("of"),s.right=this.parseExpression(),this.expect(i.parenR),t.blocks.push(this.finishNode(s,"ComprehensionBlock"))}return t.filter=this.eat(i._if)?this.parseParenExpression():null,t.body=this.parseExpression(),this.expect(e?i.parenR:i.bracketR),t.generator=e,this.finishNode(t,"ComprehensionExpression")}},{"./identifier":7,"./state":13,"./tokentype":17,"./util":18}],7:[function(t,e,s){"use strict";function i(t){function e(t){if(1==t.length)return s+="return str === "+JSON.stringify(t[0])+";";s+="switch(str){";for(var e=0;e<t.length;++e)s+="case "+JSON.stringify(t[e])+":";s+="return true}return false;"}t=t.split(" ");var s="",i=[];t:for(var r=0;r<t.length;++r){for(var n=0;n<i.length;++n)if(i[n][0].length==t[r].length){i[n].push(t[r]);continue t}i.push([t[r]])}if(i.length>3){i.sort(function(t,e){return e.length-t.length}),s+="switch(str.length){";for(var r=0;r<i.length;++r){var o=i[r];s+="case "+o[0].length+":",e(o)}s+="}"}else e(t);return new Function("str",s)}function r(t,e){for(var s=65536,i=0;i<e.length;i+=2){if(s+=e[i],s>t)return!1;if(s+=e[i+1],s>=t)return!0}}function n(t,e){return 65>t?36===t:91>t?!0:97>t?95===t:123>t?!0:65535>=t?t>=170&&l.test(String.fromCharCode(t)):e===!1?!1:r(t,d)}function o(t,e){return 48>t?36===t:58>t?!0:65>t?!1:91>t?!0:97>t?95===t:123>t?!0:65535>=t?t>=170&&f.test(String.fromCharCode(t)):e===!1?!1:r(t,d)||r(t,m)}s.isIdentifierStart=n,s.isIdentifierChar=o,s.__esModule=!0;var a={3:i("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),5:i("class enum extends super const export import"),6:i("enum await"),strict:i("implements interface let package private protected public static yield"),strictBind:i("eval arguments")};s.reservedWords=a;var h="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",p={5:i(h),6:i(h+" let const class extends export import yield super")};s.keywords=p;var c="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢲऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",u="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣤ-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏ᦰ-ᧀᧈᧉ᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷼-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︭︳︴﹍-﹏０-９＿",l=new RegExp("["+c+"]"),f=new RegExp("["+c+u+"]");c=u=null;var d=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,99,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,98,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,955,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,38,17,2,24,133,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,32,4,287,47,21,1,2,0,185,46,82,47,21,0,60,42,502,63,32,0,449,56,1288,920,104,110,2962,1070,13266,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,16481,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,1340,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,16355,541],m=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,16,9,83,11,168,11,6,9,8,2,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,316,19,13,9,214,6,3,8,112,16,16,9,82,12,9,9,535,9,20855,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,4305,6,792618,239]},{}],8:[function(t,e,s){"use strict";function i(t,e){for(var s=1,i=0;;){o.lastIndex=i;var r=o.exec(t);if(!(r&&r.index<e))return new a(s,e-i);++s,i=r.index+r[0].length}}var r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};s.getLineInfo=i,s.__esModule=!0;var n=t("./state").Parser,o=t("./whitespace").lineBreakG,a=(t("util").deprecate,s.Position=function(){function t(e,s){r(this,t),this.line=e,this.column=s}return t.prototype.offset=function(e){return new t(this.line,this.column+e)},t}()),h=(s.SourceLocation=function p(t,e,s){r(this,p),this.start=e,this.end=s,null!==t.sourceFile&&(this.source=t.sourceFile)},n.prototype);h.raise=function(t,e){var s=i(this.input,t);e+=" ("+s.line+":"+s.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=s,r.raisedAt=this.pos,r},h.curPosition=function(){return new a(this.curLine,this.pos-this.lineStart)},h.markPosition=function(){return this.options.locations?[this.start,this.startLoc]:this.start}},{"./state":13,"./whitespace":19,util:5}],9:[function(t,e,s){"use strict";var i=t("./tokentype").types,r=t("./state").Parser,n=t("./identifier").reservedWords,o=t("./util").has,a=r.prototype;a.toAssignable=function(t,e){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":break;case"ObjectExpression":t.type="ObjectPattern";for(var s=0;s<t.properties.length;s++){var i=t.properties[s];"init"!==i.kind&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,e)}break;case"ArrayExpression":t.type="ArrayPattern",this.toAssignableList(t.elements,e);break;case"AssignmentExpression":"="===t.operator?t.type="AssignmentPattern":this.raise(t.left.end,"Only '=' operator can be used for specifying default value.");break;case"ParenthesizedExpression":t.expression=this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}return t},a.toAssignableList=function(t,e){var s=t.length;if(s){var i=t[s-1];if(i&&"RestElement"==i.type)--s;else if(i&&"SpreadElement"==i.type){i.type="RestElement";var r=i.argument;this.toAssignable(r,e),"Identifier"!==r.type&&"MemberExpression"!==r.type&&"ArrayPattern"!==r.type&&this.unexpected(r.start),--s}}for(var n=0;s>n;n++){var o=t[n];o&&this.toAssignable(o,e)}return t},a.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(t),this.finishNode(e,"SpreadElement")},a.parseRest=function(){var t=this.startNode();return this.next(),t.argument=this.type===i.name||this.type===i.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(t,"RestElement")},a.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case i.name:return this.parseIdent();case i.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(i.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case i.braceL:return this.parseObj(!0);default:this.unexpected()}},a.parseBindingList=function(t,e,s){for(var r=[],n=!0;!this.eat(t);)if(n?n=!1:this.expect(i.comma),e&&this.type===i.comma)r.push(null);else{if(s&&this.afterTrailingComma(t))break;if(this.type===i.ellipsis){var o=this.parseRest();this.parseBindingListItem(o),r.push(o),this.expect(t);break}var a=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(a),r.push(a)}return r},a.parseBindingListItem=function(t){return t},a.parseMaybeDefault=function(t,e,s){if(Array.isArray(t)&&this.options.locations&&void 0===noCalls&&(s=e,e=t[1],t=t[0]),s=s||this.parseBindingAtom(),!this.eat(i.eq))return s;var r=this.startNodeAt(t,e);return r.operator="=",r.left=s,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},a.checkLVal=function(t,e,s){switch(t.type){case"Identifier":this.strict&&(n.strictBind(t.name)||n.strict(t.name))&&this.raise(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),s&&(o(s,t.name)&&this.raise(t.start,"Argument name clash in strict mode"),s[t.name]=!0);break;case"MemberExpression":e&&this.raise(t.start,(e?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var i=0;i<t.properties.length;i++)this.checkLVal(t.properties[i].value,e,s);break;case"ArrayPattern":for(var i=0;i<t.elements.length;i++){var r=t.elements[i];r&&this.checkLVal(r,e,s)}break;case"AssignmentPattern":this.checkLVal(t.left,e,s);break;case"RestElement":this.checkLVal(t.argument,e,s);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,s);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}}},{"./identifier":7,"./state":13,"./tokentype":17,"./util":18}],10:[function(t,e,s){"use strict";var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};s.__esModule=!0;var r=t("./state").Parser,n=t("./location").SourceLocation,o=r.prototype,a=s.Node=function h(){i(this,h)};o.startNode=function(){var t=new a;return t.start=this.start,this.options.locations&&(t.loc=new n(this,this.startLoc)),this.options.directSourceFile&&(t.sourceFile=this.options.directSourceFile),this.options.ranges&&(t.range=[this.start,0]),t},o.startNodeAt=function(t,e){var s=new a;return Array.isArray(t)&&this.options.locations&&void 0===e&&(e=t[1],t=t[0]),s.start=t,this.options.locations&&(s.loc=new n(this,e)),this.options.directSourceFile&&(s.sourceFile=this.options.directSourceFile),this.options.ranges&&(s.range=[t,0]),
s},o.finishNode=function(t,e){return t.type=e,t.end=this.lastTokEnd,this.options.locations&&(t.loc.end=this.lastTokEndLoc),this.options.ranges&&(t.range[1]=this.lastTokEnd),t},o.finishNodeAt=function(t,e,s,i){return t.type=e,Array.isArray(s)&&this.options.locations&&void 0===i&&(i=s[1],s=s[0]),t.end=s,this.options.locations&&(t.loc.end=i),this.options.ranges&&(t.range[1]=s),t}},{"./location":8,"./state":13}],11:[function(t,e,s){"use strict";function i(t){var e={};for(var s in p)e[s]=t&&o(t,s)?t[s]:p[s];return a(e.onToken)&&!function(){var t=e.onToken;e.onToken=function(e){return t.push(e)}}(),a(e.onComment)&&(e.onComment=r(e,e.onComment)),e}function r(t,e){return function(s,i,r,n,o,a){var p={type:s?"Block":"Line",value:i,start:r,end:n};t.locations&&(p.loc=new h(this,o,a)),t.ranges&&(p.range=[r,n]),e.push(p)}}s.getOptions=i,s.__esModule=!0;var n=t("./util"),o=n.has,a=n.isArray,h=t("./location").SourceLocation,p={ecmaVersion:5,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:!0,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}};s.defaultOptions=p},{"./location":8,"./util":18}],12:[function(t,e,s){"use strict";var i=t("./tokentype").types,r=t("./state").Parser,n=t("./whitespace").lineBreak,o=r.prototype;o.isUseStrict=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value},o.eat=function(t){return this.type===t?(this.next(),!0):!1},o.isContextual=function(t){return this.type===i.name&&this.value===t},o.eatContextual=function(t){return this.value===t&&this.eat(i.name)},o.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},o.canInsertSemicolon=function(){return this.type===i.eof||this.type===i.braceR||n.test(this.input.slice(this.lastTokEnd,this.start))},o.insertSemicolon=function(){return this.canInsertSemicolon()?(this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0):void 0},o.semicolon=function(){this.eat(i.semi)||this.insertSemicolon()||this.unexpected()},o.afterTrailingComma=function(t){return this.type==t?(this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),this.next(),!0):void 0},o.expect=function(t){this.eat(t)||this.unexpected()},o.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")}},{"./state":13,"./tokentype":17,"./whitespace":19}],13:[function(t,e,s){"use strict";function i(t,e,s){this.options=t,this.sourceFile=this.options.sourceFile||null,this.isKeyword=o[this.options.ecmaVersion>=6?6:5],this.isReservedWord=n[this.options.ecmaVersion],this.input=e,this.loadPlugins(this.options.plugins),s?(this.pos=s,this.lineStart=Math.max(0,this.input.lastIndexOf("\n",s)),this.curLine=this.input.slice(0,this.lineStart).split(h).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=a.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=null,this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.strict=this.inModule="module"===this.options.sourceType,this.potentialArrowAt=-1,this.inFunction=this.inGenerator=!1,this.labels=[],0===this.pos&&this.options.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)}s.Parser=i,s.__esModule=!0;var r=t("./identifier"),n=r.reservedWords,o=r.keywords,a=t("./tokentype").types,h=t("./whitespace").lineBreak;i.prototype.extend=function(t,e){this[t]=e(this[t])};var p={};s.plugins=p,i.prototype.loadPlugins=function(t){for(var e in t){var i=s.plugins[e];if(!i)throw new Error("Plugin '"+e+"' not found");i(this,t[e])}}},{"./identifier":7,"./tokentype":17,"./whitespace":19}],14:[function(t,e,s){"use strict";var i=t("./tokentype").types,r=t("./state").Parser,n=t("./whitespace").lineBreak,o=r.prototype;o.parseTopLevel=function(t){var e=!0;for(t.body||(t.body=[]);this.type!==i.eof;){var s=this.parseStatement(!0,!0);t.body.push(s),e&&this.isUseStrict(s)&&this.setStrict(!0),e=!1}return this.next(),this.options.ecmaVersion>=6&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var a={kind:"loop"},h={kind:"switch"};o.parseStatement=function(t,e){var s=this.type,r=this.startNode();switch(s){case i._break:case i._continue:return this.parseBreakContinueStatement(r,s.keyword);case i._debugger:return this.parseDebuggerStatement(r);case i._do:return this.parseDoStatement(r);case i._for:return this.parseForStatement(r);case i._function:return!t&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r);case i._class:return t||this.unexpected(),this.parseClass(r,!0);case i._if:return this.parseIfStatement(r);case i._return:return this.parseReturnStatement(r);case i._switch:return this.parseSwitchStatement(r);case i._throw:return this.parseThrowStatement(r);case i._try:return this.parseTryStatement(r);case i._let:case i._const:t||this.unexpected();case i._var:return this.parseVarStatement(r,s);case i._while:return this.parseWhileStatement(r);case i._with:return this.parseWithStatement(r);case i.braceL:return this.parseBlock();case i.semi:return this.parseEmptyStatement(r);case i._export:case i._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===i._import?this.parseImport(r):this.parseExport(r);default:var n=this.value,o=this.parseExpression();return s===i.name&&"Identifier"===o.type&&this.eat(i.colon)?this.parseLabeledStatement(r,n,o):this.parseExpressionStatement(r,o)}},o.parseBreakContinueStatement=function(t,e){var s="break"==e;this.next(),this.eat(i.semi)||this.insertSemicolon()?t.label=null:this.type!==i.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var n=this.labels[r];if(null==t.label||n.name===t.label.name){if(null!=n.kind&&(s||"loop"===n.kind))break;if(t.label&&s)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,s?"BreakStatement":"ContinueStatement")},o.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},o.parseDoStatement=function(t){return this.next(),this.labels.push(a),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(i._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(i.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},o.parseForStatement=function(t){if(this.next(),this.labels.push(a),this.expect(i.parenL),this.type===i.semi)return this.parseFor(t,null);if(this.type===i._var||this.type===i._let||this.type===i._const){var e=this.startNode(),s=this.type;return this.next(),this.parseVar(e,!0,s),this.finishNode(e,"VariableDeclaration"),!(this.type===i._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==e.declarations.length||s!==i._var&&e.declarations[0].init?this.parseFor(t,e):this.parseForIn(t,e)}var r={start:0},n=this.parseExpression(!0,r);return this.type===i._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.toAssignable(n),this.checkLVal(n),this.parseForIn(t,n)):(r.start&&this.unexpected(r.start),this.parseFor(t,n))},o.parseFunctionStatement=function(t){return this.next(),this.parseFunction(t,!0)},o.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!1),t.alternate=this.eat(i._else)?this.parseStatement(!1):null,this.finishNode(t,"IfStatement")},o.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(i.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},o.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(i.braceL),this.labels.push(h);for(var e,s;this.type!=i.braceR;)if(this.type===i._case||this.type===i._default){var r=this.type===i._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(s&&this.raise(this.lastTokStart,"Multiple default clauses"),s=!0,e.test=null),this.expect(i.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(!0));return e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},o.parseThrowStatement=function(t){return this.next(),n.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var p=[];o.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===i._catch){var e=this.startNode();this.next(),this.expect(i.parenL),e.param=this.parseBindingAtom(),this.checkLVal(e.param,!0),this.expect(i.parenR),e.guard=null,e.body=this.parseBlock(),t.handler=this.finishNode(e,"CatchClause")}return t.guardedHandlers=p,t.finalizer=this.eat(i._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},o.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},o.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(a),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},o.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},o.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},o.parseLabeledStatement=function(t,e,s){for(var r=0;r<this.labels.length;++r)this.labels[r].name===e&&this.raise(s.start,"Label '"+e+"' is already declared");var n=this.type.isLoop?"loop":this.type===i._switch?"switch":null;return this.labels.push({name:e,kind:n}),t.body=this.parseStatement(!0),this.labels.pop(),t.label=s,this.finishNode(t,"LabeledStatement")},o.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},o.parseBlock=function(t){var e=this.startNode(),s=!0,r=void 0;for(e.body=[],this.expect(i.braceL);!this.eat(i.braceR);){var n=this.parseStatement(!0);e.body.push(n),s&&t&&this.isUseStrict(n)&&(r=this.strict,this.setStrict(this.strict=!0)),s=!1}return r===!1&&this.setStrict(!1),this.finishNode(e,"BlockStatement")},o.parseFor=function(t,e){return t.init=e,this.expect(i.semi),t.test=this.type===i.semi?null:this.parseExpression(),this.expect(i.semi),t.update=this.type===i.parenR?null:this.parseExpression(),this.expect(i.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},o.parseForIn=function(t,e){var s=this.type===i._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.expect(i.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,s)},o.parseVar=function(t,e,s){for(t.declarations=[],t.kind=s.keyword;;){var r=this.startNode();if(this.parseVarId(r),this.eat(i.eq)?r.init=this.parseMaybeAssign(e):s!==i._const||this.type===i._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"==r.id.type||e&&(this.type===i._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(i.comma))break}return t},o.parseVarId=function(t){t.id=this.parseBindingAtom(),this.checkLVal(t.id,!0)},o.parseFunction=function(t,e,s){return this.initFunction(t),this.options.ecmaVersion>=6&&(t.generator=this.eat(i.star)),(e||this.type===i.name)&&(t.id=this.parseIdent()),this.parseFunctionParams(t),this.parseFunctionBody(t,s),this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},o.parseFunctionParams=function(t){this.expect(i.parenL),t.params=this.parseBindingList(i.parenR,!1,!1)},o.parseClass=function(t,e){this.next(),this.parseClassId(t,e),this.parseClassSuper(t);var s=this.startNode(),r=!1;for(s.body=[],this.expect(i.braceL);!this.eat(i.braceR);)if(!this.eat(i.semi)){var n=this.startNode(),o=this.eat(i.star),a=this.type===i.name&&"static"===this.value;if(this.parsePropertyName(n),n["static"]=a&&this.type!==i.parenL,n["static"]&&(o&&this.unexpected(),o=this.eat(i.star),this.parsePropertyName(n)),n.kind="method",!n.computed){var h=n.key,p=!1;o||"Identifier"!==h.type||this.type===i.parenL||"get"!==h.name&&"set"!==h.name||(p=!0,n.kind=h.name,h=this.parsePropertyName(n)),!n["static"]&&("Identifier"===h.type&&"constructor"===h.name||"Literal"===h.type&&"constructor"===h.value)&&(r&&this.raise(h.start,"Duplicate constructor in the same class"),p&&this.raise(h.start,"Constructor can't have get/set modifier"),o&&this.raise(h.start,"Constructor can't be a generator"),n.kind="constructor",r=!0)}this.parseClassMethod(s,n,o)}return t.body=this.finishNode(s,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},o.parseClassMethod=function(t,e,s){e.value=this.parseMethod(s),t.body.push(this.finishNode(e,"MethodDefinition"))},o.parseClassId=function(t,e){t.id=this.type===i.name?this.parseIdent():e?this.unexpected():null},o.parseClassSuper=function(t){t.superClass=this.eat(i._extends)?this.parseExprSubscripts():null},o.parseExport=function(t){if(this.next(),this.eat(i.star))return this.expectContextual("from"),t.source=this.type===i.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(i._default)){var e=this.parseMaybeAssign(),s=!0;return"FunctionExpression"!=e.type&&"ClassExpression"!=e.type||(s=!1,e.id&&(e.type="FunctionExpression"==e.type?"FunctionDeclaration":"ClassDeclaration")),t.declaration=e,s&&this.semicolon(),this.finishNode(t,"ExportDefaultDeclaration")}return this.shouldParseExportStatement()?(t.declaration=this.parseStatement(!0),t.specifiers=[],t.source=null):(t.declaration=null,t.specifiers=this.parseExportSpecifiers(),this.eatContextual("from")?t.source=this.type===i.string?this.parseExprAtom():this.unexpected():t.source=null,this.semicolon()),this.finishNode(t,"ExportNamedDeclaration")},o.shouldParseExportStatement=function(){return this.type.keyword},o.parseExportSpecifiers=function(){var t=[],e=!0;for(this.expect(i.braceL);!this.eat(i.braceR);){if(e)e=!1;else if(this.expect(i.comma),this.afterTrailingComma(i.braceR))break;var s=this.startNode();s.local=this.parseIdent(this.type===i._default),s.exported=this.eatContextual("as")?this.parseIdent(!0):s.local,t.push(this.finishNode(s,"ExportSpecifier"))}return t},o.parseImport=function(t){return this.next(),this.type===i.string?(t.specifiers=p,t.source=this.parseExprAtom(),t.kind=""):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===i.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},o.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===i.name){var s=this.startNode();if(s.local=this.parseIdent(),this.checkLVal(s.local,!0),t.push(this.finishNode(s,"ImportDefaultSpecifier")),!this.eat(i.comma))return t}if(this.type===i.star){var s=this.startNode();return this.next(),this.expectContextual("as"),s.local=this.parseIdent(),this.checkLVal(s.local,!0),t.push(this.finishNode(s,"ImportNamespaceSpecifier")),t}for(this.expect(i.braceL);!this.eat(i.braceR);){if(e)e=!1;else if(this.expect(i.comma),this.afterTrailingComma(i.braceR))break;var s=this.startNode();s.imported=this.parseIdent(!0),s.local=this.eatContextual("as")?this.parseIdent():s.imported,this.checkLVal(s.local,!0),t.push(this.finishNode(s,"ImportSpecifier"))}return t}},{"./state":13,"./tokentype":17,"./whitespace":19}],15:[function(t,e,s){"use strict";var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};s.__esModule=!0;var r=t("./state").Parser,n=t("./tokentype").types,o=t("./whitespace").lineBreak,a=s.TokContext=function c(t,e,s,r){i(this,c),this.token=t,this.isExpr=e,this.preserveSpace=s,this.override=r},h={b_stat:new a("{",!1),b_expr:new a("{",!0),b_tmpl:new a("${",!0),p_stat:new a("(",!1),p_expr:new a("(",!0),q_tmpl:new a("`",!0,!0,function(t){return t.readTmplToken()}),f_expr:new a("function",!0)};s.types=h;var p=r.prototype;p.initialContext=function(){return[h.b_stat]},p.braceIsBlock=function(t){var e=void 0;return t===n.colon&&"{"==(e=this.curContext()).token?!e.isExpr:t===n._return?o.test(this.input.slice(this.lastTokEnd,this.start)):t===n._else||t===n.semi||t===n.eof?!0:t==n.braceL?this.curContext()===h.b_stat:!this.exprAllowed},p.updateContext=function(t){var e=void 0,s=this.type;s.keyword&&t==n.dot?this.exprAllowed=!1:(e=s.updateContext)?e.call(this,t):this.exprAllowed=s.beforeExpr},n.parenR.updateContext=n.braceR.updateContext=function(){if(1==this.context.length)return void(this.exprAllowed=!0);var t=this.context.pop();t===h.b_stat&&this.curContext()===h.f_expr?(this.context.pop(),this.exprAllowed=!1):t===h.b_tmpl?this.exprAllowed=!0:this.exprAllowed=!t.isExpr},n.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?h.b_stat:h.b_expr),this.exprAllowed=!0},n.dollarBraceL.updateContext=function(){this.context.push(h.b_tmpl),this.exprAllowed=!0},n.parenL.updateContext=function(t){var e=t===n._if||t===n._for||t===n._with||t===n._while;this.context.push(e?h.p_stat:h.p_expr),this.exprAllowed=!0},n.incDec.updateContext=function(){},n._function.updateContext=function(){this.curContext()!==h.b_stat&&this.context.push(h.f_expr),this.exprAllowed=!1},n.backQuote.updateContext=function(){this.curContext()===h.q_tmpl?this.context.pop():this.context.push(h.q_tmpl),this.exprAllowed=!1}},{"./state":13,"./tokentype":17,"./whitespace":19}],16:[function(t,e,s){"use strict";function i(t){return 65535>=t?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};s.__esModule=!0;var n=t("./identifier"),o=n.isIdentifierStart,a=n.isIdentifierChar,h=t("./tokentype"),p=h.types,c=h.keywords,u=t("./state").Parser,l=t("./location").SourceLocation,f=t("./whitespace"),d=f.lineBreak,m=f.lineBreakG,x=f.isNewLine,y=f.nonASCIIwhitespace,v=s.Token=function S(t){r(this,S),this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new l(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},g=u.prototype,b="undefined"!=typeof Packages;g.next=function(){this.options.onToken&&this.options.onToken(new v(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},g.getToken=function(){return this.next(),new v(this)},"undefined"!=typeof Symbol&&(g[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===p.eof,value:e}}}}),g.setStrict=function(t){if(this.strict=t,this.type===p.num||this.type===p.string){if(this.pos=this.start,this.options.locations)for(;this.pos<this.lineStart;)this.lineStart=this.input.lastIndexOf("\n",this.lineStart-2)+1,--this.curLine;this.nextToken()}},g.curContext=function(){return this.context[this.context.length-1]},g.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(p.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},g.readToken=function(t){return o(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},g.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(55295>=t||t>=57344)return t;var e=this.input.charCodeAt(this.pos+1);return(t<<10)+e-56613888},g.skipBlockComment=function(){var t=this.options.onComment&&this.options.locations&&this.curPosition(),e=this.pos,s=this.input.indexOf("*/",this.pos+=2);if(-1===s&&this.raise(this.pos-2,"Unterminated comment"),this.pos=s+2,this.options.locations){m.lastIndex=e;for(var i=void 0;(i=m.exec(this.input))&&i.index<this.pos;)++this.curLine,this.lineStart=i.index+i[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,s),e,this.pos,t,this.options.locations&&this.curPosition())},g.skipLineComment=function(t){for(var e=this.pos,s=this.options.onComment&&this.options.locations&&this.curPosition(),i=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==i&&13!==i&&8232!==i&&8233!==i;)++this.pos,i=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,s,this.options.locations&&this.curPosition())},g.skipSpace=function(){for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);if(32===t)++this.pos;else if(13===t){++this.pos;var e=this.input.charCodeAt(this.pos);10===e&&++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos)}else if(10===t||8232===t||8233===t)++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);else if(t>8&&14>t)++this.pos;else if(47===t){var e=this.input.charCodeAt(this.pos+1);if(42===e)this.skipBlockComment();else{if(47!==e)break;this.skipLineComment(2)}}else if(160===t)++this.pos;else{if(!(t>=5760&&y.test(String.fromCharCode(t))))break;++this.pos}}},g.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var s=this.type;this.type=t,this.value=e,this.updateContext(s)},g.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&57>=t)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(p.ellipsis)):(++this.pos,this.finishToken(p.dot))},g.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(p.assign,2):this.finishOp(p.slash,1)},g.readToken_mult_modulo=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(p.assign,2):this.finishOp(42===t?p.star:p.modulo,1)},g.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?p.logicalOR:p.logicalAND,2):61===e?this.finishOp(p.assign,2):this.finishOp(124===t?p.bitwiseOR:p.bitwiseAND,1)},g.readToken_caret=function(){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(p.assign,2):this.finishOp(p.bitwiseXOR,1)},g.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45==e&&62==this.input.charCodeAt(this.pos+2)&&d.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(p.incDec,2):61===e?this.finishOp(p.assign,2):this.finishOp(p.plusMin,1)},g.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),s=1;return e===t?(s=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+s)?this.finishOp(p.assign,s+1):this.finishOp(p.bitShift,s)):33==e&&60==t&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===e&&(s=61===this.input.charCodeAt(this.pos+2)?3:2),this.finishOp(p.relational,s))},g.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(p.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(p.arrow)):this.finishOp(61===t?p.eq:p.prefix,1)},g.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(p.parenL);case 41:return++this.pos,this.finishToken(p.parenR);case 59:return++this.pos,this.finishToken(p.semi);case 44:return++this.pos,this.finishToken(p.comma);case 91:return++this.pos,this.finishToken(p.bracketL);case 93:return++this.pos,this.finishToken(p.bracketR);case 123:return++this.pos,this.finishToken(p.braceL);case 125:return++this.pos,this.finishToken(p.braceR);case 58:return++this.pos,this.finishToken(p.colon);case 63:return++this.pos,this.finishToken(p.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(p.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(p.prefix,1)}this.raise(this.pos,"Unexpected character '"+i(t)+"'")},g.finishOp=function(t,e){var s=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,s)};var k=!1;try{new RegExp("￿","u"),k=!0}catch(w){}g.readRegexp=function(){for(var t=void 0,e=void 0,s=this.pos;;){this.pos>=this.input.length&&this.raise(s,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(d.test(i)&&this.raise(s,"Unterminated regular expression"),t)t=!1;else{if("["===i)e=!0;else if("]"===i&&e)e=!1;else if("/"===i&&!e)break;t="\\"===i}++this.pos}var r=this.input.slice(s,this.pos);++this.pos;var n=this.readWord1(),o=r;if(n){var a=/^[gmsiy]*$/;this.options.ecmaVersion>=6&&(a=/^[gmsiyu]*$/),a.test(n)||this.raise(s,"Invalid regular expression flag"),n.indexOf("u")>=0&&!k&&(o=o.replace(/\\u([a-fA-F0-9]{4})|\\u\{([0-9a-fA-F]+)\}|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"))}var h=null;if(!b){try{new RegExp(o)}catch(c){c instanceof SyntaxError&&this.raise(s,"Error parsing regular expression: "+c.message),this.raise(c)}try{h=new RegExp(r,n)}catch(u){}}return this.finishToken(p.regexp,{pattern:r,flags:n,value:h})},g.readInt=function(t,e){for(var s=this.pos,i=0,r=0,n=null==e?1/0:e;n>r;++r){var o=this.input.charCodeAt(this.pos),a=void 0;if(a=o>=97?o-97+10:o>=65?o-65+10:o>=48&&57>=o?o-48:1/0,a>=t)break;++this.pos,i=i*t+a}return this.pos===s||null!=e&&this.pos-s!==e?null:i},g.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),o(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(p.num,e)},g.readNumber=function(t){var e=this.pos,s=!1,i=48===this.input.charCodeAt(this.pos);t||null!==this.readInt(10)||this.raise(e,"Invalid number"),46===this.input.charCodeAt(this.pos)&&(++this.pos,this.readInt(10),s=!0);var r=this.input.charCodeAt(this.pos);69!==r&&101!==r||(r=this.input.charCodeAt(++this.pos),43!==r&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),s=!0),o(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var n=this.input.slice(e,this.pos),a=void 0;return s?a=parseFloat(n):i&&1!==n.length?/[89]/.test(n)||this.strict?this.raise(e,"Invalid number"):a=parseInt(n,8):a=parseInt(n,10),this.finishToken(p.num,a)},g.readCodePoint=function(){var t=this.input.charCodeAt(this.pos),e=void 0;return 123===t?(this.options.ecmaVersion<6&&this.unexpected(),++this.pos,e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.unexpected()):e=this.readHexChar(4),e},g.readString=function(t){for(var e="",s=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(e+=this.input.slice(s,this.pos),e+=this.readEscapedChar(),s=this.pos):(x(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(s,this.pos++),this.finishToken(p.string,e)},g.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var s=this.input.charCodeAt(this.pos);if(96===s||36===s&&123===this.input.charCodeAt(this.pos+1))return this.pos===this.start&&this.type===p.template?36===s?(this.pos+=2,this.finishToken(p.dollarBraceL)):(++this.pos,this.finishToken(p.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(p.template,t));92===s?(t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(),e=this.pos):x(s)?(t+=this.input.slice(e,this.pos),++this.pos,13===s&&10===this.input.charCodeAt(this.pos)?(++this.pos,t+="\n"):t+=String.fromCharCode(s),this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos):++this.pos}},g.readEscapedChar=function(){var t=this.input.charCodeAt(++this.pos),e=/^[0-7]+/.exec(this.input.slice(this.pos,this.pos+3));for(e&&(e=e[0]);e&&parseInt(e,8)>255;)e=e.slice(0,-1);if("0"===e&&(e=null),++this.pos,e)return this.strict&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=e.length-1,String.fromCharCode(parseInt(e,8));switch(t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return i(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\x0B";case 102:return"\f";case 48:return"\x00";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:return String.fromCharCode(t)}},g.readHexChar=function(t){var e=this.readInt(16,t);return null===e&&this.raise(this.start,"Bad character escape sequence"),e};var E;g.readWord1=function(){E=!1;for(var t="",e=!0,s=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var n=this.fullCharCodeAtPos();if(a(n,r))this.pos+=65535>=n?1:2;else{if(92!==n)break;E=!0,t+=this.input.slice(s,this.pos);var h=this.pos;117!=this.input.charCodeAt(++this.pos)&&this.raise(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var p=this.readCodePoint();(e?o:a)(p,r)||this.raise(h,"Invalid Unicode escape"),t+=i(p),s=this.pos}e=!1}return t+this.input.slice(s,this.pos)},g.readWord=function(){var t=this.readWord1(),e=p.name;return(this.options.ecmaVersion>=6||!E)&&this.isKeyword(t)&&(e=c[t]),this.finishToken(e,t)}},{"./identifier":7,"./location":8,"./state":13,"./tokentype":17,"./whitespace":19}],17:[function(t,e,s){"use strict";function i(t,e){return new o(t,{beforeExpr:!0,binop:e})}function r(t){var e=void 0===arguments[1]?{}:arguments[1];e.keyword=t,c[t]=p["_"+t]=new o(t,e)}var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};s.__esModule=!0;var o=s.TokenType=function u(t){var e=void 0===arguments[1]?{}:arguments[1];n(this,u),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null},a={beforeExpr:!0},h={startsExpr:!0},p={num:new o("num",h),regexp:new o("regexp",h),string:new o("string",h),name:new o("name",h),eof:new o("eof"),bracketL:new o("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new o("]"),braceL:new o("{",{beforeExpr:!0,startsExpr:!0}),braceR:new o("}"),parenL:new o("(",{beforeExpr:!0,
startsExpr:!0}),parenR:new o(")"),comma:new o(",",a),semi:new o(";",a),colon:new o(":",a),dot:new o("."),question:new o("?",a),arrow:new o("=>",a),template:new o("template"),ellipsis:new o("...",a),backQuote:new o("`",h),dollarBraceL:new o("${",{beforeExpr:!0,startsExpr:!0}),eq:new o("=",{beforeExpr:!0,isAssign:!0}),assign:new o("_=",{beforeExpr:!0,isAssign:!0}),incDec:new o("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new o("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:i("||",1),logicalAND:i("&&",2),bitwiseOR:i("|",3),bitwiseXOR:i("^",4),bitwiseAND:i("&",5),equality:i("==/!=",6),relational:i("</>",7),bitShift:i("<</>>",8),plusMin:new o("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:i("%",10),star:i("*",10),slash:i("/",10)};s.types=p;var c={};s.keywords=c,r("break"),r("case",a),r("catch"),r("continue"),r("debugger"),r("default"),r("do",{isLoop:!0}),r("else",a),r("finally"),r("for",{isLoop:!0}),r("function",h),r("if"),r("return",a),r("switch"),r("throw",a),r("try"),r("var"),r("let"),r("const"),r("while",{isLoop:!0}),r("with"),r("new",{beforeExpr:!0,startsExpr:!0}),r("this",h),r("super",h),r("class"),r("extends",a),r("export"),r("import"),r("yield",{beforeExpr:!0,startsExpr:!0}),r("null",h),r("true",h),r("false",h),r("in",{beforeExpr:!0,binop:7}),r("instanceof",{beforeExpr:!0,binop:7}),r("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),r("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),r("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},{}],18:[function(t,e,s){"use strict";function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}s.isArray=i,s.has=r,s.__esModule=!0},{}],19:[function(t,e,s){"use strict";function i(t){return 10===t||13===t||8232===t||8233==t}s.isNewLine=i,s.__esModule=!0;var r=/\r\n?|\n|\u2028|\u2029/;s.lineBreak=r;var n=new RegExp(r.source,"g");s.lineBreakG=n;var o=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;s.nonASCIIwhitespace=o},{}]},{},[1])(1)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],205:[function(require,module,exports){
module.exports=function(){for(var o=0;o<arguments.length;o++)if(void 0!==arguments[o])return arguments[o]};
},{}],206:[function(require,module,exports){
(function (global){
!function(){"use strict";function e(e){return P.Expression.hasOwnProperty(e.type)}function t(e){return P.Statement.hasOwnProperty(e.type)}function n(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:"\n",space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function r(e,t){var n="";for(t|=0;t>0;t>>>=1,e+=e)1&t&&(n+=e);return n}function i(e){return/[\r\n]/g.test(e)}function s(e){var t=e.length;return t&&z.code.isLineTerminator(e.charCodeAt(t-1))}function o(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e,t){function n(e){return"object"==typeof e&&e instanceof Object&&!(e instanceof RegExp)}var r,i;for(r in t)t.hasOwnProperty(r)&&(i=t[r],n(i)?n(e[r])?a(e[r],i):e[r]=a({},i):e[r]=i);return e}function u(e){var t,n,r,i,s;if(e!==e)throw new Error("Numeric literal whose value is NaN");if(0>e||0===e&&0>1/e)throw new Error("Numeric literal whose value is negative");if(e===1/0)return G?"null":H?"1e400":"1e+400";if(t=""+e,!H||t.length<3)return t;for(n=t.indexOf("."),G||48!==t.charCodeAt(0)||1!==n||(n=0,t=t.slice(1)),r=t,t=t.replace("e+","e"),i=0,(s=r.indexOf("e"))>0&&(i=+r.slice(s+1),r=r.slice(0,s)),n>=0&&(i-=r.length-n-1,r=+(r.slice(0,n)+r.slice(n+1))+""),s=0;48===r.charCodeAt(r.length+s-1);)--s;return 0!==s&&(i-=s,r=r.slice(0,s)),0!==i&&(r+="e"+i),(r.length<t.length||Y&&e>1e12&&Math.floor(e)===e&&(r="0x"+e.toString(16)).length<t.length)&&+r===e&&(t=r),t}function p(e,t){return 8232===(-2&e)?(t?"u":"\\u")+(8232===e?"2028":"2029"):10===e||13===e?(t?"":"\\")+(10===e?"n":"r"):String.fromCharCode(e)}function c(e){var t,n,r,i,s,o,a,u;if(n=e.toString(),e.source){if(t=n.match(/\/([^/]*)$/),!t)return n;for(r=t[1],n="",a=!1,u=!1,i=0,s=e.source.length;s>i;++i)o=e.source.charCodeAt(i),u?(n+=p(o,u),u=!1):(a?93===o&&(a=!1):47===o?n+="\\":91===o&&(a=!0),n+=p(o,u),u=92===o);return"/"+n+"/"+r}return n}function h(e,t){var n;return 8===e?"\\b":12===e?"\\f":9===e?"\\t":(n=e.toString(16).toUpperCase(),G||e>255?"\\u"+"0000".slice(n.length)+n:0!==e||z.code.isDecimalDigit(t)?11===e?"\\x0B":"\\x"+"00".slice(n.length)+n:"\\0")}function l(e){if(92===e)return"\\\\";if(10===e)return"\\n";if(13===e)return"\\r";if(8232===e)return"\\u2028";if(8233===e)return"\\u2029";throw new Error("Incorrectly classified character")}function g(e){var t,n,r,i;for(i="double"===X?'"':"'",t=0,n=e.length;n>t;++t){if(r=e.charCodeAt(t),39===r){i='"';break}if(34===r){i="'";break}92===r&&++t}return i+e+i}function f(e){var t,n,r,i,s,o="",a=0,u=0;for(t=0,n=e.length;n>t;++t){if(r=e.charCodeAt(t),39===r)++a;else if(34===r)++u;else if(47===r&&G)o+="\\";else{if(z.code.isLineTerminator(r)||92===r){o+=l(r);continue}if(!z.code.isIdentifierPartES5(r)&&(G&&32>r||!G&&!$&&(32>r||r>126))){o+=h(r,e.charCodeAt(t+1));continue}}o+=String.fromCharCode(r)}if(i=!("double"===X||"auto"===X&&a>u),s=i?"'":'"',!(i?a:u))return s+o+s;for(e=o,o=s,t=0,n=e.length;n>t;++t)r=e.charCodeAt(t),(39===r&&i||34===r&&!i)&&(o+="\\"),o+=String.fromCharCode(r);return o+s}function m(e){var t,n,r,i="";for(t=0,n=e.length;n>t;++t)r=e[t],i+=U(r)?m(r):r;return i}function d(e,t){if(!ie)return U(e)?m(e):e;if(null==t){if(e instanceof W)return e;t={}}return null==t.loc?new W(null,null,ie,e,t.name||null):new W(t.loc.start.line,t.loc.start.column,ie===!0?t.loc.source||null:ie,e,t.name||null)}function y(){return J?J:" "}function S(e,t){var n,r,i,s;return n=d(e).toString(),0===n.length?[t]:(r=d(t).toString(),0===r.length?[e]:(i=n.charCodeAt(n.length-1),s=r.charCodeAt(0),(43===i||45===i)&&i===s||z.code.isIdentifierPartES5(i)&&z.code.isIdentifierPartES5(s)||47===i&&105===s?[e,y(),t]:z.code.isWhiteSpace(i)||z.code.isLineTerminator(i)||z.code.isWhiteSpace(s)||z.code.isLineTerminator(s)?[e,t]:[e,J,t]))}function x(e){return[K,e]}function b(e){var t;t=K,K+=V,e(K),K=t}function E(e){var t;for(t=e.length-1;t>=0&&!z.code.isLineTerminator(e.charCodeAt(t));--t);return e.length-1-t}function v(e,t){var n,r,i,s,o,a,u,p;for(n=e.split(/\r\n|[\r\n]/),a=Number.MAX_VALUE,r=1,i=n.length;i>r;++r){for(s=n[r],o=0;o<s.length&&z.code.isWhiteSpace(s.charCodeAt(o));)++o;a>o&&(a=o)}for("undefined"!=typeof t?(u=K,"*"===n[1][a]&&(t+=" "),K=t):(1&a&&--a,u=K),r=1,i=n.length;i>r;++r)p=d(x(n[r].slice(a))),n[r]=ie?p.join(""):p;return K=u,n.join("\n")}function C(e,t){if("Line"===e.type){if(s(e.value))return"//"+e.value;var n="//"+e.value;return oe||(n+="\n"),n}return ne.format.indent.adjustMultilineComment&&/[\n\r]/.test(e.value)?v("/*"+e.value+"*/",t):"/*"+e.value+"*/"}function A(e,t){var n,i,o,a,u,p,c,h,l,g,f,m,y,S;if(e.leadingComments&&e.leadingComments.length>0){if(a=t,oe){for(o=e.leadingComments[0],t=[],h=o.extendedRange,l=o.range,f=se.substring(h[0],l[0]),S=(f.match(/\n/g)||[]).length,S>0?(t.push(r("\n",S)),t.push(x(C(o)))):(t.push(f),t.push(C(o))),g=l,n=1,i=e.leadingComments.length;i>n;n++)o=e.leadingComments[n],l=o.range,m=se.substring(g[1],l[0]),S=(m.match(/\n/g)||[]).length,t.push(r("\n",S)),t.push(x(C(o))),g=l;y=se.substring(l[1],h[1]),S=(y.match(/\n/g)||[]).length,t.push(r("\n",S))}else for(o=e.leadingComments[0],t=[],ee&&e.type===T.Program&&0===e.body.length&&t.push("\n"),t.push(C(o)),s(d(t).toString())||t.push("\n"),n=1,i=e.leadingComments.length;i>n;++n)o=e.leadingComments[n],c=[C(o)],s(d(c).toString())||c.push("\n"),t.push(x(c));t.push(x(a))}if(e.trailingComments)if(oe)o=e.trailingComments[0],h=o.extendedRange,l=o.range,f=se.substring(h[0],l[0]),S=(f.match(/\n/g)||[]).length,S>0?(t.push(r("\n",S)),t.push(x(C(o)))):(t.push(f),t.push(C(o)));else for(u=!s(d(t).toString()),p=r(" ",E(d([K,t,V]).toString())),n=0,i=e.trailingComments.length;i>n;++n)o=e.trailingComments[n],u?(t=0===n?[t,V]:[t,p],t.push(C(o,p))):t=[t,x(C(o))],n===i-1||s(d(t).toString())||(t=[t,"\n"]);return t}function q(e,t,n){var r,i=0;for(r=e;t>r;r++)"\n"===se[r]&&i++;for(r=1;i>r;r++)n.push(_)}function w(e,t,n){return n>t?["(",e,")"]:e}function k(e){var t,n,r;for(r=e.split(/\r\n|\n/),t=1,n=r.length;n>t;t++)r[t]=_+K+r[t];return r}function B(e,t){var n,r,i;return n=e[ne.verbatim],"string"==typeof n?r=w(k(n),O.Sequence,t):(r=k(n.content),i=null!=n.precedence?n.precedence:O.Sequence,r=w(r,i,t)),d(r,e)}function P(){}function F(e){return d(e.name,e)}function I(e,t){return e.async?"async"+(t?y():J):""}function M(e){var t=e.generator&&!ne.moz.starlessGenerator;return t?"*"+J:""}function D(e){var t=e.value;return t.async?I(t,!e.computed):M(t)?"*":""}function L(n){var r;if(r=new P,t(n))return r.generateStatement(n,Ee);if(e(n))return r.generateExpression(n,O.Sequence,ye);throw new Error("Unknown node type: "+n.type)}function R(e,t){var i,s,o=n();return null!=t?("string"==typeof t.indent&&(o.format.indent.style=t.indent),"number"==typeof t.base&&(o.format.indent.base=t.base),t=a(o,t),V=t.format.indent.style,K="string"==typeof t.base?t.base:r(V,t.format.indent.base)):(t=o,V=t.format.indent.style,K=r(V,t.format.indent.base)),G=t.format.json,H=t.format.renumber,Y=G?!1:t.format.hexadecimal,X=G?"double":t.format.quotes,$=t.format.escapeless,_=t.format.newline,J=t.format.space,t.format.compact&&(_=J=V=K=""),Q=t.format.parentheses,Z=t.format.semicolons,ee=t.format.safeConcatenation,te=t.directive,re=G?null:t.parse,ie=t.sourceMap,se=t.sourceCode,oe=t.format.preserveBlankLines&&null!==se,ne=t,ie&&(W=exports.browser?global.sourceMap.SourceNode:require("source-map").SourceNode),i=L(e),ie?(s=i.toStringWithSourceMap({file:t.file,sourceRoot:t.sourceMapRoot}),t.sourceContent&&s.map.setSourceContent(t.sourceMap,t.sourceContent),t.sourceMapWithCode?s:s.map.toString()):(s={code:i.toString(),map:null},t.sourceMapWithCode?s:s.code)}var T,O,N,W,j,z,U,K,V,G,H,Y,X,$,_,J,Q,Z,ee,te,ne,re,ie,se,oe,ae,ue;j=require("estraverse"),z=require("esutils"),T=j.Syntax,O={Sequence:0,Yield:1,Await:1,Assignment:1,Conditional:2,ArrowFunction:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Unary:13,Postfix:14,Call:15,New:16,TaggedTemplate:17,Member:18,Primary:19},N={"||":O.LogicalOR,"&&":O.LogicalAND,"|":O.BitwiseOR,"^":O.BitwiseXOR,"&":O.BitwiseAND,"==":O.Equality,"!=":O.Equality,"===":O.Equality,"!==":O.Equality,is:O.Equality,isnt:O.Equality,"<":O.Relational,">":O.Relational,"<=":O.Relational,">=":O.Relational,"in":O.Relational,"instanceof":O.Relational,"<<":O.BitwiseSHIFT,">>":O.BitwiseSHIFT,">>>":O.BitwiseSHIFT,"+":O.Additive,"-":O.Additive,"*":O.Multiplicative,"%":O.Multiplicative,"/":O.Multiplicative};var pe=1,ce=2,he=4,le=8,ge=16,fe=32,me=ce|he,de=pe|ce,ye=pe|ce|he,Se=pe,xe=he,be=pe|he,Ee=pe,ve=pe|fe,Ce=0,Ae=pe|ge,qe=pe|le;U=Array.isArray,U||(U=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),P.prototype.maybeBlock=function(e,t){var n,r,i=this;return r=!ne.comment||!e.leadingComments,e.type===T.BlockStatement&&r?[J,this.generateStatement(e,t)]:e.type===T.EmptyStatement&&r?";":(b(function(){n=[_,x(i.generateStatement(e,t))]}),n)},P.prototype.maybeBlockSuffix=function(e,t){var n=s(d(t).toString());return e.type!==T.BlockStatement||ne.comment&&e.leadingComments||n?n?[t,K]:[t,_,K]:[t,J]},P.prototype.generatePattern=function(e,t,n){return e.type===T.Identifier?F(e):this.generateExpression(e,t,n)},P.prototype.generateFunctionParams=function(e){var t,n,r,i;if(i=!1,e.type!==T.ArrowFunctionExpression||e.rest||e.defaults&&0!==e.defaults.length||1!==e.params.length||e.params[0].type!==T.Identifier){for(r=e.type===T.ArrowFunctionExpression?[I(e,!1)]:[],r.push("("),e.defaults&&(i=!0),t=0,n=e.params.length;n>t;++t)i&&e.defaults[t]?r.push(this.generateAssignment(e.params[t],e.defaults[t],"=",O.Assignment,ye)):r.push(this.generatePattern(e.params[t],O.Assignment,ye)),n>t+1&&r.push(","+J);e.rest&&(e.params.length&&r.push(","+J),r.push("..."),r.push(F(e.rest))),r.push(")")}else r=[I(e,!0),F(e.params[0])];return r},P.prototype.generateFunctionBody=function(e){var t,n;return t=this.generateFunctionParams(e),e.type===T.ArrowFunctionExpression&&(t.push(J),t.push("=>")),e.expression?(t.push(J),n=this.generateExpression(e.body,O.Assignment,ye),"{"===n.toString().charAt(0)&&(n=["(",n,")"]),t.push(n)):t.push(this.maybeBlock(e.body,qe)),t},P.prototype.generateIterationForStatement=function(e,t,n){var r=["for"+J+"("],i=this;return b(function(){t.left.type===T.VariableDeclaration?b(function(){r.push(t.left.kind+y()),r.push(i.generateStatement(t.left.declarations[0],Ce))}):r.push(i.generateExpression(t.left,O.Call,ye)),r=S(r,e),r=[S(r,i.generateExpression(t.right,O.Sequence,ye)),")"]}),r.push(this.maybeBlock(t.body,n)),r},P.prototype.generatePropertyKey=function(e,t){var n=[];return t&&n.push("["),n.push(this.generateExpression(e,O.Sequence,ye)),t&&n.push("]"),n},P.prototype.generateAssignment=function(e,t,n,r,i){return O.Assignment<r&&(i|=pe),w([this.generateExpression(e,O.Call,i),J+n+J,this.generateExpression(t,O.Assignment,i)],O.Assignment,r)},P.prototype.semicolon=function(e){return!Z&&e&fe?"":";"},P.Statement={BlockStatement:function(e,t){var n,r,i=["{",_],o=this;return b(function(){0===e.body.length&&oe&&(n=e.range,n[1]-n[0]>2&&(r=se.substring(n[0]+1,n[1]-1),"\n"===r[0]&&(i=["{"]),i.push(r)));var a,u,p,c;for(c=Ee,t&le&&(c|=ge),a=0,u=e.body.length;u>a;++a)oe&&(0===a&&(e.body[0].leadingComments&&(n=e.body[0].leadingComments[0].extendedRange,r=se.substring(n[0],n[1]),"\n"===r[0]&&(i=["{"])),e.body[0].leadingComments||q(e.range[0],e.body[0].range[0],i)),a>0&&(e.body[a-1].trailingComments||e.body[a].leadingComments||q(e.body[a-1].range[1],e.body[a].range[0],i))),a===u-1&&(c|=fe),p=e.body[a].leadingComments&&oe?o.generateStatement(e.body[a],c):x(o.generateStatement(e.body[a],c)),i.push(p),s(d(p).toString())||(oe&&u-1>a?e.body[a+1].leadingComments||i.push(_):i.push(_)),oe&&a===u-1&&(e.body[a].trailingComments||q(e.body[a].range[1],e.range[1],i))}),i.push(x("}")),i},BreakStatement:function(e,t){return e.label?"break "+e.label.name+this.semicolon(t):"break"+this.semicolon(t)},ContinueStatement:function(e,t){return e.label?"continue "+e.label.name+this.semicolon(t):"continue"+this.semicolon(t)},ClassBody:function(e,t){var n=["{",_],r=this;return b(function(t){var i,s;for(i=0,s=e.body.length;s>i;++i)n.push(t),n.push(r.generateExpression(e.body[i],O.Sequence,ye)),s>i+1&&n.push(_)}),s(d(n).toString())||n.push(_),n.push(K),n.push("}"),n},ClassDeclaration:function(e,t){var n,r;return n=["class "+e.id.name],e.superClass&&(r=S("extends",this.generateExpression(e.superClass,O.Assignment,ye)),n=S(n,r)),n.push(J),n.push(this.generateStatement(e.body,ve)),n},DirectiveStatement:function(e,t){return ne.raw&&e.raw?e.raw+this.semicolon(t):g(e.directive)+this.semicolon(t)},DoWhileStatement:function(e,t){var n=S("do",this.maybeBlock(e.body,Ee));return n=this.maybeBlockSuffix(e.body,n),S(n,["while"+J+"(",this.generateExpression(e.test,O.Sequence,ye),")"+this.semicolon(t)])},CatchClause:function(e,t){var n,r=this;return b(function(){var t;n=["catch"+J+"(",r.generateExpression(e.param,O.Sequence,ye),")"],e.guard&&(t=r.generateExpression(e.guard,O.Sequence,ye),n.splice(2,0," if ",t))}),n.push(this.maybeBlock(e.body,Ee)),n},DebuggerStatement:function(e,t){return"debugger"+this.semicolon(t)},EmptyStatement:function(e,t){return";"},ExportDefaultDeclaration:function(e,n){var r,i=["export"];return r=n&fe?ve:Ee,i=S(i,"default"),i=t(e.declaration)?S(i,this.generateStatement(e.declaration,r)):S(i,this.generateExpression(e.declaration,O.Assignment,ye)+this.semicolon(n))},ExportNamedDeclaration:function(e,t){var n,r=["export"],i=this;return n=t&fe?ve:Ee,e.declaration?S(r,this.generateStatement(e.declaration,n)):(e.specifiers&&(0===e.specifiers.length?r=S(r,"{"+J+"}"):e.specifiers[0].type===T.ExportBatchSpecifier?r=S(r,this.generateExpression(e.specifiers[0],O.Sequence,ye)):(r=S(r,"{"),b(function(t){var n,s;for(r.push(_),n=0,s=e.specifiers.length;s>n;++n)r.push(t),r.push(i.generateExpression(e.specifiers[n],O.Sequence,ye)),s>n+1&&r.push(","+_)}),s(d(r).toString())||r.push(_),r.push(K+"}")),e.source?r=S(r,["from"+J,this.generateExpression(e.source,O.Sequence,ye),this.semicolon(t)]):r.push(this.semicolon(t))),r)},ExportAllDeclaration:function(e,t){return["export"+J,"*"+J,"from"+J,this.generateExpression(e.source,O.Sequence,ye),this.semicolon(t)]},ExpressionStatement:function(e,t){function n(e){var t;return"class"!==e.slice(0,5)?!1:(t=e.charCodeAt(5),123===t||z.code.isWhiteSpace(t)||z.code.isLineTerminator(t))}function r(e){var t;return"function"!==e.slice(0,8)?!1:(t=e.charCodeAt(8),40===t||z.code.isWhiteSpace(t)||42===t||z.code.isLineTerminator(t))}function i(e){var t,n,r;if("async"!==e.slice(0,5))return!1;if(!z.code.isWhiteSpace(e.charCodeAt(5)))return!1;for(n=6,r=e.length;r>n&&z.code.isWhiteSpace(e.charCodeAt(n));++n);return n===r?!1:"function"!==e.slice(n,n+8)?!1:(t=e.charCodeAt(n+8),40===t||z.code.isWhiteSpace(t)||42===t||z.code.isLineTerminator(t))}var s,o;return s=[this.generateExpression(e.expression,O.Sequence,ye)],o=d(s).toString(),123===o.charCodeAt(0)||n(o)||r(o)||i(o)||te&&t&ge&&e.expression.type===T.Literal&&"string"==typeof e.expression.value?s=["(",s,")"+this.semicolon(t)]:s.push(this.semicolon(t)),s},ImportDeclaration:function(e,t){var n,r,i=this;return 0===e.specifiers.length?["import",J,this.generateExpression(e.source,O.Sequence,ye),this.semicolon(t)]:(n=["import"],r=0,e.specifiers[r].type===T.ImportDefaultSpecifier&&(n=S(n,[this.generateExpression(e.specifiers[r],O.Sequence,ye)]),++r),e.specifiers[r]&&(0!==r&&n.push(","),e.specifiers[r].type===T.ImportNamespaceSpecifier?n=S(n,[J,this.generateExpression(e.specifiers[r],O.Sequence,ye)]):(n.push(J+"{"),e.specifiers.length-r===1?(n.push(J),n.push(this.generateExpression(e.specifiers[r],O.Sequence,ye)),n.push(J+"}"+J)):(b(function(t){var s,o;for(n.push(_),s=r,o=e.specifiers.length;o>s;++s)n.push(t),n.push(i.generateExpression(e.specifiers[s],O.Sequence,ye)),o>s+1&&n.push(","+_)}),s(d(n).toString())||n.push(_),n.push(K+"}"+J)))),n=S(n,["from"+J,this.generateExpression(e.source,O.Sequence,ye),this.semicolon(t)]))},VariableDeclarator:function(e,t){var n=t&pe?ye:me;return e.init?[this.generateExpression(e.id,O.Assignment,n),J,"=",J,this.generateExpression(e.init,O.Assignment,n)]:this.generatePattern(e.id,O.Assignment,n)},VariableDeclaration:function(e,t){function n(){for(o=e.declarations[0],ne.comment&&o.leadingComments?(r.push("\n"),r.push(x(u.generateStatement(o,a)))):(r.push(y()),r.push(u.generateStatement(o,a))),i=1,s=e.declarations.length;s>i;++i)o=e.declarations[i],ne.comment&&o.leadingComments?(r.push(","+_),r.push(x(u.generateStatement(o,a)))):(r.push(","+J),r.push(u.generateStatement(o,a)))}var r,i,s,o,a,u=this;return r=[e.kind],a=t&pe?Ee:Ce,e.declarations.length>1?b(n):n(),r.push(this.semicolon(t)),r},ThrowStatement:function(e,t){return[S("throw",this.generateExpression(e.argument,O.Sequence,ye)),this.semicolon(t)]},TryStatement:function(e,t){var n,r,i,s;if(n=["try",this.maybeBlock(e.block,Ee)],n=this.maybeBlockSuffix(e.block,n),e.handlers)for(r=0,i=e.handlers.length;i>r;++r)n=S(n,this.generateStatement(e.handlers[r],Ee)),(e.finalizer||r+1!==i)&&(n=this.maybeBlockSuffix(e.handlers[r].body,n));else{for(s=e.guardedHandlers||[],r=0,i=s.length;i>r;++r)n=S(n,this.generateStatement(s[r],Ee)),(e.finalizer||r+1!==i)&&(n=this.maybeBlockSuffix(s[r].body,n));if(e.handler)if(U(e.handler))for(r=0,i=e.handler.length;i>r;++r)n=S(n,this.generateStatement(e.handler[r],Ee)),(e.finalizer||r+1!==i)&&(n=this.maybeBlockSuffix(e.handler[r].body,n));else n=S(n,this.generateStatement(e.handler,Ee)),e.finalizer&&(n=this.maybeBlockSuffix(e.handler.body,n))}return e.finalizer&&(n=S(n,["finally",this.maybeBlock(e.finalizer,Ee)])),n},SwitchStatement:function(e,t){var n,r,i,o,a,u=this;if(b(function(){n=["switch"+J+"(",u.generateExpression(e.discriminant,O.Sequence,ye),")"+J+"{"+_]}),e.cases)for(a=Ee,i=0,o=e.cases.length;o>i;++i)i===o-1&&(a|=fe),r=x(this.generateStatement(e.cases[i],a)),n.push(r),s(d(r).toString())||n.push(_);return n.push(x("}")),n},SwitchCase:function(e,t){var n,r,i,o,a,u=this;return b(function(){for(n=e.test?[S("case",u.generateExpression(e.test,O.Sequence,ye)),":"]:["default:"],i=0,o=e.consequent.length,o&&e.consequent[0].type===T.BlockStatement&&(r=u.maybeBlock(e.consequent[0],Ee),n.push(r),i=1),i===o||s(d(n).toString())||n.push(_),a=Ee;o>i;++i)i===o-1&&t&fe&&(a|=fe),r=x(u.generateStatement(e.consequent[i],a)),n.push(r),i+1===o||s(d(r).toString())||n.push(_)}),n},IfStatement:function(e,t){var n,r,i,s=this;return b(function(){n=["if"+J+"(",s.generateExpression(e.test,O.Sequence,ye),")"]}),i=t&fe,r=Ee,i&&(r|=fe),e.alternate?(n.push(this.maybeBlock(e.consequent,Ee)),n=this.maybeBlockSuffix(e.consequent,n),n=e.alternate.type===T.IfStatement?S(n,["else ",this.generateStatement(e.alternate,r)]):S(n,S("else",this.maybeBlock(e.alternate,r)))):n.push(this.maybeBlock(e.consequent,r)),n},ForStatement:function(e,t){var n,r=this;return b(function(){n=["for"+J+"("],e.init?e.init.type===T.VariableDeclaration?n.push(r.generateStatement(e.init,Ce)):(n.push(r.generateExpression(e.init,O.Sequence,me)),n.push(";")):n.push(";"),e.test?(n.push(J),n.push(r.generateExpression(e.test,O.Sequence,ye)),n.push(";")):n.push(";"),e.update?(n.push(J),n.push(r.generateExpression(e.update,O.Sequence,ye)),n.push(")")):n.push(")")}),n.push(this.maybeBlock(e.body,t&fe?ve:Ee)),n},ForInStatement:function(e,t){return this.generateIterationForStatement("in",e,t&fe?ve:Ee)},ForOfStatement:function(e,t){return this.generateIterationForStatement("of",e,t&fe?ve:Ee)},LabeledStatement:function(e,t){return[e.label.name+":",this.maybeBlock(e.body,t&fe?ve:Ee)]},Program:function(e,t){var n,r,i,o,a;for(o=e.body.length,n=[ee&&o>0?"\n":""],a=Ae,i=0;o>i;++i)ee||i!==o-1||(a|=fe),oe&&(0===i&&(e.body[0].leadingComments||q(e.range[0],e.body[i].range[0],n)),i>0&&(e.body[i-1].trailingComments||e.body[i].leadingComments||q(e.body[i-1].range[1],e.body[i].range[0],n))),r=x(this.generateStatement(e.body[i],a)),n.push(r),o>i+1&&!s(d(r).toString())&&(oe?e.body[i+1].leadingComments||n.push(_):n.push(_)),oe&&i===o-1&&(e.body[i].trailingComments||q(e.body[i].range[1],e.range[1],n));return n},FunctionDeclaration:function(e,t){return[I(e,!0),"function",M(e)||y(),e.id?F(e.id):"",this.generateFunctionBody(e)]},ReturnStatement:function(e,t){return e.argument?[S("return",this.generateExpression(e.argument,O.Sequence,ye)),this.semicolon(t)]:["return"+this.semicolon(t)]},WhileStatement:function(e,t){var n,r=this;return b(function(){n=["while"+J+"(",r.generateExpression(e.test,O.Sequence,ye),")"]}),n.push(this.maybeBlock(e.body,t&fe?ve:Ee)),n},WithStatement:function(e,t){var n,r=this;return b(function(){n=["with"+J+"(",r.generateExpression(e.object,O.Sequence,ye),")"]}),n.push(this.maybeBlock(e.body,t&fe?ve:Ee)),n}},o(P.prototype,P.Statement),P.Expression={SequenceExpression:function(e,t,n){var r,i,s;for(O.Sequence<t&&(n|=pe),r=[],i=0,s=e.expressions.length;s>i;++i)r.push(this.generateExpression(e.expressions[i],O.Assignment,n)),s>i+1&&r.push(","+J);return w(r,O.Sequence,t)},AssignmentExpression:function(e,t,n){return this.generateAssignment(e.left,e.right,e.operator,t,n)},ArrowFunctionExpression:function(e,t,n){return w(this.generateFunctionBody(e),O.ArrowFunction,t)},ConditionalExpression:function(e,t,n){return O.Conditional<t&&(n|=pe),w([this.generateExpression(e.test,O.LogicalOR,n),J+"?"+J,this.generateExpression(e.consequent,O.Assignment,n),J+":"+J,this.generateExpression(e.alternate,O.Assignment,n)],O.Conditional,t)},LogicalExpression:function(e,t,n){return this.BinaryExpression(e,t,n)},BinaryExpression:function(e,t,n){var r,i,s,o;return i=N[e.operator],t>i&&(n|=pe),s=this.generateExpression(e.left,i,n),o=s.toString(),r=47===o.charCodeAt(o.length-1)&&z.code.isIdentifierPartES5(e.operator.charCodeAt(0))?[s,y(),e.operator]:S(s,e.operator),s=this.generateExpression(e.right,i+1,n),"/"===e.operator&&"/"===s.toString().charAt(0)||"<"===e.operator.slice(-1)&&"!--"===s.toString().slice(0,3)?(r.push(y()),r.push(s)):r=S(r,s),"in"!==e.operator||n&pe?w(r,i,t):["(",r,")"]},CallExpression:function(e,t,n){var r,i,s;for(r=[this.generateExpression(e.callee,O.Call,de)],r.push("("),i=0,s=e.arguments.length;s>i;++i)r.push(this.generateExpression(e.arguments[i],O.Assignment,ye)),s>i+1&&r.push(","+J);return r.push(")"),n&ce?w(r,O.Call,t):["(",r,")"]},NewExpression:function(e,t,n){var r,i,s,o,a;if(i=e.arguments.length,a=n&he&&!Q&&0===i?be:Se,r=S("new",this.generateExpression(e.callee,O.New,a)),!(n&he)||Q||i>0){for(r.push("("),s=0,o=i;o>s;++s)r.push(this.generateExpression(e.arguments[s],O.Assignment,ye)),o>s+1&&r.push(","+J);r.push(")")}return w(r,O.New,t)},MemberExpression:function(e,t,n){var r,i;return r=[this.generateExpression(e.object,O.Call,n&ce?de:Se)],e.computed?(r.push("["),r.push(this.generateExpression(e.property,O.Sequence,n&ce?ye:be)),r.push("]")):(e.object.type===T.Literal&&"number"==typeof e.object.value&&(i=d(r).toString(),i.indexOf(".")<0&&!/[eExX]/.test(i)&&z.code.isDecimalDigit(i.charCodeAt(i.length-1))&&!(i.length>=2&&48===i.charCodeAt(0))&&r.push(".")),r.push("."),r.push(F(e.property))),w(r,O.Member,t)},MetaProperty:function(e,t,n){var r;return r=[],r.push(e.meta),r.push("."),r.push(e.property),w(r,O.Member,t)},UnaryExpression:function(e,t,n){var r,i,s,o,a;return i=this.generateExpression(e.argument,O.Unary,ye),""===J?r=S(e.operator,i):(r=[e.operator],e.operator.length>2?r=S(r,i):(o=d(r).toString(),a=o.charCodeAt(o.length-1),s=i.toString().charCodeAt(0),(43===a||45===a)&&a===s||z.code.isIdentifierPartES5(a)&&z.code.isIdentifierPartES5(s)?(r.push(y()),r.push(i)):r.push(i))),w(r,O.Unary,t)},YieldExpression:function(e,t,n){var r;return r=e.delegate?"yield*":"yield",e.argument&&(r=S(r,this.generateExpression(e.argument,O.Yield,ye))),w(r,O.Yield,t)},AwaitExpression:function(e,t,n){var r=S(e.all?"await*":"await",this.generateExpression(e.argument,O.Await,ye));return w(r,O.Await,t)},UpdateExpression:function(e,t,n){return e.prefix?w([e.operator,this.generateExpression(e.argument,O.Unary,ye)],O.Unary,t):w([this.generateExpression(e.argument,O.Postfix,ye),e.operator],O.Postfix,t)},FunctionExpression:function(e,t,n){var r=[I(e,!0),"function"];return e.id?(r.push(M(e)||y()),r.push(F(e.id))):r.push(M(e)||J),r.push(this.generateFunctionBody(e)),r},ArrayPattern:function(e,t,n){return this.ArrayExpression(e,t,n,!0)},ArrayExpression:function(e,t,n,r){var i,o,a=this;return e.elements.length?(o=r?!1:e.elements.length>1,i=["[",o?_:""],b(function(t){var n,r;for(n=0,r=e.elements.length;r>n;++n)e.elements[n]?(i.push(o?t:""),i.push(a.generateExpression(e.elements[n],O.Assignment,ye))):(o&&i.push(t),n+1===r&&i.push(",")),r>n+1&&i.push(","+(o?_:J))}),o&&!s(d(i).toString())&&i.push(_),i.push(o?K:""),i.push("]"),i):"[]"},RestElement:function(e,t,n){return"..."+this.generatePattern(e.argument)},ClassExpression:function(e,t,n){var r,i;return r=["class"],e.id&&(r=S(r,this.generateExpression(e.id,O.Sequence,ye))),e.superClass&&(i=S("extends",this.generateExpression(e.superClass,O.Assignment,ye)),r=S(r,i)),r.push(J),r.push(this.generateStatement(e.body,ve)),r},MethodDefinition:function(e,t,n){var r,i;return r=e["static"]?["static"+J]:[],i="get"===e.kind||"set"===e.kind?[S(e.kind,this.generatePropertyKey(e.key,e.computed)),this.generateFunctionBody(e.value)]:[D(e),this.generatePropertyKey(e.key,e.computed),this.generateFunctionBody(e.value)],S(r,i)},Property:function(e,t,n){return"get"===e.kind||"set"===e.kind?[e.kind,y(),this.generatePropertyKey(e.key,e.computed),this.generateFunctionBody(e.value)]:e.shorthand?this.generatePropertyKey(e.key,e.computed):e.method?[D(e),this.generatePropertyKey(e.key,e.computed),this.generateFunctionBody(e.value)]:[this.generatePropertyKey(e.key,e.computed),":"+J,this.generateExpression(e.value,O.Assignment,ye)]},ObjectExpression:function(e,t,n){var r,o,a,u=this;return e.properties.length?(r=e.properties.length>1,b(function(){a=u.generateExpression(e.properties[0],O.Sequence,ye)}),r||i(d(a).toString())?(b(function(t){var n,i;if(o=["{",_,t,a],r)for(o.push(","+_),n=1,i=e.properties.length;i>n;++n)o.push(t),o.push(u.generateExpression(e.properties[n],O.Sequence,ye)),i>n+1&&o.push(","+_)}),s(d(o).toString())||o.push(_),o.push(K),o.push("}"),o):["{",J,a,J,"}"]):"{}"},AssignmentPattern:function(e,t,n){return this.generateAssignment(e.left,e.right,e.operator,t,n)},ObjectPattern:function(e,t,n){var r,i,o,a,u,p=this;if(!e.properties.length)return"{}";if(a=!1,1===e.properties.length)u=e.properties[0],u.value.type!==T.Identifier&&(a=!0);else for(i=0,o=e.properties.length;o>i;++i)if(u=e.properties[i],!u.shorthand){a=!0;break}return r=["{",a?_:""],b(function(t){var n,i;for(n=0,i=e.properties.length;i>n;++n)r.push(a?t:""),r.push(p.generateExpression(e.properties[n],O.Sequence,ye)),i>n+1&&r.push(","+(a?_:J))}),a&&!s(d(r).toString())&&r.push(_),r.push(a?K:""),r.push("}"),r},ThisExpression:function(e,t,n){return"this"},Super:function(e,t,n){return"super"},Identifier:function(e,t,n){return F(e)},ImportDefaultSpecifier:function(e,t,n){return F(e.id||e.local)},ImportNamespaceSpecifier:function(e,t,n){var r=["*"],i=e.id||e.local;return i&&r.push(J+"as"+y()+F(i)),r},ImportSpecifier:function(e,t,n){var r=e.imported,i=[r.name],s=e.local;return s&&s.name!==r.name&&i.push(y()+"as"+y()+F(s)),i},ExportSpecifier:function(e,t,n){var r=e.local,i=[r.name],s=e.exported;return s&&s.name!==r.name&&i.push(y()+"as"+y()+F(s)),i},Literal:function(e,t,n){var r;if(e.hasOwnProperty("raw")&&re&&ne.raw)try{if(r=re(e.raw).body[0].expression,r.type===T.Literal&&r.value===e.value)return e.raw}catch(i){}return null===e.value?"null":"string"==typeof e.value?f(e.value):"number"==typeof e.value?u(e.value):"boolean"==typeof e.value?e.value?"true":"false":c(e.value)},GeneratorExpression:function(e,t,n){return this.ComprehensionExpression(e,t,n)},ComprehensionExpression:function(e,t,n){var r,i,s,o,a=this;return r=e.type===T.GeneratorExpression?["("]:["["],ne.moz.comprehensionExpressionStartsWithAssignment&&(o=this.generateExpression(e.body,O.Assignment,ye),r.push(o)),e.blocks&&b(function(){for(i=0,s=e.blocks.length;s>i;++i)o=a.generateExpression(e.blocks[i],O.Sequence,ye),i>0||ne.moz.comprehensionExpressionStartsWithAssignment?r=S(r,o):r.push(o)}),e.filter&&(r=S(r,"if"+J),o=this.generateExpression(e.filter,O.Sequence,ye),r=S(r,["(",o,")"])),ne.moz.comprehensionExpressionStartsWithAssignment||(o=this.generateExpression(e.body,O.Assignment,ye),r=S(r,o)),r.push(e.type===T.GeneratorExpression?")":"]"),r},ComprehensionBlock:function(e,t,n){var r;return r=e.left.type===T.VariableDeclaration?[e.left.kind,y(),this.generateStatement(e.left.declarations[0],Ce)]:this.generateExpression(e.left,O.Call,ye),r=S(r,e.of?"of":"in"),r=S(r,this.generateExpression(e.right,O.Sequence,ye)),["for"+J+"(",r,")"]},SpreadElement:function(e,t,n){return["...",this.generateExpression(e.argument,O.Assignment,ye)]},TaggedTemplateExpression:function(e,t,n){var r=de;n&ce||(r=Se);var i=[this.generateExpression(e.tag,O.Call,r),this.generateExpression(e.quasi,O.Primary,xe)];return w(i,O.TaggedTemplate,t)},TemplateElement:function(e,t,n){return e.value.raw},TemplateLiteral:function(e,t,n){var r,i,s;for(r=["`"],i=0,s=e.quasis.length;s>i;++i)r.push(this.generateExpression(e.quasis[i],O.Primary,ye)),s>i+1&&(r.push("${"+J),r.push(this.generateExpression(e.expressions[i],O.Sequence,ye)),r.push(J+"}"));return r.push("`"),r},ModuleSpecifier:function(e,t,n){return this.Literal(e,t,n)}},o(P.prototype,P.Expression),P.prototype.generateExpression=function(e,t,n){var r,i;return i=e.type||T.Property,ne.verbatim&&e.hasOwnProperty(ne.verbatim)?B(e,t):(r=this[i](e,t,n),ne.comment&&(r=A(e,r)),d(r,e))},P.prototype.generateStatement=function(e,t){var n,r;return n=this[e.type](e,t),ne.comment&&(n=A(e,n)),r=d(n).toString(),e.type!==T.Program||ee||""!==_||"\n"!==r.charAt(r.length-1)||(n=ie?d(n).replaceRight(/\s+$/,""):r.replace(/\s+$/,"")),d(n,e)},ae={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},ue=n().format,exports.version=require("./package.json").version,exports.generate=R,exports.attachComments=j.attachComments,exports.Precedence=a({},O),exports.browser=!1,exports.FORMAT_MINIFY=ae,exports.FORMAT_DEFAULTS=ue}();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./package.json":217,"estraverse":207,"esutils":211,"source-map":212}],207:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.estraverse={})}(this,function e(t){"use strict";function n(){}function r(e){var t,n,i={};for(t in e)e.hasOwnProperty(t)&&(n=e[t],"object"==typeof n&&null!==n?i[t]=r(n):i[t]=n);return i}function i(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function o(e,t){var n,r,i,o;for(r=e.length,i=0;r;)n=r>>>1,o=i+n,t(e[o])?r=n:(i=o+1,r-=n+1);return i}function s(e,t){var n,r,i,o;for(r=e.length,i=0;r;)n=r>>>1,o=i+n,t(e[o])?(i=o+1,r-=n+1):r=n;return i}function a(e,t){var n,r,i,o=b(t);for(r=0,i=o.length;i>r;r+=1)n=o[r],e[n]=t[n];return e}function l(e,t){this.parent=e,this.key=t}function p(e,t,n,r){this.node=e,this.path=t,this.wrap=n,this.ref=r}function u(){}function c(e){return null==e?!1:"object"==typeof e&&"string"==typeof e.type}function f(e,t){return(e===x.ObjectExpression||e===x.ObjectPattern)&&"properties"===t}function h(e,t){var n=new u;return n.traverse(e,t)}function m(e,t){var n=new u;return n.replace(e,t)}function d(e,t){var n;return n=o(t,function(t){return t.range[0]>e.range[0]}),e.extendedRange=[e.range[0],e.range[1]],n!==t.length&&(e.extendedRange[1]=t[n].range[0]),n-=1,n>=0&&(e.extendedRange[0]=t[n].range[1]),e}function y(e,t,n){var i,o,s,a,l=[];if(!e.range)throw new Error("attachComments needs range information");if(!n.length){if(t.length){for(s=0,o=t.length;o>s;s+=1)i=r(t[s]),i.extendedRange=[0,e.range[0]],l.push(i);e.leadingComments=l}return e}for(s=0,o=t.length;o>s;s+=1)l.push(d(r(t[s]),n));return a=0,h(e,{enter:function(e){for(var t;a<l.length&&(t=l[a],!(t.extendedRange[1]>e.range[0]));)t.extendedRange[1]===e.range[0]?(e.leadingComments||(e.leadingComments=[]),e.leadingComments.push(t),l.splice(a,1)):a+=1;return a===l.length?_.Break:l[a].extendedRange[0]>e.range[1]?_.Skip:void 0}}),a=0,h(e,{leave:function(e){for(var t;a<l.length&&(t=l[a],!(e.range[1]<t.extendedRange[0]));)e.range[1]===t.extendedRange[0]?(e.trailingComments||(e.trailingComments=[]),e.trailingComments.push(t),l.splice(a,1)):a+=1;return a===l.length?_.Break:l[a].extendedRange[0]>e.range[1]?_.Skip:void 0}}),e}var x,g,_,S,E,b,v,w,k;return g=Array.isArray,g||(g=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),n(i),n(s),E=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}(),b=Object.keys||function(e){var t,n=[];for(t in e)n.push(t);return n},x={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportBatchSpecifier:"ExportBatchSpecifier",ExportDeclaration:"ExportDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},S={AssignmentExpression:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","defaults","rest","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","body","superClass"],ClassExpression:["id","body","superClass"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportBatchSpecifier:[],ExportDeclaration:["declaration","specifiers","source"],ExportSpecifier:["id","name"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","defaults","rest","body"],FunctionExpression:["id","params","defaults","rest","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["id"],ImportNamespaceSpecifier:["id"],ImportSpecifier:["id","name"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handlers","handler","guardedHandlers","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},v={},w={},k={},_={Break:v,Skip:w,Remove:k},l.prototype.replace=function(e){this.parent[this.key]=e},l.prototype.remove=function(){return g(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)},u.prototype.path=function(){function e(e,t){if(g(t))for(r=0,i=t.length;i>r;++r)e.push(t[r]);else e.push(t)}var t,n,r,i,o,s;if(!this.__current.path)return null;for(o=[],t=2,n=this.__leavelist.length;n>t;++t)s=this.__leavelist[t],e(o,s.path);return e(o,this.__current.path),o},u.prototype.type=function(){var e=this.current();return e.type||this.__current.wrap},u.prototype.parents=function(){var e,t,n;for(n=[],e=1,t=this.__leavelist.length;t>e;++e)n.push(this.__leavelist[e].node);return n},u.prototype.current=function(){return this.__current.node},u.prototype.__execute=function(e,t){var n,r;return r=void 0,n=this.__current,this.__current=t,this.__state=null,e&&(r=e.call(this,t.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=n,r},u.prototype.notify=function(e){this.__state=e},u.prototype.skip=function(){this.notify(w)},u.prototype["break"]=function(){this.notify(v)},u.prototype.remove=function(){this.notify(k)},u.prototype.__initialize=function(e,t){this.visitor=t,this.root=e,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback="iteration"===t.fallback,this.__keys=S,t.keys&&(this.__keys=a(E(this.__keys),t.keys))},u.prototype.traverse=function(e,t){var n,r,i,o,s,a,l,u,h,m,d,y;for(this.__initialize(e,t),y={},n=this.__worklist,r=this.__leavelist,n.push(new p(e,null,null,null)),r.push(new p(null,null,null,null));n.length;)if(i=n.pop(),i!==y){if(i.node){if(a=this.__execute(t.enter,i),this.__state===v||a===v)return;if(n.push(y),r.push(i),this.__state===w||a===w)continue;if(o=i.node,s=i.wrap||o.type,m=this.__keys[s],!m){if(!this.__fallback)throw new Error("Unknown node type "+s+".");m=b(o)}for(u=m.length;(u-=1)>=0;)if(l=m[u],d=o[l])if(g(d)){for(h=d.length;(h-=1)>=0;)if(d[h]){if(f(s,m[u]))i=new p(d[h],[l,h],"Property",null);else{if(!c(d[h]))continue;i=new p(d[h],[l,h],null,null)}n.push(i)}}else c(d)&&n.push(new p(d,l,null,null))}}else if(i=r.pop(),a=this.__execute(t.leave,i),this.__state===v||a===v)return},u.prototype.replace=function(e,t){function n(e){var t,n,i,o;if(e.ref.remove())for(n=e.ref.key,o=e.ref.parent,t=r.length;t--;)if(i=r[t],i.ref&&i.ref.parent===o){if(i.ref.key<n)break;--i.ref.key}}var r,i,o,s,a,u,h,m,d,y,x,_,S;for(this.__initialize(e,t),x={},r=this.__worklist,i=this.__leavelist,_={root:e},u=new p(e,null,null,new l(_,"root")),r.push(u),i.push(u);r.length;)if(u=r.pop(),u!==x){if(a=this.__execute(t.enter,u),void 0!==a&&a!==v&&a!==w&&a!==k&&(u.ref.replace(a),u.node=a),this.__state!==k&&a!==k||(n(u),u.node=null),this.__state===v||a===v)return _.root;if(o=u.node,o&&(r.push(x),i.push(u),this.__state!==w&&a!==w)){if(s=u.wrap||o.type,d=this.__keys[s],!d){if(!this.__fallback)throw new Error("Unknown node type "+s+".");d=b(o)}for(h=d.length;(h-=1)>=0;)if(S=d[h],y=o[S])if(g(y)){for(m=y.length;(m-=1)>=0;)if(y[m]){if(f(s,d[h]))u=new p(y[m],[S,m],"Property",new l(y,m));else{if(!c(y[m]))continue;u=new p(y[m],[S,m],null,new l(y,m))}r.push(u)}}else c(y)&&r.push(new p(y,S,null,new l(o,S)))}}else if(u=i.pop(),a=this.__execute(t.leave,u),void 0!==a&&a!==v&&a!==w&&a!==k&&u.ref.replace(a),this.__state!==k&&a!==k||n(u),this.__state===v||a===v)return _.root;return _.root},t.version="1.8.1-dev",t.Syntax=x,t.traverse=h,t.replace=m,t.attachComments=y,t.VisitorKeys=S,t.VisitorOption=_,t.Controller=u,t.cloneEnvironment=function(){return e({})},t});
},{}],208:[function(require,module,exports){
!function(){"use strict";function e(e){if(null==e)return!1;switch(e.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(e){if(null==e)return!1;switch(e.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function n(e){if(null==e)return!1;switch(e.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function a(e){return n(e)||null!=e&&"FunctionDeclaration"===e.type}function s(e){switch(e.type){case"IfStatement":return null!=e.alternate?e.alternate:e.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return e.body}return null}function r(e){var t;if("IfStatement"!==e.type)return!1;if(null==e.alternate)return!1;t=e.consequent;do{if("IfStatement"===t.type&&null==t.alternate)return!0;t=s(t)}while(t);return!1}module.exports={isExpression:e,isStatement:n,isIterationStatement:t,isSourceElement:a,isProblematicIfStatement:r,trailingStatement:s}}();
},{}],209:[function(require,module,exports){
!function(){"use strict";function u(u){return u>=48&&57>=u}function D(u){return u>=48&&57>=u||u>=97&&102>=u||u>=65&&70>=u}function A(u){return u>=48&&55>=u}function F(u){return 32===u||9===u||11===u||12===u||160===u||u>=5760&&x.indexOf(u)>=0}function C(u){return 10===u||13===u||8232===u||8233===u}function E(u){if(65535>=u)return String.fromCharCode(u);var D=String.fromCharCode(Math.floor((u-65536)/1024)+55296),A=String.fromCharCode((u-65536)%1024+56320);return D+A}function B(u){return 128>u?o[u]:e.NonAsciiIdentifierStart.test(E(u))}function i(u){return 128>u?f[u]:e.NonAsciiIdentifierPart.test(E(u))}function t(u){return 128>u?o[u]:n.NonAsciiIdentifierStart.test(E(u))}function r(u){return 128>u?f[u]:n.NonAsciiIdentifierPart.test(E(u))}var n,e,x,o,f,a;for(e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B2\u08E4-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58\u0C59\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D60-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA69D\uA69F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2D\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDE00-\uDE11\uDE13-\uDE2B\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDE00-\uDE2F\uDE44\uDE80-\uDEAA]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF98]|\uD809[\uDC00-\uDC6E]|[\uD80C\uD840-\uD868\uD86A-\uD86C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B2\u08E4-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58\u0C59\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D60-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA69D\uA69F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2D\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDD0-\uDDDA\uDE00-\uDE11\uDE13-\uDE37\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF01-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF98]|\uD809[\uDC00-\uDC6E]|[\uD80C\uD840-\uD868\uD86A-\uD86C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},x=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279],o=new Array(128),a=0;128>a;++a)o[a]=a>=97&&122>=a||a>=65&&90>=a||36===a||95===a;for(f=new Array(128),a=0;128>a;++a)f[a]=a>=97&&122>=a||a>=65&&90>=a||a>=48&&57>=a||36===a||95===a;module.exports={isDecimalDigit:u,isHexDigit:D,isOctalDigit:A,isWhiteSpace:F,isLineTerminator:C,isIdentifierStartES5:B,isIdentifierPartES5:i,isIdentifierStartES6:t,isIdentifierPartES6:r}}();
},{}],210:[function(require,module,exports){
!function(){"use strict";function e(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function r(e,r){return r||"yield"!==e?t(e,r):!1}function t(r,t){if(t&&e(r))return!0;switch(r.length){case 2:return"if"===r||"in"===r||"do"===r;case 3:return"var"===r||"for"===r||"new"===r||"try"===r;case 4:return"this"===r||"else"===r||"case"===r||"void"===r||"with"===r||"enum"===r;case 5:return"while"===r||"break"===r||"catch"===r||"throw"===r||"const"===r||"yield"===r||"class"===r||"super"===r;case 6:return"return"===r||"typeof"===r||"delete"===r||"switch"===r||"export"===r||"import"===r;case 7:return"default"===r||"finally"===r||"extends"===r;case 8:return"function"===r||"continue"===r||"debugger"===r;case 10:return"instanceof"===r;default:return!1}}function n(e,t){return"null"===e||"true"===e||"false"===e||r(e,t)}function i(e,r){return"null"===e||"true"===e||"false"===e||t(e,r)}function u(e){return"eval"===e||"arguments"===e}function s(e){var r,t,n;if(0===e.length)return!1;if(n=e.charCodeAt(0),!d.isIdentifierStartES5(n))return!1;for(r=1,t=e.length;t>r;++r)if(n=e.charCodeAt(r),!d.isIdentifierPartES5(n))return!1;return!0}function c(e,r){return 1024*(e-55296)+(r-56320)+65536}function a(e){var r,t,n,i,u;if(0===e.length)return!1;for(u=d.isIdentifierStartES6,r=0,t=e.length;t>r;++r){if(n=e.charCodeAt(r),n>=55296&&56319>=n){if(++r,r>=t)return!1;if(i=e.charCodeAt(r),!(i>=56320&&57343>=i))return!1;n=c(n,i)}if(!u(n))return!1;u=d.isIdentifierPartES6}return!0}function f(e,r){return s(e)&&!n(e,r)}function o(e,r){return a(e)&&!i(e,r)}var d=require("./code");module.exports={isKeywordES5:r,isKeywordES6:t,isReservedWordES5:n,isReservedWordES6:i,isRestrictedWord:u,isIdentifierNameES5:s,isIdentifierNameES6:a,isIdentifierES5:f,isIdentifierES6:o}}();
},{"./code":209}],211:[function(require,module,exports){
!function(){"use strict";exports.ast=require("./ast"),exports.code=require("./code"),exports.keyword=require("./keyword")}();
},{"./ast":208,"./code":209,"./keyword":210}],212:[function(require,module,exports){
exports.SourceMapGenerator=require("./source-map/source-map-generator").SourceMapGenerator,exports.SourceMapConsumer=require("./source-map/source-map-consumer").SourceMapConsumer,exports.SourceNode=require("./source-map/source-node").SourceNode;
},{"./source-map/source-map-consumer":213,"./source-map/source-map-generator":214,"./source-map/source-node":215}],213:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(e,n,r){function i(n){var r=n;if("string"==typeof n&&(r=JSON.parse(n.replace(/^\)\]\}'/,""))),null!=r.sections){var i=e("./indexed-source-map-consumer");return new i.IndexedSourceMapConsumer(r)}var o=e("./basic-source-map-consumer");return new o.BasicSourceMapConsumer(r)}var o=e("./util");i.fromSourceMap=function(n){var r=e("./basic-source-map-consumer");return r.BasicSourceMapConsumer.fromSourceMap(n)},i.prototype._version=3,i.prototype.__generatedMappings=null,Object.defineProperty(i.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),i.prototype.__originalMappings=null,Object.defineProperty(i.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),i.prototype._nextCharIsMappingSeparator=function(e){var n=e.charAt(0);return";"===n||","===n},i.prototype._parseMappings=function(e,n){throw new Error("Subclasses must implement _parseMappings")},i.GENERATED_ORDER=1,i.ORIGINAL_ORDER=2,i.prototype.eachMapping=function(e,n,r){var a,t=n||null,s=r||i.GENERATED_ORDER;switch(s){case i.GENERATED_ORDER:a=this._generatedMappings;break;case i.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var p=this.sourceRoot;a.map(function(e){var n=e.source;return null!=n&&null!=p&&(n=o.join(p,n)),{source:n,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:e.name}}).forEach(e,t)},i.prototype.allGeneratedPositionsFor=function(e){var n={source:o.getArg(e,"source"),originalLine:o.getArg(e,"line"),originalColumn:1/0};null!=this.sourceRoot&&(n.source=o.relative(this.sourceRoot,n.source));var r=[],i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",o.compareByOriginalPositions);if(i>=0)for(var a=this._originalMappings[i];a&&a.originalLine===n.originalLine;)r.push({line:o.getArg(a,"generatedLine",null),column:o.getArg(a,"generatedColumn",null),lastColumn:o.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[--i];return r.reverse()},n.SourceMapConsumer=i});
},{"amdefine":216}],214:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(e,n,o){function t(e){e||(e={}),this._file=r.getArg(e,"file",null),this._sourceRoot=r.getArg(e,"sourceRoot",null),this._skipValidation=r.getArg(e,"skipValidation",!1),this._sources=new s,this._names=new s,this._mappings=new l,this._sourcesContents=null}var i=e("./base64-vlq"),r=e("./util"),s=e("./array-set").ArraySet,l=e("./mapping-list").MappingList;t.prototype._version=3,t.fromSourceMap=function(e){var n=e.sourceRoot,o=new t({file:e.file,sourceRoot:n});return e.eachMapping(function(e){var t={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(t.source=e.source,null!=n&&(t.source=r.relative(n,t.source)),t.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(t.name=e.name)),o.addMapping(t)}),e.sources.forEach(function(n){var t=e.sourceContentFor(n);null!=t&&o.setSourceContent(n,t)}),o},t.prototype.addMapping=function(e){var n=r.getArg(e,"generated"),o=r.getArg(e,"original",null),t=r.getArg(e,"source",null),i=r.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,o,t,i),null==t||this._sources.has(t)||this._sources.add(t),null==i||this._names.has(i)||this._names.add(i),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:null!=o&&o.line,originalColumn:null!=o&&o.column,source:t,name:i})},t.prototype.setSourceContent=function(e,n){var o=e;null!=this._sourceRoot&&(o=r.relative(this._sourceRoot,o)),null!=n?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[r.toSetString(o)]=n):this._sourcesContents&&(delete this._sourcesContents[r.toSetString(o)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},t.prototype.applySourceMap=function(e,n,o){var t=n;if(null==n){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');t=e.file}var i=this._sourceRoot;null!=i&&(t=r.relative(i,t));var l=new s,u=new s;this._mappings.unsortedForEach(function(n){if(n.source===t&&null!=n.originalLine){var s=e.originalPositionFor({line:n.originalLine,column:n.originalColumn});null!=s.source&&(n.source=s.source,null!=o&&(n.source=r.join(o,n.source)),null!=i&&(n.source=r.relative(i,n.source)),n.originalLine=s.line,n.originalColumn=s.column,null!=s.name&&(n.name=s.name))}var a=n.source;null==a||l.has(a)||l.add(a);var c=n.name;null==c||u.has(c)||u.add(c)},this),this._sources=l,this._names=u,e.sources.forEach(function(n){var t=e.sourceContentFor(n);null!=t&&(null!=o&&(n=r.join(o,n)),null!=i&&(n=r.relative(i,n)),this.setSourceContent(n,t))},this)},t.prototype._validateMapping=function(e,n,o,t){if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||n||o||t)&&!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&o))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:o,original:n,name:t}))},t.prototype._serializeMappings=function(){for(var e,n=0,o=1,t=0,s=0,l=0,u=0,a="",c=this._mappings.toArray(),p=0,g=c.length;g>p;p++){if(e=c[p],e.generatedLine!==o)for(n=0;e.generatedLine!==o;)a+=";",o++;else if(p>0){if(!r.compareByGeneratedPositions(e,c[p-1]))continue;a+=","}a+=i.encode(e.generatedColumn-n),n=e.generatedColumn,null!=e.source&&(a+=i.encode(this._sources.indexOf(e.source)-u),u=this._sources.indexOf(e.source),a+=i.encode(e.originalLine-1-s),s=e.originalLine-1,a+=i.encode(e.originalColumn-t),t=e.originalColumn,null!=e.name&&(a+=i.encode(this._names.indexOf(e.name)-l),l=this._names.indexOf(e.name)))}return a},t.prototype._generateSourcesContent=function(e,n){return e.map(function(e){if(!this._sourcesContents)return null;null!=n&&(e=r.relative(n,e));var o=r.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,o)?this._sourcesContents[o]:null},this)},t.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},t.prototype.toString=function(){return JSON.stringify(this)},n.SourceMapGenerator=t});
},{"amdefine":216}],215:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(n,e,t){function r(n,e,t,r,o){this.children=[],this.sourceContents={},this.line=null==n?null:n,this.column=null==e?null:e,this.source=null==t?null:t,this.name=null==o?null:o,this[s]=!0,null!=r&&this.add(r)}var o=n("./source-map-generator").SourceMapGenerator,i=n("./util"),l=/(\r?\n)/,u=10,s="$$$isSourceNode$$$";r.fromStringWithSourceMap=function(n,e,t){function o(n,e){if(null===n||void 0===n.source)u.add(e);else{var o=t?i.join(t,n.source):n.source;u.add(new r(n.originalLine,n.originalColumn,o,e,n.name))}}var u=new r,s=n.split(l),c=function(){var n=s.shift(),e=s.shift()||"";return n+e},a=1,h=0,d=null;return e.eachMapping(function(n){if(null!==d){if(!(a<n.generatedLine)){var e=s[0],t=e.substr(0,n.generatedColumn-h);return s[0]=e.substr(n.generatedColumn-h),h=n.generatedColumn,o(d,t),void(d=n)}var t="";o(d,c()),a++,h=0}for(;a<n.generatedLine;)u.add(c()),a++;if(h<n.generatedColumn){var e=s[0];u.add(e.substr(0,n.generatedColumn)),s[0]=e.substr(n.generatedColumn),h=n.generatedColumn}d=n},this),s.length>0&&(d&&o(d,c()),u.add(s.join(""))),e.sources.forEach(function(n){var r=e.sourceContentFor(n);null!=r&&(null!=t&&(n=i.join(t,n)),u.setSourceContent(n,r))}),u},r.prototype.add=function(n){if(Array.isArray(n))n.forEach(function(n){this.add(n)},this);else{if(!n[s]&&"string"!=typeof n)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);n&&this.children.push(n)}return this},r.prototype.prepend=function(n){if(Array.isArray(n))for(var e=n.length-1;e>=0;e--)this.prepend(n[e]);else{if(!n[s]&&"string"!=typeof n)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);this.children.unshift(n)}return this},r.prototype.walk=function(n){for(var e,t=0,r=this.children.length;r>t;t++)e=this.children[t],e[s]?e.walk(n):""!==e&&n(e,{source:this.source,line:this.line,column:this.column,name:this.name})},r.prototype.join=function(n){var e,t,r=this.children.length;if(r>0){for(e=[],t=0;r-1>t;t++)e.push(this.children[t]),e.push(n);e.push(this.children[t]),this.children=e}return this},r.prototype.replaceRight=function(n,e){var t=this.children[this.children.length-1];return t[s]?t.replaceRight(n,e):"string"==typeof t?this.children[this.children.length-1]=t.replace(n,e):this.children.push("".replace(n,e)),this},r.prototype.setSourceContent=function(n,e){this.sourceContents[i.toSetString(n)]=e},r.prototype.walkSourceContents=function(n){for(var e=0,t=this.children.length;t>e;e++)this.children[e][s]&&this.children[e].walkSourceContents(n);for(var r=Object.keys(this.sourceContents),e=0,t=r.length;t>e;e++)n(i.fromSetString(r[e]),this.sourceContents[r[e]])},r.prototype.toString=function(){var n="";return this.walk(function(e){n+=e}),n},r.prototype.toStringWithSourceMap=function(n){var e={code:"",line:1,column:0},t=new o(n),r=!1,i=null,l=null,s=null,c=null;return this.walk(function(n,o){e.code+=n,null!==o.source&&null!==o.line&&null!==o.column?(i===o.source&&l===o.line&&s===o.column&&c===o.name||t.addMapping({source:o.source,original:{line:o.line,column:o.column},generated:{line:e.line,column:e.column},name:o.name}),i=o.source,l=o.line,s=o.column,c=o.name,r=!0):r&&(t.addMapping({generated:{line:e.line,column:e.column}}),i=null,r=!1);for(var a=0,h=n.length;h>a;a++)n.charCodeAt(a)===u?(e.line++,e.column=0,a+1===h?(i=null,r=!1):r&&t.addMapping({source:o.source,original:{line:o.line,column:o.column},generated:{line:e.line,column:e.column},name:o.name})):e.column++}),this.walkSourceContents(function(n,e){t.setSourceContent(n,e)}),{code:e.code,map:t}},e.SourceNode=r});
},{"amdefine":216}],216:[function(require,module,exports){
(function (process,__filename){
"use strict";function amdefine(r,n){function e(r){var n,e;for(n=0;r[n];n+=1)if(e=r[n],"."===e)r.splice(n,1),n-=1;else if(".."===e){if(1===n&&(".."===r[2]||".."===r[0]))break;n>0&&(r.splice(n-1,2),n-=2)}}function t(r,n){var t;return r&&"."===r.charAt(0)&&n&&(t=n.split("/"),t=t.slice(0,t.length-1),t=t.concat(r.split("/")),e(t),r=t.join("/")),r}function i(r){return function(n){return t(n,r)}}function o(r){function n(n){p[r]=n}return n.fromText=function(r,n){throw new Error("amdefine does not implement load.fromText")},n}function u(e,t,i){var o,u,f,l;if(e)u=p[e]={},f={id:e,uri:__filename,exports:u},o=a(n,u,f,e);else{if(s)throw new Error("amdefine with no module ID cannot be called more than once per file.");s=!0,u=r.exports,f=r,o=a(n,u,f,r.id)}t&&(t=t.map(function(r){return o(r)})),l="function"==typeof i?i.apply(f.exports,t):i,void 0!==l&&(f.exports=l,e&&(p[e]=f.exports))}function f(r,n,e){Array.isArray(r)?(e=n,n=r,r=void 0):"string"!=typeof r&&(e=r,r=n=void 0),n&&!Array.isArray(n)&&(e=n,n=void 0),n||(n=["require","exports","module"]),r?c[r]=[r,n,e]:u(r,n,e)}var a,l,c={},p={},s=!1,d=require("path");return a=function(r,n,e,i){function o(t,o){return"string"==typeof t?l(r,n,e,t,i):(t=t.map(function(t){return l(r,n,e,t,i)}),void(o&&process.nextTick(function(){o.apply(null,t)})))}return o.toUrl=function(r){return 0===r.indexOf(".")?t(r,d.dirname(e.filename)):r},o},n=n||function(){return r.require.apply(r,arguments)},l=function(r,n,e,f,s){var d,m,x=f.indexOf("!"),y=f;if(-1===x){if(f=t(f,s),"require"===f)return a(r,n,e,s);if("exports"===f)return n;if("module"===f)return e;if(p.hasOwnProperty(f))return p[f];if(c[f])return u.apply(null,c[f]),p[f];if(r)return r(y);throw new Error("No module with ID: "+f)}return d=f.substring(0,x),f=f.substring(x+1,f.length),m=l(r,n,e,d,s),f=m.normalize?m.normalize(f,i(s)):t(f,s),p[f]?p[f]:(m.load(f,a(r,n,e,s),o(f),{}),p[f])},f.require=function(r){return p[r]?p[r]:c[r]?(u.apply(null,c[r]),p[r]):void 0},f.amd={},f}module.exports=amdefine;
}).call(this,require('_process'),"/node_modules/browserify-shim/node_modules/exposify/node_modules/replace-requires/node_modules/detective/node_modules/escodegen/node_modules/source-map/node_modules/amdefine/amdefine.js")

},{"_process":283,"path":282}],217:[function(require,module,exports){
module.exports={"name":"escodegen","description":"ECMAScript code generator","homepage":"http://github.com/estools/escodegen","main":"escodegen.js","bin":{"esgenerate":"./bin/esgenerate.js","escodegen":"./bin/escodegen.js"},"files":["LICENSE.BSD","LICENSE.source-map","README.md","bin","escodegen.js","package.json"],"version":"1.8.0","engines":{"node":">=0.12.0"},"maintainers":[{"name":"constellation","email":"utatane.tea@gmail.com"},{"name":"michaelficarra","email":"npm@michael.ficarra.me"}],"repository":{"type":"git","url":"git+ssh://git@github.com/estools/escodegen.git"},"dependencies":{"estraverse":"^1.9.1","esutils":"^2.0.2","esprima":"^2.7.1","optionator":"^0.8.1","source-map":"~0.2.0"},"optionalDependencies":{"source-map":"~0.2.0"},"devDependencies":{"acorn-6to5":"^0.11.1-25","bluebird":"^2.3.11","bower-registry-client":"^0.2.1","chai":"^1.10.0","commonjs-everywhere":"^0.9.7","gulp":"^3.8.10","gulp-eslint":"^0.2.0","gulp-mocha":"^2.0.0","semver":"^5.1.0"},"license":"BSD-2-Clause","scripts":{"test":"gulp travis","unit-test":"gulp test","lint":"gulp lint","release":"node tools/release.js","build-min":"cjsify -ma path: tools/entry-point.js > escodegen.browser.min.js","build":"cjsify -a path: tools/entry-point.js > escodegen.browser.js"},"gitHead":"0e8280aa061a0dbefb32d277a05015baa7f3e7f2","bugs":{"url":"https://github.com/estools/escodegen/issues"},"_id":"escodegen@1.8.0","_shasum":"b246aae829ce73d59e2c55727359edd1c130a81b","_from":"escodegen@>=1.4.1 <2.0.0","_npmVersion":"2.14.4","_nodeVersion":"4.1.1","_npmUser":{"name":"constellation","email":"utatane.tea@gmail.com"},"dist":{"shasum":"b246aae829ce73d59e2c55727359edd1c130a81b","tarball":"http://registry.npmjs.org/escodegen/-/escodegen-1.8.0.tgz"},"directories":{},"_resolved":"https://registry.npmjs.org/escodegen/-/escodegen-1.8.0.tgz"}
},{}],218:[function(require,module,exports){
"use strict";function hasRequire(e,r){return new RequireChecker(e).has(r)}function RequireChecker(e){this.code=e}function createRegExp(e){return new RegExp([escape("require("),"\\s*['\"]",e,"['\"]\\s*",escape(")")].join(""))}var escape=require("escape-string-regexp");module.exports=hasRequire,hasRequire.any=function(e){return new RequireChecker(e).any()},hasRequire.Checker=RequireChecker;var anyRegExp=createRegExp("@?[A-Za-z0-9/_.-]+");RequireChecker.prototype.any=function(){return null!=this._any?this._any:(this._any=anyRegExp.test(this.code),this._any)},RequireChecker.prototype.has=function(e){if(!e)throw new Error("module id is required");return this.any()&&createRegExp(escape(e)).test(this.code)};
},{"escape-string-regexp":219}],219:[function(require,module,exports){
"use strict";var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;module.exports=function(r){if("string"!=typeof r)throw new TypeError("Expected a string");return r.replace(matchOperatorsRe,"\\$&")};
},{}],220:[function(require,module,exports){
"use strict";module.exports=function(e,r){var t=0;return r.reduce(function(e,r){var n=r.start+t,c=r.end+t,u=r.replacement;return t+=u.length-(c-n),e.slice(0,n)+u+e.slice(c)},e)};
},{}],221:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],222:[function(require,module,exports){
(function (process){
function Duplex(e){return this instanceof Duplex?(Readable.call(this,e),Writable.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(e)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;r>i;i++)t(e[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});
}).call(this,require('_process'))

},{"./_stream_readable":223,"./_stream_writable":225,"_process":283,"core-util-is":226,"inherits":227}],223:[function(require,module,exports){
(function (process){
function ReadableState(e,t){e=e||{};var n=e.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){return this instanceof Readable?(this._readableState=new ReadableState(e,this),this.readable=!0,void Stream.call(this)):new Readable(e)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(null===n||void 0===n)t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){var d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&emitReadable(e),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;32>t;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:0>=e?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?emitReadable(e):endReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){e.emit("readable")}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&flow(e)}}function flow(e){function t(e,t,i){var a=e.write(n);!1===a&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes,0,null):forEach(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;return 0===r.pipesCount?(r.flowing=!1,void(EE.listenerCount(e,"data")>0&&emitDataEvents(e))):void(r.ranOut=!0)}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow(this))}function emitDataEvents(e,t){var n=e._readableState;if(n.flowing)throw new Error("Cannot switch to old mode now.");var r=t||!1,i=!1;e.readable=!0,e.pipe=Stream.prototype.pipe,e.on=e.addListener=Stream.prototype.on,e.on("readable",function(){i=!0;for(var t;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(i=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,i?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else if(e<r[0].length){var o=r[0];n=o.slice(0,e),r[0]=o.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var l=0,s=0,u=r.length;u>s&&e>l;s++){var o=r[0],h=Math.min(e-l,o.length);a?n+=o.slice(0,h):o.copy(n,l,0,h),h<o.length?r[0]=o.slice(h):r.shift(),l+=h}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding,t!==n.encoding&&(e=new Buffer(e,t),t="")),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){var t=this._readableState;return readableAddChunk(this,t,e,"",!0)},Readable.prototype.setEncoding=function(e){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e};var MAX_HWM=8388608;Readable.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return emitReadable(this),null;if(e=howMuchToRead(e,t),0===e&&t.ended)return n=null,t.length>0&&t.decoder&&(n=fromList(e,t),t.length-=n.length),0===t.length&&endReadable(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),n=e>0?fromList(e,t):null,null===n&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&endReadable(this),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){function n(e){e===s&&i()}function r(){e.end()}function i(){e.removeListener("close",d),e.removeListener("finish",o),e.removeListener("drain",p),e.removeListener("error",a),e.removeListener("unpipe",n),s.removeListener("end",r),s.removeListener("end",i),e._writableState&&!e._writableState.needDrain||p()}function a(t){l(),e.removeListener("error",a),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function d(){e.removeListener("finish",o),l()}function o(){e.removeListener("close",d),l()}function l(){s.unpipe(e)}var s=this,u=this._readableState;switch(u.pipesCount){case 0:u.pipes=e;break;case 1:u.pipes=[u.pipes,e];break;default:u.pipes.push(e)}u.pipesCount+=1;var h=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,f=h?r:i;u.endEmitted?process.nextTick(f):s.once("end",f),e.on("unpipe",n);var p=pipeOnDrain(s);return e.on("drain",p),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",d),e.once("finish",o),e.emit("pipe",s),u.flowing||(this.on("readable",pipeOnReadable),u.flowing=!0,process.nextTick(function(){flow(s)})),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=indexOf(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||emitDataEvents(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&emitReadable(this,r):this.read(0))}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var a=r.push(i);a||(n=!0,e.pause())}});for(var i in e)"function"==typeof e[i]&&"undefined"==typeof this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var a=["error","close","destroy","pause","resume"];return forEach(a,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},Readable._fromList=fromList;
}).call(this,require('_process'))

},{"_process":283,"buffer":275,"core-util-is":226,"events":279,"inherits":227,"isarray":228,"stream":295,"string_decoder/":229}],224:[function(require,module,exports){
function TransformState(r,t){this.afterTransform=function(r,e){return afterTransform(t,r,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,e){var n=r._transformState;n.transforming=!1;var a=n.writecb;if(!a)return r.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==e&&void 0!==e&&r.push(e),a&&a(t);var i=r._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&r._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r);var t=(this._transformState=new TransformState(r,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var e=r._writableState,n=(r._readableState,r._transformState);if(e.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,e){throw new Error("not implemented")},Transform.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};
},{"./_stream_duplex":222,"core-util-is":226,"inherits":227}],225:[function(require,module,exports){
(function (process){
function WriteReq(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function WritableState(e,t){e=e||{};var i=e.highWaterMark;this.highWaterMark=i||0===i?i:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=e.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable(e){var t=require("./_stream_duplex");return this instanceof Writable||this instanceof t?(this._writableState=new WritableState(e,this),this.writable=!0,void Stream.call(this)):new Writable(e)}function writeAfterEnd(e,t,i){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){i(r)})}function validChunk(e,t,i,r){var n=!0;if(!Buffer.isBuffer(i)&&"string"!=typeof i&&null!==i&&void 0!==i&&!t.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,t,i){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=new Buffer(t,i)),t}function writeOrBuffer(e,t,i,r,n){i=decodeChunk(t,i,r),Buffer.isBuffer(i)&&(r="buffer");var f=t.objectMode?1:i.length;t.length+=f;var o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing?t.buffer.push(new WriteReq(i,r,n)):doWrite(e,t,f,i,r,n),o}function doWrite(e,t,i,r,n,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1}function onwriteError(e,t,i,r,n){i?process.nextTick(function(){n(r)}):n(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(onwriteStateUpdate(i),t)onwriteError(e,i,r,t,n);else{var f=needFinish(e,i);f||i.bufferProcessing||!i.buffer.length||clearBuffer(e,i),r?process.nextTick(function(){afterWrite(e,i,f,n)}):afterWrite(e,i,f,n)}}function afterWrite(e,t,i,r){i||onwriteDrain(e,t),r(),i&&finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var r=t.buffer[i],n=r.chunk,f=r.encoding,o=r.callback,a=t.objectMode?1:n.length;if(doWrite(e,t,a,n,f,o),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}function needFinish(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function finishMaybe(e,t){var i=needFinish(e,t);return i&&(t.finished=!0,e.emit("finish")),i}function endWritable(e,t,i){t.ending=!0,finishMaybe(e,t),i&&(t.finished?process.nextTick(i):e.once("finish",i)),t.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,i){var r=this._writableState,n=!1;return"function"==typeof t&&(i=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof i&&(i=function(){}),r.ended?writeAfterEnd(this,r,i):validChunk(this,r,e,i)&&(n=writeOrBuffer(this,r,e,t,i)),n},Writable.prototype._write=function(e,t,i){i(new Error("not implemented"))},Writable.prototype.end=function(e,t,i){var r=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),"undefined"!=typeof e&&null!==e&&this.write(e,t),r.ending||r.finished||endWritable(this,r,i)};
}).call(this,require('_process'))

},{"./_stream_duplex":222,"_process":283,"buffer":275,"core-util-is":226,"inherits":227,"stream":295}],226:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||"undefined"==typeof r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;
}).call(this,require("buffer").Buffer)

},{"buffer":275}],227:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],228:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};
},{}],229:[function(require,module,exports){
function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";e=e.slice(r,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var h=t.charCodeAt(t.length-1);if(!(h>=55296&&56319>=h)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,h=t.charCodeAt(i);if(h>=55296&&56319>=h){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,i)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(2>=t&&r>>4==14){this.charLength=3;break}if(3>=t&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};
},{"buffer":275}],230:[function(require,module,exports){
module.exports=require("./lib/_stream_transform.js");
},{"./lib/_stream_transform.js":224}],231:[function(require,module,exports){
function hasKeys(e){return null!==e&&("object"==typeof e||"function"==typeof e)}module.exports=hasKeys;
},{}],232:[function(require,module,exports){
function extend(){for(var e={},r=0;r<arguments.length;r++){var s=arguments[r];if(hasKeys(s))for(var a=Keys(s),t=0;t<a.length;t++){var n=a[t];e[n]=s[n]}}return e}var Keys=require("object-keys"),hasKeys=require("./has-keys");module.exports=extend;
},{"./has-keys":231,"object-keys":234}],233:[function(require,module,exports){
var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString,isFunction=function(t){var n="function"==typeof t&&!(t instanceof RegExp)||"[object Function]"===toString.call(t);return n||"undefined"==typeof window||(n=t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt),n};module.exports=function(t,n){if(!isFunction(n))throw new TypeError("iterator must be a function");var o,e,r="string"==typeof t,i=t.length,l=arguments.length>2?arguments[2]:null;if(i===+i)for(o=0;i>o;o++)null===l?n(r?t.charAt(o):t[o],o,t):n.call(l,r?t.charAt(o):t[o],o,t);else for(e in t)hasOwn.call(t,e)&&(null===l?n(t[e],e,t):n.call(l,t[e],e,t))};
},{}],234:[function(require,module,exports){
module.exports=Object.keys||require("./shim");
},{"./shim":236}],235:[function(require,module,exports){
var toString=Object.prototype.toString;module.exports=function t(e){var o=toString.call(e),t="[object Arguments]"===o;return t||(t="[object Array]"!==o&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===toString.call(e.callee)),t};
},{}],236:[function(require,module,exports){
!function(){"use strict";var t,r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,e=require("./foreach"),n=require("./isArguments"),c=!{toString:null}.propertyIsEnumerable("toString"),p=function(){}.propertyIsEnumerable("prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];t=function(t){var i=null!==t&&"object"==typeof t,l="[object Function]"===o.call(t),s=n(t),a=[];if(!i&&!l&&!s)throw new TypeError("Object.keys called on a non-object");if(s)e(t,function(t){a.push(t)});else{var y,f=p&&l;for(y in t)f&&"prototype"===y||!r.call(t,y)||a.push(y)}if(c){var b=t.constructor,h=b&&b.prototype===t;e(u,function(o){h&&"constructor"===o||!r.call(t,o)||a.push(o)})}return a},module.exports=t}();
},{"./foreach":233,"./isArguments":235}],237:[function(require,module,exports){
function noop(r,n,t){t(null,r)}function through2(r){return function(n,t,o){return"function"==typeof n&&(o=t,t=n,n={}),"function"!=typeof t&&(t=noop),"function"!=typeof o&&(o=null),r(n,t,o)}}var Transform=require("readable-stream/transform"),inherits=require("util").inherits,xtend=require("xtend");module.exports=through2(function(r,n,t){var o=new Transform(r);return o._transform=n,t&&(o._flush=t),o}),module.exports.ctor=through2(function(r,n,t){function o(n){return this instanceof o?(this.options=xtend(r,n),void Transform.call(this,this.options)):new o(n)}return inherits(o,Transform),o.prototype._transform=n,t&&(o.prototype._flush=t),o}),module.exports.obj=through2(function(r,n,t){var o=new Transform(xtend({objectMode:!0},r));return o._transform=n,t&&(o._flush=t),o});
},{"readable-stream/transform":230,"util":298,"xtend":232}],238:[function(require,module,exports){
"use strict";function StringTransform(r,t){return this instanceof StringTransform?(t=t||{},Transform.call(this,t),this.transformFn=r,void(this.string="")):new StringTransform(r,t)}var stream=require("stream"),util=require("util"),Transform=stream.Transform||require("readable-stream").Transform;util.inherits(StringTransform,Transform),StringTransform.prototype._transform=function(r,t,n){this.string+=r.toString(),n()},StringTransform.prototype._flush=function(r){try{var t=this.transformFn(this.string);this.push(t),r()}catch(n){r(n)}};var go=module.exports=function(r){return function(t){return new StringTransform(r)}};
},{"readable-stream":248,"stream":295,"util":298}],239:[function(require,module,exports){
(function (process){
function Duplex(e){return this instanceof Duplex?(Readable.call(this,e),Writable.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(e)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;r>i;i++)t(e[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});
}).call(this,require('_process'))

},{"./_stream_readable":241,"./_stream_writable":243,"_process":283,"core-util-is":244,"inherits":245}],240:[function(require,module,exports){
function PassThrough(r){return this instanceof PassThrough?void Transform.call(this,r):new PassThrough(r)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};
},{"./_stream_transform":242,"core-util-is":244,"inherits":245}],241:[function(require,module,exports){
(function (process){
function ReadableState(e,t){var n=require("./_stream_duplex");e=e||{};var r=e.highWaterMark,i=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){require("./_stream_duplex");return this instanceof Readable?(this._readableState=new ReadableState(e,this),this.readable=!0,void Stream.call(this)):new Readable(e)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(util.isNullOrUndefined(n))t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){var d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&emitReadable(e)),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;32>t;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||util.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:0>=e?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,emitReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){resume_(e,t)}))}function resume_(e,t){t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do var n=e.read();while(null!==n&&t.flowing)}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else if(e<r[0].length){var o=r[0];n=o.slice(0,e),r[0]=o.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var l=0,u=0,s=r.length;s>u&&e>l;u++){var o=r[0],h=Math.min(e-l,o.length);a?n+=o.slice(0,h):o.copy(n,l,0,h),h<o.length?r[0]=o.slice(h):r.shift(),l+=h}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder,debug=require("util");debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return util.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=new Buffer(e,t),t="")),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){var t=this._readableState;return readableAddChunk(this,t,e,"",!0)},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,n=e;if((!util.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(e=howMuchToRead(e,t),0===e&&t.ended)return 0===t.length&&endReadable(this),null;var r=t.needReadable;debug("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,debug("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,debug("reading or ended",r)),r&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=howMuchToRead(n,t));var i;return i=e>0?fromList(e,t):null,util.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&endReadable(this),util.isNull(i)||this.emit("data",i),i},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){function n(e){debug("onunpipe"),e===s&&i()}function r(){debug("onend"),e.end()}function i(){debug("cleanup"),e.removeListener("close",o),e.removeListener("finish",l),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",n),s.removeListener("end",r),s.removeListener("end",i),s.removeListener("data",a),!h.awaitDrain||e._writableState&&!e._writableState.needDrain||c()}function a(t){debug("ondata");var n=e.write(t);!1===n&&(debug("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,s.pause())}function d(t){debug("onerror",t),u(),e.removeListener("error",d),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function o(){e.removeListener("finish",l),u()}function l(){debug("onfinish"),e.removeListener("close",o),u()}function u(){debug("unpipe"),s.unpipe(e)}var s=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,debug("pipe count=%d opts=%j",h.pipesCount,t);var f=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,b=f?r:i;h.endEmitted?process.nextTick(b):s.once("end",b),e.on("unpipe",n);var c=pipeOnDrain(s);return e.on("drain",c),s.on("data",a),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(d):e._events.error=[d,e._events.error]:e.on("error",d),e.once("close",o),e.once("finish",l),e.emit("pipe",s),h.flowing||(debug("pipe resume"),s.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=indexOf(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&emitReadable(this,r);else{var i=this;process.nextTick(function(){debug("readable nexttick read 0"),i.read(0)})}}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,e.reading||(debug("resume read 0"),this.read(0)),resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var a=r.push(i);a||(n=!0,e.pause())}});for(var i in e)util.isFunction(e[i])&&util.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var a=["error","close","destroy","pause","resume"];return forEach(a,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},r},Readable._fromList=fromList;
}).call(this,require('_process'))

},{"./_stream_duplex":239,"_process":283,"buffer":275,"core-util-is":244,"events":279,"inherits":245,"isarray":246,"stream":295,"string_decoder/":247,"util":274}],242:[function(require,module,exports){
function TransformState(r,t){this.afterTransform=function(r,n){return afterTransform(t,r,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,util.isNullOrUndefined(n)||r.push(n),i&&i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){util.isFunction(this._flush)?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;util.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))};
},{"./_stream_duplex":239,"core-util-is":244,"inherits":245}],243:[function(require,module,exports){
(function (process){
function WriteReq(e,i,t){this.chunk=e,this.encoding=i,this.callback=t}function WritableState(e,i){var t=require("./_stream_duplex");e=e||{};var r=e.highWaterMark,n=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.objectMode=!!e.objectMode,i instanceof t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=e.decodeStrings===!1;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(e){var i=require("./_stream_duplex");return this instanceof Writable||this instanceof i?(this._writableState=new WritableState(e,this),this.writable=!0,void Stream.call(this)):new Writable(e)}function writeAfterEnd(e,i,t){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){t(r)})}function validChunk(e,i,t,r){var n=!0;if(!(util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||i.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),process.nextTick(function(){r(o)}),n=!1}return n}function decodeChunk(e,i,t){return!e.objectMode&&e.decodeStrings!==!1&&util.isString(i)&&(i=new Buffer(i,t)),i}function writeOrBuffer(e,i,t,r,n){t=decodeChunk(i,t,r),util.isBuffer(t)&&(r="buffer");var o=i.objectMode?1:t.length;i.length+=o;var f=i.length<i.highWaterMark;return f||(i.needDrain=!0),i.writing||i.corked?i.buffer.push(new WriteReq(t,r,n)):doWrite(e,i,!1,o,t,r,n),f}function doWrite(e,i,t,r,n,o,f){i.writelen=r,i.writecb=f,i.writing=!0,i.sync=!0,t?e._writev(n,i.onwrite):e._write(n,o,i.onwrite),i.sync=!1}function onwriteError(e,i,t,r,n){t?process.nextTick(function(){i.pendingcb--,n(r)}):(i.pendingcb--,n(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,i){var t=e._writableState,r=t.sync,n=t.writecb;if(onwriteStateUpdate(t),i)onwriteError(e,t,r,i,n);else{var o=needFinish(e,t);o||t.corked||t.bufferProcessing||!t.buffer.length||clearBuffer(e,t),r?process.nextTick(function(){afterWrite(e,t,o,n)}):afterWrite(e,t,o,n)}}function afterWrite(e,i,t,r){t||onwriteDrain(e,i),i.pendingcb--,r(),finishMaybe(e,i)}function onwriteDrain(e,i){0===i.length&&i.needDrain&&(i.needDrain=!1,e.emit("drain"))}function clearBuffer(e,i){if(i.bufferProcessing=!0,e._writev&&i.buffer.length>1){for(var t=[],r=0;r<i.buffer.length;r++)t.push(i.buffer[r].callback);i.pendingcb++,doWrite(e,i,!0,i.length,i.buffer,"",function(e){for(var r=0;r<t.length;r++)i.pendingcb--,t[r](e)}),i.buffer=[]}else{for(var r=0;r<i.buffer.length;r++){var n=i.buffer[r],o=n.chunk,f=n.encoding,u=n.callback,s=i.objectMode?1:o.length;if(doWrite(e,i,!1,s,o,f,u),i.writing){r++;break}}r<i.buffer.length?i.buffer=i.buffer.slice(r):i.buffer.length=0}i.bufferProcessing=!1}function needFinish(e,i){return i.ending&&0===i.length&&!i.finished&&!i.writing}function prefinish(e,i){i.prefinished||(i.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,i){var t=needFinish(e,i);return t&&(0===i.pendingcb?(prefinish(e,i),i.finished=!0,e.emit("finish")):prefinish(e,i)),t}function endWritable(e,i,t){i.ending=!0,finishMaybe(e,i),t&&(i.finished?process.nextTick(t):e.once("finish",t)),i.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,i,t){var r=this._writableState,n=!1;return util.isFunction(i)&&(t=i,i=null),util.isBuffer(e)?i="buffer":i||(i=r.defaultEncoding),util.isFunction(t)||(t=function(){}),r.ended?writeAfterEnd(this,r,t):validChunk(this,r,e,t)&&(r.pendingcb++,n=writeOrBuffer(this,r,e,i,t)),n},Writable.prototype.cork=function(){var e=this._writableState;e.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||clearBuffer(this,e))},Writable.prototype._write=function(e,i,t){t(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,i,t){var r=this._writableState;util.isFunction(e)?(t=e,e=null,i=null):util.isFunction(i)&&(t=i,i=null),util.isNullOrUndefined(e)||this.write(e,i),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||endWritable(this,r,t)};
}).call(this,require('_process'))

},{"./_stream_duplex":239,"_process":283,"buffer":275,"core-util-is":244,"inherits":245,"stream":295}],244:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||"undefined"==typeof r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;
}).call(this,require("buffer").Buffer)

},{"buffer":275}],245:[function(require,module,exports){
arguments[4][227][0].apply(exports,arguments)
},{"dup":227}],246:[function(require,module,exports){
arguments[4][228][0].apply(exports,arguments)
},{"dup":228}],247:[function(require,module,exports){
arguments[4][229][0].apply(exports,arguments)
},{"buffer":275,"dup":229}],248:[function(require,module,exports){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=require("stream"),exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");
},{"./lib/_stream_duplex.js":239,"./lib/_stream_passthrough.js":240,"./lib/_stream_readable.js":241,"./lib/_stream_transform.js":242,"./lib/_stream_writable.js":243,"stream":295}],249:[function(require,module,exports){
"use strict";var findParentDir=require("find-parent-dir"),path=require("path"),go=module.exports=function(r,n,e){!function t(r){findParentDir(r,"package.json",function(a,i){if(a)return e(a);if(!i)return e();var o;try{if(o=require(path.join(i,"package.json")),n(o))return e(null,{path:path.join(i,"package.json"),pack:o});t(path.resolve(r,".."))}catch(p){e(p)}})}(r)};
},{"find-parent-dir":250,"path":282}],250:[function(require,module,exports){
"use strict";function splitPath(t){var n=t.split(/(\/|\\)/);return n.length?n[0].length?n:n.slice(1):n}var path=require("path"),fs=require("fs"),exists=fs.exists||path.exists,existsSync=fs.existsSync||path.existsSync;exports=module.exports=function(t,n,s){function i(t){if(0===t.length)return s(null,null);var e=t.join("");exists(path.join(e,n),function(n){return n?s(null,e):void i(t.slice(0,-1))})}i(splitPath(t))},exports.sync=function(t,n){function s(t){if(0===t.length)return null;var i=t.join(""),e=existsSync(path.join(i,n));return e?i:s(t.slice(0,-1))}return s(splitPath(t))};
},{"fs":273,"path":282}],251:[function(require,module,exports){
"use strict";function rangeComparator(e,r){return e.from>r.from?1:-1}function getReplacements(e,r,t){var n=new RegExp("^"+e),a=detective.find(t,{word:e,nodes:!0,parse:esprimaOpts});return a.nodes.map(function(e){var a=e.callee,o=t.slice(a.range[0],a.range[1]).replace(n,r);return{from:a.range[0],to:a.range[1],code:o}})}var detective=require("detective"),esprimaOpts={tolerant:!0,range:!0},go=module.exports=function(e,r,t){var n=t,a=new RegExp(e+" *\\(.*\\)");if(!a.test(n))return n;var o=n.match(/^#![^\n]*\n/),c=o?o[0]:"";o&&(n=n.slice(c.length));var i=0;return c+getReplacements(e,r,n).sort(rangeComparator).reduce(function(e,r){var t=r.from+i,n=r.to+i,a=r.code,o=a.length-(n-t);return i+=o,e.slice(0,t)+a+e.slice(n)},n)};
},{"detective":252}],252:[function(require,module,exports){
var esprima=require("esprima-fb"),escodegen=require("escodegen"),traverse=function(e,r){Array.isArray(e)?e.forEach(function(n){null!=n&&(n.parent=e,traverse(n,r))}):e&&"object"==typeof e&&(r(e),Object.keys(e).forEach(function(n){"parent"!==n&&e[n]&&(e[n].parent=e,traverse(e[n],r))}))},walk=function(e,r,n){var s=esprima.parse(e,r);traverse(s,n)},exports=module.exports=function(e,r){return exports.find(e,r).strings};exports.find=function(e,r){r||(r={}),r.parse=r.parse||{},r.parse.tolerant=!0;var n=void 0===r.word?"require":r.word;"string"!=typeof e&&(e=String(e)),e=e.replace(/^#![^\n]*\n/,"");var s=r.isRequire||function(e){var r=e.callee;return r&&"CallExpression"===e.type&&"Identifier"===r.type&&r.name===n},t={strings:[],expressions:[]};return r.nodes&&(t.nodes=[]),-1==e.indexOf(n)?t:(walk(e,r.parse,function(e){s(e)&&(e.arguments.length&&("Literal"===e.arguments[0].type?t.strings.push(e.arguments[0].value):t.expressions.push(escodegen.generate(e.arguments[0]))),r.nodes&&t.nodes.push(e))}),t)};
},{"escodegen":253,"esprima-fb":264}],253:[function(require,module,exports){
(function (global){
!function(){"use strict";function e(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:"\n",space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1,parenthesizedComprehensionBlock:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,verbatim:null}}function n(e,n){var t="";for(n|=0;n>0;n>>>=1,e+=e)1&n&&(t+=e);return t}function t(e){return/[\r\n]/g.test(e)}function a(e){var n=e.length;return n&&N.code.isLineTerminator(e.charCodeAt(n-1))}function r(e,n){function t(e){return"object"==typeof e&&e instanceof Object&&!(e instanceof RegExp)}var a,o;for(a in n)n.hasOwnProperty(a)&&(o=n[a],t(o)?t(e[a])?r(e[a],o):e[a]=r({},o):e[a]=o);return e}function o(e){var n,t,a,r,o;if(e!==e)throw new Error("Numeric literal whose value is NaN");if(0>e||0===e&&0>1/e)throw new Error("Numeric literal whose value is negative");if(e===1/0)return z?"null":W?"1e400":"1e+400";if(n=""+e,!W||n.length<3)return n;for(t=n.indexOf("."),z||48!==n.charCodeAt(0)||1!==t||(t=0,n=n.slice(1)),a=n,n=n.replace("e+","e"),r=0,(o=a.indexOf("e"))>0&&(r=+a.slice(o+1),a=a.slice(0,o)),t>=0&&(r-=a.length-t-1,a=+(a.slice(0,t)+a.slice(t+1))+""),o=0;48===a.charCodeAt(a.length+o-1);)--o;return 0!==o&&(r-=o,a=a.slice(0,o)),0!==r&&(a+="e"+r),(a.length<n.length||V&&e>1e12&&Math.floor(e)===e&&(a="0x"+e.toString(16)).length<n.length)&&+a===e&&(n=a),n}function l(e,n){return 8232===(-2&e)?(n?"u":"\\u")+(8232===e?"2028":"2029"):10===e||13===e?(n?"":"\\")+(10===e?"n":"r"):String.fromCharCode(e)}function i(e){var n,t,a,r,o,i,s,c;if(t=e.toString(),e.source){if(n=t.match(/\/([^/]*)$/),!n)return t;for(a=n[1],t="",s=!1,c=!1,r=0,o=e.source.length;o>r;++r)i=e.source.charCodeAt(r),c?(t+=l(i,c),c=!1):(s?93===i&&(s=!1):47===i?t+="\\":91===i&&(s=!0),t+=l(i,c),c=92===i);return"/"+t+"/"+a}return t}function s(e,n){var t,a="\\";switch(e){case 8:a+="b";break;case 12:a+="f";break;case 9:a+="t";break;default:t=e.toString(16).toUpperCase(),a+=z||e>255?"u"+"0000".slice(t.length)+t:0!==e||N.code.isDecimalDigit(n)?11===e?"x0B":"x"+"00".slice(t.length)+t:"0"}return a}function c(e){var n="\\";switch(e){case 92:n+="\\";break;case 10:n+="n";break;case 13:n+="r";break;case 8232:n+="u2028";break;case 8233:n+="u2029";break;default:throw new Error("Incorrectly classified character")}return n}function p(e){var n,t,a,r;for(r="double"===H?'"':"'",n=0,t=e.length;t>n;++n){if(a=e.charCodeAt(n),39===a){r='"';break}if(34===a){r="'";break}92===a&&++n}return r+e+r}function u(e){var n,t,a,r,o,l="",i=0,p=0;for(n=0,t=e.length;t>n;++n){if(a=e.charCodeAt(n),39===a)++i;else if(34===a)++p;else if(47===a&&z)l+="\\";else{if(N.code.isLineTerminator(a)||92===a){l+=c(a);continue}if(z&&32>a||!(z||G||a>=32&&126>=a)){l+=s(a,e.charCodeAt(n+1));continue}}l+=String.fromCharCode(a)}if(r=!("double"===H||"auto"===H&&i>p),o=r?"'":'"',!(r?i:p))return o+l+o;for(e=l,l=o,n=0,t=e.length;t>n;++n)a=e.charCodeAt(n),(39===a&&r||34===a&&!r)&&(l+="\\"),l+=String.fromCharCode(a);return l+o}function h(e){var n,t,a,r="";for(n=0,t=e.length;t>n;++n)a=e[n],r+=T(a)?h(a):a;return r}function d(e,n){if(!ee)return T(e)?h(e):e;if(null==n){if(e instanceof M)return e;n={}}return null==n.loc?new M(null,null,ee,e,n.name||null):new M(n.loc.start.line,n.loc.start.column,ee===!0?n.loc.source||null:ee,e,n.name||null)}function m(){return X?X:" "}function f(e,n){var t=d(e).toString(),a=d(n).toString(),r=t.charCodeAt(t.length-1),o=a.charCodeAt(0);return(43===r||45===r)&&r===o||N.code.isIdentifierPart(r)&&N.code.isIdentifierPart(o)||47===r&&105===o?[e,m(),n]:N.code.isWhiteSpace(r)||N.code.isLineTerminator(r)||N.code.isWhiteSpace(o)||N.code.isLineTerminator(o)?[e,n]:[e,X,n]}function w(e){return[U,e]}function g(e){var n,t;return n=U,U+=j,t=e.call(this,U),U=n,t}function b(e){var n;for(n=e.length-1;n>=0&&!N.code.isLineTerminator(e.charCodeAt(n));--n);return e.length-1-n}function S(e,n){var t,a,r,o,l,i,s,c;for(t=e.split(/\r\n|[\r\n]/),i=Number.MAX_VALUE,a=1,r=t.length;r>a;++a){for(o=t[a],l=0;l<o.length&&N.code.isWhiteSpace(o.charCodeAt(l));)++l;i>l&&(i=l)}for("undefined"!=typeof n?(s=U,"*"===t[1][i]&&(n+=" "),U=n):(1&i&&--i,s=U),a=1,r=t.length;r>a;++a)c=d(w(t[a].slice(i))),t[a]=ee?c.join(""):c;return U=s,t.join("\n")}function C(e,n){return"Line"===e.type?a(e.value)?"//"+e.value:"//"+e.value+"\n":Q.format.indent.adjustMultilineComment&&/[\n\r]/.test(e.value)?S("/*"+e.value+"*/",n):"/*"+e.value+"*/"}function y(e,t){var r,o,l,i,s,c,p;if(e.leadingComments&&e.leadingComments.length>0){for(i=t,l=e.leadingComments[0],t=[],J&&e.type===F.Program&&0===e.body.length&&t.push("\n"),t.push(C(l)),a(d(t).toString())||t.push("\n"),r=1,o=e.leadingComments.length;o>r;++r)l=e.leadingComments[r],p=[C(l)],a(d(p).toString())||p.push("\n"),t.push(w(p));t.push(w(i))}if(e.trailingComments)for(s=!a(d(t).toString()),c=n(" ",b(d([U,t,j]).toString())),r=0,o=e.trailingComments.length;o>r;++r)l=e.trailingComments[r],s?(t=0===r?[t,j]:[t,c],t.push(C(l,c))):t=[t,w(C(l))],r===o-1||a(d(t).toString())||(t=[t,"\n"]);return t}function x(e,n,t){return t>n?["(",e,")"]:e}function k(e,n,t){var a,r;return r=!Q.comment||!e.leadingComments,e.type===F.BlockStatement&&r?[X,B(e,{functionBody:t})]:e.type===F.EmptyStatement&&r?";":(g(function(){a=[Y,w(B(e,{semicolonOptional:n,functionBody:t}))]}),a)}function E(e,n){var t=a(d(n).toString());return e.type!==F.BlockStatement||Q.comment&&e.leadingComments||t?t?[n,U]:[n,Y,U]:[n,X]}function I(e,n){var t,a;for(a=e[Q.verbatim].split(/\r\n|\n/),t=1;t<a.length;t++)a[t]=Y+U+a[t];return a=x(a,P.Sequence,n.precedence),d(a,e)}function A(e){return d(e.name,e)}function v(e,n){var t;return t=e.type===F.Identifier?A(e):D(e,{precedence:n.precedence,allowIn:n.allowIn,allowCall:!0})}function q(e){var n,t,a,r,o;if(o=e.type===F.ArrowFunctionExpression,o&&1===e.params.length&&e.params[0].type===F.Identifier)n=[A(e.params[0])];else{for(n=["("],t=0,a=e.params.length;a>t;++t)n.push(v(e.params[t],{precedence:P.Assignment,allowIn:!0})),a>t+1&&n.push(","+X);n.push(")")}return o&&n.push(X,"=>"),e.expression?(n.push(X),r=D(e.body,{precedence:P.Assignment,allowIn:!0,allowCall:!0}),"{"===r.toString().charAt(0)&&(r=["(",r,")"]),n.push(r)):n.push(k(e.body,!1,!0)),n}function D(e,n){var r,l,s,c,p,h,w,b,S,C,y,k,E,v,O,M,R;if(l=n.precedence,E=n.allowIn,v=n.allowCall,s=e.type||n.type,Q.verbatim&&e.hasOwnProperty(Q.verbatim))return I(e,n);switch(s){case F.SequenceExpression:for(r=[],E|=P.Sequence<l,p=0,h=e.expressions.length;h>p;++p)r.push(D(e.expressions[p],{precedence:P.Assignment,allowIn:E,allowCall:!0})),h>p+1&&r.push(","+X);r=x(r,P.Sequence,l);break;case F.AssignmentExpression:E|=P.Assignment<l,r=x([D(e.left,{precedence:P.Call,allowIn:E,allowCall:!0}),X+e.operator+X,D(e.right,{precedence:P.Assignment,allowIn:E,allowCall:!0})],P.Assignment,l);break;case F.ArrowFunctionExpression:E|=P.ArrowFunction<l,r=x(q(e),P.ArrowFunction,l);break;case F.ConditionalExpression:E|=P.Conditional<l,r=x([D(e.test,{precedence:P.LogicalOR,allowIn:E,allowCall:!0}),X+"?"+X,D(e.consequent,{precedence:P.Assignment,allowIn:E,allowCall:!0}),X+":"+X,D(e.alternate,{precedence:P.Assignment,allowIn:E,allowCall:!0})],P.Conditional,l);break;case F.LogicalExpression:case F.BinaryExpression:c=L[e.operator],E|=l>c,b=D(e.left,{precedence:c,allowIn:E,allowCall:!0}),y=b.toString(),r=47===y.charCodeAt(y.length-1)&&N.code.isIdentifierPart(e.operator.charCodeAt(0))?[b,m(),e.operator]:f(b,e.operator),b=D(e.right,{precedence:c+1,allowIn:E,allowCall:!0}),"/"===e.operator&&"/"===b.toString().charAt(0)||"<"===e.operator.slice(-1)&&"!--"===b.toString().slice(0,3)?r.push(m(),b):r=f(r,b),r="in"!==e.operator||E?x(r,c,l):["(",r,")"];break;case F.CallExpression:for(r=[D(e.callee,{precedence:P.Call,allowIn:!0,allowCall:!0,allowUnparenthesizedNew:!1})],r.push("("),p=0,h=e.arguments.length;h>p;++p)r.push(D(e.arguments[p],{precedence:P.Assignment,allowIn:!0,allowCall:!0})),h>p+1&&r.push(","+X);r.push(")"),r=v?x(r,P.Call,l):["(",r,")"];break;case F.NewExpression:if(h=e.arguments.length,O=void 0===n.allowUnparenthesizedNew||n.allowUnparenthesizedNew,r=f("new",D(e.callee,{precedence:P.New,allowIn:!0,allowCall:!1,allowUnparenthesizedNew:O&&!$&&0===h})),!O||$||h>0){for(r.push("("),p=0;h>p;++p)r.push(D(e.arguments[p],{precedence:P.Assignment,allowIn:!0,allowCall:!0})),h>p+1&&r.push(","+X);r.push(")")}r=x(r,P.New,l);break;case F.MemberExpression:r=[D(e.object,{precedence:P.Call,allowIn:!0,allowCall:v,allowUnparenthesizedNew:!1})],e.computed?r.push("[",D(e.property,{precedence:P.Sequence,allowIn:!0,allowCall:v}),"]"):(e.object.type===F.Literal&&"number"==typeof e.object.value&&(b=d(r).toString(),b.indexOf(".")<0&&!/[eExX]/.test(b)&&N.code.isDecimalDigit(b.charCodeAt(b.length-1))&&!(b.length>=2&&48===b.charCodeAt(0))&&r.push(".")),r.push(".",A(e.property))),r=x(r,P.Member,l);break;case F.UnaryExpression:b=D(e.argument,{precedence:P.Unary,allowIn:!0,allowCall:!0}),""===X?r=f(e.operator,b):(r=[e.operator],e.operator.length>2?r=f(r,b):(y=d(r).toString(),C=y.charCodeAt(y.length-1),k=b.toString().charCodeAt(0),(43===C||45===C)&&C===k||N.code.isIdentifierPart(C)&&N.code.isIdentifierPart(k)?r.push(m(),b):r.push(b))),r=x(r,P.Unary,l);break;case F.YieldExpression:r=e.delegate?"yield*":"yield",e.argument&&(r=f(r,D(e.argument,{precedence:P.Yield,allowIn:!0,allowCall:!0}))),r=x(r,P.Yield,l);break;case F.UpdateExpression:r=e.prefix?x([e.operator,D(e.argument,{precedence:P.Unary,allowIn:!0,allowCall:!0})],P.Unary,l):x([D(e.argument,{precedence:P.Postfix,allowIn:!0,allowCall:!0}),e.operator],P.Postfix,l);break;case F.FunctionExpression:R=e.generator&&!Q.moz.starlessGenerator,r=R?"function*":"function",r=e.id?[r,R?X:m(),A(e.id),q(e)]:[r+X,q(e)];break;case F.ArrayPattern:case F.ArrayExpression:if(!e.elements.length){r="[]";break}S=e.elements.length>1,r=["[",S?Y:""],g(function(n){for(p=0,h=e.elements.length;h>p;++p)e.elements[p]?r.push(S?n:"",D(e.elements[p],{precedence:P.Assignment,allowIn:!0,allowCall:!0})):(S&&r.push(n),p+1===h&&r.push(",")),h>p+1&&r.push(","+(S?Y:X))}),S&&!a(d(r).toString())&&r.push(Y),r.push(S?U:"","]");break;case F.Property:"get"===e.kind||"set"===e.kind?r=[e.kind,m(),D(e.key,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),q(e.value)]:e.shorthand?r=D(e.key,{precedence:P.Sequence,allowIn:!0,allowCall:!0}):e.method?(r=[],e.value.generator&&r.push("*"),r.push(D(e.key,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),q(e.value))):r=[D(e.key,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),":"+X,D(e.value,{precedence:P.Assignment,allowIn:!0,allowCall:!0})];break;case F.ObjectExpression:if(!e.properties.length){r="{}";break}if(S=e.properties.length>1,g(function(){b=D(e.properties[0],{precedence:P.Sequence,allowIn:!0,allowCall:!0,type:F.Property})}),!S&&!t(d(b).toString())){r=["{",X,b,X,"}"];break}g(function(n){if(r=["{",Y,n,b],S)for(r.push(","+Y),p=1,h=e.properties.length;h>p;++p)r.push(n,D(e.properties[p],{precedence:P.Sequence,allowIn:!0,allowCall:!0,type:F.Property})),h>p+1&&r.push(","+Y)}),a(d(r).toString())||r.push(Y),r.push(U,"}");break;case F.ObjectPattern:if(!e.properties.length){r="{}";break}if(S=!1,1===e.properties.length)M=e.properties[0],M.value.type!==F.Identifier&&(S=!0);else for(p=0,h=e.properties.length;h>p;++p)if(M=e.properties[p],!M.shorthand){S=!0;break}r=["{",S?Y:""],g(function(n){for(p=0,h=e.properties.length;h>p;++p)r.push(S?n:"",D(e.properties[p],{precedence:P.Sequence,allowIn:!0,allowCall:!0})),h>p+1&&r.push(","+(S?Y:X))}),S&&!a(d(r).toString())&&r.push(Y),r.push(S?U:"","}");break;case F.ThisExpression:r="this";break;case F.Identifier:r=A(e);break;case F.Literal:if(e.hasOwnProperty("raw")&&Z)try{if(w=Z(e.raw).body[0].expression,w.type===F.Literal&&w.value===e.value){r=e.raw;break}}catch(T){}if(null===e.value){r="null";break}if("string"==typeof e.value){r=u(e.value);break}if("number"==typeof e.value){r=o(e.value);break}if("boolean"==typeof e.value){r=e.value?"true":"false";break}r=i(e.value);break;case F.GeneratorExpression:case F.ComprehensionExpression:r=s===F.GeneratorExpression?["("]:["["],Q.moz.comprehensionExpressionStartsWithAssignment&&(b=D(e.body,{precedence:P.Assignment,allowIn:!0,allowCall:!0}),r.push(b)),e.blocks&&g(function(){for(p=0,h=e.blocks.length;h>p;++p)b=D(e.blocks[p],{precedence:P.Sequence,allowIn:!0,allowCall:!0}),p>0||Q.moz.comprehensionExpressionStartsWithAssignment?r=f(r,b):r.push(b)}),e.filter&&(r=f(r,"if"+X),b=D(e.filter,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),r=Q.moz.parenthesizedComprehensionBlock?f(r,["(",b,")"]):f(r,b)),Q.moz.comprehensionExpressionStartsWithAssignment||(b=D(e.body,{precedence:P.Assignment,allowIn:!0,allowCall:!0}),r=f(r,b)),r.push(s===F.GeneratorExpression?")":"]");break;case F.ComprehensionBlock:b=e.left.type===F.VariableDeclaration?[e.left.kind,m(),B(e.left.declarations[0],{allowIn:!1})]:D(e.left,{precedence:P.Call,allowIn:!0,allowCall:!0}),b=f(b,e.of?"of":"in"),b=f(b,D(e.right,{precedence:P.Sequence,allowIn:!0,allowCall:!0})),r=Q.moz.parenthesizedComprehensionBlock?["for"+X+"(",b,")"]:f("for"+X,b);break;default:throw new Error("Unknown expression type: "+e.type)}return d(r,e)}function B(e,n){var t,r,o,l,i,s,c,u,h,b;switch(i=!0,h=";",s=!1,c=!1,n&&(i=void 0===n.allowIn||n.allowIn,_||n.semicolonOptional!==!0||(h=""),s=n.functionBody,c=n.directiveContext),e.type){case F.BlockStatement:o=["{",Y],g(function(){for(t=0,r=e.body.length;r>t;++t)u=w(B(e.body[t],{semicolonOptional:t===r-1,directiveContext:s})),o.push(u),a(d(u).toString())||o.push(Y)}),o.push(w("}"));break;case F.BreakStatement:o=e.label?"break "+e.label.name+h:"break"+h;break;case F.ContinueStatement:o=e.label?"continue "+e.label.name+h:"continue"+h;break;case F.DirectiveStatement:o=e.raw?e.raw+h:p(e.directive)+h;break;case F.DoWhileStatement:o=f("do",k(e.body)),o=E(e.body,o),o=f(o,["while"+X+"(",D(e.test,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"+h]);break;case F.CatchClause:g(function(){var n;o=["catch"+X+"(",D(e.param,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"],e.guard&&(n=D(e.guard,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),o.splice(2,0," if ",n))}),o.push(k(e.body));break;case F.DebuggerStatement:o="debugger"+h;break;case F.EmptyStatement:o=";";break;case F.ExportDeclaration:if(o="export ",e.declaration){o=[o,B(e.declaration,{semicolonOptional:""===h})];break}break;case F.ExpressionStatement:o=[D(e.expression,{precedence:P.Sequence,allowIn:!0,allowCall:!0})],u=d(o).toString(),"{"===u.charAt(0)||"function"===u.slice(0,8)&&"* (".indexOf(u.charAt(8))>=0||K&&c&&e.expression.type===F.Literal&&"string"==typeof e.expression.value?o=["(",o,")"+h]:o.push(h);break;case F.VariableDeclarator:o=e.init?[D(e.id,{precedence:P.Assignment,allowIn:i,allowCall:!0}),X,"=",X,D(e.init,{precedence:P.Assignment,allowIn:i,allowCall:!0})]:v(e.id,{precedence:P.Assignment,allowIn:i});break;case F.VariableDeclaration:o=[e.kind],1===e.declarations.length&&e.declarations[0].init&&e.declarations[0].init.type===F.FunctionExpression?o.push(m(),B(e.declarations[0],{allowIn:i})):g(function(){for(l=e.declarations[0],Q.comment&&l.leadingComments?o.push("\n",w(B(l,{allowIn:i}))):o.push(m(),B(l,{allowIn:i})),t=1,r=e.declarations.length;r>t;++t)l=e.declarations[t],Q.comment&&l.leadingComments?o.push(","+Y,w(B(l,{allowIn:i}))):o.push(","+X,B(l,{allowIn:i}))}),o.push(h);break;case F.ThrowStatement:o=[f("throw",D(e.argument,{precedence:P.Sequence,allowIn:!0,allowCall:!0})),h];break;case F.TryStatement:if(o=["try",k(e.block)],o=E(e.block,o),e.handlers)for(t=0,r=e.handlers.length;r>t;++t)o=f(o,B(e.handlers[t])),(e.finalizer||t+1!==r)&&(o=E(e.handlers[t].body,o));else{for(e.guardedHandlers=e.guardedHandlers||[],t=0,r=e.guardedHandlers.length;r>t;++t)o=f(o,B(e.guardedHandlers[t])),(e.finalizer||t+1!==r)&&(o=E(e.guardedHandlers[t].body,o));if(e.handler)if(T(e.handler))for(t=0,r=e.handler.length;r>t;++t)o=f(o,B(e.handler[t])),(e.finalizer||t+1!==r)&&(o=E(e.handler[t].body,o));else o=f(o,B(e.handler)),e.finalizer&&(o=E(e.handler.body,o))}e.finalizer&&(o=f(o,["finally",k(e.finalizer)]));break;case F.SwitchStatement:if(g(function(){o=["switch"+X+"(",D(e.discriminant,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"+X+"{"+Y]}),e.cases)for(t=0,r=e.cases.length;r>t;++t)u=w(B(e.cases[t],{semicolonOptional:t===r-1})),o.push(u),a(d(u).toString())||o.push(Y);o.push(w("}"));break;case F.SwitchCase:g(function(){for(o=e.test?[f("case",D(e.test,{precedence:P.Sequence,allowIn:!0,allowCall:!0})),":"]:["default:"],t=0,r=e.consequent.length,r&&e.consequent[0].type===F.BlockStatement&&(u=k(e.consequent[0]),o.push(u),t=1),t===r||a(d(o).toString())||o.push(Y);r>t;++t)u=w(B(e.consequent[t],{semicolonOptional:t===r-1&&""===h})),o.push(u),t+1===r||a(d(u).toString())||o.push(Y)});break;case F.IfStatement:g(function(){o=["if"+X+"(",D(e.test,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"]}),e.alternate?(o.push(k(e.consequent)),o=E(e.consequent,o),o=e.alternate.type===F.IfStatement?f(o,["else ",B(e.alternate,{semicolonOptional:""===h})]):f(o,f("else",k(e.alternate,""===h)))):o.push(k(e.consequent,""===h));break;case F.ForStatement:g(function(){o=["for"+X+"("],e.init?e.init.type===F.VariableDeclaration?o.push(B(e.init,{allowIn:!1})):o.push(D(e.init,{precedence:P.Sequence,allowIn:!1,allowCall:!0}),";"):o.push(";"),e.test?o.push(X,D(e.test,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),";"):o.push(";"),e.update?o.push(X,D(e.update,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"):o.push(")")}),o.push(k(e.body,""===h));break;case F.ForInStatement:o=["for"+X+"("],g(function(){e.left.type===F.VariableDeclaration?g(function(){o.push(e.left.kind+m(),B(e.left.declarations[0],{allowIn:!1}))}):o.push(D(e.left,{precedence:P.Call,allowIn:!0,allowCall:!0})),o=f(o,"in"),o=[f(o,D(e.right,{precedence:P.Sequence,allowIn:!0,allowCall:!0})),")"]}),o.push(k(e.body,""===h));break;case F.LabeledStatement:o=[e.label.name+":",k(e.body,""===h)];break;case F.Program:for(r=e.body.length,o=[J&&r>0?"\n":""],t=0;r>t;++t)u=w(B(e.body[t],{semicolonOptional:!J&&t===r-1,directiveContext:!0})),o.push(u),r>t+1&&!a(d(u).toString())&&o.push(Y);break;case F.FunctionDeclaration:b=e.generator&&!Q.moz.starlessGenerator,o=[b?"function*":"function",b?X:m(),A(e.id),q(e)];break;case F.ReturnStatement:o=e.argument?[f("return",D(e.argument,{precedence:P.Sequence,allowIn:!0,allowCall:!0})),h]:["return"+h];break;case F.WhileStatement:g(function(){o=["while"+X+"(",D(e.test,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"]}),o.push(k(e.body,""===h));break;case F.WithStatement:g(function(){o=["with"+X+"(",D(e.object,{precedence:P.Sequence,allowIn:!0,allowCall:!0}),")"]}),o.push(k(e.body,""===h));break;default:throw new Error("Unknown statement type: "+e.type)}return Q.comment&&(o=y(e,o)),u=d(o).toString(),e.type!==F.Program||J||""!==Y||"\n"!==u.charAt(u.length-1)||(o=ee?d(o).replaceRight(/\s+$/,""):u.replace(/\s+$/,"")),d(o,e)}function O(t,a){var o,l,i=e();switch(null!=a?("string"==typeof a.indent&&(i.format.indent.style=a.indent),"number"==typeof a.base&&(i.format.indent.base=a.base),a=r(i,a),j=a.format.indent.style,U="string"==typeof a.base?a.base:n(j,a.format.indent.base)):(a=i,j=a.format.indent.style,U=n(j,a.format.indent.base)),z=a.format.json,W=a.format.renumber,V=z?!1:a.format.hexadecimal,H=z?"double":a.format.quotes,G=a.format.escapeless,Y=a.format.newline,X=a.format.space,a.format.compact&&(Y=X=j=U=""),$=a.format.parentheses,_=a.format.semicolons,J=a.format.safeConcatenation,K=a.directive,Z=z?null:a.parse,ee=a.sourceMap,Q=a,ee&&(M=exports.browser?global.sourceMap.SourceNode:require("source-map").SourceNode),t.type){case F.BlockStatement:case F.BreakStatement:case F.CatchClause:case F.ContinueStatement:case F.DirectiveStatement:case F.DoWhileStatement:case F.DebuggerStatement:case F.EmptyStatement:case F.ExpressionStatement:case F.ForStatement:case F.ForInStatement:case F.FunctionDeclaration:case F.IfStatement:case F.LabeledStatement:case F.Program:case F.ReturnStatement:case F.SwitchStatement:case F.SwitchCase:case F.ThrowStatement:case F.TryStatement:case F.VariableDeclaration:case F.VariableDeclarator:case F.WhileStatement:case F.WithStatement:o=B(t);break;case F.AssignmentExpression:case F.ArrayExpression:case F.ArrayPattern:case F.BinaryExpression:case F.CallExpression:case F.ConditionalExpression:case F.FunctionExpression:case F.Identifier:case F.Literal:case F.LogicalExpression:case F.MemberExpression:case F.NewExpression:case F.ObjectExpression:case F.ObjectPattern:case F.Property:case F.SequenceExpression:case F.ThisExpression:case F.UnaryExpression:case F.UpdateExpression:case F.YieldExpression:o=D(t,{precedence:P.Sequence,allowIn:!0,allowCall:!0});break;default:throw new Error("Unknown node type: "+t.type)}return ee?(l=o.toStringWithSourceMap({file:a.file,sourceRoot:a.sourceMapRoot}),a.sourceContent&&l.map.setSourceContent(a.sourceMap,a.sourceContent),a.sourceMapWithCode?l:l.map.toString()):o.toString()}var F,P,L,M,R,N,T,U,j,z,W,V,H,G,Y,X,$,_,J,K,Q,Z,ee,ne,te;R=require("estraverse"),N=require("esutils"),F={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},P={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Unary:13,Postfix:14,Call:15,New:16,Member:17,Primary:18},L={"||":P.LogicalOR,"&&":P.LogicalAND,"|":P.BitwiseOR,"^":P.BitwiseXOR,"&":P.BitwiseAND,"==":P.Equality,"!=":P.Equality,"===":P.Equality,"!==":P.Equality,is:P.Equality,isnt:P.Equality,"<":P.Relational,">":P.Relational,"<=":P.Relational,">=":P.Relational,"in":P.Relational,"instanceof":P.Relational,"<<":P.BitwiseSHIFT,">>":P.BitwiseSHIFT,">>>":P.BitwiseSHIFT,"+":P.Additive,"-":P.Additive,"*":P.Multiplicative,"%":P.Multiplicative,"/":P.Multiplicative},T=Array.isArray,T||(T=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),ne={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},te=e().format,exports.version=require("./package.json").version,exports.generate=O,exports.attachComments=R.attachComments,exports.browser=!1,exports.FORMAT_MINIFY=ne,exports.FORMAT_DEFAULTS=te}();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./package.json":263,"estraverse":254,"esutils":257,"source-map":258}],254:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.estraverse={})}(this,function(e){"use strict";function t(){}function n(e){var t,r,i={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],"object"==typeof r&&null!==r?i[t]=n(r):i[t]=r);return i}function r(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function i(e,t){var n,r,i,s;for(r=e.length,i=0;r;)n=r>>>1,s=i+n,t(e[s])?r=n:(i=s+1,r-=n+1);return i}function s(e,t){var n,r,i,s;for(r=e.length,i=0;r;)n=r>>>1,s=i+n,t(e[s])?(i=s+1,r-=n+1):r=n;return i}function a(e,t){this.parent=e,this.key=t}function o(e,t,n,r){this.node=e,this.path=t,this.wrap=n,this.ref=r}function l(){}function p(e,t){var n=new l;return n.traverse(e,t)}function u(e,t){var n=new l;return n.replace(e,t)}function h(e,t){var n;return n=i(t,function(t){return t.range[0]>e.range[0]}),e.extendedRange=[e.range[0],e.range[1]],n!==t.length&&(e.extendedRange[1]=t[n].range[0]),n-=1,n>=0&&(e.extendedRange[0]=t[n].range[1]),e}function c(e,t,r){var i,s,a,o,l=[];if(!e.range)throw new Error("attachComments needs range information");if(!r.length){if(t.length){for(a=0,s=t.length;s>a;a+=1)i=n(t[a]),i.extendedRange=[0,e.range[0]],l.push(i);e.leadingComments=l}return e}for(a=0,s=t.length;s>a;a+=1)l.push(h(n(t[a]),r));return o=0,p(e,{enter:function(e){for(var t;o<l.length&&(t=l[o],!(t.extendedRange[1]>e.range[0]));)t.extendedRange[1]===e.range[0]?(e.leadingComments||(e.leadingComments=[]),e.leadingComments.push(t),l.splice(o,1)):o+=1;return o===l.length?f.Break:l[o].extendedRange[0]>e.range[1]?f.Skip:void 0}}),o=0,p(e,{leave:function(e){for(var t;o<l.length&&(t=l[o],!(e.range[1]<t.extendedRange[0]));)e.range[1]===t.extendedRange[0]?(e.trailingComments||(e.trailingComments=[]),e.trailingComments.push(t),l.splice(o,1)):o+=1;return o===l.length?f.Break:l[o].extendedRange[0]>e.range[1]?f.Skip:void 0}}),e}var m,d,f,g,x,y;m={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},d=Array.isArray,d||(d=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t(r),t(s),g={AssignmentExpression:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","defaults","rest","body"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","body","superClass"],ClassExpression:["id","body","superClass"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","defaults","rest","body"],FunctionExpression:["id","params","defaults","rest","body"],Identifier:[],IfStatement:["test","consequent","alternate"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MethodDefinition:["key","value"],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handlers","handler","guardedHandlers","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},x={},y={},f={Break:x,Skip:y},a.prototype.replace=function(e){this.parent[this.key]=e},l.prototype.path=function(){function e(e,t){if(d(t))for(r=0,i=t.length;i>r;++r)e.push(t[r]);else e.push(t)}var t,n,r,i,s,a;if(!this.__current.path)return null;for(s=[],t=2,n=this.__leavelist.length;n>t;++t)a=this.__leavelist[t],e(s,a.path);return e(s,this.__current.path),s},l.prototype.parents=function(){var e,t,n;for(n=[],e=1,t=this.__leavelist.length;t>e;++e)n.push(this.__leavelist[e].node);return n},l.prototype.current=function(){return this.__current.node},l.prototype.__execute=function(e,t){var n,r;return r=void 0,n=this.__current,this.__current=t,this.__state=null,e&&(r=e.call(this,t.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=n,r},l.prototype.notify=function(e){this.__state=e},l.prototype.skip=function(){this.notify(y)},l.prototype["break"]=function(){this.notify(x)},l.prototype.__initialize=function(e,t){this.visitor=t,this.root=e,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null},l.prototype.traverse=function(e,t){var n,r,i,s,a,l,p,u,h,c,f,_;for(this.__initialize(e,t),_={},n=this.__worklist,r=this.__leavelist,n.push(new o(e,null,null,null)),r.push(new o(null,null,null,null));n.length;)if(i=n.pop(),i!==_){if(i.node){if(l=this.__execute(t.enter,i),this.__state===x||l===x)return;if(n.push(_),r.push(i),this.__state===y||l===y)continue;for(s=i.node,a=i.wrap||s.type,c=g[a],u=c.length;(u-=1)>=0;)if(p=c[u],f=s[p])if(d(f))for(h=f.length;(h-=1)>=0;)f[h]&&(i=a!==m.ObjectExpression&&a!==m.ObjectPattern||"properties"!==c[u]?new o(f[h],[p,h],null,null):new o(f[h],[p,h],"Property",null),n.push(i));else n.push(new o(f,p,null,null))}}else if(i=r.pop(),l=this.__execute(t.leave,i),this.__state===x||l===x)return},l.prototype.replace=function(e,t){var n,r,i,s,l,p,u,h,c,f,_,S,E;for(this.__initialize(e,t),_={},n=this.__worklist,r=this.__leavelist,S={root:e},p=new o(e,null,null,new a(S,"root")),n.push(p),r.push(p);n.length;)if(p=n.pop(),p!==_){if(l=this.__execute(t.enter,p),void 0!==l&&l!==x&&l!==y&&(p.ref.replace(l),p.node=l),this.__state===x||l===x)return S.root;if(i=p.node,i&&(n.push(_),r.push(p),this.__state!==y&&l!==y))for(s=p.wrap||i.type,c=g[s],u=c.length;(u-=1)>=0;)if(E=c[u],f=i[E])if(d(f))for(h=f.length;(h-=1)>=0;)f[h]&&(p=s===m.ObjectExpression&&"properties"===c[u]?new o(f[h],[E,h],"Property",new a(f,h)):new o(f[h],[E,h],null,new a(f,h)),n.push(p));else n.push(new o(f,E,null,new a(i,E)))}else if(p=r.pop(),l=this.__execute(t.leave,p),void 0!==l&&l!==x&&l!==y&&p.ref.replace(l),this.__state===x||l===x)return S.root;return S.root},e.version="1.5.1-dev",e.Syntax=m,e.traverse=p,e.replace=u,e.attachComments=c,e.VisitorKeys=g,e.VisitorOption=f,e.Controller=l});
},{}],255:[function(require,module,exports){
!function(){"use strict";function i(i){return i>=48&&57>=i}function t(t){return i(t)||t>=97&&102>=t||t>=65&&70>=t}function n(i){return i>=48&&55>=i}function e(i){return 32===i||9===i||11===i||12===i||160===i||i>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(i)>=0}function r(i){return 10===i||13===i||8232===i||8233===i}function o(i){return 36===i||95===i||i>=65&&90>=i||i>=97&&122>=i||92===i||i>=128&&u.NonAsciiIdentifierStart.test(String.fromCharCode(i))}function f(i){return 36===i||95===i||i>=65&&90>=i||i>=97&&122>=i||i>=48&&57>=i||92===i||i>=128&&u.NonAsciiIdentifierPart.test(String.fromCharCode(i))}var u;u={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},module.exports={isDecimalDigit:i,isHexDigit:t,isOctalDigit:n,isWhiteSpace:e,isLineTerminator:r,isIdentifierStart:o,isIdentifierPart:f}}();
},{}],256:[function(require,module,exports){
!function(){"use strict";function e(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function t(e,t){return t||"yield"!==e?r(e,t):!1}function r(t,r){if(r&&e(t))return!0;switch(t.length){case 2:return"if"===t||"in"===t||"do"===t;case 3:return"var"===t||"for"===t||"new"===t||"try"===t;case 4:return"this"===t||"else"===t||"case"===t||"void"===t||"with"===t||"enum"===t;case 5:return"while"===t||"break"===t||"catch"===t||"throw"===t||"const"===t||"yield"===t||"class"===t||"super"===t;case 6:return"return"===t||"typeof"===t||"delete"===t||"switch"===t||"export"===t||"import"===t;case 7:return"default"===t||"finally"===t||"extends"===t;case 8:return"function"===t||"continue"===t||"debugger"===t;case 10:return"instanceof"===t;default:return!1}}function n(e){return"eval"===e||"arguments"===e}function i(e){var t,r,n;if(0===e.length)return!1;if(n=e.charCodeAt(0),!c.isIdentifierStart(n)||92===n)return!1;for(t=1,r=e.length;r>t;++t)if(n=e.charCodeAt(t),!c.isIdentifierPart(n)||92===n)return!1;return!0}var c=require("./code");module.exports={isKeywordES5:t,isKeywordES6:r,isRestrictedWord:n,isIdentifierName:i}}();
},{"./code":255}],257:[function(require,module,exports){
!function(){"use strict";exports.code=require("./code"),exports.keyword=require("./keyword")}();
},{"./code":255,"./keyword":256}],258:[function(require,module,exports){
arguments[4][212][0].apply(exports,arguments)
},{"./source-map/source-map-consumer":259,"./source-map/source-map-generator":260,"./source-map/source-node":261,"dup":212}],259:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(e,n,r){function t(e){var n=e;"string"==typeof e&&(n=JSON.parse(e.replace(/^\)\]\}'/,"")));var r=i.getArg(n,"version"),t=i.getArg(n,"sources"),o=i.getArg(n,"names",[]),s=i.getArg(n,"sourceRoot",null),l=i.getArg(n,"sourcesContent",null),u=i.getArg(n,"mappings"),g=i.getArg(n,"file",null);if(r!=this._version)throw new Error("Unsupported version: "+r);t=t.map(i.normalize),this._names=a.fromArray(o,!0),this._sources=a.fromArray(t,!0),this.sourceRoot=s,this.sourcesContent=l,this._mappings=u,this.file=g}var i=e("./util"),o=e("./binary-search"),a=e("./array-set").ArraySet,s=e("./base64-vlq");t.fromSourceMap=function(e){var n=Object.create(t.prototype);return n._names=a.fromArray(e._names.toArray(),!0),n._sources=a.fromArray(e._sources.toArray(),!0),n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n.__generatedMappings=e._mappings.toArray().slice(),n.__originalMappings=e._mappings.toArray().slice().sort(i.compareByOriginalPositions),n},t.prototype._version=3,Object.defineProperty(t.prototype,"sources",{get:function(){return this._sources.toArray().map(function(e){return null!=this.sourceRoot?i.join(this.sourceRoot,e):e},this)}}),t.prototype.__generatedMappings=null,Object.defineProperty(t.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),t.prototype.__originalMappings=null,Object.defineProperty(t.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),t.prototype._nextCharIsMappingSeparator=function(e){var n=e.charAt(0);return";"===n||","===n},t.prototype._parseMappings=function(e,n){for(var r,t=1,o=0,a=0,l=0,u=0,g=0,p=e,c={};p.length>0;)if(";"===p.charAt(0))t++,p=p.slice(1),o=0;else if(","===p.charAt(0))p=p.slice(1);else{if(r={},r.generatedLine=t,s.decode(p,c),r.generatedColumn=o+c.value,o=r.generatedColumn,p=c.rest,p.length>0&&!this._nextCharIsMappingSeparator(p)){if(s.decode(p,c),r.source=this._sources.at(u+c.value),u+=c.value,p=c.rest,0===p.length||this._nextCharIsMappingSeparator(p))throw new Error("Found a source, but no line and column");if(s.decode(p,c),r.originalLine=a+c.value,a=r.originalLine,r.originalLine+=1,p=c.rest,0===p.length||this._nextCharIsMappingSeparator(p))throw new Error("Found a source and line, but no column");s.decode(p,c),r.originalColumn=l+c.value,l=r.originalColumn,p=c.rest,p.length>0&&!this._nextCharIsMappingSeparator(p)&&(s.decode(p,c),r.name=this._names.at(g+c.value),g+=c.value,p=c.rest)}this.__generatedMappings.push(r),"number"==typeof r.originalLine&&this.__originalMappings.push(r)}this.__generatedMappings.sort(i.compareByGeneratedPositions),this.__originalMappings.sort(i.compareByOriginalPositions)},t.prototype._findMapping=function(e,n,r,t,i){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[t]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[t]);return o.search(e,n,i)},t.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var n=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(n.generatedLine===r.generatedLine){n.lastGeneratedColumn=r.generatedColumn-1;continue}}n.lastGeneratedColumn=1/0}},t.prototype.originalPositionFor=function(e){var n={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=this._findMapping(n,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositions);if(r>=0){var t=this._generatedMappings[r];if(t.generatedLine===n.generatedLine){var o=i.getArg(t,"source",null);return null!=o&&null!=this.sourceRoot&&(o=i.join(this.sourceRoot,o)),{source:o,line:i.getArg(t,"originalLine",null),column:i.getArg(t,"originalColumn",null),name:i.getArg(t,"name",null)}}}return{source:null,line:null,column:null,name:null}},t.prototype.sourceContentFor=function(e){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(e=i.relative(this.sourceRoot,e)),this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];var n;if(null!=this.sourceRoot&&(n=i.urlParse(this.sourceRoot))){var r=e.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(r))return this.sourcesContent[this._sources.indexOf(r)];if((!n.path||"/"==n.path)&&this._sources.has("/"+e))return this.sourcesContent[this._sources.indexOf("/"+e)]}throw new Error('"'+e+'" is not in the SourceMap.')},t.prototype.generatedPositionFor=function(e){var n={source:i.getArg(e,"source"),originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")};null!=this.sourceRoot&&(n.source=i.relative(this.sourceRoot,n.source));var r=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions);if(r>=0){var t=this._originalMappings[r];return{line:i.getArg(t,"generatedLine",null),column:i.getArg(t,"generatedColumn",null),lastColumn:i.getArg(t,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.prototype.allGeneratedPositionsFor=function(e){var n={source:i.getArg(e,"source"),originalLine:i.getArg(e,"line"),originalColumn:1/0};null!=this.sourceRoot&&(n.source=i.relative(this.sourceRoot,n.source));var r=[],t=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions);if(t>=0)for(var o=this._originalMappings[t];o&&o.originalLine===n.originalLine;)r.push({line:i.getArg(o,"generatedLine",null),column:i.getArg(o,"generatedColumn",null),lastColumn:i.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[--t];return r.reverse()},t.GENERATED_ORDER=1,t.ORIGINAL_ORDER=2,t.prototype.eachMapping=function(e,n,r){var o,a=n||null,s=r||t.GENERATED_ORDER;switch(s){case t.GENERATED_ORDER:o=this._generatedMappings;break;case t.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var l=this.sourceRoot;o.map(function(e){var n=e.source;return null!=n&&null!=l&&(n=i.join(l,n)),{source:n,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:e.name}}).forEach(e,a)},n.SourceMapConsumer=t});
},{"amdefine":262}],260:[function(require,module,exports){
arguments[4][214][0].apply(exports,arguments)
},{"amdefine":262,"dup":214}],261:[function(require,module,exports){
arguments[4][215][0].apply(exports,arguments)
},{"amdefine":262,"dup":215}],262:[function(require,module,exports){
(function (process,__filename){
"use strict";function amdefine(r,n){function e(r){var n,e;for(n=0;r[n];n+=1)if(e=r[n],"."===e)r.splice(n,1),n-=1;else if(".."===e){if(1===n&&(".."===r[2]||".."===r[0]))break;n>0&&(r.splice(n-1,2),n-=2)}}function t(r,n){var t;return r&&"."===r.charAt(0)&&n&&(t=n.split("/"),t=t.slice(0,t.length-1),t=t.concat(r.split("/")),e(t),r=t.join("/")),r}function i(r){return function(n){return t(n,r)}}function o(r){function n(n){p[r]=n}return n.fromText=function(r,n){throw new Error("amdefine does not implement load.fromText")},n}function u(e,t,i){var o,u,f,l;if(e)u=p[e]={},f={id:e,uri:__filename,exports:u},o=a(n,u,f,e);else{if(s)throw new Error("amdefine with no module ID cannot be called more than once per file.");s=!0,u=r.exports,f=r,o=a(n,u,f,r.id)}t&&(t=t.map(function(r){return o(r)})),l="function"==typeof i?i.apply(f.exports,t):i,void 0!==l&&(f.exports=l,e&&(p[e]=f.exports))}function f(r,n,e){Array.isArray(r)?(e=n,n=r,r=void 0):"string"!=typeof r&&(e=r,r=n=void 0),n&&!Array.isArray(n)&&(e=n,n=void 0),n||(n=["require","exports","module"]),r?c[r]=[r,n,e]:u(r,n,e)}var a,l,c={},p={},s=!1,d=require("path");return a=function(r,n,e,i){function o(t,o){return"string"==typeof t?l(r,n,e,t,i):(t=t.map(function(t){return l(r,n,e,t,i)}),void(o&&process.nextTick(function(){o.apply(null,t)})))}return o.toUrl=function(r){return 0===r.indexOf(".")?t(r,d.dirname(e.filename)):r},o},n=n||function(){return r.require.apply(r,arguments)},l=function(r,n,e,f,s){var d,m,x=f.indexOf("!"),y=f;if(-1===x){if(f=t(f,s),"require"===f)return a(r,n,e,s);if("exports"===f)return n;if("module"===f)return e;if(p.hasOwnProperty(f))return p[f];if(c[f])return u.apply(null,c[f]),p[f];if(r)return r(y);throw new Error("No module with ID: "+f)}return d=f.substring(0,x),f=f.substring(x+1,f.length),m=l(r,n,e,d,s),f=m.normalize?m.normalize(f,i(s)):t(f,s),p[f]?p[f]:(m.load(f,a(r,n,e,s),o(f),{}),p[f])},f.require=function(r){return p[r]?p[r]:c[r]?(u.apply(null,c[r]),p[r]):void 0},f.amd={},f}module.exports=amdefine;
}).call(this,require('_process'),"/node_modules/browserify-shim/node_modules/rename-function-calls/node_modules/detective/node_modules/escodegen/node_modules/source-map/node_modules/amdefine/amdefine.js")

},{"_process":283,"path":282}],263:[function(require,module,exports){
module.exports={"name":"escodegen","description":"ECMAScript code generator","homepage":"http://github.com/Constellation/escodegen","main":"escodegen.js","bin":{"esgenerate":"./bin/esgenerate.js","escodegen":"./bin/escodegen.js"},"version":"1.1.0","engines":{"node":">=0.4.0"},"maintainers":[{"name":"constellation","email":"utatane.tea@gmail.com"}],"repository":{"type":"git","url":"git+ssh://git@github.com/Constellation/escodegen.git"},"dependencies":{"esprima":"~1.0.4","estraverse":"~1.5.0","esutils":"~1.0.0","source-map":"~0.1.30"},"optionalDependencies":{"source-map":"~0.1.30"},"devDependencies":{"esprima-moz":"*","commonjs-everywhere":"~0.8.0","q":"*","bower":"*","semver":"*","chai":"~1.7.2","grunt-contrib-jshint":"~0.5.0","grunt-cli":"~0.1.9","grunt":"~0.4.1","grunt-mocha-test":"~0.6.2"},"licenses":[{"type":"BSD","url":"http://github.com/Constellation/escodegen/raw/master/LICENSE.BSD"}],"scripts":{"test":"grunt travis","unit-test":"grunt test","lint":"grunt lint","release":"node tools/release.js","build-min":"cjsify -ma path: tools/entry-point.js > escodegen.browser.min.js","build":"cjsify -a path: tools/entry-point.js > escodegen.browser.js"},"bugs":{"url":"https://github.com/Constellation/escodegen/issues"},"_id":"escodegen@1.1.0","dist":{"shasum":"c663923f6e20aad48d0c0fa49f31c6d4f49360cf","tarball":"http://registry.npmjs.org/escodegen/-/escodegen-1.1.0.tgz"},"_from":"escodegen@>=1.1.0 <1.2.0","_npmVersion":"1.3.21","_npmUser":{"name":"constellation","email":"utatane.tea@gmail.com"},"directories":{},"_shasum":"c663923f6e20aad48d0c0fa49f31c6d4f49360cf","_resolved":"https://registry.npmjs.org/escodegen/-/escodegen-1.1.0.tgz","readme":"ERROR: No README data found!"}
},{}],264:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.esprima={})}(this,function(e){"use strict";function t(e,t){if(!e)throw new Error("ASSERT: "+t)}function r(e){return e>=48&&57>=e}function n(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function a(e){return"01234567".indexOf(e)>=0}function i(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&" ᠎             　\ufeff".indexOf(String.fromCharCode(e))>0}function o(e){return 10===e||13===e||8232===e||8233===e}function s(e){return 36===e||95===e||e>=65&&90>=e||e>=97&&122>=e||92===e||e>=128&&sr.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function l(e){return 36===e||95===e||e>=65&&90>=e||e>=97&&122>=e||e>=48&&57>=e||92===e||e>=128&&sr.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function c(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function u(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function p(e){return"eval"===e||"arguments"===e}function d(e){if(dr&&u(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}function f(){var e,t,r;for(t=!1,r=!1;gr>fr;)if(e=pr.charCodeAt(fr),r)++fr,o(e)&&(r=!1,13===e&&10===pr.charCodeAt(fr)&&++fr,++mr,yr=fr);else if(t)o(e)?(13===e&&10===pr.charCodeAt(fr+1)&&++fr,++mr,++fr,yr=fr,fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL")):(e=pr.charCodeAt(fr++),fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL"),42===e&&(e=pr.charCodeAt(fr),47===e&&(++fr,t=!1)));else if(47===e)if(e=pr.charCodeAt(fr+1),47===e)fr+=2,r=!0;else{if(42!==e)break;fr+=2,t=!0,fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL")}else if(i(e))++fr;else{if(!o(e))break;++fr,13===e&&10===pr.charCodeAt(fr)&&++fr,++mr,yr=fr}}function m(e){var t,r,a,i=0;for(r="u"===e?4:2,t=0;r>t;++t){if(!(gr>fr&&n(pr[fr])))return"";a=pr[fr++],i=16*i+"0123456789abcdef".indexOf(a.toLowerCase())}return String.fromCharCode(i)}function y(){var e,t,r,a;for(e=pr[fr],t=0,"}"===e&&D({},or.UnexpectedToken,"ILLEGAL");gr>fr&&(e=pr[fr++],n(e));)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&D({},or.UnexpectedToken,"ILLEGAL"),65535>=t?String.fromCharCode(t):(r=(t-65536>>10)+55296,a=(t-65536&1023)+56320,String.fromCharCode(r,a))}function g(){var e,t;for(e=pr.charCodeAt(fr++),t=String.fromCharCode(e),92===e&&(117!==pr.charCodeAt(fr)&&D({},or.UnexpectedToken,"ILLEGAL"),++fr,e=m("u"),e&&"\\"!==e&&s(e.charCodeAt(0))||D({},or.UnexpectedToken,"ILLEGAL"),t=e);gr>fr&&(e=pr.charCodeAt(fr),l(e));)++fr,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==pr.charCodeAt(fr)&&D({},or.UnexpectedToken,"ILLEGAL"),++fr,e=m("u"),e&&"\\"!==e&&l(e.charCodeAt(0))||D({},or.UnexpectedToken,"ILLEGAL"),t+=e);return t}function S(){var e,t;for(e=fr++;gr>fr;){if(t=pr.charCodeAt(fr),92===t)return fr=e,g();if(!l(t))break;++fr}return pr.slice(e,fr)}function h(){var e,t,r;return e=fr,t=92===pr.charCodeAt(fr)?g():S(),r=1===t.length?tr.Identifier:d(t)?tr.Keyword:"null"===t?tr.NullLiteral:"true"===t||"false"===t?tr.BooleanLiteral:tr.Identifier,{type:r,value:t,lineNumber:mr,lineStart:yr,range:[e,fr]}}function x(){var e,t,r,n,a=fr,i=pr.charCodeAt(fr),o=pr[fr];switch(i){case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++fr,Er.tokenize&&(40===i?Er.openParenToken=Er.tokens.length:123===i&&(Er.openCurlyToken=Er.tokens.length)),{type:tr.Punctuator,value:String.fromCharCode(i),lineNumber:mr,lineStart:yr,range:[a,fr]};default:if(e=pr.charCodeAt(fr+1),61===e)switch(i){case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:return fr+=2,{type:tr.Punctuator,value:String.fromCharCode(i)+String.fromCharCode(e),lineNumber:mr,lineStart:yr,range:[a,fr]};case 33:case 61:return fr+=2,61===pr.charCodeAt(fr)&&++fr,{type:tr.Punctuator,value:pr.slice(a,fr),lineNumber:mr,lineStart:yr,range:[a,fr]}}}return t=pr[fr+1],r=pr[fr+2],n=pr[fr+3],">"===o&&">"===t&&">"===r&&"="===n?(fr+=4,{type:tr.Punctuator,value:">>>=",lineNumber:mr,lineStart:yr,range:[a,fr]}):">"===o&&">"===t&&">"===r?(fr+=3,{type:tr.Punctuator,value:">>>",lineNumber:mr,lineStart:yr,range:[a,fr]}):"<"===o&&"<"===t&&"="===r?(fr+=3,{type:tr.Punctuator,value:"<<=",lineNumber:mr,lineStart:yr,range:[a,fr]}):">"===o&&">"===t&&"="===r?(fr+=3,{type:tr.Punctuator,value:">>=",lineNumber:mr,lineStart:yr,range:[a,fr]}):"."===o&&"."===t&&"."===r?(fr+=3,{type:tr.Punctuator,value:"...",lineNumber:mr,lineStart:yr,range:[a,fr]}):o===t&&"+-<>&|".indexOf(o)>=0?(fr+=2,{type:tr.Punctuator,value:o+t,lineNumber:mr,lineStart:yr,range:[a,fr]}):"="===o&&">"===t?(fr+=2,{type:tr.Punctuator,value:"=>",lineNumber:mr,lineStart:yr,range:[a,fr]}):"<>=!+-*%&|^/".indexOf(o)>=0?(++fr,{type:tr.Punctuator,value:o,lineNumber:mr,lineStart:yr,range:[a,fr]}):"."===o?(++fr,{type:tr.Punctuator,value:o,lineNumber:mr,lineStart:yr,range:[a,fr]}):void D({},or.UnexpectedToken,"ILLEGAL")}function E(e){for(var t="";gr>fr&&n(pr[fr]);)t+=pr[fr++];return 0===t.length&&D({},or.UnexpectedToken,"ILLEGAL"),s(pr.charCodeAt(fr))&&D({},or.UnexpectedToken,"ILLEGAL"),{type:tr.NumericLiteral,value:parseInt("0x"+t,16),lineNumber:mr,lineStart:yr,range:[e,fr]}}function v(e,t){var n,i;for(a(e)?(i=!0,n="0"+pr[fr++]):(i=!1,++fr,n="");gr>fr&&a(pr[fr]);)n+=pr[fr++];return i||0!==n.length||D({},or.UnexpectedToken,"ILLEGAL"),(s(pr.charCodeAt(fr))||r(pr.charCodeAt(fr)))&&D({},or.UnexpectedToken,"ILLEGAL"),{type:tr.NumericLiteral,value:parseInt(n,8),octal:i,lineNumber:mr,lineStart:yr,range:[t,fr]}}function b(){var e,n,i;if(i=pr[fr],t(r(i.charCodeAt(0))||"."===i,"Numeric literal must start with a decimal digit or a decimal point"),n=fr,e="","."!==i){if(e=pr[fr++],i=pr[fr],"0"===e){if("x"===i||"X"===i)return++fr,E(n);if("b"===i||"B"===i){for(++fr,e="";gr>fr&&(i=pr[fr],"0"===i||"1"===i);)e+=pr[fr++];return 0===e.length&&D({},or.UnexpectedToken,"ILLEGAL"),gr>fr&&(i=pr.charCodeAt(fr),(s(i)||r(i))&&D({},or.UnexpectedToken,"ILLEGAL")),{type:tr.NumericLiteral,value:parseInt(e,2),lineNumber:mr,lineStart:yr,range:[n,fr]}}if("o"===i||"O"===i||a(i))return v(i,n);i&&r(i.charCodeAt(0))&&D({},or.UnexpectedToken,"ILLEGAL")}for(;r(pr.charCodeAt(fr));)e+=pr[fr++];i=pr[fr]}if("."===i){for(e+=pr[fr++];r(pr.charCodeAt(fr));)e+=pr[fr++];i=pr[fr]}if("e"===i||"E"===i)if(e+=pr[fr++],i=pr[fr],"+"!==i&&"-"!==i||(e+=pr[fr++]),r(pr.charCodeAt(fr)))for(;r(pr.charCodeAt(fr));)e+=pr[fr++];else D({},or.UnexpectedToken,"ILLEGAL");return s(pr.charCodeAt(fr))&&D({},or.UnexpectedToken,"ILLEGAL"),{type:tr.NumericLiteral,value:parseFloat(e),lineNumber:mr,lineStart:yr,range:[n,fr]}}function C(){var e,r,n,i,s,l,c="",u=!1;for(e=pr[fr],t("'"===e||'"'===e,"String literal must starts with a quote"),r=fr,++fr;gr>fr;){if(n=pr[fr++],n===e){e="";break}if("\\"===n)if(n=pr[fr++],n&&o(n.charCodeAt(0)))++mr,"\r"===n&&"\n"===pr[fr]&&++fr;else switch(n){case"n":c+="\n";break;case"r":c+="\r";break;case"t":c+="	";break;case"u":case"x":"{"===pr[fr]?(++fr,c+=y()):(l=fr,s=m(n),s?c+=s:(fr=l,c+=n));break;case"b":c+="\b";break;case"f":c+="\f";break;case"v":c+="\x0B";break;default:a(n)?(i="01234567".indexOf(n),0!==i&&(u=!0),gr>fr&&a(pr[fr])&&(u=!0,i=8*i+"01234567".indexOf(pr[fr++]),"0123".indexOf(n)>=0&&gr>fr&&a(pr[fr])&&(i=8*i+"01234567".indexOf(pr[fr++]))),c+=String.fromCharCode(i)):c+=n}else{if(o(n.charCodeAt(0)))break;c+=n}}return""!==e&&D({},or.UnexpectedToken,"ILLEGAL"),{type:tr.StringLiteral,value:c,octal:u,lineNumber:mr,lineStart:yr,range:[r,fr]}}function I(){var e,t,r,n,i,s,l,c,u="";for(r=!1,n=!1,t=fr,++fr;gr>fr;){if(e=pr[fr++],"`"===e){n=!0,r=!0;break}if("$"===e){if("{"===pr[fr]){++fr,r=!0;break}u+=e}else if("\\"===e)if(e=pr[fr++],o(e.charCodeAt(0)))++mr,"\r"===e&&"\n"===pr[fr]&&++fr;else switch(e){case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="	";break;case"u":case"x":"{"===pr[fr]?(++fr,u+=y()):(i=fr,s=m(e),s?u+=s:(fr=i,u+=e));break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\x0B";break;default:a(e)?(l="01234567".indexOf(e),0!==l&&(c=!0),gr>fr&&a(pr[fr])&&(c=!0,l=8*l+"01234567".indexOf(pr[fr++]),"0123".indexOf(e)>=0&&gr>fr&&a(pr[fr])&&(l=8*l+"01234567".indexOf(pr[fr++]))),u+=String.fromCharCode(l)):u+=e}else o(e.charCodeAt(0))?(++mr,"\r"===e&&"\n"===pr[fr]&&++fr,u+="\n"):u+=e}return r||D({},or.UnexpectedToken,"ILLEGAL"),{type:tr.Template,value:{cooked:u,raw:pr.slice(t+1,fr-(n?1:2))},tail:n,octal:c,lineNumber:mr,lineStart:yr,range:[t,fr]}}function A(e){var t,r;return hr=null,f(),t=e.head?"`":"}",pr[fr]!==t&&D({},or.UnexpectedToken,"ILLEGAL"),r=I(),O(),r}function w(){var e,r,n,a,i,s,c,u=!1,p=!1;for(hr=null,f(),n=fr,r=pr[fr],t("/"===r,"Regular expression literal must start with a slash"),e=pr[fr++];gr>fr;)if(r=pr[fr++],e+=r,u)"]"===r&&(u=!1);else if("\\"===r)r=pr[fr++],o(r.charCodeAt(0))&&D({},or.UnterminatedRegExp),e+=r;else{if("/"===r){p=!0;break}"["===r?u=!0:o(r.charCodeAt(0))&&D({},or.UnterminatedRegExp)}for(p||D({},or.UnterminatedRegExp),a=e.substr(1,e.length-2),i="";gr>fr&&(r=pr[fr],l(r.charCodeAt(0)));)if(++fr,"\\"===r&&gr>fr)if(r=pr[fr],"u"===r)if(++fr,c=fr,r=m("u"))for(i+=r,e+="\\u";fr>c;++c)e+=pr[c];else fr=c,i+="u",e+="\\u";else e+="\\";else i+=r,e+=r;try{s=new RegExp(a,i)}catch(d){D({},or.InvalidRegExp)}return O(),Er.tokenize?{type:tr.RegularExpression,value:s,lineNumber:mr,lineStart:yr,range:[n,fr]}:{literal:e,value:s,range:[n,fr]}}function L(e){return e.type===tr.Identifier||e.type===tr.Keyword||e.type===tr.BooleanLiteral||e.type===tr.NullLiteral}function k(){var e,t;if(e=Er.tokens[Er.tokens.length-1],!e)return w();if("Punctuator"===e.type){if(")"===e.value)return t=Er.tokens[Er.openParenToken-1],!t||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?x():w();if("}"===e.value){if(Er.tokens[Er.openCurlyToken-3]&&"Keyword"===Er.tokens[Er.openCurlyToken-3].type){if(t=Er.tokens[Er.openCurlyToken-4],!t)return x()}else{if(!Er.tokens[Er.openCurlyToken-4]||"Keyword"!==Er.tokens[Er.openCurlyToken-4].type)return x();if(t=Er.tokens[Er.openCurlyToken-5],!t)return w()}return nr.indexOf(t.value)>=0?x():w()}return w()}return"Keyword"===e.type?w():x()}function T(){var e;return xr.inXJSChild||f(),fr>=gr?{type:tr.EOF,lineNumber:mr,lineStart:yr,range:[fr,fr]}:xr.inXJSChild?Pt():(e=pr.charCodeAt(fr),40===e||41===e||58===e?x():39===e||34===e?xr.inXJSTag?Tt():C():xr.inXJSTag&&It(e)?wt():96===e?I():s(e)?h():46===e?r(pr.charCodeAt(fr+1))?b():x():r(e)?b():Er.tokenize&&47===e?k():x())}function P(){var e;return e=hr,fr=e.range[1],mr=e.lineNumber,yr=e.lineStart,hr=T(),fr=e.range[1],mr=e.lineNumber,yr=e.lineStart,e}function O(){var e,t,r;e=fr,t=mr,r=yr,hr=T(),fr=e,mr=t,yr=r}function X(){var e,t,r,n,a;return e="function"==typeof Er.advance?Er.advance:T,t=fr,r=mr,n=yr,null===hr&&(hr=e()),fr=hr.range[1],mr=hr.lineNumber,yr=hr.lineStart,a=e(),fr=t,mr=r,yr=n,a}function J(){var e,t,r,n;return e=fr,t=mr,r=yr,f(),n=mr!==t,fr=e,mr=t,yr=r,n}function D(e,r){var n,a=Array.prototype.slice.call(arguments,2),i=r.replace(/%(\d)/g,function(e,r){return t(r<a.length,"Message reference must be in range"),a[r]});throw"number"==typeof e.lineNumber?(n=new Error("Line "+e.lineNumber+": "+i),n.index=e.range[0],n.lineNumber=e.lineNumber,n.column=e.range[0]-yr+1):(n=new Error("Line "+mr+": "+i),n.index=fr,n.lineNumber=mr,n.column=fr-yr+1),n.description=i,n}function N(){try{D.apply(null,arguments)}catch(e){if(!Er.errors)throw e;Er.errors.push(e)}}function F(e){if(e.type===tr.EOF&&D(e,or.UnexpectedEOS),e.type===tr.NumericLiteral&&D(e,or.UnexpectedNumber),e.type!==tr.StringLiteral&&e.type!==tr.XJSText||D(e,or.UnexpectedString),e.type===tr.Identifier&&D(e,or.UnexpectedIdentifier),e.type===tr.Keyword){if(c(e.value))D(e,or.UnexpectedReserved);else if(dr&&u(e.value))return void N(e,or.StrictReservedWord);D(e,or.UnexpectedToken,e.value)}e.type===tr.Template&&D(e,or.UnexpectedTemplate,e.value.raw),D(e,or.UnexpectedToken,e.value)}function U(e){var t=P();t.type===tr.Punctuator&&t.value===e||F(t)}function B(e){var t=P();t.type===tr.Keyword&&t.value===e||F(t)}function R(e){return hr.type===tr.Punctuator&&hr.value===e}function M(e){return hr.type===tr.Keyword&&hr.value===e}function j(e){return hr.type===tr.Identifier&&hr.value===e}function G(){var e;return hr.type!==tr.Punctuator?!1:(e=hr.value,"="===e||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}function q(){var e;return 59===pr.charCodeAt(fr)?void P():(e=mr,f(),mr===e?R(";")?void P():void(hr.type===tr.EOF||R("}")||F(hr)):void 0)}function K(e){return e.type===ar.Identifier||e.type===ar.MemberExpression}function V(e){return K(e)||e.type===ar.ObjectPattern||e.type===ar.ArrayPattern}function z(){var e,t=[],r=[],n=null,a=!0;for(U("[");!R("]");)"for"===hr.value&&hr.type===tr.Keyword?(a||D({},or.ComprehensionError),M("for"),e=Ge({ignoreBody:!0}),e.of=e.type===ar.ForOfStatement,e.type=ar.ComprehensionBlock,e.left.kind&&D({},or.ComprehensionError),r.push(e)):"if"===hr.value&&hr.type===tr.Keyword?(a||D({},or.ComprehensionError),B("if"),U("("),n=Ee(),U(")")):","===hr.value&&hr.type===tr.Punctuator?(a=!1,P(),t.push(null)):(e=ne(),t.push(e),e&&e.type===ar.SpreadElement?R("]")||D({},or.ElementAfterSpreadElement):R("]")||M("for")||M("if")||(U(","),a=!1));return U("]"),n&&!r.length&&D({},or.ComprehensionRequiresBlock),r.length?(1!==t.length&&D({},or.ComprehensionError),{type:ar.ComprehensionExpression,filter:n,blocks:r,body:t[0]}):Sr.createArrayExpression(t)}function H(e){var t,r,n,a,i;return t=dr,r=xr.yieldAllowed,xr.yieldAllowed=e.generator,n=e.params||[],a=e.defaults||[],i=et(),e.name&&dr&&p(n[0].name)&&N(e.name,or.StrictParamName),xr.yieldAllowed&&!xr.yieldFound&&N({},or.NoYieldInGenerator),dr=t,xr.yieldAllowed=r,Sr.createFunctionExpression(null,n,a,i,e.rest||null,e.generator,i.type!==ar.BlockStatement,e.returnTypeAnnotation)}function W(e){var t,r,n;return t=dr,dr=!0,r=at(),r.stricted&&N(r.stricted,r.message),n=H({params:r.params,defaults:r.defaults,rest:r.rest,generator:e.generator,returnTypeAnnotation:r.returnTypeAnnotation}),dr=t,n}function Y(){var e=P();return e.type===tr.StringLiteral||e.type===tr.NumericLiteral?(dr&&e.octal&&N(e,or.StrictOctalLiteral),Sr.createLiteral(e)):Sr.createIdentifier(e.value)}function $(){var e,t,r,n;return e=hr,e.type===tr.Identifier?(r=Y(),"get"!==e.value||R(":")||R("(")?"set"!==e.value||R(":")||R("(")?R(":")?(P(),Sr.createProperty("init",r,xe(),!1,!1)):R("(")?Sr.createProperty("init",r,W({generator:!1}),!0,!1):Sr.createProperty("init",r,r,!1,!0):(t=Y(),U("("),e=hr,n=[Ae()],U(")"),Sr.createProperty("set",t,H({params:n,generator:!1,name:e}),!1,!1)):(t=Y(),U("("),U(")"),Sr.createProperty("get",t,H({generator:!1}),!1,!1))):e.type===tr.EOF||e.type===tr.Punctuator?(R("*")||F(e),P(),r=Y(),R("(")||F(P()),Sr.createProperty("init",r,W({generator:!0}),!0,!1)):(t=Y(),R(":")?(P(),Sr.createProperty("init",t,xe(),!1,!1)):R("(")?Sr.createProperty("init",t,W({generator:!1}),!0,!1):void F(P()))}function Z(){var e,t,r,n,a=[],i={},o=String;for(U("{");!R("}");)e=$(),t=e.key.type===ar.Identifier?e.key.name:o(e.key.value),n="init"===e.kind?ir.Data:"get"===e.kind?ir.Get:ir.Set,r="$"+t,Object.prototype.hasOwnProperty.call(i,r)?(i[r]===ir.Data?dr&&n===ir.Data?N({},or.StrictDuplicateProperty):n!==ir.Data&&N({},or.AccessorDataProperty):n===ir.Data?N({},or.AccessorDataProperty):i[r]&n&&N({},or.AccessorGetSet),i[r]|=n):i[r]=n,a.push(e),R("}")||U(",");return U("}"),Sr.createObjectExpression(a)}function Q(e){var t=A(e);return dr&&t.octal&&D(t,or.StrictOctalLiteral),Sr.createTemplateElement({raw:t.value.raw,cooked:t.value.cooked},t.tail)}function _(){var e,t,r;for(e=Q({head:!0}),t=[e],r=[];!e.tail;)r.push(Ee()),e=Q({head:!1}),t.push(e);return Sr.createTemplateLiteral(t,r)}function ee(){var e;return U("("),++xr.parenthesizedCount,e=Ee(),U(")"),e}function te(){var e,t;if(t=hr,e=hr.type,e===tr.Identifier)return P(),Sr.createIdentifier(t.value);if(e===tr.StringLiteral||e===tr.NumericLiteral)return dr&&hr.octal&&N(hr,or.StrictOctalLiteral),Sr.createLiteral(P());if(e===tr.Keyword){if(M("this"))return P(),Sr.createThisExpression();if(M("function"))return ot();if(M("class"))return pt();if(M("super"))return P(),Sr.createIdentifier("super")}return e===tr.BooleanLiteral?(t=P(),t.value="true"===t.value,Sr.createLiteral(t)):e===tr.NullLiteral?(t=P(),t.value=null,Sr.createLiteral(t)):R("[")?z():R("{")?Z():R("(")?ee():R("/")||R("/=")?Sr.createLiteral(w()):e===tr.Template?_():R("<")?Rt():F(P())}function re(){var e,t=[];if(U("("),!R(")"))for(;gr>fr&&(e=ne(),t.push(e),!R(")"));)e.type===ar.SpreadElement&&D({},or.ElementAfterSpreadElement),U(",");return U(")"),t}function ne(){return R("...")?(P(),Sr.createSpreadElement(xe())):xe()}function ae(){var e=P();return L(e)||F(e),Sr.createIdentifier(e.value)}function ie(){return U("."),ae()}function oe(){var e;return U("["),e=Ee(),U("]"),e}function se(){var e,t;return B("new"),e=ce(),t=R("(")?re():[],Sr.createNewExpression(e,t)}function le(){var e,t;for(e=M("new")?se():te();R(".")||R("[")||R("(")||hr.type===tr.Template;)R("(")?(t=re(),e=Sr.createCallExpression(e,t)):e=R("[")?Sr.createMemberExpression("[",e,oe()):R(".")?Sr.createMemberExpression(".",e,ie()):Sr.createTaggedTemplateExpression(e,_());return e}function ce(){var e;for(e=M("new")?se():te();R(".")||R("[")||hr.type===tr.Template;)e=R("[")?Sr.createMemberExpression("[",e,oe()):R(".")?Sr.createMemberExpression(".",e,ie()):Sr.createTaggedTemplateExpression(e,_());return e}function ue(){var e=le(),t=hr;return hr.type!==tr.Punctuator?e:(!R("++")&&!R("--")||J()||(dr&&e.type===ar.Identifier&&p(e.name)&&N({},or.StrictLHSPostfix),K(e)||D({},or.InvalidLHSInAssignment),t=P(),e=Sr.createPostfixExpression(t.value,e)),e)}function pe(){var e,t;return hr.type!==tr.Punctuator&&hr.type!==tr.Keyword?ue():R("++")||R("--")?(e=P(),t=pe(),dr&&t.type===ar.Identifier&&p(t.name)&&N({},or.StrictLHSPrefix),K(t)||D({},or.InvalidLHSInAssignment),Sr.createUnaryExpression(e.value,t)):R("+")||R("-")||R("~")||R("!")?(e=P(),t=pe(),Sr.createUnaryExpression(e.value,t)):M("delete")||M("void")||M("typeof")?(e=P(),t=pe(),t=Sr.createUnaryExpression(e.value,t),dr&&"delete"===t.operator&&t.argument.type===ar.Identifier&&N({},or.StrictDelete),t):ue()}function de(e,t){var r=0;if(e.type!==tr.Punctuator&&e.type!==tr.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=t?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function fe(){var e,t,r,n,a,i,o,s,l;if(n=xr.allowIn,xr.allowIn=!0,e=pe(),t=hr,r=de(t,n),0===r)return e;for(t.prec=r,P(),a=[e,t,pe()];(r=de(hr,n))>0;){for(;a.length>2&&r<=a[a.length-2].prec;)i=a.pop(),o=a.pop().value,s=a.pop(),a.push(Sr.createBinaryExpression(o,s,i));t=P(),t.prec=r,a.push(t),a.push(pe())}for(xr.allowIn=n,l=a.length-1,e=a[l];l>1;)e=Sr.createBinaryExpression(a[l-1].value,a[l-2],e),l-=2;return e}function me(){var e,t,r,n;return e=fe(),R("?")&&(P(),t=xr.allowIn,xr.allowIn=!0,r=xe(),xr.allowIn=t,U(":"),n=xe(),e=Sr.createConditionalExpression(e,r,n)),e}function ye(e){var t,r,n,a;if(e.type===ar.ObjectExpression)for(e.type=ar.ObjectPattern,t=0,r=e.properties.length;r>t;t+=1)n=e.properties[t],"init"!==n.kind&&D({},or.InvalidLHSInAssignment),ye(n.value);else if(e.type===ar.ArrayExpression)for(e.type=ar.ArrayPattern,t=0,r=e.elements.length;r>t;t+=1)a=e.elements[t],a&&ye(a);else e.type===ar.Identifier?p(e.name)&&D({},or.InvalidLHSInAssignment):e.type===ar.SpreadElement?(ye(e.argument),e.argument.type===ar.ObjectPattern&&D({},or.ObjectPatternAsSpread)):e.type!==ar.MemberExpression&&e.type!==ar.CallExpression&&e.type!==ar.NewExpression&&D({},or.InvalidLHSInAssignment)}function ge(e,t){var r,n,a,i;if(t.type===ar.ObjectExpression)for(t.type=ar.ObjectPattern,r=0,n=t.properties.length;n>r;r+=1)a=t.properties[r],"init"!==a.kind&&D({},or.InvalidLHSInFormalsList),ge(e,a.value);else if(t.type===ar.ArrayExpression)for(t.type=ar.ArrayPattern,r=0,n=t.elements.length;n>r;r+=1)i=t.elements[r],i&&ge(e,i);else t.type===ar.Identifier?rt(e,t,t.name):t.type!==ar.MemberExpression&&D({},or.InvalidLHSInFormalsList)}function Se(e){var r,n,a,i,o,s,l,c;for(i=[],o=[],s=0,c=null,l={paramSet:{}},r=0,n=e.length;n>r;r+=1)if(a=e[r],a.type===ar.Identifier)i.push(a),o.push(null),rt(l,a,a.name);else if(a.type===ar.ObjectExpression||a.type===ar.ArrayExpression)ge(l,a),i.push(a),o.push(null);else if(a.type===ar.SpreadElement)t(r===n-1,"It is guaranteed that SpreadElement is last element by parseExpression"),ge(l,a.argument),c=a.argument;else{if(a.type!==ar.AssignmentExpression)return null;i.push(a.left),o.push(a.right),++s,rt(l,a.left,a.left.name)}return l.message===or.StrictParamDupe&&D(dr?l.stricted:l.firstRestricted,l.message),0===s&&(o=[]),{params:i,defaults:o,rest:c,stricted:l.stricted,firstRestricted:l.firstRestricted,message:l.message}}function he(e){var t,r,n;return U("=>"),t=dr,r=xr.yieldAllowed,xr.yieldAllowed=!1,n=et(),dr&&e.firstRestricted&&D(e.firstRestricted,e.message),dr&&e.stricted&&N(e.stricted,e.message),dr=t,xr.yieldAllowed=r,Sr.createArrowFunctionExpression(e.params,e.defaults,n,e.rest,n.type!==ar.BlockStatement)}function xe(){var e,t,r,n;return M("yield")?st():(n=xr.parenthesizedCount,R("(")&&(t=X(),t.type===tr.Punctuator&&")"===t.value||"..."===t.value)?(r=at(),R("=>")||F(P()),he(r)):(t=hr,e=me(),R("=>")&&(xr.parenthesizedCount===n||xr.parenthesizedCount===n+1)&&(e.type===ar.Identifier?r=Se([e]):e.type===ar.SequenceExpression&&(r=Se(e.expressions)),r)?he(r):(G()&&(dr&&e.type===ar.Identifier&&p(e.name)&&N(t,or.StrictLHSAssignment),!R("=")||e.type!==ar.ObjectExpression&&e.type!==ar.ArrayExpression?K(e)||D({},or.InvalidLHSInAssignment):ye(e),e=Sr.createAssignmentExpression(P().value,e,xe())),e)))}function Ee(){var e,t,r,n,a,i;if(i=xr.parenthesizedCount,e=xe(),t=[e],R(",")){for(;gr>fr&&R(",");)if(P(),e=ne(),t.push(e),e.type===ar.SpreadElement){a=!0,R(")")||D({},or.ElementAfterSpreadElement);break}r=Sr.createSequenceExpression(t)}if(R("=>")){if((xr.parenthesizedCount===i||xr.parenthesizedCount===i+1)&&(e=e.type===ar.SequenceExpression?e.expressions:t,n=Se(e)))return he(n);F(P())}return a&&"=>"!==X().value&&D({},or.IllegalSpread),r||e}function ve(){for(var e,t=[];gr>fr&&!R("}")&&(e=mt(),"undefined"!=typeof e);)t.push(e);return t}function be(){var e;return U("{"),e=ve(),U("}"),Sr.createBlockStatement(e)}function Ce(e){var t=null,r=null,n=null,a=!1;if(e||U(":"),R("?")&&(P(),a=!0),hr.type===tr.Identifier&&(t=Ie()),R("(")){for(P(),r=[];hr.type===tr.Identifier||R("?");)r.push(Ce(!0)),R(")")||U(",");U(")"),U("=>"),M("void")?P():n=Ce(!0)}return Sr.createTypeAnnotation(t,r,n,a)}function Ie(){var e=P();return e.type!==tr.Identifier&&F(e),Sr.createIdentifier(e.value)}function Ae(){var e=Ie();return R(":")?Sr.createTypeAnnotatedIdentifier(e,Ce()):e}function we(e){var t,r=null;return R("{")?(t=Z(),ye(t)):R("[")?(t=z(),ye(t)):(t=xr.allowKeyword?ae():Ae(),dr&&p(t.name)&&N({},or.StrictVarName)),"const"===e?(R("=")||D({},or.NoUnintializedConst),U("="),r=xe()):R("=")&&(P(),r=xe()),Sr.createVariableDeclarator(t,r)}function Le(e){var t=[];do{if(t.push(we(e)),!R(","))break;P()}while(gr>fr);return t}function ke(){var e;return B("var"),e=Le(),q(),Sr.createVariableDeclaration(e,"var")}function Te(e){var t;return B(e),t=Le(e),q(),Sr.createVariableDeclaration(t,e)}function Pe(){var e,t,r;switch(P(),J()&&D({},or.NewlineAfterModule),hr.type){case tr.StringLiteral:e=te(),r=xt(),t=null;break;case tr.Identifier:e=Ie(),r=null,j("from")||F(P()),P(),t=te(),t.type!==ar.Literal&&D({},or.InvalidModuleSpecifier)}return q(),Sr.createModuleDeclaration(e,t,r)}function Oe(){return U("*"),Sr.createExportBatchSpecifier()}function Xe(){var e,t=null;return e=Ie(),j("as")&&(P(),t=ae()),Sr.createExportSpecifier(e,t)}function Je(){var e,t,r,n;if(B("export"),hr.type===tr.Keyword)switch(hr.value){case"let":case"const":case"var":case"class":case"function":return Sr.createExportDeclaration(mt(),null,null)}if(L(hr))return e=xr.allowKeyword,xr.allowKeyword=!0,t=Le("let"),xr.allowKeyword=e,Sr.createExportDeclaration(t,null,null);if(n=[],r=null,R("*"))n.push(Oe());else{U("{");do n.push(Xe());while(R(",")&&P());U("}")}return j("from")&&(P(),r=te(),r.type!==ar.Literal&&D({},or.InvalidModuleSpecifier)),q(),Sr.createExportDeclaration(null,n,r)}function De(){var e,t,r;if(B("import"),e=[],L(hr))t="default",e.push(Ne()),j("from")||D({},or.NoFromAfterImport),P();else if(R("{")){t="named",P();do e.push(Ne());while(R(",")&&P());U("}"),j("from")||D({},or.NoFromAfterImport),P()}return r=te(),r.type!==ar.Literal&&D({},or.InvalidModuleSpecifier),q(),Sr.createImportDeclaration(e,t,r)}function Ne(){var e,t=null;return e=ae(),j("as")&&(P(),t=Ie()),Sr.createImportSpecifier(e,t)}function Fe(){return U(";"),Sr.createEmptyStatement()}function Ue(){var e=Ee();return q(),Sr.createExpressionStatement(e)}function Be(){var e,t,r;return B("if"),U("("),e=Ee(),U(")"),t=_e(),M("else")?(P(),r=_e()):r=null,Sr.createIfStatement(e,t,r)}function Re(){var e,t,r;return B("do"),r=xr.inIteration,xr.inIteration=!0,e=_e(),xr.inIteration=r,B("while"),U("("),t=Ee(),U(")"),R(";")&&P(),Sr.createDoWhileStatement(e,t)}function Me(){var e,t,r;return B("while"),U("("),e=Ee(),U(")"),r=xr.inIteration,xr.inIteration=!0,t=_e(),xr.inIteration=r,Sr.createWhileStatement(e,t)}function je(){var e=P(),t=Le();return Sr.createVariableDeclaration(t,e.value)}function Ge(e){var t,r,n,a,i,o,s,l;return t=r=n=null,B("for"),j("each")&&D({},or.EachNotAllowed),U("("),R(";")?P():(M("var")||M("let")||M("const")?(xr.allowIn=!1,t=je(),xr.allowIn=!0,1===t.declarations.length&&(M("in")||j("of"))&&(s=hr,("in"!==s.value&&"var"===t.kind||!t.declarations[0].init)&&(P(),a=t,i=Ee(),t=null))):(xr.allowIn=!1,t=Ee(),xr.allowIn=!0,j("of")?(s=P(),a=t,i=Ee(),t=null):M("in")&&(V(t)||D({},or.InvalidLHSInForIn),s=P(),a=t,i=Ee(),t=null)),"undefined"==typeof a&&U(";")),"undefined"==typeof a&&(R(";")||(r=Ee()),U(";"),R(")")||(n=Ee())),U(")"),l=xr.inIteration,xr.inIteration=!0,void 0!==e&&e.ignoreBody||(o=_e()),xr.inIteration=l,"undefined"==typeof a?Sr.createForStatement(t,r,n,o):"in"===s.value?Sr.createForInStatement(a,i,o):Sr.createForOfStatement(a,i,o)}function qe(){var e,t=null;return B("continue"),59===pr.charCodeAt(fr)?(P(),xr.inIteration||D({},or.IllegalContinue),Sr.createContinueStatement(null)):J()?(xr.inIteration||D({},or.IllegalContinue),Sr.createContinueStatement(null)):(hr.type===tr.Identifier&&(t=Ie(),e="$"+t.name,Object.prototype.hasOwnProperty.call(xr.labelSet,e)||D({},or.UnknownLabel,t.name)),q(),null!==t||xr.inIteration||D({},or.IllegalContinue),Sr.createContinueStatement(t))}function Ke(){var e,t=null;return B("break"),59===pr.charCodeAt(fr)?(P(),xr.inIteration||xr.inSwitch||D({},or.IllegalBreak),Sr.createBreakStatement(null)):J()?(xr.inIteration||xr.inSwitch||D({},or.IllegalBreak),Sr.createBreakStatement(null)):(hr.type===tr.Identifier&&(t=Ie(),e="$"+t.name,Object.prototype.hasOwnProperty.call(xr.labelSet,e)||D({},or.UnknownLabel,t.name)),q(),null!==t||xr.inIteration||xr.inSwitch||D({},or.IllegalBreak),Sr.createBreakStatement(t))}function Ve(){var e=null;return B("return"),xr.inFunctionBody||N({},or.IllegalReturn),32===pr.charCodeAt(fr)&&s(pr.charCodeAt(fr+1))?(e=Ee(),q(),Sr.createReturnStatement(e)):J()?Sr.createReturnStatement(null):(R(";")||R("}")||hr.type===tr.EOF||(e=Ee()),q(),Sr.createReturnStatement(e))}function ze(){var e,t;return dr&&N({},or.StrictModeWith),B("with"),U("("),e=Ee(),U(")"),t=_e(),Sr.createWithStatement(e,t)}function He(){var e,t,r=[];for(M("default")?(P(),e=null):(B("case"),e=Ee()),U(":");gr>fr&&!(R("}")||M("default")||M("case"))&&(t=mt(),"undefined"!=typeof t);)r.push(t);return Sr.createSwitchCase(e,r)}function We(){var e,t,r,n,a;if(B("switch"),U("("),e=Ee(),U(")"),U("{"),t=[],R("}"))return P(),Sr.createSwitchStatement(e,t);for(n=xr.inSwitch,xr.inSwitch=!0,a=!1;gr>fr&&!R("}");)r=He(),null===r.test&&(a&&D({},or.MultipleDefaultsInSwitch),a=!0),t.push(r);return xr.inSwitch=n,U("}"),Sr.createSwitchStatement(e,t)}function Ye(){var e;return B("throw"),J()&&D({},or.NewlineAfterThrow),e=Ee(),q(),Sr.createThrowStatement(e)}function $e(){var e,t;return B("catch"),U("("),R(")")&&F(hr),e=Ee(),dr&&e.type===ar.Identifier&&p(e.name)&&N({},or.StrictCatchVariable),U(")"),t=be(),Sr.createCatchClause(e,t)}function Ze(){var e,t=[],r=null;return B("try"),e=be(),M("catch")&&t.push($e()),M("finally")&&(P(),r=be()),0!==t.length||r||D({},or.NoCatchOrFinally),Sr.createTryStatement(e,[],t,r)}function Qe(){return B("debugger"),q(),Sr.createDebuggerStatement()}function _e(){var e,t,r,n=hr.type;if(n===tr.EOF&&F(hr),n===tr.Punctuator)switch(hr.value){case";":return Fe();case"{":return be();case"(":return Ue()}if(n===tr.Keyword)switch(hr.value){case"break":return Ke();case"continue":return qe();case"debugger":return Qe();case"do":return Re();case"for":return Ge();case"function":return it();case"class":return dt();case"if":return Be();case"return":return Ve();case"switch":return We();case"throw":return Ye();case"try":return Ze();case"var":return ke();case"while":return Me();case"with":return ze()}return e=Ee(),e.type===ar.Identifier&&R(":")?(P(),r="$"+e.name,Object.prototype.hasOwnProperty.call(xr.labelSet,r)&&D({},or.Redeclaration,"Label",e.name),xr.labelSet[r]=!0,t=_e(),delete xr.labelSet[r],Sr.createLabeledStatement(e,t)):(q(),Sr.createExpressionStatement(e))}function et(){return R("{")?tt():xe()}function tt(){var e,t,r,n,a,i,o,s,l,c=[];for(U("{");gr>fr&&hr.type===tr.StringLiteral&&(t=hr,e=mt(),c.push(e),e.expression.type===ar.Literal);)r=pr.slice(t.range[0]+1,t.range[1]-1),"use strict"===r?(dr=!0,n&&N(n,or.StrictOctalLiteral)):!n&&t.octal&&(n=t);for(a=xr.labelSet,i=xr.inIteration,o=xr.inSwitch,s=xr.inFunctionBody,l=xr.parenthesizedCount,xr.labelSet={},xr.inIteration=!1,xr.inSwitch=!1,xr.inFunctionBody=!0,xr.parenthesizedCount=0;gr>fr&&!R("}")&&(e=mt(),"undefined"!=typeof e);)c.push(e);return U("}"),xr.labelSet=a,xr.inIteration=i,xr.inSwitch=o,xr.inFunctionBody=s,xr.parenthesizedCount=l,Sr.createBlockStatement(c)}function rt(e,t,r){var n="$"+r;dr?(p(r)&&(e.stricted=t,e.message=or.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=or.StrictParamDupe)):e.firstRestricted||(p(r)?(e.firstRestricted=t,e.message=or.StrictParamName):u(r)?(e.firstRestricted=t,e.message=or.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.firstRestricted=t,e.message=or.StrictParamDupe)),e.paramSet[n]=!0}function nt(e){var t,r,n,a;return t=hr,"..."===t.value&&(t=P(),r=!0),R("[")?(n=z(),ge(e,n)):R("{")?(r&&D({},or.ObjectPatternAsRestParameter),n=Z(),ge(e,n)):(n=r?Ie():Ae(),rt(e,t,t.value),R("=")&&(r&&N(hr,or.DefaultRestParameter),P(),a=xe(),++e.defaultCount)),r?(R(")")||D({},or.ParameterAfterRestParameter),e.rest=n,!1):(e.params.push(n),e.defaults.push(a),!R(")"))}function at(e){var t;if(t={params:[],defaultCount:0,defaults:[],rest:null,firstRestricted:e},U("("),!R(")"))for(t.paramSet={};gr>fr&&nt(t);)U(",");return U(")"),0===t.defaultCount&&(t.defaults=[]),R(":")&&(t.returnTypeAnnotation=Ce()),t}function it(){var e,t,r,n,a,i,o,s,l;return B("function"),l=!1,R("*")&&(P(),l=!0),r=hr,e=Ie(),dr?p(r.value)&&N(r,or.StrictFunctionName):p(r.value)?(a=r,i=or.StrictFunctionName):u(r.value)&&(a=r,i=or.StrictReservedWord),n=at(a),a=n.firstRestricted,n.message&&(i=n.message),o=dr,s=xr.yieldAllowed,xr.yieldAllowed=l,
t=tt(),dr&&a&&D(a,i),dr&&n.stricted&&N(n.stricted,i),xr.yieldAllowed&&!xr.yieldFound&&N({},or.NoYieldInGenerator),dr=o,xr.yieldAllowed=s,Sr.createFunctionDeclaration(e,n.params,n.defaults,t,n.rest,l,!1,n.returnTypeAnnotation)}function ot(){var e,t,r,n,a,i,o,s,l=null;return B("function"),s=!1,R("*")&&(P(),s=!0),R("(")||(e=hr,l=Ie(),dr?p(e.value)&&N(e,or.StrictFunctionName):p(e.value)?(t=e,r=or.StrictFunctionName):u(e.value)&&(t=e,r=or.StrictReservedWord)),n=at(t),t=n.firstRestricted,n.message&&(r=n.message),i=dr,o=xr.yieldAllowed,xr.yieldAllowed=s,a=tt(),dr&&t&&D(t,r),dr&&n.stricted&&N(n.stricted,r),xr.yieldAllowed&&!xr.yieldFound&&N({},or.NoYieldInGenerator),dr=i,xr.yieldAllowed=o,Sr.createFunctionExpression(l,n.params,n.defaults,a,n.rest,s,!1,n.returnTypeAnnotation)}function st(){var e,t;return B("yield"),xr.yieldAllowed||N({},or.IllegalYield),e=!1,R("*")&&(P(),e=!0),t=xe(),xr.yieldFound=!0,Sr.createYieldExpression(t,e)}function lt(e){var t,r,n,a,i=!1;return"static"===hr.value?(a=ur["static"],P()):a=ur.prototype,R("*")?(P(),Sr.createMethodDefinition(a,"",Y(),W({generator:!0}))):(t=hr,r=Y(),"get"!==t.value||R("(")?"set"!==t.value||R("(")?(e[a].hasOwnProperty(r.name)?D(r,or.IllegalDuplicateClassProperty):e[a][r.name]={},e[a][r.name].data=!0,Sr.createMethodDefinition(a,"",r,W({generator:!1}))):(r=Y(),e[a].hasOwnProperty(r.name)?(i=void 0===e[a][r.name].set&&void 0===e[a][r.name].data&&void 0!==e[a][r.name].get,i||D(r,or.IllegalDuplicateClassProperty)):e[a][r.name]={},e[a][r.name].set=!0,U("("),t=hr,n=[Ae()],U(")"),Sr.createMethodDefinition(a,"set",r,H({params:n,generator:!1,name:t}))):(r=Y(),e[a].hasOwnProperty(r.name)?(i=void 0===e[a][r.name].get&&void 0===e[a][r.name].data&&void 0!==e[a][r.name].set,i||D(r,or.IllegalDuplicateClassProperty)):e[a][r.name]={},e[a][r.name].get=!0,U("("),U(")"),Sr.createMethodDefinition(a,"get",r,H({generator:!1}))))}function ct(e){return R(";")?void P():lt(e)}function ut(){var e,t=[],r={};for(r[ur["static"]]={},r[ur.prototype]={},U("{");gr>fr&&!R("}");)e=ct(r),"undefined"!=typeof e&&t.push(e);return U("}"),Sr.createClassBody(t)}function pt(){var e,t,r=null;return B("class"),M("extends")||R("{")||(e=Ie()),M("extends")&&(B("extends"),t=xr.yieldAllowed,xr.yieldAllowed=!1,r=xe(),xr.yieldAllowed=t),Sr.createClassExpression(e,r,ut())}function dt(){var e,t,r=null;return B("class"),e=Ie(),M("extends")&&(B("extends"),t=xr.yieldAllowed,xr.yieldAllowed=!1,r=xe(),xr.yieldAllowed=t),Sr.createClassDeclaration(e,r,ut())}function ft(){var e;return j("module")?(e=X(),e.type===tr.StringLiteral||e.type===tr.Identifier):!1}function mt(){if(hr.type===tr.Keyword)switch(hr.value){case"const":case"let":return Te(hr.value);case"function":return it();case"export":return Je();case"import":return De();default:return _e()}return ft()&&D({},or.NestedModule),hr.type!==tr.EOF?_e():void 0}function yt(){if(hr.type===tr.Keyword)switch(hr.value){case"export":return Je();case"import":return De()}return ft()?Pe():mt()}function gt(){for(var e,t,r,n,a=[];gr>fr&&(t=hr,t.type===tr.StringLiteral)&&(e=yt(),a.push(e),e.expression.type===ar.Literal);)r=pr.slice(t.range[0]+1,t.range[1]-1),"use strict"===r?(dr=!0,n&&N(n,or.StrictOctalLiteral)):!n&&t.octal&&(n=t);for(;gr>fr&&(e=yt(),"undefined"!=typeof e);)a.push(e);return a}function St(){return mt()}function ht(){for(var e,t=[];gr>fr&&!R("}")&&(e=St(),"undefined"!=typeof e);)t.push(e);return t}function xt(){var e;return U("{"),e=ht(),U("}"),Sr.createBlockStatement(e)}function Et(){var e;return dr=!1,O(),e=gt(),Sr.createProgram(e)}function vt(e,r,n,a,i){t("number"==typeof n,"Comment must have valid position"),Er.comments.length>0&&Er.comments[Er.comments.length-1].range[1]>n||Er.comments.push({type:e,value:r,range:[n,a],loc:i})}function bt(){var e,t,r,n,a,s;for(e="",a=!1,s=!1;gr>fr;)if(t=pr[fr],s)t=pr[fr++],o(t.charCodeAt(0))?(r.end={line:mr,column:fr-yr-1},s=!1,vt("Line",e,n,fr-1,r),"\r"===t&&"\n"===pr[fr]&&++fr,++mr,yr=fr,e=""):fr>=gr?(s=!1,e+=t,r.end={line:mr,column:gr-yr},vt("Line",e,n,gr,r)):e+=t;else if(a)o(t.charCodeAt(0))?("\r"===t&&"\n"===pr[fr+1]?(++fr,e+="\r\n"):e+=t,++mr,++fr,yr=fr,fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL")):(t=pr[fr++],fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL"),e+=t,"*"===t&&(t=pr[fr],"/"===t&&(e=e.substr(0,e.length-1),a=!1,++fr,r.end={line:mr,column:fr-yr},vt("Block",e,n,fr,r),e="")));else if("/"===t)if(t=pr[fr+1],"/"===t)r={start:{line:mr,column:fr-yr}},n=fr,fr+=2,s=!0,fr>=gr&&(r.end={line:mr,column:fr-yr},s=!1,vt("Line",e,n,fr,r));else{if("*"!==t)break;n=fr,fr+=2,a=!0,r={start:{line:mr,column:fr-yr-2}},fr>=gr&&D({},or.UnexpectedToken,"ILLEGAL")}else if(i(t.charCodeAt(0)))++fr;else{if(!o(t.charCodeAt(0)))break;++fr,"\r"===t&&"\n"===pr[fr]&&++fr,++mr,yr=fr}}function Ct(){var e,t,r,n=[];for(e=0;e<Er.comments.length;++e)t=Er.comments[e],r={type:t.type,value:t.value},Er.range&&(r.range=t.range),Er.loc&&(r.loc=t.loc),n.push(r);Er.comments=n}function It(e){return 92!==e&&s(e)}function At(e){return 92!==e&&(45===e||l(e))}function wt(){var e,t,r,n="";for(t=fr;gr>fr&&(e=pr.charCodeAt(fr),At(e));)n+=pr[fr++];if(58===e)for(++fr,r=n,n="";gr>fr&&(e=pr.charCodeAt(fr),At(e));)n+=pr[fr++];return n||D({},or.InvalidXJSTagName),{type:tr.XJSIdentifier,value:n,namespace:r,lineNumber:mr,lineStart:yr,range:[t,fr]}}function Lt(){var e,r,n="",a=0;for(e=pr[fr],t("&"===e,"Entity must start with an ampersand"),fr++;gr>fr&&a++<10&&(e=pr[fr++],";"!==e);)n+=e;return r="#"===n[0]&&"x"===n[1]?String.fromCharCode(parseInt(n.substr(2),16)):"#"===n[0]?String.fromCharCode(parseInt(n.substr(1),10)):cr[n]}function kt(e){var t,r,n="";for(r=fr;gr>fr&&(t=pr[fr],-1===e.indexOf(t));)"&"===t?n+=Lt():(t=pr[fr++],o(t.charCodeAt(0))&&(++mr,yr=fr),n+=t);return{type:tr.XJSText,value:n,lineNumber:mr,lineStart:yr,range:[r,fr]}}function Tt(){var e,r,n;return r=pr[fr],t("'"===r||'"'===r,"String literal must starts with a quote"),n=fr,++fr,e=kt([r]),r!==pr[fr]&&D({},or.UnexpectedToken,"ILLEGAL"),++fr,e.range=[n,fr],e}function Pt(){var e=pr.charCodeAt(fr);return 123!==e&&60!==e?kt(["<","{"]):x()}function Ot(){var e;return hr.type!==tr.XJSIdentifier&&F(hr),e=P(),Sr.createXJSIdentifier(e.value,e.namespace)}function Xt(){var e;return R("{")?(e=Dt(),e.expression.type===ar.XJSEmptyExpression&&D(e,"XJS attributes must only be assigned a non-empty expression")):R("<")?e=Rt():hr.type===tr.XJSText?e=Sr.createLiteral(P()):D({},or.InvalidXJSAttributeValue),e}function Jt(){for(;"}"!==pr.charAt(fr);)fr++;return Sr.createXJSEmptyExpression()}function Dt(){var e,t,r;return t=xr.inXJSChild,r=xr.inXJSTag,xr.inXJSChild=!1,xr.inXJSTag=!1,U("{"),e=R("}")?Jt():Ee(),xr.inXJSChild=t,xr.inXJSTag=r,U("}"),Sr.createXJSExpressionContainer(e)}function Nt(){var e;return e=Ot(),R("=")?(P(),Sr.createXJSAttribute(e,Xt())):Sr.createXJSAttribute(e)}function Ft(){var e;return e=R("{")?Dt():hr.type===tr.XJSText?Sr.createLiteral(P()):Rt()}function Ut(){var e,t,r;return t=xr.inXJSChild,r=xr.inXJSTag,xr.inXJSChild=!1,xr.inXJSTag=!0,U("<"),U("/"),e=Ot(),xr.inXJSChild=t,xr.inXJSTag=r,U(">"),Sr.createXJSClosingElement(e)}function Bt(){var e,t,r,n=[],a=!1;for(t=xr.inXJSChild,r=xr.inXJSTag,xr.inXJSChild=!1,xr.inXJSTag=!0,U("<"),e=Ot();gr>fr&&"/"!==hr.value&&">"!==hr.value;)n.push(Nt());return xr.inXJSTag=r,"/"===hr.value?(U("/"),xr.inXJSChild=t,U(">"),a=!0):(xr.inXJSChild=!0,U(">")),Sr.createXJSOpeningElement(e,n,a)}function Rt(){var e,t,r,n,a=[];if(r=xr.inXJSChild,n=xr.inXJSTag,e=Bt(),!e.selfClosing){for(;gr>fr&&(xr.inXJSChild=!1,"<"!==hr.value||"/"!==X().value);)xr.inXJSChild=!0,O(),a.push(Ft());xr.inXJSChild=r,xr.inXJSTag=n,t=Ut(),t.name.namespace===e.name.namespace&&t.name.name===e.name.name||D({},or.ExpectedXJSClosingTag,e.name.namespace?e.name.namespace+":"+e.name.name:e.name.name)}return Sr.createXJSElement(e,t,a)}function Mt(){var e,t,r,n,a;return f(),e=fr,t={start:{line:mr,column:fr-yr}},r=Er.advance(),t.end={line:mr,column:fr-yr},r.type!==tr.EOF&&(n=[r.range[0],r.range[1]],a=pr.slice(r.range[0],r.range[1]),Er.tokens.push({type:rr[r.type],value:a,range:n,loc:t})),r}function jt(){var e,t,r,n;return f(),e=fr,t={start:{line:mr,column:fr-yr}},r=Er.scanRegExp(),t.end={line:mr,column:fr-yr},Er.tokenize||(Er.tokens.length>0&&(n=Er.tokens[Er.tokens.length-1],n.range[0]===e&&"Punctuator"===n.type&&("/"!==n.value&&"/="!==n.value||Er.tokens.pop())),Er.tokens.push({type:"RegularExpression",value:r.literal,range:[e,fr],loc:t})),r}function Gt(){var e,t,r,n=[];for(e=0;e<Er.tokens.length;++e)t=Er.tokens[e],r={type:t.type,value:t.value},Er.range&&(r.range=t.range),Er.loc&&(r.loc=t.loc),n.push(r);Er.tokens=n}function qt(){this.range=[fr,fr],this.loc={start:{line:mr,column:fr-yr},end:{line:mr,column:fr-yr}}}function Kt(){return new qt}function Vt(){var e,t;return f(),e=Kt(),U("("),++xr.parenthesizedCount,t=Ee(),U(")"),e.end(),e.applyGroup(t),t}function zt(){var e,t;for(f(),e=Kt(),t=M("new")?se():te();R(".")||R("[")||hr.type===tr.Template;)R("[")?(t=Sr.createMemberExpression("[",t,oe()),e.end(),e.apply(t)):R(".")?(t=Sr.createMemberExpression(".",t,ie()),e.end(),e.apply(t)):(t=Sr.createTaggedTemplateExpression(t,_()),e.end(),e.apply(t));return t}function Ht(){var e,t,r;for(f(),e=Kt(),t=M("new")?se():te();R(".")||R("[")||R("(")||hr.type===tr.Template;)R("(")?(r=re(),t=Sr.createCallExpression(t,r),e.end(),e.apply(t)):R("[")?(t=Sr.createMemberExpression("[",t,oe()),e.end(),e.apply(t)):R(".")?(t=Sr.createMemberExpression(".",t,ie()),e.end(),e.apply(t)):(t=Sr.createTaggedTemplateExpression(t,_()),e.end(),e.apply(t));return t}function Wt(e){var t,r,n;t="[object Array]"===Object.prototype.toString.apply(e)?[]:{};for(r in e)e.hasOwnProperty(r)&&"groupRange"!==r&&"groupLoc"!==r&&(n=e[r],null===n||"object"!=typeof n||n instanceof RegExp?t[r]=n:t[r]=Wt(n));return t}function Yt(e,t,r){return function(n){function a(e){return e.type===ar.LogicalExpression||e.type===ar.BinaryExpression}function i(r){var n,o;a(r.left)&&i(r.left),a(r.right)&&i(r.right),e&&(r.left.groupRange||r.right.groupRange?(n=r.left.groupRange?r.left.groupRange[0]:r.left.range[0],o=r.right.groupRange?r.right.groupRange[1]:r.right.range[1],r.range=[n,o]):"undefined"==typeof r.range&&(n=r.left.range[0],o=r.right.range[1],r.range=[n,o])),t&&(r.left.groupLoc||r.right.groupLoc?(n=r.left.groupLoc?r.left.groupLoc.start:r.left.loc.start,o=r.right.groupLoc?r.right.groupLoc.end:r.right.loc.end,r.loc={start:n,end:o},r=Sr.postProcess(r)):"undefined"==typeof r.loc&&(r.loc={start:r.left.loc.start,end:r.right.loc.end},r=Sr.postProcess(r)))}return function(){var o,s;return r||f(),o=Kt(),s=n.apply(null,arguments),o.end(),e&&"undefined"==typeof s.range&&o.apply(s),t&&"undefined"==typeof s.loc&&o.apply(s),a(s)&&i(s),s}}}function $t(){var e,t;Er.comments&&(Er.skipComment=f,f=bt),(Er.range||Er.loc)&&(Er.parseGroupExpression=ee,Er.parseLeftHandSideExpression=ce,Er.parseLeftHandSideExpressionAllowCall=le,ee=Vt,ce=zt,le=Ht,e=Yt(Er.range,Er.loc),t=Yt(Er.range,Er.loc,!0),Er.parseArrayInitialiser=z,Er.parseAssignmentExpression=xe,Er.parseBinaryExpression=fe,Er.parseBlock=be,Er.parseFunctionSourceElements=tt,Er.parseCatchClause=$e,Er.parseComputedMember=oe,Er.parseConditionalExpression=me,Er.parseConstLetDeclaration=Te,Er.parseExportBatchSpecifier=Oe,Er.parseExportDeclaration=Je,Er.parseExportSpecifier=Xe,Er.parseExpression=Ee,Er.parseForVariableDeclaration=je,Er.parseFunctionDeclaration=it,Er.parseFunctionExpression=ot,Er.parseParams=at,Er.parseImportDeclaration=De,Er.parseImportSpecifier=Ne,Er.parseModuleDeclaration=Pe,Er.parseModuleBlock=xt,Er.parseNewExpression=se,Er.parseNonComputedProperty=ae,Er.parseObjectInitialiser=Z,Er.parseObjectProperty=$,Er.parseObjectPropertyKey=Y,Er.parsePostfixExpression=ue,Er.parsePrimaryExpression=te,Er.parseProgram=Et,Er.parsePropertyFunction=H,Er.parseSpreadOrAssignmentExpression=ne,Er.parseTemplateElement=Q,Er.parseTemplateLiteral=_,Er.parseTypeAnnotatableIdentifier=Ae,Er.parseTypeAnnotation=Ce,Er.parseStatement=_e,Er.parseSwitchCase=He,Er.parseUnaryExpression=pe,Er.parseVariableDeclaration=we,Er.parseVariableIdentifier=Ie,Er.parseMethodDefinition=lt,Er.parseClassDeclaration=dt,Er.parseClassExpression=pt,Er.parseClassBody=ut,Er.parseXJSIdentifier=Ot,Er.parseXJSChild=Ft,Er.parseXJSAttribute=Nt,Er.parseXJSAttributeValue=Xt,Er.parseXJSExpressionContainer=Dt,Er.parseXJSEmptyExpression=Jt,Er.parseXJSElement=Rt,Er.parseXJSClosingElement=Ut,Er.parseXJSOpeningElement=Bt,z=e(Er.parseArrayInitialiser),xe=e(Er.parseAssignmentExpression),fe=e(Er.parseBinaryExpression),be=e(Er.parseBlock),tt=e(Er.parseFunctionSourceElements),$e=e(Er.parseCatchClause),oe=e(Er.parseComputedMember),me=e(Er.parseConditionalExpression),Te=e(Er.parseConstLetDeclaration),Oe=e(Oe),Je=e(Je),Xe=e(Xe),Ee=e(Er.parseExpression),je=e(Er.parseForVariableDeclaration),it=e(Er.parseFunctionDeclaration),ot=e(Er.parseFunctionExpression),at=e(Er.parseParams),De=e(Er.parseImportDeclaration),Ne=e(Er.parseImportSpecifier),Pe=e(Er.parseModuleDeclaration),xt=e(Er.parseModuleBlock),ce=e(ce),se=e(Er.parseNewExpression),ae=e(Er.parseNonComputedProperty),Z=e(Er.parseObjectInitialiser),$=e(Er.parseObjectProperty),Y=e(Er.parseObjectPropertyKey),ue=e(Er.parsePostfixExpression),te=e(Er.parsePrimaryExpression),Et=e(Er.parseProgram),H=e(Er.parsePropertyFunction),Q=e(Er.parseTemplateElement),_=e(Er.parseTemplateLiteral),Ae=e(Er.parseTypeAnnotatableIdentifier),Ce=e(Er.parseTypeAnnotation),ne=e(Er.parseSpreadOrAssignmentExpression),_e=e(Er.parseStatement),He=e(Er.parseSwitchCase),pe=e(Er.parseUnaryExpression),we=e(Er.parseVariableDeclaration),Ie=e(Er.parseVariableIdentifier),lt=e(Er.parseMethodDefinition),dt=e(Er.parseClassDeclaration),pt=e(Er.parseClassExpression),ut=e(Er.parseClassBody),Ot=e(Er.parseXJSIdentifier),Ft=t(Er.parseXJSChild),Nt=e(Er.parseXJSAttribute),Xt=e(Er.parseXJSAttributeValue),Dt=e(Er.parseXJSExpressionContainer),Jt=t(Er.parseXJSEmptyExpression),Rt=e(Er.parseXJSElement),Ut=e(Er.parseXJSClosingElement),Bt=e(Er.parseXJSOpeningElement)),"undefined"!=typeof Er.tokens&&(Er.advance=T,Er.scanRegExp=w,T=Mt,w=jt)}function Zt(){"function"==typeof Er.skipComment&&(f=Er.skipComment),(Er.range||Er.loc)&&(z=Er.parseArrayInitialiser,xe=Er.parseAssignmentExpression,fe=Er.parseBinaryExpression,be=Er.parseBlock,tt=Er.parseFunctionSourceElements,$e=Er.parseCatchClause,oe=Er.parseComputedMember,me=Er.parseConditionalExpression,Te=Er.parseConstLetDeclaration,Oe=Er.parseExportBatchSpecifier,Je=Er.parseExportDeclaration,Xe=Er.parseExportSpecifier,Ee=Er.parseExpression,je=Er.parseForVariableDeclaration,it=Er.parseFunctionDeclaration,ot=Er.parseFunctionExpression,De=Er.parseImportDeclaration,Ne=Er.parseImportSpecifier,ee=Er.parseGroupExpression,ce=Er.parseLeftHandSideExpression,le=Er.parseLeftHandSideExpressionAllowCall,Pe=Er.parseModuleDeclaration,xt=Er.parseModuleBlock,se=Er.parseNewExpression,ae=Er.parseNonComputedProperty,Z=Er.parseObjectInitialiser,$=Er.parseObjectProperty,Y=Er.parseObjectPropertyKey,ue=Er.parsePostfixExpression,te=Er.parsePrimaryExpression,Et=Er.parseProgram,H=Er.parsePropertyFunction,Q=Er.parseTemplateElement,_=Er.parseTemplateLiteral,Ae=Er.parseTypeAnnotatableIdentifier,Ce=Er.parseTypeAnnotation,ne=Er.parseSpreadOrAssignmentExpression,_e=Er.parseStatement,He=Er.parseSwitchCase,pe=Er.parseUnaryExpression,we=Er.parseVariableDeclaration,Ie=Er.parseVariableIdentifier,lt=Er.parseMethodDefinition,dt=Er.parseClassDeclaration,pt=Er.parseClassExpression,ut=Er.parseClassBody,Ot=Er.parseXJSIdentifier,Ft=Er.parseXJSChild,Nt=Er.parseXJSAttribute,Xt=Er.parseXJSAttributeValue,Dt=Er.parseXJSExpressionContainer,Jt=Er.parseXJSEmptyExpression,Rt=Er.parseXJSElement,Ut=Er.parseXJSClosingElement,Bt=Er.parseXJSOpeningElement),"function"==typeof Er.scanRegExp&&(T=Er.advance,w=Er.scanRegExp)}function Qt(e,t){var r,n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function _t(e,t){var r,n,a;r=String,"string"==typeof e||e instanceof String||(e=r(e)),Sr=lr,pr=e,fr=0,mr=pr.length>0?1:0,yr=0,gr=pr.length,hr=null,xr={allowKeyword:!0,allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1},Er={},t=t||{},t.tokens=!0,Er.tokens=[],Er.tokenize=!0,Er.openParenToken=-1,Er.openCurlyToken=-1,Er.range="boolean"==typeof t.range&&t.range,Er.loc="boolean"==typeof t.loc&&t.loc,"boolean"==typeof t.comment&&t.comment&&(Er.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Er.errors=[]),gr>0&&"undefined"==typeof pr[0]&&e instanceof String&&(pr=e.valueOf()),$t();try{if(O(),hr.type===tr.EOF)return Er.tokens;for(n=P();hr.type!==tr.EOF;)try{n=P()}catch(i){if(n=hr,Er.errors){Er.errors.push(i);break}throw i}Gt(),a=Er.tokens,"undefined"!=typeof Er.comments&&(Ct(),a.comments=Er.comments),"undefined"!=typeof Er.errors&&(a.errors=Er.errors)}catch(o){throw o}finally{Zt(),Er={}}return a}function er(e,t){var r,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),Sr=lr,pr=e,fr=0,mr=pr.length>0?1:0,yr=0,gr=pr.length,hr=null,xr={allowKeyword:!1,allowIn:!0,labelSet:{},parenthesizedCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,inXJSChild:!1,inXJSTag:!1,yieldAllowed:!1,yieldFound:!1},Er={},"undefined"!=typeof t&&(Er.range="boolean"==typeof t.range&&t.range,Er.loc="boolean"==typeof t.loc&&t.loc,Er.loc&&null!==t.source&&void 0!==t.source&&(Sr=Qt(Sr,{postProcess:function(e){return e.loc.source=n(t.source),e}})),"boolean"==typeof t.tokens&&t.tokens&&(Er.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(Er.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Er.errors=[])),gr>0&&"undefined"==typeof pr[0]&&e instanceof String&&(pr=e.valueOf()),$t();try{r=Et(),"undefined"!=typeof Er.comments&&(Ct(),r.comments=Er.comments),"undefined"!=typeof Er.tokens&&(Gt(),r.tokens=Er.tokens),"undefined"!=typeof Er.errors&&(r.errors=Er.errors),(Er.range||Er.loc)&&(r.body=Wt(r.body))}catch(a){throw a}finally{Zt(),Er={}}return r}var tr,rr,nr,ar,ir,or,sr,lr,cr,ur,pr,dr,fr,mr,yr,gr,Sr,hr,xr,Er;tr={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9,Template:10,XJSIdentifier:11,XJSText:12},rr={},rr[tr.BooleanLiteral]="Boolean",rr[tr.EOF]="<end>",rr[tr.Identifier]="Identifier",rr[tr.Keyword]="Keyword",rr[tr.NullLiteral]="Null",rr[tr.NumericLiteral]="Numeric",rr[tr.Punctuator]="Punctuator",rr[tr.StringLiteral]="String",rr[tr.XJSIdentifier]="XJSIdentifier",rr[tr.XJSText]="XJSText",rr[tr.RegularExpression]="RegularExpression",nr=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],ar={ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AssignmentExpression:"AssignmentExpression",BinaryExpression:"BinaryExpression",BlockStatement:"BlockStatement",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ClassHeritage:"ClassHeritage",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExportBatchSpecifier:"ExportBatchSpecifier",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",ForStatement:"ForStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportSpecifier:"ImportSpecifier",LabeledStatement:"LabeledStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",ModuleDeclaration:"ModuleDeclaration",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",TypeAnnotatedIdentifier:"TypeAnnotatedIdentifier",TypeAnnotation:"TypeAnnotation",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",XJSIdentifier:"XJSIdentifier",XJSEmptyExpression:"XJSEmptyExpression",XJSExpressionContainer:"XJSExpressionContainer",XJSElement:"XJSElement",XJSClosingElement:"XJSClosingElement",XJSOpeningElement:"XJSOpeningElement",XJSAttribute:"XJSAttribute",XJSText:"XJSText",YieldExpression:"YieldExpression"},ir={Data:1,Get:2,Set:4},ur={"static":"static",prototype:"prototype"},or={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInFormalsList:"Invalid left-hand side in formals list",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalDuplicateClassProperty:"Illegal duplicate property in class definition",IllegalReturn:"Illegal return statement",IllegalYield:"Illegal yield expression",IllegalSpread:"Illegal spread element",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",ParameterAfterRestParameter:"Rest parameter must be final parameter of an argument list",DefaultRestParameter:"Rest parameter can not have a default value",ElementAfterSpreadElement:"Spread must be the final element of an element list",ObjectPatternAsRestParameter:"Invalid rest parameter",ObjectPatternAsSpread:"Invalid spread argument",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",NewlineAfterModule:"Illegal newline after module",NoFromAfterImport:"Missing from after import",InvalidModuleSpecifier:"Invalid module specifier",NestedModule:"Module declaration can not be nested",NoYieldInGenerator:"Missing yield in generator",NoUnintializedConst:"Const must be initialized",ComprehensionRequiresBlock:"Comprehension must have at least one block",ComprehensionError:"Comprehension Error",EachNotAllowed:"Each is not supported",InvalidXJSTagName:"XJS tag name can not be empty",InvalidXJSAttributeValue:"XJS value should be either an expression or a quoted XJS text",ExpectedXJSClosingTag:"Expected corresponding XJS closing tag for %0"},sr={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},lr={name:"SyntaxTree",postProcess:function(e){return e},createArrayExpression:function(e){return{type:ar.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,r){return{type:ar.AssignmentExpression,operator:e,left:t,right:r}},createBinaryExpression:function(e,t,r){var n="||"===e||"&&"===e?ar.LogicalExpression:ar.BinaryExpression;return{type:n,operator:e,left:t,right:r}},createBlockStatement:function(e){return{type:ar.BlockStatement,body:e}},createBreakStatement:function(e){return{type:ar.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:ar.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:ar.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,r){return{type:ar.ConditionalExpression,test:e,consequent:t,alternate:r}},createContinueStatement:function(e){return{type:ar.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:ar.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:ar.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:ar.EmptyStatement}},createExpressionStatement:function(e){return{type:ar.ExpressionStatement,expression:e}},createForStatement:function(e,t,r,n){return{type:ar.ForStatement,init:e,test:t,update:r,body:n}},createForInStatement:function(e,t,r){return{type:ar.ForInStatement,left:e,right:t,body:r,each:!1}},createForOfStatement:function(e,t,r){return{type:ar.ForOfStatement,left:e,right:t,body:r}},createFunctionDeclaration:function(e,t,r,n,a,i,o,s){return{type:ar.FunctionDeclaration,id:e,params:t,defaults:r,body:n,rest:a,generator:i,expression:o,returnType:s}},createFunctionExpression:function(e,t,r,n,a,i,o,s){return{type:ar.FunctionExpression,id:e,params:t,defaults:r,body:n,rest:a,generator:i,expression:o,returnType:s}},createIdentifier:function(e){return{type:ar.Identifier,name:e,typeAnnotation:void 0}},createTypeAnnotation:function(e,t,r,n){return{type:ar.TypeAnnotation,id:e,paramTypes:t,returnType:r,nullable:n}},createTypeAnnotatedIdentifier:function(e,t){return{type:ar.TypeAnnotatedIdentifier,id:e,annotation:t}},createXJSAttribute:function(e,t){return{type:ar.XJSAttribute,name:e,value:t}},createXJSIdentifier:function(e,t){return{type:ar.XJSIdentifier,name:e,namespace:t}},createXJSElement:function(e,t,r){return{type:ar.XJSElement,openingElement:e,closingElement:t,children:r}},createXJSEmptyExpression:function(){return{type:ar.XJSEmptyExpression}},createXJSExpressionContainer:function(e){return{type:ar.XJSExpressionContainer,expression:e}},createXJSOpeningElement:function(e,t,r){return{type:ar.XJSOpeningElement,name:e,selfClosing:r,attributes:t}},createXJSClosingElement:function(e){return{type:ar.XJSClosingElement,name:e}},createIfStatement:function(e,t,r){return{type:ar.IfStatement,test:e,consequent:t,alternate:r}},createLabeledStatement:function(e,t){return{type:ar.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:ar.Literal,value:e.value,raw:pr.slice(e.range[0],e.range[1])}},createMemberExpression:function(e,t,r){return{type:ar.MemberExpression,computed:"["===e,object:t,property:r}},createNewExpression:function(e,t){return{type:ar.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:ar.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:ar.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:ar.Program,body:e}},createProperty:function(e,t,r,n,a){return{type:ar.Property,key:t,value:r,kind:e,method:n,shorthand:a}},createReturnStatement:function(e){return{type:ar.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:ar.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:ar.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:ar.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:ar.ThisExpression}},createThrowStatement:function(e){return{type:ar.ThrowStatement,argument:e}},createTryStatement:function(e,t,r,n){return{type:ar.TryStatement,block:e,guardedHandlers:t,handlers:r,finalizer:n}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:ar.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:ar.UnaryExpression,operator:e,argument:t}},createVariableDeclaration:function(e,t){return{type:ar.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:ar.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:ar.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:ar.WithStatement,object:e,body:t}},createTemplateElement:function(e,t){return{type:ar.TemplateElement,value:e,tail:t}},createTemplateLiteral:function(e,t){return{type:ar.TemplateLiteral,quasis:e,expressions:t}},createSpreadElement:function(e){return{type:ar.SpreadElement,argument:e}},createTaggedTemplateExpression:function(e,t){return{type:ar.TaggedTemplateExpression,tag:e,quasi:t}},createArrowFunctionExpression:function(e,t,r,n,a){return{type:ar.ArrowFunctionExpression,id:null,params:e,defaults:t,body:r,rest:n,generator:!1,expression:a}},createMethodDefinition:function(e,t,r,n){return{type:ar.MethodDefinition,key:r,value:n,kind:t,"static":e===ur["static"]}},createClassBody:function(e){return{type:ar.ClassBody,body:e}},createClassExpression:function(e,t,r){return{type:ar.ClassExpression,
id:e,superClass:t,body:r}},createClassDeclaration:function(e,t,r){return{type:ar.ClassDeclaration,id:e,superClass:t,body:r}},createExportSpecifier:function(e,t){return{type:ar.ExportSpecifier,id:e,name:t}},createExportBatchSpecifier:function(){return{type:ar.ExportBatchSpecifier}},createExportDeclaration:function(e,t,r){return{type:ar.ExportDeclaration,declaration:e,specifiers:t,source:r}},createImportSpecifier:function(e,t){return{type:ar.ImportSpecifier,id:e,name:t}},createImportDeclaration:function(e,t,r){return{type:ar.ImportDeclaration,specifiers:e,kind:t,source:r}},createYieldExpression:function(e,t){return{type:ar.YieldExpression,argument:e,delegate:t}},createModuleDeclaration:function(e,t,r){return{type:ar.ModuleDeclaration,id:e,source:t,body:r}}},cr={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪","int":"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"},qt.prototype={constructor:qt,end:function(){this.range[1]=fr,this.loc.end.line=mr,this.loc.end.column=fr-yr},applyGroup:function(e){Er.range&&(e.groupRange=[this.range[0],this.range[1]]),Er.loc&&(e.groupLoc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=Sr.postProcess(e))},apply:function(e){var r=typeof e;t("object"===r,"Applying location marker to an unexpected node type: "+r),Er.range&&(e.range=[this.range[0],this.range[1]]),Er.loc&&(e.loc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=Sr.postProcess(e))}},e.version="1.1.0-dev-harmony",e.tokenize=_t,e.parse=er,e.Syntax=function(){var e,t={};"function"==typeof Object.create&&(t=Object.create(null));for(e in ar)ar.hasOwnProperty(e)&&(t[e]=ar[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()});
},{}],265:[function(require,module,exports){
var core=require("./lib/core");exports=module.exports=require("./lib/async"),exports.core=core,exports.isCore=function(r){return core[r]},exports.sync=require("./lib/sync");
},{"./lib/async":266,"./lib/core":269,"./lib/sync":271}],266:[function(require,module,exports){
var core=require("./core"),fs=require("fs"),path=require("path"),caller=require("./caller.js"),nodeModulesPaths=require("./node-modules-paths.js");module.exports=function(n,e,i){function o(n,i,o){"function"==typeof i&&(o=i,i=e["package"]),function r(e){if(0===e.length)return o(null,void 0,i);var t=n+e[0];u(t,function(n,u){n?o(n):u?o(null,t,i):r(e.slice(1))})}([""].concat(l))}function r(n,i,t){"function"==typeof i&&(t=i,i=e["package"]);var l=path.join(n,"/package.json");u(l,function(u,c){return u?t(u):c?void a(l,function(i,u){if(i)return t(i);try{var a=JSON.parse(u)}catch(i){}return e.packageFilter&&(a=e.packageFilter(a,n)),a.main?("."!==a.main&&"./"!==a.main||(a.main="index"),void o(path.resolve(n,a.main),a,function(e,i,u){if(e)return t(e);if(i)return t(null,i,u);if(!u)return o(path.join(n,"/index"),u,t);var a=path.resolve(n,u.main);r(a,u,function(e,i,r){return e?t(e):i?t(null,i,r):void o(path.join(n,"/index"),r,t)})})):void o(path.join(n,"/index"),a,t)}):o(path.join(n,"/index"),i,t)})}function t(n,i,t){!function u(e){if(0===e.length)return t(null,void 0);var i=e[0];o(path.join(i,"/",n),void 0,function(o,a,l){return o?t(o):a?t(null,a,l):void r(path.join(i,"/",n),void 0,function(n,i,o){return n?t(n):i?t(null,i,o):void u(e.slice(1))})})}(nodeModulesPaths(i,e))}"function"==typeof e&&(i=e,e={}),e||(e={});var u=e.isFile||function(n,e){fs.stat(n,function(n,i){n&&"ENOENT"===n.code?e(null,!1):n?e(n):e(null,i.isFile()||i.isFIFO())})},a=e.readFile||fs.readFile,l=e.extensions||[".js"],c=e.basedir||path.dirname(caller());e.moduleDirectory||"node_modules";e.paths=e.paths||[],n.match(/^(?:\.\.?\/|\/|([A-Za-z]:)?\\)/)?o(path.resolve(c,n),function(e,o,t){e?i(e):o?i(null,o,t):r(path.resolve(c,n),function(e,o,r){e?i(e):o?i(null,o,r):i(new Error("Cannot find module '"+n+"' from '"+c+"'"))})}):t(n,c,function(e,o,r){if(e)i(e);else if(o)i(null,o,r);else{if(core[n])return i(null,n);i(new Error("Cannot find module '"+n+"' from '"+c+"'"))}})};
},{"./caller.js":267,"./core":269,"./node-modules-paths.js":270,"fs":273,"path":282}],267:[function(require,module,exports){
module.exports=function(){var r=Error.prepareStackTrace;Error.prepareStackTrace=function(r,e){return e};var e=(new Error).stack;return Error.prepareStackTrace=r,e[2].getFileName()};
},{}],268:[function(require,module,exports){
module.exports=["assert","buffer_ieee754","buffer","child_process","cluster","console","constants","crypto","_debugger","dgram","dns","domain","events","freelist","fs","http","https","_linklist","module","net","os","path","punycode","querystring","readline","repl","stream","string_decoder","sys","timers","tls","tty","url","util","vm","zlib"]
},{}],269:[function(require,module,exports){
module.exports=require("./core.json").reduce(function(e,r){return e[r]=!0,e},{});
},{"./core.json":268}],270:[function(require,module,exports){
(function (process){
var path=require("path");module.exports=function(t,e){var r=e.moduleDirectory||"node_modules",a="/";/^([A-Za-z]:)/.test(t)?a="":/^\\\\/.test(t)&&(a="\\\\");for(var p="win32"===process.platform?/[\/\\]/:/\/+/,o=t.split(p),l=[],n=o.length-1;n>=0;n--)if(o[n]!==r){var s=path.join(path.join.apply(path,o.slice(0,n+1)),r);l.push(a+s)}return"win32"===process.platform&&(l[l.length-1]=l[l.length-1].replace(":",":\\")),l.concat(e.paths)};
}).call(this,require('_process'))

},{"_process":283,"path":282}],271:[function(require,module,exports){
var core=require("./core"),fs=require("fs"),path=require("path"),caller=require("./caller.js"),nodeModulesPaths=require("./node-modules-paths.js");module.exports=function(r,e){function a(r){if(i(r))return r;for(var e=0;e<s.length;e++){var a=r+s[e];if(i(a))return a}}function t(r){var n=path.join(r,"/package.json");if(i(n)){var s=o(n,"utf8");try{var u=JSON.parse(s);if(e.packageFilter&&(u=e.packageFilter(u,r)),u.main){var f=a(path.resolve(r,u.main));if(f)return f;var l=t(path.resolve(r,u.main));if(l)return l}}catch(c){}}return a(path.join(r,"/index"))}function n(r,n){for(var i=nodeModulesPaths(n,e),o=0;o<i.length;o++){var s=i[o],u=a(path.join(s,"/",r));if(u)return u;var f=t(path.join(s,"/",r));if(f)return f}}e||(e={});var i=e.isFile||function(r){try{var e=fs.statSync(r)}catch(a){if(a&&"ENOENT"===a.code)return!1}return e.isFile()||e.isFIFO()},o=e.readFileSync||fs.readFileSync,s=e.extensions||[".js"],u=e.basedir||path.dirname(caller());if(e.paths=e.paths||[],r.match(/^(?:\.\.?\/|\/|([A-Za-z]:)?\\)/)){var f=a(path.resolve(u,r))||t(path.resolve(u,r));if(f)return f}else{var l=n(r,u);if(l)return l}if(core[r])return r;throw new Error("Cannot find module '"+r+"' from '"+u+"'")};
},{"./caller.js":267,"./core":269,"./node-modules-paths.js":270,"fs":273,"path":282}],272:[function(require,module,exports){
(function (process){
function through(e,t,u){function r(){for(;i.length&&!d.paused;){var e=i.shift();if(null===e)return d.emit("end");d.emit("data",e)}}function n(){d.writable=!1,t.call(d),!d.readable&&d.autoDestroy&&d.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,a=!1,i=[],s=!1,d=new Stream;return d.readable=d.writable=!0,d.paused=!1,d.autoDestroy=!(u&&u.autoDestroy===!1),d.write=function(t){return e.call(this,t),!d.paused},d.queue=d.push=function(e){return s?d:(null===e&&(s=!0),i.push(e),r(),d)},d.on("end",function(){d.readable=!1,!d.writable&&d.autoDestroy&&process.nextTick(function(){d.destroy()})}),d.end=function(e){return o?void 0:(o=!0,arguments.length&&d.write(e),n(),d)},d.destroy=function(){return a?void 0:(a=!0,o=!0,i.length=0,d.writable=d.readable=!1,d.emit("close"),d)},d.pause=function(){return d.paused?void 0:(d.paused=!0,d)},d.resume=function(){return d.paused&&(d.paused=!1,d.emit("resume")),r(),d.paused||d.emit("drain"),d},d}var Stream=require("stream");exports=module.exports=through,through.through=through;
}).call(this,require('_process'))

},{"_process":283,"stream":295}],273:[function(require,module,exports){

},{}],274:[function(require,module,exports){
arguments[4][273][0].apply(exports,arguments)
},{"dup":273}],275:[function(require,module,exports){
function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(t){return this instanceof Buffer?(this.length=0,this.parent=void 0,"number"==typeof t?fromNumber(this,t):"string"==typeof t?fromString(this,t,arguments.length>1?arguments[1]:"utf8"):fromObject(this,t)):arguments.length>1?new Buffer(t,arguments[1]):new Buffer(t)}function fromNumber(t,e){if(t=allocate(t,0>e?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;e>r;r++)t[r]=0;return t}function fromString(t,e,r){"string"==typeof r&&""!==r||(r="utf8");var n=0|byteLength(e,r);return t=allocate(t,n),t.write(e,r),t}function fromObject(t,e){if(Buffer.isBuffer(e))return fromBuffer(t,e);if(isArray(e))return fromArray(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer?fromTypedArray(t,e):e.length?fromArrayLike(t,e):fromJsonObject(t,e)}function fromBuffer(t,e){var r=0|checked(e.length);return t=allocate(t,r),e.copy(t,0,0,r),t}function fromArray(t,e){var r=0|checked(e.length);t=allocate(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function fromTypedArray(t,e){var r=0|checked(e.length);t=allocate(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function fromArrayLike(t,e){var r=0|checked(e.length);t=allocate(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function fromJsonObject(t,e){var r,n=0;"Buffer"===e.type&&isArray(e.data)&&(r=e.data,n=0|checked(r.length)),t=allocate(t,n);for(var i=0;n>i;i+=1)t[i]=255&r[i];return t}function allocate(t,e){Buffer.TYPED_ARRAY_SUPPORT?t=Buffer._augment(new Uint8Array(e)):(t.length=e,t._isBuffer=!0);var r=0!==e&&e<=Buffer.poolSize>>>1;return r&&(t.parent=rootParent),t}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t,e){if(!(this instanceof SlowBuffer))return new SlowBuffer(t,e);var r=new Buffer(t,e);return delete r.parent,r}function byteLength(t,e){"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return r;case"utf8":case"utf-8":return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,r){var n=!1;if(e=0|e,r=void 0===r||r===1/0?this.length:0|r,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"binary":return binarySlice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function hexWrite(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var f=e.length;if(f%2!==0)throw new Error("Invalid hex string");n>f/2&&(n=f/2);for(var o=0;n>o;o++){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[r+o]=u}return o}function utf8Write(t,e,r,n){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,n)}function asciiWrite(t,e,r,n){return blitBuffer(asciiToBytes(e),t,r,n)}function binaryWrite(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){return blitBuffer(base64ToBytes(e),t,r,n)}function ucs2Write(t,e,r,n){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,n)}function base64Slice(t,e,r){return 0===e&&r===t.length?base64.fromByteArray(t):base64.fromByteArray(t.slice(e,r))}function utf8Slice(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var f=e;r>f;f++)t[f]<=127?(n+=decodeUtf8Char(i)+String.fromCharCode(t[f]),i=""):i+="%"+t[f].toString(16);return n+decodeUtf8Char(i)}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function binarySlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function hexSlice(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",f=e;r>f;f++)i+=toHex(t[f]);return i}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),i="",f=0;f<n.length;f+=2)i+=String.fromCharCode(n[f]+256*n[f+1]);return i}function checkOffset(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,i,f){if(!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function objectWriteUInt16(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,f=Math.min(t.length-r,2);f>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,f=Math.min(t.length-r,4);f>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function checkIEEE754(t,e,r,n,i,f){if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function writeFloat(t,e,r,n,i){return i||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,i){return i||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){e=e||1/0;for(var r,n=t.length,i=null,f=[],o=0;n>o;o++){if(r=t.charCodeAt(o),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&f.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&f.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&f.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&f.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;f.push(r)}else if(2048>r){if((e-=2)<0)break;f.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;f.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;f.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return f}function asciiToBytes(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,i,f=[],o=0;o<t.length&&!((e-=2)<0);o++)r=t.charCodeAt(o),n=r>>8,i=r%256,f.push(i),f.push(n);return f}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function decodeUtf8Char(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){function t(){}try{var e=new ArrayBuffer(0),r=new Uint8Array(e);return r.foo=function(){return 42},r.constructor=t,42===r.foo()&&r.constructor===t&&"function"==typeof r.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,f=Math.min(r,n);f>i&&t[i]===e[i];)++i;return i!==f&&(r=t[i],n=e[i]),n>r?-1:r>n?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new Buffer(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new Buffer(e),i=0;for(r=0;r<t.length;r++){var f=t[r];f.copy(n,i),i+=f.length}return n},Buffer.byteLength=byteLength,Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:Buffer.compare(this,t)},Buffer.prototype.indexOf=function(t,e){function r(t,e,r){for(var n=-1,i=0;r+i<t.length;i++)if(t[r+i]===e[-1===n?0:i-n]){if(-1===n&&(n=i),i-n+1===e.length)return r+n}else n=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(Buffer.isBuffer(t))return r(this,t,e);if("number"==typeof t)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},Buffer.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0);else{var i=n;n=e,e=0|r,r=i}var f=this.length-e;if((void 0===r||r>f)&&(r=f),t.length>0&&(0>r||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"binary":return binaryWrite(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=Buffer._augment(this.subarray(t,e));else{var i=e-t;n=new Buffer(i,void 0);for(var f=0;i>f;f++)n[f]=this[f+t]}return n.length&&(n.parent=this.parent||this),n},Buffer.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return n},Buffer.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||checkOffset(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||checkOffset(t,e,this.length);for(var n=e,i=1,f=this[t+--n];n>0&&(i*=256);)f+=this[t+--n]*i;return i*=128,f>=i&&(f-=Math.pow(2,8*e)),f},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=1,f=0;for(this[e]=255&t;++f<r&&(i*=256);)this[e+f]=t/i&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,f=1;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=t/f&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);checkInt(this,t,e,r,i-1,-i)}var f=0,o=1,u=0>t?1:0;for(this[e]=255&t;++f<r&&(o*=256);)this[e+f]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);checkInt(this,t,e,r,i-1,-i)}var f=r-1,o=1,u=0>t?1:0;for(this[e+f]=255&t;--f>=0&&(o*=256);)this[e+f]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e=0|e,r||checkInt(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;if(1e3>i||!Buffer.TYPED_ARRAY_SUPPORT)for(var f=0;i>f;f++)t[f+e]=this[f+r];else t._set(this.subarray(r,r+i),e);return i},Buffer.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=utf8ToBytes(t.toString()),f=i.length;for(n=e;r>n;n++)this[n]=i[n%f]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(t){return t.constructor=Buffer,t._isBuffer=!0,t._set=t.set,t.get=BP.get,t.set=BP.set,t.write=BP.write,t.toString=BP.toString,t.toLocaleString=BP.toString,t.toJSON=BP.toJSON,t.equals=BP.equals,t.compare=BP.compare,t.indexOf=BP.indexOf,t.copy=BP.copy,t.slice=BP.slice,t.readUIntLE=BP.readUIntLE,t.readUIntBE=BP.readUIntBE,t.readUInt8=BP.readUInt8,t.readUInt16LE=BP.readUInt16LE,t.readUInt16BE=BP.readUInt16BE,t.readUInt32LE=BP.readUInt32LE,t.readUInt32BE=BP.readUInt32BE,t.readIntLE=BP.readIntLE,t.readIntBE=BP.readIntBE,t.readInt8=BP.readInt8,t.readInt16LE=BP.readInt16LE,t.readInt16BE=BP.readInt16BE,t.readInt32LE=BP.readInt32LE,t.readInt32BE=BP.readInt32BE,t.readFloatLE=BP.readFloatLE,t.readFloatBE=BP.readFloatBE,t.readDoubleLE=BP.readDoubleLE,t.readDoubleBE=BP.readDoubleBE,t.writeUInt8=BP.writeUInt8,t.writeUIntLE=BP.writeUIntLE,t.writeUIntBE=BP.writeUIntBE,t.writeUInt16LE=BP.writeUInt16LE,t.writeUInt16BE=BP.writeUInt16BE,t.writeUInt32LE=BP.writeUInt32LE,t.writeUInt32BE=BP.writeUInt32BE,t.writeIntLE=BP.writeIntLE,t.writeIntBE=BP.writeIntBE,t.writeInt8=BP.writeInt8,t.writeInt16LE=BP.writeInt16LE,t.writeInt16BE=BP.writeInt16BE,t.writeInt32LE=BP.writeInt32LE,t.writeInt32BE=BP.writeInt32BE,t.writeFloatLE=BP.writeFloatLE,t.writeFloatBE=BP.writeFloatBE,t.writeDoubleLE=BP.writeDoubleLE,t.writeDoubleBE=BP.writeDoubleBE,t.fill=BP.fill,t.inspect=BP.inspect,t.toArrayBuffer=BP.toArrayBuffer,t};var INVALID_BASE64_RE=/[^+\/0-9A-z\-]/g;
},{"base64-js":276,"ieee754":277,"is-array":278}],276:[function(require,module,exports){
var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function r(t){var r=t.charCodeAt(0);return r===h||r===u?62:r===c||r===f?63:o>r?-1:o+10>r?r-o+26+26:i+26>r?r-i:A+26>r?r-A+26:void 0}function e(t){function e(t){i[f++]=t}var n,h,c,o,A,i;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=t.length;A="="===t.charAt(u-2)?2:"="===t.charAt(u-1)?1:0,i=new a(3*t.length/4-A),c=A>0?t.length-4:t.length;var f=0;for(n=0,h=0;c>n;n+=4,h+=3)o=r(t.charAt(n))<<18|r(t.charAt(n+1))<<12|r(t.charAt(n+2))<<6|r(t.charAt(n+3)),e((16711680&o)>>16),e((65280&o)>>8),e(255&o);return 2===A?(o=r(t.charAt(n))<<2|r(t.charAt(n+1))>>4,e(255&o)):1===A&&(o=r(t.charAt(n))<<10|r(t.charAt(n+1))<<4|r(t.charAt(n+2))>>2,e(o>>8&255),e(255&o)),i}function n(t){function r(t){return lookup.charAt(t)}function e(t){return r(t>>18&63)+r(t>>12&63)+r(t>>6&63)+r(63&t)}var n,a,h,c=t.length%3,o="";for(n=0,h=t.length-c;h>n;n+=3)a=(t[n]<<16)+(t[n+1]<<8)+t[n+2],o+=e(a);switch(c){case 1:a=t[t.length-1],o+=r(a>>2),o+=r(a<<4&63),o+="==";break;case 2:a=(t[t.length-2]<<8)+t[t.length-1],o+=r(a>>10),o+=r(a>>4&63),o+=r(a<<2&63),o+="="}return o}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,h="+".charCodeAt(0),c="/".charCodeAt(0),o="0".charCodeAt(0),A="a".charCodeAt(0),i="A".charCodeAt(0),u="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=e,t.fromByteArray=n}("undefined"==typeof exports?this.base64js={}:exports);
},{}],277:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:(s?-1:1)*(1/0);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=0>o||0===o&&0>1/o?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),o+=p+N>=1?n/f:n*Math.pow(2,1-N),o*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],278:[function(require,module,exports){
var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(r){return!!r&&"[object Array]"==str.call(r)};
},{}],279:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,i,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),r=1;i>r;r++)s[r-1]=arguments[r];n.apply(this,s)}else if(isObject(n)){for(i=arguments.length,s=new Array(i-1),r=1;i>r;r++)s[r-1]=arguments[r];for(o=n.slice(),i=o.length,r=0;i>r;r++)o[r].apply(this,s)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,i,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=s;r-- >0;)if(n[r]===t||n[r].listener&&n[r].listener===t){i=r;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};
},{}],280:[function(require,module,exports){
arguments[4][227][0].apply(exports,arguments)
},{"dup":227}],281:[function(require,module,exports){
arguments[4][228][0].apply(exports,arguments)
},{"dup":228}],282:[function(require,module,exports){
(function (process){
function normalizeArray(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function filter(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(r){return splitPathRe.exec(r).slice(1)};exports.resolve=function(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var n=e>=0?arguments[e]:process.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(r=n+"/"+r,t="/"===n.charAt(0))}return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+r||"."},exports.normalize=function(r){var t=exports.isAbsolute(r),e="/"===substr(r,-1);return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),r||t||(r="."),r&&e&&(r+="/"),(t?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),i=Math.min(n.length,s.length),o=i,u=0;i>u;u++)if(n[u]!==s[u]){o=u;break}for(var l=[],u=o;u<n.length;u++)l.push("..");return l=l.concat(s.slice(o)),l.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=splitPath(r),e=t[0],n=t[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},exports.basename=function(r,t){var e=splitPath(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return splitPath(r)[3]};var substr="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return 0>t&&(t=r.length+t),r.substr(t,e)};
}).call(this,require('_process'))

},{"_process":283}],283:[function(require,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};
},{}],284:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");
},{"./lib/_stream_duplex.js":285}],285:[function(require,module,exports){
(function (process){
function Duplex(e){return this instanceof Duplex?(Readable.call(this,e),Writable.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(e)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;r>i;i++)t(e[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});
}).call(this,require('_process'))

},{"./_stream_readable":287,"./_stream_writable":289,"_process":283,"core-util-is":290,"inherits":280}],286:[function(require,module,exports){
arguments[4][240][0].apply(exports,arguments)
},{"./_stream_transform":288,"core-util-is":290,"dup":240,"inherits":280}],287:[function(require,module,exports){
(function (process){
function ReadableState(e,t){var n=require("./_stream_duplex");e=e||{};var r=e.highWaterMark,i=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){require("./_stream_duplex");return this instanceof Readable?(this._readableState=new ReadableState(e,this),this.readable=!0,void Stream.call(this)):new Readable(e)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(util.isNullOrUndefined(n))t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){var d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&emitReadable(e)),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;32>t;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||util.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:0>=e?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,emitReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){resume_(e,t)}))}function resume_(e,t){t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do var n=e.read();while(null!==n&&t.flowing)}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else if(e<r[0].length){var o=r[0];n=o.slice(0,e),r[0]=o.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var l=0,u=0,s=r.length;s>u&&e>l;u++){var o=r[0],h=Math.min(e-l,o.length);a?n+=o.slice(0,h):o.copy(n,l,0,h),h<o.length?r[0]=o.slice(h):r.shift(),l+=h}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder,debug=require("util");debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return util.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=new Buffer(e,t),t="")),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){var t=this._readableState;return readableAddChunk(this,t,e,"",!0)},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,n=e;if((!util.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(e=howMuchToRead(e,t),0===e&&t.ended)return 0===t.length&&endReadable(this),null;var r=t.needReadable;debug("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,debug("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,debug("reading or ended",r)),r&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=howMuchToRead(n,t));var i;return i=e>0?fromList(e,t):null,util.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&endReadable(this),util.isNull(i)||this.emit("data",i),i},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){function n(e){debug("onunpipe"),e===s&&i()}function r(){debug("onend"),e.end()}function i(){debug("cleanup"),e.removeListener("close",o),e.removeListener("finish",l),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",n),s.removeListener("end",r),s.removeListener("end",i),s.removeListener("data",a),!h.awaitDrain||e._writableState&&!e._writableState.needDrain||c()}function a(t){debug("ondata");var n=e.write(t);!1===n&&(debug("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,s.pause())}function d(t){debug("onerror",t),u(),e.removeListener("error",d),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function o(){e.removeListener("finish",l),u()}function l(){debug("onfinish"),e.removeListener("close",o),u()}function u(){debug("unpipe"),s.unpipe(e)}var s=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,debug("pipe count=%d opts=%j",h.pipesCount,t);var f=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,b=f?r:i;h.endEmitted?process.nextTick(b):s.once("end",b),e.on("unpipe",n);var c=pipeOnDrain(s);return e.on("drain",c),s.on("data",a),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(d):e._events.error=[d,e._events.error]:e.on("error",d),e.once("close",o),e.once("finish",l),e.emit("pipe",s),h.flowing||(debug("pipe resume"),s.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=indexOf(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&emitReadable(this,r);else{var i=this;process.nextTick(function(){debug("readable nexttick read 0"),i.read(0)})}}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,e.reading||(debug("resume read 0"),this.read(0)),resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var a=r.push(i);a||(n=!0,e.pause())}});for(var i in e)util.isFunction(e[i])&&util.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var a=["error","close","destroy","pause","resume"];return forEach(a,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},r},Readable._fromList=fromList;
}).call(this,require('_process'))

},{"./_stream_duplex":285,"_process":283,"buffer":275,"core-util-is":290,"events":279,"inherits":280,"isarray":281,"stream":295,"string_decoder/":296,"util":274}],288:[function(require,module,exports){
arguments[4][242][0].apply(exports,arguments)
},{"./_stream_duplex":285,"core-util-is":290,"dup":242,"inherits":280}],289:[function(require,module,exports){
(function (process){
function WriteReq(e,i,t){this.chunk=e,this.encoding=i,this.callback=t}function WritableState(e,i){var t=require("./_stream_duplex");e=e||{};var r=e.highWaterMark,n=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.objectMode=!!e.objectMode,i instanceof t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=e.decodeStrings===!1;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(e){var i=require("./_stream_duplex");return this instanceof Writable||this instanceof i?(this._writableState=new WritableState(e,this),this.writable=!0,void Stream.call(this)):new Writable(e)}function writeAfterEnd(e,i,t){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){t(r)})}function validChunk(e,i,t,r){var n=!0;if(!(util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||i.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),process.nextTick(function(){r(o)}),n=!1}return n}function decodeChunk(e,i,t){return!e.objectMode&&e.decodeStrings!==!1&&util.isString(i)&&(i=new Buffer(i,t)),i}function writeOrBuffer(e,i,t,r,n){t=decodeChunk(i,t,r),util.isBuffer(t)&&(r="buffer");var o=i.objectMode?1:t.length;i.length+=o;var f=i.length<i.highWaterMark;return f||(i.needDrain=!0),i.writing||i.corked?i.buffer.push(new WriteReq(t,r,n)):doWrite(e,i,!1,o,t,r,n),f}function doWrite(e,i,t,r,n,o,f){i.writelen=r,i.writecb=f,i.writing=!0,i.sync=!0,t?e._writev(n,i.onwrite):e._write(n,o,i.onwrite),i.sync=!1}function onwriteError(e,i,t,r,n){t?process.nextTick(function(){i.pendingcb--,n(r)}):(i.pendingcb--,n(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,i){var t=e._writableState,r=t.sync,n=t.writecb;if(onwriteStateUpdate(t),i)onwriteError(e,t,r,i,n);else{var o=needFinish(e,t);o||t.corked||t.bufferProcessing||!t.buffer.length||clearBuffer(e,t),r?process.nextTick(function(){afterWrite(e,t,o,n)}):afterWrite(e,t,o,n)}}function afterWrite(e,i,t,r){t||onwriteDrain(e,i),i.pendingcb--,r(),finishMaybe(e,i)}function onwriteDrain(e,i){0===i.length&&i.needDrain&&(i.needDrain=!1,e.emit("drain"))}function clearBuffer(e,i){if(i.bufferProcessing=!0,e._writev&&i.buffer.length>1){for(var t=[],r=0;r<i.buffer.length;r++)t.push(i.buffer[r].callback);i.pendingcb++,doWrite(e,i,!0,i.length,i.buffer,"",function(e){for(var r=0;r<t.length;r++)i.pendingcb--,t[r](e)}),i.buffer=[]}else{for(var r=0;r<i.buffer.length;r++){var n=i.buffer[r],o=n.chunk,f=n.encoding,u=n.callback,s=i.objectMode?1:o.length;if(doWrite(e,i,!1,s,o,f,u),i.writing){r++;break}}r<i.buffer.length?i.buffer=i.buffer.slice(r):i.buffer.length=0}i.bufferProcessing=!1}function needFinish(e,i){return i.ending&&0===i.length&&!i.finished&&!i.writing}function prefinish(e,i){i.prefinished||(i.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,i){var t=needFinish(e,i);return t&&(0===i.pendingcb?(prefinish(e,i),i.finished=!0,e.emit("finish")):prefinish(e,i)),t}function endWritable(e,i,t){i.ending=!0,finishMaybe(e,i),t&&(i.finished?process.nextTick(t):e.once("finish",t)),i.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,i,t){var r=this._writableState,n=!1;return util.isFunction(i)&&(t=i,i=null),util.isBuffer(e)?i="buffer":i||(i=r.defaultEncoding),util.isFunction(t)||(t=function(){}),r.ended?writeAfterEnd(this,r,t):validChunk(this,r,e,t)&&(r.pendingcb++,n=writeOrBuffer(this,r,e,i,t)),n},Writable.prototype.cork=function(){var e=this._writableState;e.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||clearBuffer(this,e))},Writable.prototype._write=function(e,i,t){t(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,i,t){var r=this._writableState;util.isFunction(e)?(t=e,e=null,i=null):util.isFunction(i)&&(t=i,i=null),util.isNullOrUndefined(e)||this.write(e,i),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||endWritable(this,r,t)};
}).call(this,require('_process'))

},{"./_stream_duplex":285,"_process":283,"buffer":275,"core-util-is":290,"inherits":280,"stream":295}],290:[function(require,module,exports){
(function (Buffer){
function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function isBuffer(e){return Buffer.isBuffer(e)}function objectToString(e){return Object.prototype.toString.call(e)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=isBuffer;
}).call(this,require("buffer").Buffer)

},{"buffer":275}],291:[function(require,module,exports){
module.exports=require("./lib/_stream_passthrough.js");
},{"./lib/_stream_passthrough.js":286}],292:[function(require,module,exports){
arguments[4][248][0].apply(exports,arguments)
},{"./lib/_stream_duplex.js":285,"./lib/_stream_passthrough.js":286,"./lib/_stream_readable.js":287,"./lib/_stream_transform.js":288,"./lib/_stream_writable.js":289,"dup":248,"stream":295}],293:[function(require,module,exports){
arguments[4][230][0].apply(exports,arguments)
},{"./lib/_stream_transform.js":288,"dup":230}],294:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");
},{"./lib/_stream_writable.js":289}],295:[function(require,module,exports){
function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){function t(r){e.writable&&!1===e.write(r)&&m.pause&&m.pause()}function n(){m.readable&&m.resume&&m.resume()}function a(){u||(u=!0,e.end())}function o(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function i(e){if(s(),0===EE.listenerCount(this,"error"))throw e}function s(){m.removeListener("data",t),e.removeListener("drain",n),m.removeListener("end",a),m.removeListener("close",o),m.removeListener("error",i),e.removeListener("error",i),m.removeListener("end",s),m.removeListener("close",s),e.removeListener("close",s)}var m=this;m.on("data",t),e.on("drain",n),e._isStdio||r&&r.end===!1||(m.on("end",a),m.on("close",o));var u=!1;return m.on("error",i),e.on("error",i),m.on("end",s),m.on("close",s),e.on("close",s),e.emit("pipe",m),e};
},{"events":279,"inherits":280,"readable-stream/duplex.js":284,"readable-stream/passthrough.js":291,"readable-stream/readable.js":292,"readable-stream/transform.js":293,"readable-stream/writable.js":294}],296:[function(require,module,exports){
arguments[4][229][0].apply(exports,arguments)
},{"buffer":275,"dup":229}],297:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],298:[function(require,module,exports){
(function (process,global){
function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c="",a=!1,l=["{","}"];if(isArray(r)&&(a=!0,l=["[","]"]),isFunction(r)){var p=r.name?": "+r.name:"";c=" [Function"+p+"]"}if(isRegExp(r)&&(c=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(c=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(c=" "+formatError(r)),0===o.length&&(!a||0==r.length))return l[0]+c+l[1];if(0>t)return isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var f;return f=a?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,a)}),e.seen.pop(),reduceToSingleString(f,c,l)}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;u>s;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if(c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]},c.get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){var n=0,i=e.reduce(function(e,r){return n++,r.indexOf("\n")>=0&&n++,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return 10>e?"0"+e.toString(10):e.toString(10)}function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}for(var t=1,n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(r){return"[Circular]"}default:return e}}),s=n[t];i>t;s=n[++t])o+=isNull(s)||!isObject(s)?" "+s:" "+inspect(s);return o},exports.deprecate=function(e,r){function t(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(process.noDeprecation===!0)return e;var n=!1;return t};var debugs={},debugEnviron;exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./support/isBuffer":297,"_process":283,"inherits":280}],299:[function(require,module,exports){
!function(e,t){"use strict";function i(e,i){return u[i]!==t?u[i].apply(e,Array.prototype.slice.call(arguments,2)):e}function s(t){return i(t,"option","placeholder")||t.data("placeholder")||e.bselect.i18n.selectAnOption}function n(e){var t=e.find(".bselect-option-list"),i=t.find("li:visible").length;t.innerHeight(1.5*parseInt(t.css("line-height"),10)*(5>i?i:5))}function a(t,s,n){var a=i(t,"element");e.each(s,function(t,i){if(n[t]!==i&&"size"===t){var s=e.map(p.slice(0),function(e){return"bselect-"+e}).join(" ");a.removeClass(s),p.indexOf(n.size)>-1&&a.addClass("bselect-"+n.size)}})}function l(t){var s=i(t,"element");s.find(".bselect-message").text(e.bselect.i18n.noOptionsAvailable).show()}function o(t){if(38===t.keyCode||40===t.keyCode||13===t.keyCode){var i=e(this),s=i.is(".bselect-search-input");switch(t.keyCode){case 38:s?e(t.delegateTarget).find(".bselect-option:visible:last").focus():i.prevAll(".bselect-option:visible").eq(0).focus();break;case 40:s?e(t.delegateTarget).find(".bselect-option:visible:first").focus():i.nextAll(".bselect-option:visible").eq(0).focus();break;case 13:s||i.trigger("click")}return!1}}function r(t,n){var l,r,p,b,f,v=e(t);if(b=++c,p=e("<div class='bselect' />",{id:"bselect-"+b}),f=e("<div class='bselect-dropdown' />"),n.searchInput===!0){var g=e("<div class='bselect-search' />");e("<input type='text' class='bselect-search-input' />").attr({role:"combobox",tabindex:1,"aria-expanded":"false","aria-owns":"bselect-option-list-"+b}).appendTo(g),e("<span class='bselect-search-icon'><i class='icon-search' /></span>").appendTo(g),g.appendTo(f)}e("<div class='bselect-message' role='status' />").appendTo(f),e("<ul class='bselect-option-list' />").attr({id:"bselect-option-list-"+b,role:"listbox"}).appendTo(f),p.append(f).insertAfter(v),v.data(d,{options:n,element:p,open:!1}),a(v,e.bselect.defaults,n),i(v,"refresh"),v.bind("bselectselect",n.select),v.bind("bselectselected",n.selected),v.bind("bselectsearch",n.search),r=e("<span />").addClass("bselect-label").text(s(v)),l=e("<button type='button' />").addClass("bselect-caret").html("<span class='caret'></span>"),p.prepend(l).prepend(r),r.outerWidth(v.outerWidth()-l.outerWidth()),v.addClass("bselect-inaccessible"),h.push(v),p.find(".bselect-search-input").keyup(e.proxy(u.search,v)),p.on("click",".bselect-option",e.proxy(u.select,v)),p.on("click",".bselect-caret, .bselect-label",e.proxy(u.toggle,v)),p.on("keydown",".bselect-option, .bselect-search-input",o),v.bind("change.bselect",function(){var e=v.data(d).itemsMap[this.value];i(v,"select",e)}).trigger("change.bselect"),t.id&&e(document).on("click","label[for='"+t.id+"']",function(){return i(v,"show"),!1})}var c=0,d="bselect",h=[],p=["mini","small","large"],u={option:function(i,s){var n=this.data(d).options||{},l=e.extend({},n);return"string"==typeof i&&"_"!==i[0]?s===t?n[i]:(n[i]=s,a(this,l,n),this):(e.isPlainObject(i)&&(e.extend(n,i),a(this,l,n),this.data(d).options=n),n)},element:function(){return this.data(d).element},toggle:function(t){if(this[0].disabled)return this;var s=i(this,"element");if(t instanceof e.Event){var n=i(this,"option","showOn");if(e(t.target).is(".bselect-label")&&"both"!==n)return this}return s.find(".bselect-dropdown").is(":hidden")?i(this,"show"):i(this,"hide"),this},show:function(){var t=this.data(d);if(this[0].disabled||t.open)return this;var s,a,l=t.element,o=l.find(".bselect-dropdown");if(o.css("left","-9999em").show(),n(l),a=l.find(".bselect-option.active"),a.length){var r=l.find(".bselect-option-list"),c=a.position().top,h=r.position().top;c-h<r.height()?r.scrollTop(0):r.scrollTop(c-h)}return o.hide().css("left","auto"),o.slideDown(i(this,"option","animationDuration")),this.data(d,e.extend(t,{open:!0})),l.addClass("open"),s=l.find(".bselect-search-input").focus(),s.innerWidth(s.parent().width()-s.next().outerWidth()),l.find(".bselect-search-input").attr("aria-expanded","true"),this},hide:function(s){var n=this.data(d);if(this[0].disabled||!n.open)return this;var a=n.options,l=n.element;return s=s===t?!0:s,this.data(d,e.extend(n,{open:!1})),l.find(".bselect-dropdown").slideUp(a.animationDuration),l.removeClass("open"),s&&a.clearSearchOnExit&&i(this,"clearSearch"),l.find(".bselect-search-input").attr("aria-expanded","false"),this},select:function(t){var s,n,a=i(this,"element");if(t instanceof e.Event)s=e(t.currentTarget);else if(s=a.find("li").eq(t),!s.length)return this;var l=a.find("li").removeClass("active").attr("aria-selected","false").index(s),o=this.find("option[value!='']").get(l);return this.trigger("bselectselect",[o]),n=s.addClass("active").data("value"),s.attr("aria-selected","true"),a.find(".bselect-label").text(s.text()),i(this,"hide"),this.val(n),this.trigger("bselectselected",[n,o]),this},search:function(t){if(this[0].disabled)return this;var s,a,o=i(this,"option"),r=t instanceof e.Event?t.target.value:t,c=i(this,"element");if(""===r&&i(this,"clearSearch"),t instanceof e.Event||c.find(".bselect-search").val(r),!(r===o.lastSearch||r.length<o.minSearchInput)){var d=e();for(s=c.find("li").hide(),a=0;a<s.length;a++)s[a].textContent.toLowerCase().indexOf(r.toLowerCase())>-1&&(d=d.add(e(s[a]).show()));return 0===d.length?l(this):c.find(".bselect-message").hide(),this.trigger("bselectsearch",[r,d]),n(s.end()),this}},clearSearch:function(){var e=i(this,"element");return e.find(".bselect-search-input").val(""),e.find("li").show(),e.find(".bselect-message").hide(),n(e),this},disable:function(){return this[0].disabled||(i(this,"element").addClass("disabled"),this.prop("disabled",!0)),this},enable:function(){return this[0].disabled&&(i(this,"element").removeClass("disabled"),this.prop("disabled",!1)),this},refresh:function(){var t=i(this,"element"),s=t.find(".bselect-option-list").empty(),n={},a=0;return t.toggleClass("disabled",this.prop("disabled")),this.find("option, > optgroup").each(function(){var t,i,l=e(this).is("option");l&&!this.value||(t=l?"bselect-option"+(e(this).closest("optgroup").length?" grouped":""):"bselect-option-group",i=e("<li />").attr({"class":t,role:"option",tabindex:l?2:-1,"aria-selected":"false"}),l?(i.data("value",this.value),n[this.value]=a,i.html("<a href='#'>"+this.text+"</a>")):i.text(this.label),i.appendTo(s),a++)}),0===a&&l(this),this.data(d).itemsMap=n,this},destroy:function(){var e=i(this,"element");return this.data(d,null),h.splice(h.indexOf(this),1),e.remove(),this.show(),this}};e.fn.bselect=function(i){return"string"==typeof i&&this[0]?e.isPlainObject(e(this[0]).data(d))&&u[i]!==t?u[i].apply(e(this[0]),Array.prototype.slice.call(arguments,1)):this:this.each(function(){e.isPlainObject(e(this).data(d))||(i=e.isPlainObject(i)?i:{},i=e.extend({},e.bselect.defaults,i),r(this,i))})},e.bselect={defaults:{size:"normal",showOn:"both",clearSearchOnExit:!0,minSearchInput:0,animationDuration:300,searchInput:!0,search:null,select:null,selected:null},i18n:{selectAnOption:"Select an option",noOptionsAvailable:"No options available."}},e(document).click(function(e){var t,s,n;for(t=0,s=h.length;s>t;t++)n=h[t].data(d),n.open&&!n.element.has(e.target).length&&i(h[t],"hide")}),e(window).resize(function(){var e,t,i,s;for(e=0,t=h.length;t>e;e++)i=h[e].data(d),s=i.element.find(".bselect-caret"),i.element.find(".bselect-label").outerWidth(h[e].outerWidth()-s.outerWidth())})}(jQuery);
},{}],300:[function(require,module,exports){
!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return t>n?-1:n>t?1:n>=t?0:NaN}function r(n){return null===n?NaN:+n}function i(n){return!isNaN(n)}function u(n){return{left:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var u=r+i>>>1;n(t[u],e)<0?r=u+1:i=u}return r},right:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var u=r+i>>>1;n(t[u],e)>0?i=u:r=u+1}return r}}}function o(n){return n.length}function a(n){for(var t=1;n*t%1;)t*=10;return t}function l(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function c(){this._=Object.create(null)}function f(n){return(n+="")===bo||n[0]===_o?_o+n:n}function s(n){return(n+="")[0]===_o?n.slice(1):n}function h(n){return f(n)in this._}function p(n){return(n=f(n))in this._&&delete this._[n]}function g(){var n=[];for(var t in this._)n.push(s(t));return n}function v(){var n=0;for(var t in this._)++n;return n}function d(){for(var n in this._)return!1;return!0}function y(){this._=Object.create(null)}function m(n){return n}function M(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function x(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=wo.length;r>e;++e){var i=wo[e]+t;if(i in n)return i}}function b(){}function _(){}function w(n){function t(){for(var t,r=e,i=-1,u=r.length;++i<u;)(t=r[i].on)&&t.apply(this,arguments);return n}var e=[],r=new c;return t.on=function(t,i){var u,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,u=e.indexOf(o)).concat(e.slice(u+1)),r.remove(t)),i&&e.push(r.set(t,{on:i})),n)},t}function S(){ao.event.preventDefault()}function k(){for(var n,t=ao.event;n=t.sourceEvent;)t=n;return t}function N(n){for(var t=new _,e=0,r=arguments.length;++e<r;)t[arguments[e]]=w(t);return t.of=function(e,r){return function(i){try{var u=i.sourceEvent=ao.event;i.target=n,ao.event=i,t[i.type].apply(e,r)}finally{ao.event=u}}},t}function E(n){return ko(n,Co),n}function A(n){return"function"==typeof n?n:function(){return No(n,this)}}function C(n){return"function"==typeof n?n:function(){return Eo(n,this)}}function z(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function i(){this.setAttribute(n,t)}function u(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=ao.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?u:i}function L(n){return n.trim().replace(/\s+/g," ")}function q(n){return new RegExp("(?:^|\\s+)"+ao.requote(n)+"(?:\\s+|$)","g")}function T(n){return(n+"").trim().split(/^|\s+/)}function R(n,t){function e(){for(var e=-1;++e<i;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<i;)n[e](this,r)}n=T(n).map(D);var i=n.length;return"function"==typeof t?r:e}function D(n){var t=q(n);return function(e,r){if(i=e.classList)return r?i.add(n):i.remove(n);var i=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||e.setAttribute("class",L(i+" "+n))):e.setAttribute("class",L(i.replace(t," ")))}}function P(n,t,e){function r(){this.style.removeProperty(n)}function i(){this.style.setProperty(n,t,e)}function u(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?u:i}function U(n,t){function e(){delete this[n]}function r(){this[n]=t}function i(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?i:r}function j(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e&&e!==t.documentElement.namespaceURI?t.createElementNS(e,n):t.createElement(n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=ao.ns.qualify(n)).local?e:t}function F(){var n=this.parentNode;n&&n.removeChild(this)}function H(n){return{__data__:n}}function O(n){return function(){return Ao(this,n)}}function I(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(n,t){for(var e=0,r=n.length;r>e;e++)for(var i,u=n[e],o=0,a=u.length;a>o;o++)(i=u[o])&&t(i,o,e);return n}function Z(n){return ko(n,Lo),n}function V(n){var t,e;return function(r,i,u){var o,a=n[u].update,l=a.length;for(u!=e&&(e=u,t=0),i>=t&&(t=i+1);!(o=a[t])&&++t<l;);return o}}function X(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function i(){var i=l(t,co(arguments));r.call(this),this.addEventListener(n,this[o]=i,i.$=e),i._=t}function u(){var t,e=new RegExp("^__on([^.]+)"+ao.requote(n)+"$");for(var r in this)if(t=r.match(e)){var i=this[r];this.removeEventListener(t[1],i,i.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),l=$;a>0&&(n=n.slice(0,a));var c=qo.get(n);return c&&(n=c,l=B),a?t?i:r:t?b:u}function $(n,t){return function(e){var r=ao.event;ao.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{ao.event=r}}}function B(n,t){var e=$(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function W(e){var r=".dragsuppress-"+ ++Ro,i="click"+r,u=ao.select(t(e)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==To&&(To="onselectstart"in e?!1:x(e.style,"userSelect")),To){var o=n(e).style,a=o[To];o[To]="none"}return function(n){if(u.on(r,null),To&&(o[To]=a),n){var t=function(){u.on(i,null)};u.on(i,function(){S(),t()},!0),setTimeout(t,0)}}}function J(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();if(0>Do){var u=t(n);if(u.scrollX||u.scrollY){r=ao.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=r[0][0].getScreenCTM();Do=!(o.f||o.e),r.remove()}}return Do?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}function G(){return ao.event.changedTouches[0].identifier}function K(n){return n>0?1:0>n?-1:0}function Q(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function nn(n){return n>1?0:-1>n?jo:Math.acos(n)}function tn(n){return n>1?Oo:-1>n?-Oo:Math.asin(n)}function en(n){return((n=Math.exp(n))-1/n)/2}function rn(n){return((n=Math.exp(n))+1/n)/2}function un(n){return((n=Math.exp(2*n))-1)/(n+1)}function on(n){return(n=Math.sin(n/2))*n}function an(){}function ln(n,t,e){return this instanceof ln?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof ln?new ln(n.h,n.s,n.l):_n(""+n,wn,ln):new ln(n,t,e)}function cn(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?u+(o-u)*n/60:180>n?o:240>n?u+(o-u)*(240-n)/60:u}function i(n){return Math.round(255*r(n))}var u,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,u=2*e-o,new mn(i(n+120),i(n),i(n-120))}function fn(n,t,e){return this instanceof fn?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof fn?new fn(n.h,n.c,n.l):n instanceof hn?gn(n.l,n.a,n.b):gn((n=Sn((n=ao.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new fn(n,t,e)}function sn(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new hn(e,Math.cos(n*=Io)*t,Math.sin(n)*t)}function hn(n,t,e){return this instanceof hn?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof hn?new hn(n.l,n.a,n.b):n instanceof fn?sn(n.h,n.c,n.l):Sn((n=mn(n)).r,n.g,n.b):new hn(n,t,e)}function pn(n,t,e){var r=(n+16)/116,i=r+t/500,u=r-e/200;return i=vn(i)*Qo,r=vn(r)*na,u=vn(u)*ta,new mn(yn(3.2404542*i-1.5371385*r-.4985314*u),yn(-.969266*i+1.8760108*r+.041556*u),yn(.0556434*i-.2040259*r+1.0572252*u))}function gn(n,t,e){return n>0?new fn(Math.atan2(e,t)*Yo,Math.sqrt(t*t+e*e),n):new fn(NaN,NaN,n)}function vn(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function dn(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function yn(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function mn(n,t,e){return this instanceof mn?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof mn?new mn(n.r,n.g,n.b):_n(""+n,mn,cn):new mn(n,t,e)}function Mn(n){return new mn(n>>16,n>>8&255,255&n)}function xn(n){return Mn(n)+""}function bn(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function _n(n,t,e){var r,i,u,o=0,a=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(Nn(i[0]),Nn(i[1]),Nn(i[2]))}return(u=ia.get(n))?t(u.r,u.g,u.b):(null==n||"#"!==n.charAt(0)||isNaN(u=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&u)>>4,o=o>>4|o,a=240&u,a=a>>4|a,l=15&u,l=l<<4|l):7===n.length&&(o=(16711680&u)>>16,a=(65280&u)>>8,l=255&u)),t(o,a,l))}function wn(n,t,e){var r,i,u=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-u,l=(o+u)/2;return a?(i=.5>l?a/(o+u):a/(2-o-u),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=NaN,i=l>0&&1>l?0:r),new ln(r,i,l)}function Sn(n,t,e){n=kn(n),t=kn(t),e=kn(e);var r=dn((.4124564*n+.3575761*t+.1804375*e)/Qo),i=dn((.2126729*n+.7151522*t+.072175*e)/na),u=dn((.0193339*n+.119192*t+.9503041*e)/ta);return hn(116*i-16,500*(r-i),200*(i-u))}function kn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Nn(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function En(n){return"function"==typeof n?n:function(){return n}}function An(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Cn(t,e,n,r)}}function Cn(n,t,e,r){function i(){var n,t=l.status;if(!t&&Ln(l)||t>=200&&300>t||304===t){try{n=e.call(u,l)}catch(r){return void o.error.call(u,r)}o.load.call(u,n)}else o.error.call(u,l)}var u={},o=ao.dispatch("beforesend","progress","load","error"),a={},l=new XMLHttpRequest,c=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(n)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=i:l.onreadystatechange=function(){l.readyState>3&&i()},l.onprogress=function(n){var t=ao.event;ao.event=n;try{o.progress.call(u,l)}finally{ao.event=t}},u.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",u)},u.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",u):t},u.responseType=function(n){return arguments.length?(c=n,u):c},u.response=function(n){return e=n,u},["get","post"].forEach(function(n){u[n]=function(){return u.send.apply(u,[n].concat(co(arguments)))}}),u.send=function(e,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),l.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),l.setRequestHeader)for(var f in a)l.setRequestHeader(f,a[f]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=c&&(l.responseType=c),null!=i&&u.on("error",i).on("load",function(n){i(null,n)}),o.beforesend.call(u,l),l.send(null==r?null:r),u},u.abort=function(){return l.abort(),u},ao.rebind(u,o,"on"),null==r?u:u.get(zn(r))}function zn(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function Ln(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qn(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var i=e+t,u={c:n,t:i,n:null};return oa?oa.n=u:ua=u,oa=u,aa||(la=clearTimeout(la),aa=1,ca(Tn)),u}function Tn(){var n=Rn(),t=Dn()-n;t>24?(isFinite(t)&&(clearTimeout(la),la=setTimeout(Tn,t)),aa=0):(aa=1,ca(Tn))}function Rn(){for(var n=Date.now(),t=ua;t;)n>=t.t&&t.c(n-t.t)&&(t.c=null),t=t.n;return n}function Dn(){for(var n,t=ua,e=1/0;t;)t.c?(t.t<e&&(e=t.t),t=(n=t).n):t=n?n.n=t.n:ua=t.n;return oa=n,e}function Pn(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Un(n,t){var e=Math.pow(10,3*xo(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function jn(n){var t=n.decimal,e=n.thousands,r=n.grouping,i=n.currency,u=r&&e?function(n,t){for(var i=n.length,u=[],o=0,a=r[0],l=0;i>0&&a>0&&(l+a+1>t&&(a=Math.max(1,t-l)),u.push(n.substring(i-=a,i+a)),!((l+=a+1)>t));)a=r[o=(o+1)%r.length];return u.reverse().join(e)}:m;return function(n){var e=sa.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",l=e[4]||"",c=e[5],f=+e[6],s=e[7],h=e[8],p=e[9],g=1,v="",d="",y=!1,m=!0;switch(h&&(h=+h.substring(1)),(c||"0"===r&&"="===o)&&(c=r="0",o="="),p){case"n":s=!0,p="g";break;case"%":g=100,d="%",p="f";break;case"p":g=100,d="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(v="0"+p.toLowerCase());case"c":m=!1;case"d":y=!0,h=0;break;case"s":g=-1,p="r"}"$"===l&&(v=i[0],d=i[1]),"r"!=p||h||(p="g"),null!=h&&("g"==p?h=Math.max(1,Math.min(21,h)):"e"!=p&&"f"!=p||(h=Math.max(0,Math.min(20,h)))),p=ha.get(p)||Fn;var M=c&&s;return function(n){var e=d;if(y&&n%1)return"";var i=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===a?"":a;if(0>g){var l=ao.formatPrefix(n,h);n=l.scale(n),e=l.symbol+d}else n*=g;n=p(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=m?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!c&&s&&(x=u(x,1/0));var S=v.length+x.length+b.length+(M?0:i.length),k=f>S?new Array(S=f-S+1).join(r):"";return M&&(x=u(k+x,k.length?f-b.length:1/0)),i+=v,n=x+b,("<"===o?i+n+k:">"===o?k+i+n:"^"===o?k.substring(0,S>>=1)+i+n+k.substring(S):i+(M?n:k+n))+e}}}function Fn(n){return n+""}function Hn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function On(n,t,e){function r(t){var e=n(t),r=u(e,1);return r-t>t-e?e:r}function i(e){return t(e=n(new ga(e-1)),1),e}function u(n,e){return t(n=new ga(+n),e),n}function o(n,r,u){var o=i(n),a=[];if(u>1)for(;r>o;)e(o)%u||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{ga=Hn;var r=new Hn;return r._=n,o(r,t,e)}finally{ga=Date}}n.floor=n,n.round=r,n.ceil=i,n.offset=u,n.range=o;var l=n.utc=In(n);return l.floor=l,l.round=In(r),l.ceil=In(i),l.offset=In(u),l.range=a,n}function In(n){return function(t,e){try{ga=Hn;var r=new Hn;return r._=t,n(r,e)._}finally{ga=Date}}}function Yn(n){function t(n){function t(t){for(var e,i,u,o=[],a=-1,l=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(l,a)),null!=(i=da[e=n.charAt(++a)])&&(e=n.charAt(++a)),(u=A[e])&&(e=u(t,null==i?"e"===e?" ":"0":i)),o.push(e),l=a+1);return o.push(n.slice(l,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=e(r,n,t,0);if(i!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var u=null!=r.Z&&ga!==Hn,o=new(u?Hn:ga);return"j"in r?o.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),u?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var i,u,o,a=0,l=t.length,c=e.length;l>a;){if(r>=c)return-1;if(i=t.charCodeAt(a++),37===i){if(o=t.charAt(a++),u=C[o in da?t.charAt(a++):o],!u||(r=u(n,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){N.lastIndex=0;var r=N.exec(t.slice(e));return r?(n.m=E.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,A.c.toString(),t,r)}function l(n,t,r){return e(n,A.x.toString(),t,r)}function c(n,t,r){return e(n,A.X.toString(),t,r)}function f(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var s=n.dateTime,h=n.date,p=n.time,g=n.periods,v=n.days,d=n.shortDays,y=n.months,m=n.shortMonths;t.utc=function(n){function e(n){try{ga=Hn;var t=new ga;return t._=n,r(t)}finally{ga=Date}}var r=t(n);return e.parse=function(n){try{ga=Hn;var t=r.parse(n);return t&&t._}finally{ga=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ct;var M=ao.map(),x=Vn(v),b=Xn(v),_=Vn(d),w=Xn(d),S=Vn(y),k=Xn(y),N=Vn(m),E=Xn(m);g.forEach(function(n,t){M.set(n.toLowerCase(),t)});var A={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return m[n.getMonth()]},B:function(n){return y[n.getMonth()]},c:t(s),d:function(n,t){return Zn(n.getDate(),t,2)},e:function(n,t){return Zn(n.getDate(),t,2)},H:function(n,t){return Zn(n.getHours(),t,2)},I:function(n,t){return Zn(n.getHours()%12||12,t,2)},j:function(n,t){return Zn(1+pa.dayOfYear(n),t,3)},L:function(n,t){return Zn(n.getMilliseconds(),t,3)},m:function(n,t){return Zn(n.getMonth()+1,t,2)},M:function(n,t){return Zn(n.getMinutes(),t,2)},p:function(n){return g[+(n.getHours()>=12)]},S:function(n,t){return Zn(n.getSeconds(),t,2)},U:function(n,t){return Zn(pa.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Zn(pa.mondayOfYear(n),t,2)},x:t(h),X:t(p),y:function(n,t){return Zn(n.getFullYear()%100,t,2)},Y:function(n,t){return Zn(n.getFullYear()%1e4,t,4)},Z:at,"%":function(){return"%"}},C={a:r,A:i,b:u,B:o,c:a,d:tt,e:tt,H:rt,I:rt,j:et,L:ot,m:nt,M:it,p:f,S:ut,U:Bn,w:$n,W:Wn,x:l,X:c,y:Gn,Y:Jn,Z:Kn,"%":lt};return t}function Zn(n,t,e){var r=0>n?"-":"",i=(r?-n:n)+"",u=i.length;return r+(e>u?new Array(e-u+1).join(t)+i:i)}function Vn(n){return new RegExp("^(?:"+n.map(ao.requote).join("|")+")","i")}function Xn(n){for(var t=new c,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function $n(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Bn(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function Wn(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Jn(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Gn(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.y=Qn(+r[0]),e+r[0].length):-1}function Kn(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Qn(n){return n+(n>68?1900:2e3)}function nt(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function tt(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function et(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function rt(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function it(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function ut(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ot(n,t,e){ya.lastIndex=0;var r=ya.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function at(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=xo(t)/60|0,i=xo(t)%60;return e+Zn(r,"0",2)+Zn(i,"0",2)}function lt(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ct(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ft(){}function st(n,t,e){var r=e.s=n+t,i=r-n,u=r-i;e.t=n-u+(t-i)}function ht(n,t){n&&_a.hasOwnProperty(n.type)&&_a[n.type](n,t)}function pt(n,t,e){var r,i=-1,u=n.length-e;for(t.lineStart();++i<u;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function gt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)pt(n[e],t,1);t.polygonEnd()}function vt(){function n(n,t){n*=Io,t=t*Io/2+jo/4;var e=n-r,o=e>=0?1:-1,a=o*e,l=Math.cos(t),c=Math.sin(t),f=u*c,s=i*l+f*Math.cos(a),h=f*o*Math.sin(a);Sa.add(Math.atan2(h,s)),r=n,i=l,u=c}var t,e,r,i,u;ka.point=function(o,a){ka.point=n,r=(t=o)*Io,i=Math.cos(a=(e=a)*Io/2+jo/4),u=Math.sin(a)},ka.lineEnd=function(){n(t,e)}}function dt(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function yt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function mt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Mt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function xt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function bt(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function _t(n){return[Math.atan2(n[1],n[0]),tn(n[2])]}function wt(n,t){return xo(n[0]-t[0])<Po&&xo(n[1]-t[1])<Po}function St(n,t){n*=Io;var e=Math.cos(t*=Io);kt(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function kt(n,t,e){++Na,Aa+=(n-Aa)/Na,Ca+=(t-Ca)/Na,za+=(e-za)/Na}function Nt(){function n(n,i){n*=Io;var u=Math.cos(i*=Io),o=u*Math.cos(n),a=u*Math.sin(n),l=Math.sin(i),c=Math.atan2(Math.sqrt((c=e*l-r*a)*c+(c=r*o-t*l)*c+(c=t*a-e*o)*c),t*o+e*a+r*l);Ea+=c,La+=c*(t+(t=o)),qa+=c*(e+(e=a)),Ta+=c*(r+(r=l)),kt(t,e,r)}var t,e,r;Ua.point=function(i,u){i*=Io;var o=Math.cos(u*=Io);t=o*Math.cos(i),e=o*Math.sin(i),r=Math.sin(u),Ua.point=n,kt(t,e,r)}}function Et(){Ua.point=St}function At(){function n(n,t){n*=Io;var e=Math.cos(t*=Io),o=e*Math.cos(n),a=e*Math.sin(n),l=Math.sin(t),c=i*l-u*a,f=u*o-r*l,s=r*a-i*o,h=Math.sqrt(c*c+f*f+s*s),p=r*o+i*a+u*l,g=h&&-nn(p)/h,v=Math.atan2(h,p);Ra+=g*c,Da+=g*f,Pa+=g*s,Ea+=v,La+=v*(r+(r=o)),qa+=v*(i+(i=a)),Ta+=v*(u+(u=l)),kt(r,i,u)}var t,e,r,i,u;Ua.point=function(o,a){t=o,e=a,Ua.point=n,o*=Io;var l=Math.cos(a*=Io);r=l*Math.cos(o),i=l*Math.sin(o),u=Math.sin(a),kt(r,i,u)},Ua.lineEnd=function(){n(t,e),Ua.lineEnd=Et,Ua.point=St}}function Ct(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function zt(){return!0}function Lt(n,t,e,r,i){var u=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(wt(e,r)){i.lineStart();for(var a=0;t>a;++a)i.point((e=n[a])[0],e[1]);return void i.lineEnd()}var l=new Tt(e,n,null,!0),c=new Tt(e,null,l,!1);l.o=c,u.push(l),o.push(c),l=new Tt(r,n,null,!1),c=new Tt(r,null,l,!0),l.o=c,u.push(l),o.push(c)}}),o.sort(t),qt(u),qt(o),u.length){for(var a=0,l=e,c=o.length;c>a;++a)o[a].e=l=!l;for(var f,s,h=u[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;f=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(var a=0,c=f.length;c>a;++a)i.point((s=f[a])[0],s[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g){f=p.p.z;for(var a=f.length-1;a>=0;--a)i.point((s=f[a])[0],s[1])}else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,f=p.z,g=!g}while(!p.v);i.lineEnd()}}}function qt(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}function Tt(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Rt(n,t,e,r){return function(i,u){function o(t,e){var r=i(t,e);n(t=r[0],e=r[1])&&u.point(t,e)}function a(n,t){var e=i(n,t);d.point(e[0],e[1])}function l(){m.point=a,d.lineStart()}function c(){m.point=o,d.lineEnd()}function f(n,t){v.push([n,t]);var e=i(n,t);x.point(e[0],e[1])}function s(){x.lineStart(),v=[]}function h(){f(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),g.push(v),v=null,r)if(1&t){n=e[0];var i,r=n.length-1,o=-1;if(r>0){for(b||(u.polygonStart(),b=!0),u.lineStart();++o<r;)u.point((i=n[o])[0],i[1]);u.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),p.push(e.filter(Dt))}var p,g,v,d=t(u),y=i.invert(r[0],r[1]),m={point:o,lineStart:l,lineEnd:c,polygonStart:function(){m.point=f,m.lineStart=s,m.lineEnd=h,p=[],g=[]},polygonEnd:function(){m.point=o,m.lineStart=l,m.lineEnd=c,p=ao.merge(p);var n=Ot(y,g);p.length?(b||(u.polygonStart(),b=!0),Lt(p,Ut,n,e,u)):n&&(b||(u.polygonStart(),b=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),b&&(u.polygonEnd(),b=!1),p=g=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}},M=Pt(),x=t(M),b=!1;return m}}function Dt(n){return n.length>1}function Pt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:b,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Ut(n,t){return((n=n.x)[0]<0?n[1]-Oo-Po:Oo-n[1])-((t=t.x)[0]<0?t[1]-Oo-Po:Oo-t[1])}function jt(n){var t,e=NaN,r=NaN,i=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(u,o){var a=u>0?jo:-jo,l=xo(u-e);xo(l-jo)<Po?(n.point(e,r=(r+o)/2>0?Oo:-Oo),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(u,r),t=0):i!==a&&l>=jo&&(xo(e-i)<Po&&(e-=i*Po),xo(u-a)<Po&&(u-=a*Po),r=Ft(e,r,u,o),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=u,r=o),i=a},lineEnd:function(){n.lineEnd(),e=r=NaN},clean:function(){return 2-t}}}function Ft(n,t,e,r){var i,u,o=Math.sin(n-e);return xo(o)>Po?Math.atan((Math.sin(t)*(u=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(t))*Math.sin(n))/(i*u*o)):(t+r)/2}function Ht(n,t,e,r){var i;if(null==n)i=e*Oo,r.point(-jo,i),r.point(0,i),r.point(jo,i),r.point(jo,0),r.point(jo,-i),r.point(0,-i),r.point(-jo,-i),r.point(-jo,0),r.point(-jo,i);else if(xo(n[0]-t[0])>Po){var u=n[0]<t[0]?jo:-jo;i=e*u/2,r.point(-u,i),r.point(0,i),r.point(u,i)}else r.point(t[0],t[1])}function Ot(n,t){var e=n[0],r=n[1],i=[Math.sin(e),-Math.cos(e),0],u=0,o=0;Sa.reset();for(var a=0,l=t.length;l>a;++a){var c=t[a],f=c.length;if(f)for(var s=c[0],h=s[0],p=s[1]/2+jo/4,g=Math.sin(p),v=Math.cos(p),d=1;;){d===f&&(d=0),n=c[d];var y=n[0],m=n[1]/2+jo/4,M=Math.sin(m),x=Math.cos(m),b=y-h,_=b>=0?1:-1,w=_*b,S=w>jo,k=g*M;if(Sa.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),u+=S?b+_*Fo:b,S^h>=e^y>=e){var N=mt(dt(s),dt(n));bt(N);var E=mt(i,N);bt(E);var A=(S^b>=0?-1:1)*tn(E[2]);(r>A||r===A&&(N[0]||N[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=y,g=M,v=x,s=n}}return(-Po>u||Po>u&&0>Sa)^1&o}function It(n){function t(n,t){return Math.cos(n)*Math.cos(t)>u}function e(n){var e,u,l,c,f;return{lineStart:function(){c=l=!1,f=1},point:function(s,h){var p,g=[s,h],v=t(s,h),d=o?v?0:i(s,h):v?i(s+(0>s?jo:-jo),h):0;if(!e&&(c=l=v)&&n.lineStart(),v!==l&&(p=r(e,g),(wt(e,p)||wt(g,p))&&(g[0]+=Po,g[1]+=Po,v=t(g[0],g[1]))),v!==l)f=0,v?(n.lineStart(),p=r(g,e),n.point(p[0],p[1])):(p=r(e,g),n.point(p[0],p[1]),n.lineEnd()),e=p;else if(a&&e&&o^v){var y;d&u||!(y=r(g,e,!0))||(f=0,o?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!v||e&&wt(e,g)||n.point(g[0],g[1]),e=g,l=v,u=d},lineEnd:function(){l&&n.lineEnd(),e=null},clean:function(){return f|(c&&l)<<1}}}function r(n,t,e){var r=dt(n),i=dt(t),o=[1,0,0],a=mt(r,i),l=yt(a,a),c=a[0],f=l-c*c;if(!f)return!e&&n;var s=u*l/f,h=-u*c/f,p=mt(o,a),g=xt(o,s),v=xt(a,h);Mt(g,v);var d=p,y=yt(g,d),m=yt(d,d),M=y*y-m*(yt(g,g)-1);if(!(0>M)){var x=Math.sqrt(M),b=xt(d,(-y-x)/m);if(Mt(b,g),b=_t(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],N=t[1];w>S&&(_=w,w=S,S=_);var E=S-w,A=xo(E-jo)<Po,C=A||Po>E;if(!A&&k>N&&(_=k,k=N,N=_),C?A?k+N>0^b[1]<(xo(b[0]-w)<Po?k:N):k<=b[1]&&b[1]<=N:E>jo^(w<=b[0]&&b[0]<=S)){var z=xt(d,(-y+x)/m);return Mt(z,g),[b,_t(z)]}}}function i(t,e){var r=o?n:jo-n,i=0;return-r>t?i|=1:t>r&&(i|=2),-r>e?i|=4:e>r&&(i|=8),i}var u=Math.cos(n),o=u>0,a=xo(u)>Po,l=ve(n,6*Io);return Rt(t,e,l,o?[0,-n]:[-jo,n-jo])}function Yt(n,t,e,r){return function(i){var u,o=i.a,a=i.b,l=o.x,c=o.y,f=a.x,s=a.y,h=0,p=1,g=f-l,v=s-c;if(u=n-l,g||!(u>0)){if(u/=g,0>g){if(h>u)return;p>u&&(p=u)}else if(g>0){if(u>p)return;u>h&&(h=u)}if(u=e-l,g||!(0>u)){if(u/=g,0>g){if(u>p)return;u>h&&(h=u)}else if(g>0){if(h>u)return;p>u&&(p=u)}if(u=t-c,v||!(u>0)){if(u/=v,0>v){if(h>u)return;p>u&&(p=u)}else if(v>0){if(u>p)return;u>h&&(h=u)}if(u=r-c,v||!(0>u)){if(u/=v,0>v){if(u>p)return;u>h&&(h=u)}else if(v>0){if(h>u)return;p>u&&(p=u)}return h>0&&(i.a={x:l+h*g,y:c+h*v}),1>p&&(i.b={x:l+p*g,y:c+p*v}),i}}}}}}function Zt(n,t,e,r){function i(r,i){return xo(r[0]-n)<Po?i>0?0:3:xo(r[0]-e)<Po?i>0?2:1:xo(r[1]-t)<Po?i>0?1:0:i>0?3:2}function u(n,t){return o(n.x,t.x)}function o(n,t){var e=i(n,1),r=i(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function l(n){for(var t=0,e=d.length,r=n[1],i=0;e>i;++i)for(var u,o=1,a=d[i],l=a.length,c=a[0];l>o;++o)u=a[o],c[1]<=r?u[1]>r&&Q(c,u,n)>0&&++t:u[1]<=r&&Q(c,u,n)<0&&--t,c=u;return 0!==t}function c(u,a,l,c){var f=0,s=0;if(null==u||(f=i(u,l))!==(s=i(a,l))||o(u,a)<0^l>0){do c.point(0===f||3===f?n:e,f>1?r:t);while((f=(f+l+4)%4)!==s)}else c.point(a[0],a[1])}function f(i,u){return i>=n&&e>=i&&u>=t&&r>=u}function s(n,t){f(n,t)&&a.point(n,t)}function h(){C.point=g,d&&d.push(y=[]),S=!0,w=!1,b=_=NaN}function p(){v&&(g(m,M),x&&w&&E.rejoin(),v.push(E.buffer())),C.point=s,w&&a.lineEnd()}function g(n,t){n=Math.max(-Fa,Math.min(Fa,n)),t=Math.max(-Fa,Math.min(Fa,t));var e=f(n,t);if(d&&y.push([n,t]),S)m=n,M=t,x=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};A(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,y,m,M,x,b,_,w,S,k,N=a,E=Pt(),A=Yt(n,t,e,r),C={point:s,lineStart:h,lineEnd:p,polygonStart:function(){a=E,v=[],d=[],k=!0},polygonEnd:function(){a=N,v=ao.merge(v);var t=l([n,r]),e=k&&t,i=v.length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),c(null,null,1,a),a.lineEnd()),i&&Lt(v,u,t,c,a),a.polygonEnd()),v=d=y=null}};return C}}function Vt(n){var t=0,e=jo/3,r=ae(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*jo/180,e=n[1]*jo/180):[t/jo*180,e/jo*180]},i}function Xt(n,t){function e(n,t){var e=Math.sqrt(u-2*i*Math.sin(t))/i;return[e*Math.sin(n*=i),o-e*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),o=Math.sqrt(u)/i;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/i,tn((u-(n*n+e*e)*i*i)/(2*i))]},e}function $t(){function n(n,t){Oa+=i*n-r*t,r=n,i=t}var t,e,r,i;Xa.point=function(u,o){Xa.point=n,t=r=u,e=i=o},Xa.lineEnd=function(){n(t,e)}}function Bt(n,t){Ia>n&&(Ia=n),n>Za&&(Za=n),Ya>t&&(Ya=t),t>Va&&(Va=t)}function Wt(){function n(n,t){o.push("M",n,",",t,u)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function i(){o.push("Z")}var u=Jt(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return u=Jt(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Jt(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Gt(n,t){Aa+=n,Ca+=t,++za}function Kt(){function n(n,r){var i=n-t,u=r-e,o=Math.sqrt(i*i+u*u);La+=o*(t+n)/2,qa+=o*(e+r)/2,Ta+=o,Gt(t=n,e=r)}var t,e;Ba.point=function(r,i){Ba.point=n,Gt(t=r,e=i)}}function Qt(){Ba.point=Gt}function ne(){function n(n,t){var e=n-r,u=t-i,o=Math.sqrt(e*e+u*u);La+=o*(r+n)/2,qa+=o*(i+t)/2,Ta+=o,o=i*n-r*t,Ra+=o*(r+n),Da+=o*(i+t),Pa+=3*o,Gt(r=n,i=t)}var t,e,r,i;Ba.point=function(u,o){Ba.point=n,Gt(t=r=u,e=i=o)},Ba.lineEnd=function(){n(t,e)}}function te(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,Fo)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function i(){a.point=t}function u(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:i,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=i,a.point=t},pointRadius:function(n){return o=n,a},result:b};return a}function ee(n){function t(n){return(a?r:e)(n)}function e(t){return ue(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=NaN,S.point=u,t.lineStart()}function u(e,r){var u=dt([e,r]),o=n(e,r);i(M,x,m,b,_,w,M=o[0],x=o[1],m=e,b=u[0],_=u[1],w=u[2],a,t),t.point(M,x)}function o(){S.point=e,t.lineEnd()}function l(){
r(),S.point=c,S.lineEnd=f}function c(n,t){u(s=n,h=t),p=M,g=x,v=b,d=_,y=w,S.point=u}function f(){i(M,x,m,b,_,w,p,g,s,v,d,y,a,t),S.lineEnd=o,o()}var s,h,p,g,v,d,y,m,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=l},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function i(t,e,r,a,l,c,f,s,h,p,g,v,d,y){var m=f-t,M=s-e,x=m*m+M*M;if(x>4*u&&d--){var b=a+p,_=l+g,w=c+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),N=xo(xo(w)-1)<Po||xo(r-h)<Po?(r+h)/2:Math.atan2(_,b),E=n(N,k),A=E[0],C=E[1],z=A-t,L=C-e,q=M*z-m*L;(q*q/x>u||xo((m*z+M*L)/x-.5)>.3||o>a*p+l*g+c*v)&&(i(t,e,r,a,l,c,A,C,N,b/=S,_/=S,w,d,y),y.point(A,C),i(A,C,N,b,_,w,f,s,h,p,g,v,d,y))}}var u=.5,o=Math.cos(30*Io),a=16;return t.precision=function(n){return arguments.length?(a=(u=n*n)>0&&16,t):Math.sqrt(u)},t}function re(n){var t=ee(function(t,e){return n([t*Yo,e*Yo])});return function(n){return le(t(n))}}function ie(n){this.stream=n}function ue(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function oe(n){return ae(function(){return n})()}function ae(n){function t(n){return n=a(n[0]*Io,n[1]*Io),[n[0]*h+l,c-n[1]*h]}function e(n){return n=a.invert((n[0]-l)/h,(c-n[1])/h),n&&[n[0]*Yo,n[1]*Yo]}function r(){a=Ct(o=se(y,M,x),u);var n=u(v,d);return l=p-n[0]*h,c=g+n[1]*h,i()}function i(){return f&&(f.valid=!1,f=null),t}var u,o,a,l,c,f,s=ee(function(n,t){return n=u(n,t),[n[0]*h+l,c-n[1]*h]}),h=150,p=480,g=250,v=0,d=0,y=0,M=0,x=0,b=ja,_=m,w=null,S=null;return t.stream=function(n){return f&&(f.valid=!1),f=le(b(o,s(_(n)))),f.valid=!0,f},t.clipAngle=function(n){return arguments.length?(b=null==n?(w=n,ja):It((w=+n)*Io),i()):w},t.clipExtent=function(n){return arguments.length?(S=n,_=n?Zt(n[0][0],n[0][1],n[1][0],n[1][1]):m,i()):S},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(p=+n[0],g=+n[1],r()):[p,g]},t.center=function(n){return arguments.length?(v=n[0]%360*Io,d=n[1]%360*Io,r()):[v*Yo,d*Yo]},t.rotate=function(n){return arguments.length?(y=n[0]%360*Io,M=n[1]%360*Io,x=n.length>2?n[2]%360*Io:0,r()):[y*Yo,M*Yo,x*Yo]},ao.rebind(t,s,"precision"),function(){return u=n.apply(this,arguments),t.invert=u.invert&&e,r()}}function le(n){return ue(n,function(t,e){n.point(t*Io,e*Io)})}function ce(n,t){return[n,t]}function fe(n,t){return[n>jo?n-Fo:-jo>n?n+Fo:n,t]}function se(n,t,e){return n?t||e?Ct(pe(n),ge(t,e)):pe(n):t||e?ge(t,e):fe}function he(n){return function(t,e){return t+=n,[t>jo?t-Fo:-jo>t?t+Fo:t,e]}}function pe(n){var t=he(n);return t.invert=he(-n),t}function ge(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*r+a*i;return[Math.atan2(l*u-f*o,a*r-c*i),tn(f*u+l*o)]}var r=Math.cos(n),i=Math.sin(n),u=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*u-l*o;return[Math.atan2(l*u+c*o,a*r+f*i),tn(f*r-a*i)]},e}function ve(n,t){var e=Math.cos(n),r=Math.sin(n);return function(i,u,o,a){var l=o*t;null!=i?(i=de(e,i),u=de(e,u),(o>0?u>i:i>u)&&(i+=o*Fo)):(i=n+o*Fo,u=n-.5*l);for(var c,f=i;o>0?f>u:u>f;f-=l)a.point((c=_t([e,-r*Math.cos(f),-r*Math.sin(f)]))[0],c[1])}}function de(n,t){var e=dt(t);e[0]-=n,bt(e);var r=nn(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Po)%(2*Math.PI)}function ye(n,t,e){var r=ao.range(n,t-Po,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function me(n,t,e){var r=ao.range(n,t-Po,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function Me(n){return n.source}function xe(n){return n.target}function be(n,t,e,r){var i=Math.cos(t),u=Math.sin(t),o=Math.cos(r),a=Math.sin(r),l=i*Math.cos(n),c=i*Math.sin(n),f=o*Math.cos(e),s=o*Math.sin(e),h=2*Math.asin(Math.sqrt(on(r-t)+i*o*on(e-n))),p=1/Math.sin(h),g=h?function(n){var t=Math.sin(n*=h)*p,e=Math.sin(h-n)*p,r=e*l+t*f,i=e*c+t*s,o=e*u+t*a;return[Math.atan2(i,r)*Yo,Math.atan2(o,Math.sqrt(r*r+i*i))*Yo]}:function(){return[n*Yo,t*Yo]};return g.distance=h,g}function _e(){function n(n,i){var u=Math.sin(i*=Io),o=Math.cos(i),a=xo((n*=Io)-t),l=Math.cos(a);Wa+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*u-e*o*l)*a),e*u+r*o*l),t=n,e=u,r=o}var t,e,r;Ja.point=function(i,u){t=i*Io,e=Math.sin(u*=Io),r=Math.cos(u),Ja.point=n},Ja.lineEnd=function(){Ja.point=Ja.lineEnd=b}}function we(n,t){function e(t,e){var r=Math.cos(t),i=Math.cos(e),u=n(r*i);return[u*i*Math.sin(t),u*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),i=t(r),u=Math.sin(i),o=Math.cos(i);return[Math.atan2(n*u,r*o),Math.asin(r&&e*u/r)]},e}function Se(n,t){function e(n,t){o>0?-Oo+Po>t&&(t=-Oo+Po):t>Oo-Po&&(t=Oo-Po);var e=o/Math.pow(i(t),u);return[e*Math.sin(u*n),o-e*Math.cos(u*n)]}var r=Math.cos(n),i=function(n){return Math.tan(jo/4+n/2)},u=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(i(t)/i(n)),o=r*Math.pow(i(n),u)/u;return u?(e.invert=function(n,t){var e=o-t,r=K(u)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/u,2*Math.atan(Math.pow(o/r,1/u))-Oo]},e):Ne}function ke(n,t){function e(n,t){var e=u-t;return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}var r=Math.cos(n),i=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),u=r/i+n;return xo(i)<Po?ce:(e.invert=function(n,t){var e=u-t;return[Math.atan2(n,e)/i,u-K(i)*Math.sqrt(n*n+e*e)]},e)}function Ne(n,t){return[n,Math.log(Math.tan(jo/4+t/2))]}function Ee(n){var t,e=oe(n),r=e.scale,i=e.translate,u=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=i.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=u.apply(e,arguments);if(o===e){if(t=null==n){var a=jo*r(),l=i();u([[l[0]-a,l[1]-a],[l[0]+a,l[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Ae(n,t){return[Math.log(Math.tan(jo/4+t/2)),-n]}function Ce(n){return n[0]}function ze(n){return n[1]}function Le(n){for(var t=n.length,e=[0,1],r=2,i=2;t>i;i++){for(;r>1&&Q(n[e[r-2]],n[e[r-1]],n[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function qe(n,t){return n[0]-t[0]||n[1]-t[1]}function Te(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Re(n,t,e,r){var i=n[0],u=e[0],o=t[0]-i,a=r[0]-u,l=n[1],c=e[1],f=t[1]-l,s=r[1]-c,h=(a*(l-c)-s*(i-u))/(s*o-a*f);return[i+h*o,l+h*f]}function De(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Pe(){rr(this),this.edge=this.site=this.circle=null}function Ue(n){var t=ll.pop()||new Pe;return t.site=n,t}function je(n){Be(n),ul.remove(n),ll.push(n),rr(n)}function Fe(n){var t=n.circle,e=t.x,r=t.cy,i={x:e,y:r},u=n.P,o=n.N,a=[n];je(n);for(var l=u;l.circle&&xo(e-l.circle.x)<Po&&xo(r-l.circle.cy)<Po;)u=l.P,a.unshift(l),je(l),l=u;a.unshift(l),Be(l);for(var c=o;c.circle&&xo(e-c.circle.x)<Po&&xo(r-c.circle.cy)<Po;)o=c.N,a.push(c),je(c),c=o;a.push(c),Be(c);var f,s=a.length;for(f=1;s>f;++f)c=a[f],l=a[f-1],nr(c.edge,l.site,c.site,i);l=a[0],c=a[s-1],c.edge=Ke(l.site,c.site,null,i),$e(l),$e(c)}function He(n){for(var t,e,r,i,u=n.x,o=n.y,a=ul._;a;)if(r=Oe(a,o)-u,r>Po)a=a.L;else{if(i=u-Ie(a,o),!(i>Po)){r>-Po?(t=a.P,e=a):i>-Po?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var l=Ue(n);if(ul.insert(t,l),t||e){if(t===e)return Be(t),e=Ue(t.site),ul.insert(l,e),l.edge=e.edge=Ke(t.site,l.site),$e(t),void $e(e);if(!e)return void(l.edge=Ke(t.site,l.site));Be(t),Be(e);var c=t.site,f=c.x,s=c.y,h=n.x-f,p=n.y-s,g=e.site,v=g.x-f,d=g.y-s,y=2*(h*d-p*v),m=h*h+p*p,M=v*v+d*d,x={x:(d*m-p*M)/y+f,y:(h*M-v*m)/y+s};nr(e.edge,c,g,x),l.edge=Ke(c,n,null,x),e.edge=Ke(n,g,null,x),$e(t),$e(e)}}function Oe(n,t){var e=n.site,r=e.x,i=e.y,u=i-t;if(!u)return r;var o=n.P;if(!o)return-(1/0);e=o.site;var a=e.x,l=e.y,c=l-t;if(!c)return a;var f=a-r,s=1/u-1/c,h=f/c;return s?(-h+Math.sqrt(h*h-2*s*(f*f/(-2*c)-l+c/2+i-u/2)))/s+r:(r+a)/2}function Ie(n,t){var e=n.N;if(e)return Oe(e,t);var r=n.site;return r.y===t?r.x:1/0}function Ye(n){this.site=n,this.edges=[]}function Ze(n){for(var t,e,r,i,u,o,a,l,c,f,s=n[0][0],h=n[1][0],p=n[0][1],g=n[1][1],v=il,d=v.length;d--;)if(u=v[d],u&&u.prepare())for(a=u.edges,l=a.length,o=0;l>o;)f=a[o].end(),r=f.x,i=f.y,c=a[++o%l].start(),t=c.x,e=c.y,(xo(r-t)>Po||xo(i-e)>Po)&&(a.splice(o,0,new tr(Qe(u.site,f,xo(r-s)<Po&&g-i>Po?{x:s,y:xo(t-s)<Po?e:g}:xo(i-g)<Po&&h-r>Po?{x:xo(e-g)<Po?t:h,y:g}:xo(r-h)<Po&&i-p>Po?{x:h,y:xo(t-h)<Po?e:p}:xo(i-p)<Po&&r-s>Po?{x:xo(e-p)<Po?t:s,y:p}:null),u.site,null)),++l)}function Ve(n,t){return t.angle-n.angle}function Xe(){rr(this),this.x=this.y=this.arc=this.site=this.cy=null}function $e(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,i=n.site,u=e.site;if(r!==u){var o=i.x,a=i.y,l=r.x-o,c=r.y-a,f=u.x-o,s=u.y-a,h=2*(l*s-c*f);if(!(h>=-Uo)){var p=l*l+c*c,g=f*f+s*s,v=(s*p-c*g)/h,d=(l*g-f*p)/h,s=d+a,y=cl.pop()||new Xe;y.arc=n,y.site=i,y.x=v+o,y.y=s+Math.sqrt(v*v+d*d),y.cy=s,n.circle=y;for(var m=null,M=al._;M;)if(y.y<M.y||y.y===M.y&&y.x<=M.x){if(!M.L){m=M.P;break}M=M.L}else{if(!M.R){m=M;break}M=M.R}al.insert(m,y),m||(ol=y)}}}}function Be(n){var t=n.circle;t&&(t.P||(ol=t.N),al.remove(t),cl.push(t),rr(t),n.circle=null)}function We(n){for(var t,e=rl,r=Yt(n[0][0],n[0][1],n[1][0],n[1][1]),i=e.length;i--;)t=e[i],(!Je(t,n)||!r(t)||xo(t.a.x-t.b.x)<Po&&xo(t.a.y-t.b.y)<Po)&&(t.a=t.b=null,e.splice(i,1))}function Je(n,t){var e=n.b;if(e)return!0;var r,i,u=n.a,o=t[0][0],a=t[1][0],l=t[0][1],c=t[1][1],f=n.l,s=n.r,h=f.x,p=f.y,g=s.x,v=s.y,d=(h+g)/2,y=(p+v)/2;if(v===p){if(o>d||d>=a)return;if(h>g){if(u){if(u.y>=c)return}else u={x:d,y:l};e={x:d,y:c}}else{if(u){if(u.y<l)return}else u={x:d,y:c};e={x:d,y:l}}}else if(r=(h-g)/(v-p),i=y-r*d,-1>r||r>1)if(h>g){if(u){if(u.y>=c)return}else u={x:(l-i)/r,y:l};e={x:(c-i)/r,y:c}}else{if(u){if(u.y<l)return}else u={x:(c-i)/r,y:c};e={x:(l-i)/r,y:l}}else if(v>p){if(u){if(u.x>=a)return}else u={x:o,y:r*o+i};e={x:a,y:r*a+i}}else{if(u){if(u.x<o)return}else u={x:a,y:r*a+i};e={x:o,y:r*o+i}}return n.a=u,n.b=e,!0}function Ge(n,t){this.l=n,this.r=t,this.a=this.b=null}function Ke(n,t,e,r){var i=new Ge(n,t);return rl.push(i),e&&nr(i,n,t,e),r&&nr(i,t,n,r),il[n.i].edges.push(new tr(i,n,t)),il[t.i].edges.push(new tr(i,t,n)),i}function Qe(n,t,e){var r=new Ge(n,null);return r.a=t,r.b=e,rl.push(r),r}function nr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function tr(n,t,e){var r=n.a,i=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function er(){this._=null}function rr(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function ir(n,t){var e=t,r=t.R,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ur(n,t){var e=t,r=t.L,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function or(n){for(;n.L;)n=n.L;return n}function ar(n,t){var e,r,i,u=n.sort(lr).pop();for(rl=[],il=new Array(n.length),ul=new er,al=new er;;)if(i=ol,u&&(!i||u.y<i.y||u.y===i.y&&u.x<i.x))u.x===e&&u.y===r||(il[u.i]=new Ye(u),He(u),e=u.x,r=u.y),u=n.pop();else{if(!i)break;Fe(i.arc)}t&&(We(t),Ze(t));var o={cells:il,edges:rl};return ul=al=rl=il=null,o}function lr(n,t){return t.y-n.y||t.x-n.x}function cr(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function fr(n){return n.x}function sr(n){return n.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function pr(n,t,e,r,i,u){if(!n(t,e,r,i,u)){var o=.5*(e+i),a=.5*(r+u),l=t.nodes;l[0]&&pr(n,l[0],e,r,o,a),l[1]&&pr(n,l[1],o,r,i,a),l[2]&&pr(n,l[2],e,a,o,u),l[3]&&pr(n,l[3],o,a,i,u)}}function gr(n,t,e,r,i,u,o){var a,l=1/0;return function c(n,f,s,h,p){if(!(f>u||s>o||r>h||i>p)){if(g=n.point){var g,v=t-n.x,d=e-n.y,y=v*v+d*d;if(l>y){var m=Math.sqrt(l=y);r=t-m,i=e-m,u=t+m,o=e+m,a=g}}for(var M=n.nodes,x=.5*(f+h),b=.5*(s+p),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:c(n,f,s,x,b);break;case 1:c(n,x,s,h,b);break;case 2:c(n,f,b,x,p);break;case 3:c(n,x,b,h,p)}}}(n,r,i,u,o),a}function vr(n,t){n=ao.rgb(n),t=ao.rgb(t);var e=n.r,r=n.g,i=n.b,u=t.r-e,o=t.g-r,a=t.b-i;return function(n){return"#"+bn(Math.round(e+u*n))+bn(Math.round(r+o*n))+bn(Math.round(i+a*n))}}function dr(n,t){var e,r={},i={};for(e in n)e in t?r[e]=Mr(n[e],t[e]):i[e]=n[e];for(e in t)e in n||(i[e]=t[e]);return function(n){for(e in r)i[e]=r[e](n);return i}}function yr(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function mr(n,t){var e,r,i,u=sl.lastIndex=hl.lastIndex=0,o=-1,a=[],l=[];for(n+="",t+="";(e=sl.exec(n))&&(r=hl.exec(t));)(i=r.index)>u&&(i=t.slice(u,i),a[o]?a[o]+=i:a[++o]=i),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:yr(e,r)})),u=hl.lastIndex;return u<t.length&&(i=t.slice(u),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?(t=l[0].x,function(n){return t(n)+""}):function(){return t}:(t=l.length,function(n){for(var e,r=0;t>r;++r)a[(e=l[r]).i]=e.x(n);return a.join("")})}function Mr(n,t){for(var e,r=ao.interpolators.length;--r>=0&&!(e=ao.interpolators[r](n,t)););return e}function xr(n,t){var e,r=[],i=[],u=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(Mr(n[e],t[e]));for(;u>e;++e)i[e]=n[e];for(;o>e;++e)i[e]=t[e];return function(n){for(e=0;a>e;++e)i[e]=r[e](n);return i}}function br(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function _r(n){return function(t){return 1-n(1-t)}}function wr(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function Sr(n){return n*n}function kr(n){return n*n*n}function Nr(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function Er(n){return function(t){return Math.pow(t,n)}}function Ar(n){return 1-Math.cos(n*Oo)}function Cr(n){return Math.pow(2,10*(n-1))}function zr(n){return 1-Math.sqrt(1-n*n)}function Lr(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/Fo*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*Fo/t)}}function qr(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Tr(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Rr(n,t){n=ao.hcl(n),t=ao.hcl(t);var e=n.h,r=n.c,i=n.l,u=t.h-e,o=t.c-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:-180>u&&(u+=360),function(n){return sn(e+u*n,r+o*n,i+a*n)+""}}function Dr(n,t){n=ao.hsl(n),t=ao.hsl(t);var e=n.h,r=n.s,i=n.l,u=t.h-e,o=t.s-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:-180>u&&(u+=360),function(n){return cn(e+u*n,r+o*n,i+a*n)+""}}function Pr(n,t){n=ao.lab(n),t=ao.lab(t);var e=n.l,r=n.a,i=n.b,u=t.l-e,o=t.a-r,a=t.b-i;return function(n){return pn(e+u*n,r+o*n,i+a*n)+""}}function Ur(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function jr(n){var t=[n.a,n.b],e=[n.c,n.d],r=Hr(t),i=Fr(t,e),u=Hr(Or(e,t,-i))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Yo,this.translate=[n.e,n.f],this.scale=[r,u],this.skew=u?Math.atan2(i,u)*Yo:0}function Fr(n,t){return n[0]*t[0]+n[1]*t[1]}function Hr(n){var t=Math.sqrt(Fr(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Or(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Ir(n){return n.length?n.pop()+",":""}function Yr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push("translate(",null,",",null,")");r.push({i:i-4,x:yr(n[0],t[0])},{i:i-2,x:yr(n[1],t[1])})}else(t[0]||t[1])&&e.push("translate("+t+")")}function Zr(n,t,e,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:e.push(Ir(e)+"rotate(",null,")")-2,x:yr(n,t)})):t&&e.push(Ir(e)+"rotate("+t+")")}function Vr(n,t,e,r){n!==t?r.push({i:e.push(Ir(e)+"skewX(",null,")")-2,x:yr(n,t)}):t&&e.push(Ir(e)+"skewX("+t+")")}function Xr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push(Ir(e)+"scale(",null,",",null,")");r.push({i:i-4,x:yr(n[0],t[0])},{i:i-2,x:yr(n[1],t[1])})}else 1===t[0]&&1===t[1]||e.push(Ir(e)+"scale("+t+")")}function $r(n,t){var e=[],r=[];return n=ao.transform(n),t=ao.transform(t),Yr(n.translate,t.translate,e,r),Zr(n.rotate,t.rotate,e,r),Vr(n.skew,t.skew,e,r),Xr(n.scale,t.scale,e,r),n=t=null,function(n){for(var t,i=-1,u=r.length;++i<u;)e[(t=r[i]).i]=t.x(n);return e.join("")}}function Br(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Wr(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Jr(n){for(var t=n.source,e=n.target,r=Kr(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var u=i.length;e!==r;)i.splice(u,0,e),e=e.parent;return i}function Gr(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Kr(n,t){if(n===t)return n;for(var e=Gr(n),r=Gr(t),i=e.pop(),u=r.pop(),o=null;i===u;)o=i,i=e.pop(),u=r.pop();return o}function Qr(n){n.fixed|=2}function ni(n){n.fixed&=-7}function ti(n){n.fixed|=4,n.px=n.x,n.py=n.y}function ei(n){n.fixed&=-5}function ri(n,t,e){var r=0,i=0;if(n.charge=0,!n.leaf)for(var u,o=n.nodes,a=o.length,l=-1;++l<a;)u=o[l],null!=u&&(ri(u,t,e),n.charge+=u.charge,r+=u.charge*u.cx,i+=u.charge*u.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var c=t*e[n.point.index];n.charge+=n.pointCharge=c,r+=c*n.point.x,i+=c*n.point.y}n.cx=r/n.charge,n.cy=i/n.charge}function ii(n,t){return ao.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=fi,n}function ui(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(i=n.children)&&(r=i.length))for(var r,i;--r>=0;)e.push(i[r])}function oi(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(u=n.children)&&(i=u.length))for(var i,u,o=-1;++o<i;)e.push(u[o]);for(;null!=(n=r.pop());)t(n)}function ai(n){return n.children}function li(n){return n.value}function ci(n,t){return t.value-n.value}function fi(n){return ao.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function si(n){return n.x}function hi(n){return n.y}function pi(n,t,e){n.y0=t,n.y=e}function gi(n){return ao.range(n.length)}function vi(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function di(n){for(var t,e=1,r=0,i=n[0][1],u=n.length;u>e;++e)(t=n[e][1])>i&&(r=e,i=t);return r}function yi(n){return n.reduce(mi,0)}function mi(n,t){return n+t[1]}function Mi(n,t){return xi(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function xi(n,t){for(var e=-1,r=+n[0],i=(n[1]-r)/t,u=[];++e<=t;)u[e]=i*e+r;return u}function bi(n){return[ao.min(n),ao.max(n)]}function _i(n,t){return n.value-t.value}function wi(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function Si(n,t){n._pack_next=t,t._pack_prev=n}function ki(n,t){var e=t.x-n.x,r=t.y-n.y,i=n.r+t.r;return.999*i*i>e*e+r*r}function Ni(n){function t(n){f=Math.min(n.x-n.r,f),s=Math.max(n.x+n.r,s),h=Math.min(n.y-n.r,h),p=Math.max(n.y+n.r,p)}if((e=n.children)&&(c=e.length)){var e,r,i,u,o,a,l,c,f=1/0,s=-(1/0),h=1/0,p=-(1/0);if(e.forEach(Ei),r=e[0],r.x=-r.r,r.y=0,t(r),c>1&&(i=e[1],i.x=i.r,i.y=0,t(i),c>2))for(u=e[2],zi(r,i,u),t(u),wi(r,u),r._pack_prev=u,wi(u,i),i=r._pack_next,o=3;c>o;o++){zi(r,i,u=e[o]);var g=0,v=1,d=1;for(a=i._pack_next;a!==i;a=a._pack_next,v++)if(ki(a,u)){g=1;break}if(1==g)for(l=r._pack_prev;l!==a._pack_prev&&!ki(l,u);l=l._pack_prev,d++);g?(d>v||v==d&&i.r<r.r?Si(r,i=a):Si(r=l,i),o--):(wi(r,u),i=u,t(u))}var y=(f+s)/2,m=(h+p)/2,M=0;for(o=0;c>o;o++)u=e[o],u.x-=y,u.y-=m,M=Math.max(M,u.r+Math.sqrt(u.x*u.x+u.y*u.y));n.r=M,e.forEach(Ai)}}function Ei(n){n._pack_next=n._pack_prev=n}function Ai(n){delete n._pack_next,delete n._pack_prev}function Ci(n,t,e,r){var i=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,i)for(var u=-1,o=i.length;++u<o;)Ci(i[u],t,e,r)}function zi(n,t,e){var r=n.r+e.r,i=t.x-n.x,u=t.y-n.y;if(r&&(i||u)){var o=t.r+e.r,a=i*i+u*u;o*=o,r*=r;var l=.5+(r-o)/(2*a),c=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+l*i+c*u,e.y=n.y+l*u-c*i}else e.x=n.x+r,e.y=n.y}function Li(n,t){return n.parent==t.parent?1:2}function qi(n){var t=n.children;return t.length?t[0]:n.t}function Ti(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ri(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Di(n){for(var t,e=0,r=0,i=n.children,u=i.length;--u>=0;)t=i[u],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Pi(n,t,e){return n.a.parent===t.parent?n.a:e}function Ui(n){return 1+ao.max(n,function(n){return n.y})}function ji(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Fi(n){var t=n.children;return t&&t.length?Fi(t[0]):n}function Hi(n){var t,e=n.children;return e&&(t=e.length)?Hi(e[t-1]):n}function Oi(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Ii(n,t){var e=n.x+t[3],r=n.y+t[0],i=n.dx-t[1]-t[3],u=n.dy-t[0]-t[2];return 0>i&&(e+=i/2,i=0),0>u&&(r+=u/2,u=0),{x:e,y:r,dx:i,dy:u}}function Yi(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Zi(n){return n.rangeExtent?n.rangeExtent():Yi(n.range())}function Vi(n,t,e,r){var i=e(n[0],n[1]),u=r(t[0],t[1]);return function(n){return u(i(n))}}function Xi(n,t){var e,r=0,i=n.length-1,u=n[r],o=n[i];return u>o&&(e=r,r=i,i=e,e=u,u=o,o=e),n[r]=t.floor(u),n[i]=t.ceil(o),n}function $i(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:wl}function Bi(n,t,e,r){var i=[],u=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)i.push(e(n[o-1],n[o])),u.push(r(t[o-1],t[o]));return function(t){var e=ao.bisect(n,t,1,a)-1;return u[e](i[e](t))}}function Wi(n,t,e,r){function i(){var i=Math.min(n.length,t.length)>2?Bi:Vi,l=r?Wr:Br;return o=i(n,t,l,e),a=i(t,n,l,Mr),u}function u(n){return o(n)}var o,a;return u.invert=function(n){return a(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),i()):n},u.range=function(n){return arguments.length?(t=n,i()):t},u.rangeRound=function(n){return u.range(n).interpolate(Ur)},u.clamp=function(n){return arguments.length?(r=n,i()):r},u.interpolate=function(n){return arguments.length?(e=n,i()):e},u.ticks=function(t){return Qi(n,t)},u.tickFormat=function(t,e){return nu(n,t,e)},u.nice=function(t){return Gi(n,t),i()},u.copy=function(){return Wi(n,t,e,r)},i()}function Ji(n,t){return ao.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Gi(n,t){return Xi(n,$i(Ki(n,t)[2])),Xi(n,$i(Ki(n,t)[2])),n}function Ki(n,t){null==t&&(t=10);var e=Yi(n),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),u=t/r*i;return.15>=u?i*=10:.35>=u?i*=5:.75>=u&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Qi(n,t){return ao.range.apply(ao,Ki(n,t))}function nu(n,t,e){var r=Ki(n,t);if(e){var i=sa.exec(e);if(i.shift(),"s"===i[8]){var u=ao.formatPrefix(Math.max(xo(r[0]),xo(r[1])));return i[7]||(i[7]="."+tu(u.scale(r[2]))),i[8]="f",e=ao.format(i.join("")),function(n){return e(u.scale(n))+u.symbol}}i[7]||(i[7]="."+eu(i[8],r)),e=i.join("")}else e=",."+tu(r[2])+"f";return ao.format(e)}function tu(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function eu(n,t){var e=tu(t[2]);return n in Sl?Math.abs(e-tu(Math.max(xo(t[0]),xo(t[1]))))+ +("e"!==n):e-2*("%"===n)}function ru(n,t,e,r){function i(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function u(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(i(t))}return o.invert=function(t){return u(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(i)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(i)),o):t},o.nice=function(){var t=Xi(r.map(i),e?Math:Nl);return n.domain(t),r=t.map(u),o},o.ticks=function(){var n=Yi(r),o=[],a=n[0],l=n[1],c=Math.floor(i(a)),f=Math.ceil(i(l)),s=t%1?2:t;if(isFinite(f-c)){if(e){for(;f>c;c++)for(var h=1;s>h;h++)o.push(u(c)*h);o.push(u(c))}else for(o.push(u(c));c++<f;)for(var h=s-1;h>0;h--)o.push(u(c)*h);for(c=0;o[c]<a;c++);for(f=o.length;o[f-1]>l;f--);o=o.slice(c,f)}return o},o.tickFormat=function(n,e){if(!arguments.length)return kl;arguments.length<2?e=kl:"function"!=typeof e&&(e=ao.format(e));var r=Math.max(1,t*n/o.ticks().length);return function(n){var o=n/u(Math.round(i(n)));return t-.5>o*t&&(o*=t),r>=o?e(n):""}},o.copy=function(){return ru(n.copy(),t,e,r)},Ji(o,n)}function iu(n,t,e){function r(t){return n(i(t))}var i=uu(t),u=uu(1/t);return r.invert=function(t){return u(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(i)),r):e},r.ticks=function(n){return Qi(e,n)},r.tickFormat=function(n,t){return nu(e,n,t)},r.nice=function(n){return r.domain(Gi(e,n))},r.exponent=function(o){return arguments.length?(i=uu(t=o),u=uu(1/t),n.domain(e.map(i)),r):t},r.copy=function(){return iu(n.copy(),t,e)},Ji(r,n)}function uu(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function ou(n,t){function e(e){return u[((i.get(e)||("range"===t.t?i.set(e,n.push(e)):NaN))-1)%u.length]}function r(t,e){return ao.range(n.length).map(function(n){return t+e*n})}var i,u,o;return e.domain=function(r){if(!arguments.length)return n;n=[],i=new c;for(var u,o=-1,a=r.length;++o<a;)i.has(u=r[o])||i.set(u,n.push(u));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(u=n,o=0,t={t:"range",a:arguments},e):u},e.rangePoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=(l+c)/2,0):(c-l)/(n.length-1+a);return u=r(l+f*a/2,f),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(n.length-1+a)|0;return u=r(l+Math.round(f*a/2+(c-l-(n.length-1+a)*f)/2),f),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=i[1-c],h=(s-f)/(n.length-a+2*l);return u=r(f+h*l,h),c&&u.reverse(),o=h*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=i[1-c],h=Math.floor((s-f)/(n.length-a+2*l));return u=r(f+Math.round((s-f-(n.length-a)*h)/2),h),c&&u.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Yi(t.a[0])},e.copy=function(){return ou(n,t)},e.domain(n)}function au(n,t){function u(){var e=0,r=t.length;for(a=[];++e<r;)a[e-1]=ao.quantile(n,e/r);return o}function o(n){return isNaN(n=+n)?void 0:t[ao.bisect(a,n)]}var a;return o.domain=function(t){return arguments.length?(n=t.map(r).filter(i).sort(e),u()):n},o.range=function(n){return arguments.length?(t=n,u()):t},o.quantiles=function(){return a},o.invertExtent=function(e){return e=t.indexOf(e),0>e?[NaN,NaN]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},o.copy=function(){return au(n,t)},u()}function lu(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(u*(t-n))))]}function i(){return u=e.length/(t-n),o=e.length-1,r}var u,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],i()):[n,t]},r.range=function(n){return arguments.length?(e=n,i()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return lu(n,t,e)},i()}function cu(n,t){function e(e){return e>=e?t[ao.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return cu(n,t)},e}function fu(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Qi(n,t)},t.tickFormat=function(t,e){return nu(n,t,e)},t.copy=function(){return fu(n)},t}function su(){return 0}function hu(n){return n.innerRadius}function pu(n){return n.outerRadius}function gu(n){return n.startAngle}function vu(n){return n.endAngle}function du(n){return n&&n.padAngle}function yu(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function mu(n,t,e,r,i){var u=n[0]-t[0],o=n[1]-t[1],a=(i?r:-r)/Math.sqrt(u*u+o*o),l=a*o,c=-a*u,f=n[0]+l,s=n[1]+c,h=t[0]+l,p=t[1]+c,g=(f+h)/2,v=(s+p)/2,d=h-f,y=p-s,m=d*d+y*y,M=e-r,x=f*p-h*s,b=(0>y?-1:1)*Math.sqrt(Math.max(0,M*M*m-x*x)),_=(x*y-d*b)/m,w=(-x*d-y*b)/m,S=(x*y+d*b)/m,k=(-x*d+y*b)/m,N=_-g,E=w-v,A=S-g,C=k-v;return N*N+E*E>A*A+C*C&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function Mu(n){function t(t){function o(){c.push("M",u(n(f),a))}for(var l,c=[],f=[],s=-1,h=t.length,p=En(e),g=En(r);++s<h;)i.call(this,l=t[s],s)?f.push([+p.call(this,l,s),+g.call(this,l,s)]):f.length&&(o(),f=[]);return f.length&&o(),c.length?c.join(""):null}var e=Ce,r=ze,i=zt,u=xu,o=u.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(i=n,t):i},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?u=n:(u=ql.get(n)||xu).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function xu(n){return n.length>1?n.join("L"):n+"Z"}function bu(n){return n.join("L")+"Z"}function _u(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&i.push("H",r[0]),i.join("")}function wu(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("V",(r=n[t])[1],"H",r[0]);return i.join("")}function Su(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r=n[t])[0],"V",r[1]);return i.join("")}function ku(n,t){return n.length<4?xu(n):n[1]+Au(n.slice(1,-1),Cu(n,t))}function Nu(n,t){return n.length<3?bu(n):n[0]+Au((n.push(n[0]),n),Cu([n[n.length-2]].concat(n,[n[1]]),t))}function Eu(n,t){return n.length<3?xu(n):n[0]+Au(n,Cu(n,t))}function Au(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return xu(n);var e=n.length!=t.length,r="",i=n[0],u=n[1],o=t[0],a=o,l=1;if(e&&(r+="Q"+(u[0]-2*o[0]/3)+","+(u[1]-2*o[1]/3)+","+u[0]+","+u[1],i=n[1],l=2),t.length>1){a=t[1],u=n[l],l++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1];for(var c=2;c<t.length;c++,l++)u=n[l],a=t[c],r+="S"+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1]}if(e){var f=n[l];r+="Q"+(u[0]+2*a[0]/3)+","+(u[1]+2*a[1]/3)+","+f[0]+","+f[1]}return r}function Cu(n,t){for(var e,r=[],i=(1-t)/2,u=n[0],o=n[1],a=1,l=n.length;++a<l;)e=u,u=o,o=n[a],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function zu(n){if(n.length<3)return xu(n);var t=1,e=n.length,r=n[0],i=r[0],u=r[1],o=[i,i,i,(r=n[1])[0]],a=[u,u,u,r[1]],l=[i,",",u,"L",Ru(Dl,o),",",Ru(Dl,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Du(l,o,a);return n.pop(),l.push("L",r),l.join("")}function Lu(n){if(n.length<4)return xu(n);for(var t,e=[],r=-1,i=n.length,u=[0],o=[0];++r<3;)t=n[r],u.push(t[0]),o.push(t[1]);for(e.push(Ru(Dl,u)+","+Ru(Dl,o)),--r;++r<i;)t=n[r],u.shift(),u.push(t[0]),o.shift(),o.push(t[1]),Du(e,u,o);return e.join("")}function qu(n){for(var t,e,r=-1,i=n.length,u=i+4,o=[],a=[];++r<4;)e=n[r%i],o.push(e[0]),a.push(e[1]);for(t=[Ru(Dl,o),",",Ru(Dl,a)],--r;++r<u;)e=n[r%i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Du(t,o,a);return t.join("")}function Tu(n,t){var e=n.length-1;if(e)for(var r,i,u=n[0][0],o=n[0][1],a=n[e][0]-u,l=n[e][1]-o,c=-1;++c<=e;)r=n[c],i=c/e,r[0]=t*r[0]+(1-t)*(u+i*a),r[1]=t*r[1]+(1-t)*(o+i*l);return zu(n)}function Ru(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Du(n,t,e){n.push("C",Ru(Tl,t),",",Ru(Tl,e),",",Ru(Rl,t),",",Ru(Rl,e),",",Ru(Dl,t),",",Ru(Dl,e))}function Pu(n,t){return(t[1]-n[1])/(t[0]-n[0])}function Uu(n){for(var t=0,e=n.length-1,r=[],i=n[0],u=n[1],o=r[0]=Pu(i,u);++t<e;)r[t]=(o+(o=Pu(i=u,u=n[t+1])))/2;return r[t]=o,r}function ju(n){for(var t,e,r,i,u=[],o=Uu(n),a=-1,l=n.length-1;++a<l;)t=Pu(n[a],n[a+1]),xo(t)<Po?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,i=e*e+r*r,i>9&&(i=3*t/Math.sqrt(i),o[a]=i*e,o[a+1]=i*r));for(a=-1;++a<=l;)i=(n[Math.min(l,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),u.push([i||0,o[a]*i||0]);return u}function Fu(n){return n.length<3?xu(n):n[0]+Au(n,ju(n))}function Hu(n){for(var t,e,r,i=-1,u=n.length;++i<u;)t=n[i],e=t[0],r=t[1]-Oo,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Ou(n){function t(t){function l(){v.push("M",a(n(y),s),f,c(n(d.reverse()),s),"Z")}for(var h,p,g,v=[],d=[],y=[],m=-1,M=t.length,x=En(e),b=En(i),_=e===r?function(){
return p}:En(r),w=i===u?function(){return g}:En(u);++m<M;)o.call(this,h=t[m],m)?(d.push([p=+x.call(this,h,m),g=+b.call(this,h,m)]),y.push([+_.call(this,h,m),+w.call(this,h,m)])):d.length&&(l(),d=[],y=[]);return d.length&&l(),v.length?v.join(""):null}var e=Ce,r=Ce,i=0,u=ze,o=zt,a=xu,l=a.key,c=a,f="L",s=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(i=u=n,t):u},t.y0=function(n){return arguments.length?(i=n,t):i},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(l="function"==typeof n?a=n:(a=ql.get(n)||xu).key,c=a.reverse||a,f=a.closed?"M":"L",t):l},t.tension=function(n){return arguments.length?(s=n,t):s},t}function Iu(n){return n.radius}function Yu(n){return[n.x,n.y]}function Zu(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Oo;return[e*Math.cos(r),e*Math.sin(r)]}}function Vu(){return 64}function Xu(){return"circle"}function $u(n){var t=Math.sqrt(n/jo);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Bu(n){return function(){var t,e,r;(t=this[n])&&(r=t[e=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[e]:delete this[n],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Wu(n,t,e){return ko(n,Il),n.namespace=t,n.id=e,n}function Ju(n,t,e,r){var i=n.id,u=n.namespace;return Y(n,"function"==typeof e?function(n,o,a){n[u][i].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[u][i].tween.set(t,e)}))}function Gu(n){return null==n&&(n=""),function(){this.textContent=n}}function Ku(n){return null==n?"__transition__":"__transition_"+n+"__"}function Qu(n,t,e,r,i){function u(n){var t=v.delay;return f.t=t+l,n>=t?o(n-t):void(f.c=o)}function o(e){var i=g.active,u=g[i];u&&(u.timer.c=null,u.timer.t=NaN,--g.count,delete g[i],u.event&&u.event.interrupt.call(n,n.__data__,u.index));for(var o in g)if(r>+o){var c=g[o];c.timer.c=null,c.timer.t=NaN,--g.count,delete g[o]}f.c=a,qn(function(){return f.c&&a(e||1)&&(f.c=null,f.t=NaN),1},0,l),g.active=r,v.event&&v.event.start.call(n,n.__data__,t),p=[],v.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&p.push(r)}),h=v.ease,s=v.duration}function a(i){for(var u=i/s,o=h(u),a=p.length;a>0;)p[--a].call(n,o);return u>=1?(v.event&&v.event.end.call(n,n.__data__,t),--g.count?delete g[r]:delete n[e],1):void 0}var l,f,s,h,p,g=n[e]||(n[e]={active:0,count:0}),v=g[r];v||(l=i.time,f=qn(u,0,l),v=g[r]={tween:new c,time:l,timer:f,delay:i.delay,duration:i.duration,ease:i.ease,index:t},i=null,++g.count)}function no(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function to(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function eo(n){return n.toISOString()}function ro(n,t,e){function r(t){return n(t)}function i(n,e){var r=n[1]-n[0],i=r/e,u=ao.bisect(Gl,i);return u==Gl.length?[t.year,Ki(n.map(function(n){return n/31536e6}),e)[2]]:u?t[i/Gl[u-1]<Gl[u]/i?u-1:u]:[nc,Ki(n,e)[2]]}return r.invert=function(t){return io(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(io)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,io(+e+1),t).length}var u=r.domain(),o=Yi(u),a=null==n?i(o,10):"number"==typeof n&&i(o,n);return a&&(n=a[0],t=a[1]),r.domain(Xi(u,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=io(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=io(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Yi(r.domain()),u=null==n?i(e,10):"number"==typeof n?i(e,n):!n.range&&[{range:n},t];return u&&(n=u[0],t=u[1]),n.range(e[0],io(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return ro(n.copy(),t,e)},Ji(r,n)}function io(n){return new Date(n)}function uo(n){return JSON.parse(n.responseText)}function oo(n){var t=fo.createRange();return t.selectNode(fo.body),t.createContextualFragment(n.responseText)}var ao={version:"3.5.15"},lo=[].slice,co=function(n){return lo.call(n)},fo=this.document;if(fo)try{co(fo.documentElement.childNodes)[0].nodeType}catch(so){co=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),fo)try{fo.createElement("DIV").style.setProperty("opacity",0,"")}catch(ho){var po=this.Element.prototype,go=po.setAttribute,vo=po.setAttributeNS,yo=this.CSSStyleDeclaration.prototype,mo=yo.setProperty;po.setAttribute=function(n,t){go.call(this,n,t+"")},po.setAttributeNS=function(n,t,e){vo.call(this,n,t,e+"")},yo.setProperty=function(n,t,e){mo.call(this,n,t+"",e)}}ao.ascending=e,ao.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN},ao.min=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&e>r&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&e>r&&(e=r)}return e},ao.max=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&r>e&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&r>e&&(e=r)}return e},ao.extent=function(n,t){var e,r,i,u=-1,o=n.length;if(1===arguments.length){for(;++u<o;)if(null!=(r=n[u])&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=n[u])&&(e>r&&(e=r),r>i&&(i=r))}else{for(;++u<o;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=t.call(n,n[u],u))&&(e>r&&(e=r),r>i&&(i=r))}return[e,i]},ao.sum=function(n,t){var e,r=0,u=n.length,o=-1;if(1===arguments.length)for(;++o<u;)i(e=+n[o])&&(r+=e);else for(;++o<u;)i(e=+t.call(n,n[o],o))&&(r+=e);return r},ao.mean=function(n,t){var e,u=0,o=n.length,a=-1,l=o;if(1===arguments.length)for(;++a<o;)i(e=r(n[a]))?u+=e:--l;else for(;++a<o;)i(e=r(t.call(n,n[a],a)))?u+=e:--l;return l?u/l:void 0},ao.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),i=+n[r-1],u=e-r;return u?i+u*(n[r]-i):i},ao.median=function(n,t){var u,o=[],a=n.length,l=-1;if(1===arguments.length)for(;++l<a;)i(u=r(n[l]))&&o.push(u);else for(;++l<a;)i(u=r(t.call(n,n[l],l)))&&o.push(u);return o.length?ao.quantile(o.sort(e),.5):void 0},ao.variance=function(n,t){var e,u,o=n.length,a=0,l=0,c=-1,f=0;if(1===arguments.length)for(;++c<o;)i(e=r(n[c]))&&(u=e-a,a+=u/++f,l+=u*(e-a));else for(;++c<o;)i(e=r(t.call(n,n[c],c)))&&(u=e-a,a+=u/++f,l+=u*(e-a));return f>1?l/(f-1):void 0},ao.deviation=function(){var n=ao.variance.apply(this,arguments);return n?Math.sqrt(n):n};var Mo=u(e);ao.bisectLeft=Mo.left,ao.bisect=ao.bisectRight=Mo.right,ao.bisector=function(n){return u(1===n.length?function(t,r){return e(n(t),r)}:n)},ao.shuffle=function(n,t,e){(u=arguments.length)<3&&(e=n.length,2>u&&(t=0));for(var r,i,u=e-t;u;)i=Math.random()*u--|0,r=n[u+t],n[u+t]=n[i+t],n[i+t]=r;return n},ao.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},ao.pairs=function(n){for(var t,e=0,r=n.length-1,i=n[0],u=new Array(0>r?0:r);r>e;)u[e]=[t=i,i=n[++e]];return u},ao.transpose=function(n){if(!(i=n.length))return[];for(var t=-1,e=ao.min(n,o),r=new Array(e);++t<e;)for(var i,u=-1,a=r[t]=new Array(i);++u<i;)a[u]=n[u][t];return r},ao.zip=function(){return ao.transpose(arguments)},ao.keys=function(n){var t=[];for(var e in n)t.push(e);return t},ao.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},ao.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},ao.merge=function(n){for(var t,e,r,i=n.length,u=-1,o=0;++u<i;)o+=n[u].length;for(e=new Array(o);--i>=0;)for(r=n[i],t=r.length;--t>=0;)e[--o]=r[t];return e};var xo=Math.abs;ao.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e===1/0)throw new Error("infinite range");var r,i=[],u=a(xo(e)),o=-1;if(n*=u,t*=u,e*=u,0>e)for(;(r=n+e*++o)>t;)i.push(r/u);else for(;(r=n+e*++o)<t;)i.push(r/u);return i},ao.map=function(n,t){var e=new c;if(n instanceof c)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,i=-1,u=n.length;if(1===arguments.length)for(;++i<u;)e.set(i,n[i]);else for(;++i<u;)e.set(t.call(n,r=n[i],i),r)}else for(var o in n)e.set(o,n[o]);return e};var bo="__proto__",_o="\x00";l(c,{has:h,get:function(n){return this._[f(n)]},set:function(n,t){return this._[f(n)]=t},remove:p,keys:g,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:s(t),value:this._[t]});return n},size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,s(t),this._[t])}}),ao.nest=function(){function n(t,o,a){if(a>=u.length)return r?r.call(i,o):e?o.sort(e):o;for(var l,f,s,h,p=-1,g=o.length,v=u[a++],d=new c;++p<g;)(h=d.get(l=v(f=o[p])))?h.push(f):d.set(l,[f]);return t?(f=t(),s=function(e,r){f.set(e,n(t,r,a))}):(f={},s=function(e,r){f[e]=n(t,r,a)}),d.forEach(s),f}function t(n,e){if(e>=u.length)return n;var r=[],i=o[e++];return n.forEach(function(n,i){r.push({key:n,values:t(i,e)})}),i?r.sort(function(n,t){return i(n.key,t.key)}):r}var e,r,i={},u=[],o=[];return i.map=function(t,e){return n(e,t,0)},i.entries=function(e){return t(n(ao.map,e,0),0)},i.key=function(n){return u.push(n),i},i.sortKeys=function(n){return o[u.length-1]=n,i},i.sortValues=function(n){return e=n,i},i.rollup=function(n){return r=n,i},i},ao.set=function(n){var t=new y;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},l(y,{has:h,add:function(n){return this._[f(n+="")]=!0,n},remove:p,values:g,size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,s(t))}}),ao.behavior={},ao.rebind=function(n,t){for(var e,r=1,i=arguments.length;++r<i;)n[e=arguments[r]]=M(n,t,t[e]);return n};var wo=["webkit","ms","moz","Moz","o","O"];ao.dispatch=function(){for(var n=new _,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=w(n);return n},_.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},ao.event=null,ao.requote=function(n){return n.replace(So,"\\$&")};var So=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ko={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},No=function(n,t){return t.querySelector(n)},Eo=function(n,t){return t.querySelectorAll(n)},Ao=function(n,t){var e=n.matches||n[x(n,"matchesSelector")];return(Ao=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(No=function(n,t){return Sizzle(n,t)[0]||null},Eo=Sizzle,Ao=Sizzle.matchesSelector),ao.selection=function(){return ao.select(fo.documentElement)};var Co=ao.selection.prototype=[];Co.select=function(n){var t,e,r,i,u=[];n=A(n);for(var o=-1,a=this.length;++o<a;){u.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var l=-1,c=r.length;++l<c;)(i=r[l])?(t.push(e=n.call(i,i.__data__,l,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):t.push(null)}return E(u)},Co.selectAll=function(n){var t,e,r=[];n=C(n);for(var i=-1,u=this.length;++i<u;)for(var o=this[i],a=-1,l=o.length;++a<l;)(e=o[a])&&(r.push(t=co(n.call(e,e.__data__,a,i))),t.parentNode=e);return E(r)};var zo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ao.ns={prefix:zo,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&"xmlns"!==(e=n.slice(0,t))&&(n=n.slice(t+1)),zo.hasOwnProperty(e)?{space:zo[e],local:n}:n}},Co.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=ao.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(z(t,n[t]));return this}return this.each(z(n,t))},Co.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=T(n)).length,i=-1;if(t=e.classList){for(;++i<r;)if(!t.contains(n[i]))return!1}else for(t=e.getAttribute("class");++i<r;)if(!q(n[i]).test(t))return!1;return!0}for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},Co.style=function(n,e,r){var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(e="");for(r in n)this.each(P(r,n[r],e));return this}if(2>i){var u=this.node();return t(u).getComputedStyle(u,null).getPropertyValue(n)}r=""}return this.each(P(n,e,r))},Co.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(U(t,n[t]));return this}return this.each(U(n,t))},Co.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},Co.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},Co.append=function(n){return n=j(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},Co.insert=function(n,t){return n=j(n),t=A(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},Co.remove=function(){return this.each(F)},Co.data=function(n,t){function e(n,e){var r,i,u,o=n.length,s=e.length,h=Math.min(o,s),p=new Array(s),g=new Array(s),v=new Array(o);if(t){var d,y=new c,m=new Array(o);for(r=-1;++r<o;)(i=n[r])&&(y.has(d=t.call(i,i.__data__,r))?v[r]=i:y.set(d,i),m[r]=d);for(r=-1;++r<s;)(i=y.get(d=t.call(e,u=e[r],r)))?i!==!0&&(p[r]=i,i.__data__=u):g[r]=H(u),y.set(d,!0);for(r=-1;++r<o;)r in m&&y.get(m[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)i=n[r],u=e[r],i?(i.__data__=u,p[r]=i):g[r]=H(u);for(;s>r;++r)g[r]=H(e[r]);for(;o>r;++r)v[r]=n[r]}g.update=p,g.parentNode=p.parentNode=v.parentNode=n.parentNode,a.push(g),l.push(p),f.push(v)}var r,i,u=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++u<o;)(i=r[u])&&(n[u]=i.__data__);return n}var a=Z([]),l=E([]),f=E([]);if("function"==typeof n)for(;++u<o;)e(r=this[u],n.call(r,r.parentNode.__data__,u));else for(;++u<o;)e(r=this[u],n);return l.enter=function(){return a},l.exit=function(){return f},l},Co.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},Co.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=O(n));for(var u=0,o=this.length;o>u;u++){i.push(t=[]),t.parentNode=(e=this[u]).parentNode;for(var a=0,l=e.length;l>a;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return E(i)},Co.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],i=r.length-1,u=r[i];--i>=0;)(e=r[i])&&(u&&u!==e.nextSibling&&u.parentNode.insertBefore(e,u),u=e);return this},Co.sort=function(n){n=I.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},Co.each=function(n){return Y(this,function(t,e,r){n.call(t,t.__data__,e,r)})},Co.call=function(n){var t=co(arguments);return n.apply(t[0]=this,t),this},Co.empty=function(){return!this.node()},Co.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,i=e.length;i>r;r++){var u=e[r];if(u)return u}return null},Co.size=function(){var n=0;return Y(this,function(){++n}),n};var Lo=[];ao.selection.enter=Z,ao.selection.enter.prototype=Lo,Lo.append=Co.append,Lo.empty=Co.empty,Lo.node=Co.node,Lo.call=Co.call,Lo.size=Co.size,Lo.select=function(n){for(var t,e,r,i,u,o=[],a=-1,l=this.length;++a<l;){r=(i=this[a]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var c=-1,f=i.length;++c<f;)(u=i[c])?(t.push(r[c]=e=n.call(i.parentNode,u.__data__,c,a)),e.__data__=u.__data__):t.push(null)}return E(o)},Lo.insert=function(n,t){return arguments.length<2&&(t=V(this)),Co.insert.call(this,n,t)},ao.select=function(t){var e;return"string"==typeof t?(e=[No(t,fo)],e.parentNode=fo.documentElement):(e=[t],e.parentNode=n(t)),E([e])},ao.selectAll=function(n){var t;return"string"==typeof n?(t=co(Eo(n,fo)),t.parentNode=fo.documentElement):(t=co(n),t.parentNode=null),E([t])},Co.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(X(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(X(n,t,e))};var qo=ao.map({mouseenter:"mouseover",mouseleave:"mouseout"});fo&&qo.forEach(function(n){"on"+n in fo&&qo.remove(n)});var To,Ro=0;ao.mouse=function(n){return J(n,k())};var Do=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ao.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=k().changedTouches),t)for(var r,i=0,u=t.length;u>i;++i)if((r=t[i]).identifier===e)return J(n,r)},ao.behavior.drag=function(){function n(){this.on("mousedown.drag",u).on("touchstart.drag",o)}function e(n,t,e,u,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],g|=n|e,M=r,p({type:"drag",x:r[0]+c[0],y:r[1]+c[1],dx:n,dy:e}))}function l(){t(h,v)&&(y.on(u+d,null).on(o+d,null),m(g),p({type:"dragend"}))}var c,f=this,s=ao.event.target.correspondingElement||ao.event.target,h=f.parentNode,p=r.of(f,arguments),g=0,v=n(),d=".drag"+(null==v?"":"-"+v),y=ao.select(e(s)).on(u+d,a).on(o+d,l),m=W(s),M=t(h,v);i?(c=i.apply(f,arguments),c=[c.x-M[0],c.y-M[1]]):c=[0,0],p({type:"dragstart"})}}var r=N(n,"drag","dragstart","dragend"),i=null,u=e(b,ao.mouse,t,"mousemove","mouseup"),o=e(G,ao.touch,m,"touchmove","touchend");return n.origin=function(t){return arguments.length?(i=t,n):i},ao.rebind(n,r,"on")},ao.touches=function(n,t){return arguments.length<2&&(t=k().touches),t?co(t).map(function(t){var e=J(n,t);return e.identifier=t.identifier,e}):[]};var Po=1e-6,Uo=Po*Po,jo=Math.PI,Fo=2*jo,Ho=Fo-Po,Oo=jo/2,Io=jo/180,Yo=180/jo,Zo=Math.SQRT2,Vo=2,Xo=4;ao.interpolateZoom=function(n,t){var e,r,i=n[0],u=n[1],o=n[2],a=t[0],l=t[1],c=t[2],f=a-i,s=l-u,h=f*f+s*s;if(Uo>h)r=Math.log(c/o)/Zo,e=function(n){return[i+n*f,u+n*s,o*Math.exp(Zo*n*r)]};else{var p=Math.sqrt(h),g=(c*c-o*o+Xo*h)/(2*o*Vo*p),v=(c*c-o*o-Xo*h)/(2*c*Vo*p),d=Math.log(Math.sqrt(g*g+1)-g),y=Math.log(Math.sqrt(v*v+1)-v);r=(y-d)/Zo,e=function(n){var t=n*r,e=rn(d),a=o/(Vo*p)*(e*un(Zo*t+d)-en(d));return[i+a*f,u+a*s,o*e/rn(Zo*t+d)]}}return e.duration=1e3*r,e},ao.behavior.zoom=function(){function n(n){n.on(L,s).on(Bo+".zoom",p).on("dblclick.zoom",g).on(R,h)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function i(n){k.k=Math.max(A[0],Math.min(A[1],n))}function u(n,t){t=r(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function o(t,e,r,o){t.__chart__={x:k.x,y:k.y,k:k.k},i(Math.pow(2,o)),u(d=e,r),t=ao.select(t),C>0&&(t=t.transition().duration(C)),t.call(n.event)}function a(){b&&b.domain(x.range().map(function(n){return(n-k.x)/k.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function l(n){z++||n({type:"zoomstart"})}function c(n){a(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function f(n){--z||(n({type:"zoomend"}),d=null)}function s(){function n(){a=1,u(ao.mouse(i),h),c(o)}function r(){s.on(q,null).on(T,null),p(a),f(o)}var i=this,o=D.of(i,arguments),a=0,s=ao.select(t(i)).on(q,n).on(T,r),h=e(ao.mouse(i)),p=W(i);Ol.call(i),l(o)}function h(){function n(){var n=ao.touches(g);return p=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=ao.event.target;ao.select(t).on(x,r).on(b,a),_.push(t);for(var e=ao.event.changedTouches,i=0,u=e.length;u>i;++i)d[e[i].identifier]=null;var l=n(),c=Date.now();if(1===l.length){if(500>c-M){var f=l[0];o(g,f,d[f.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),S()}M=c}else if(l.length>1){var f=l[0],s=l[1],h=f[0]-s[0],p=f[1]-s[1];y=h*h+p*p}}function r(){var n,t,e,r,o=ao.touches(g);Ol.call(g);for(var a=0,l=o.length;l>a;++a,r=null)if(e=o[a],r=d[e.identifier]){if(t)break;n=e,t=r}if(r){var f=(f=e[0]-n[0])*f+(f=e[1]-n[1])*f,s=y&&Math.sqrt(f/y);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],i(s*p)}M=null,u(n,t),c(v)}function a(){if(ao.event.touches.length){for(var t=ao.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var i in d)return void n()}ao.selectAll(_).on(m,null),w.on(L,s).on(R,h),N(),f(v)}var p,g=this,v=D.of(g,arguments),d={},y=0,m=".zoom-"+ao.event.changedTouches[0].identifier,x="touchmove"+m,b="touchend"+m,_=[],w=ao.select(g),N=W(g);t(),l(v),w.on(L,null).on(R,t)}function p(){var n=D.of(this,arguments);m?clearTimeout(m):(Ol.call(this),v=e(d=y||ao.mouse(this)),l(n)),m=setTimeout(function(){m=null,f(n)},50),S(),i(Math.pow(2,.002*$o())*k.k),u(d,v),c(n)}function g(){var n=ao.mouse(this),t=Math.log(k.k)/Math.LN2;o(this,n,e(n),ao.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var v,d,y,m,M,x,b,_,w,k={x:0,y:0,k:1},E=[960,500],A=Wo,C=250,z=0,L="mousedown.zoom",q="mousemove.zoom",T="mouseup.zoom",R="touchstart.zoom",D=N(n,"zoomstart","zoom","zoomend");return Bo||(Bo="onwheel"in fo?($o=function(){return-ao.event.deltaY*(ao.event.deltaMode?120:1)},"wheel"):"onmousewheel"in fo?($o=function(){return ao.event.wheelDelta},"mousewheel"):($o=function(){return-ao.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=D.of(this,arguments),t=k;Fl?ao.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},l(n)}).tween("zoom:zoom",function(){var e=E[0],r=E[1],i=d?d[0]:e/2,u=d?d[1]:r/2,o=ao.interpolateZoom([(i-k.x)/k.k,(u-k.y)/k.k,e/k.k],[(i-t.x)/t.k,(u-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:i-r[0]*a,y:u-r[1]*a,k:a},c(n)}}).each("interrupt.zoom",function(){f(n)}).each("end.zoom",function(){f(n)}):(this.__chart__=k,l(n),c(n),f(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},a(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:null},i(+t),a(),n):k.k},n.scaleExtent=function(t){return arguments.length?(A=null==t?Wo:[+t[0],+t[1]],n):A},n.center=function(t){return arguments.length?(y=t&&[+t[0],+t[1]],n):y},n.size=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],n):E},n.duration=function(t){return arguments.length?(C=+t,n):C},n.x=function(t){return arguments.length?(b=t,x=t.copy(),k={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),k={x:0,y:0,k:1},n):w},ao.rebind(n,D,"on")};var $o,Bo,Wo=[0,1/0];ao.color=an,an.prototype.toString=function(){return this.rgb()+""},ao.hsl=ln;var Jo=ln.prototype=new an;Jo.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,this.l/n)},Jo.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,n*this.l)},Jo.rgb=function(){return cn(this.h,this.s,this.l)},ao.hcl=fn;var Go=fn.prototype=new an;Go.brighter=function(n){return new fn(this.h,this.c,Math.min(100,this.l+Ko*(arguments.length?n:1)))},Go.darker=function(n){return new fn(this.h,this.c,Math.max(0,this.l-Ko*(arguments.length?n:1)))},Go.rgb=function(){return sn(this.h,this.c,this.l).rgb()},ao.lab=hn;var Ko=18,Qo=.95047,na=1,ta=1.08883,ea=hn.prototype=new an;ea.brighter=function(n){return new hn(Math.min(100,this.l+Ko*(arguments.length?n:1)),this.a,this.b)},ea.darker=function(n){return new hn(Math.max(0,this.l-Ko*(arguments.length?n:1)),this.a,this.b)},ea.rgb=function(){return pn(this.l,this.a,this.b)},ao.rgb=mn;var ra=mn.prototype=new an;ra.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,i=30;return t||e||r?(t&&i>t&&(t=i),e&&i>e&&(e=i),r&&i>r&&(r=i),new mn(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new mn(i,i,i)},ra.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new mn(n*this.r,n*this.g,n*this.b)},ra.hsl=function(){return wn(this.r,this.g,this.b)},ra.toString=function(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)};var ia=ao.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ia.forEach(function(n,t){ia.set(n,Mn(t))}),ao.functor=En,ao.xhr=An(m),ao.dsv=function(n,t){function e(n,e,u){arguments.length<3&&(u=e,e=null);var o=Cn(n,t,null==e?r:i(e),u);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:i(n)):e},o}function r(n){return e.parse(n.responseText)}function i(n){return function(t){return e.parse(t.responseText,n)}}function u(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),l=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var i=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(i(n),e)}:i})},e.parseRows=function(n,t){function e(){if(f>=c)return o;if(i)return i=!1,u;var t=f;if(34===n.charCodeAt(t)){for(var e=t;e++<c;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}f=e+2;var r=n.charCodeAt(e+1);return 13===r?(i=!0,10===n.charCodeAt(e+2)&&++f):10===r&&(i=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;c>f;){var r=n.charCodeAt(f++),a=1;if(10===r)i=!0;else if(13===r)i=!0,10===n.charCodeAt(f)&&(++f,++a);else if(r!==l)continue;return n.slice(t,f-a)}return n.slice(t)}for(var r,i,u={},o={},a=[],c=n.length,f=0,s=0;(r=e())!==o;){for(var h=[];r!==u&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,s++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new y,i=[];return t.forEach(function(n){for(var t in n)r.has(t)||i.push(r.add(t))}),[i.map(o).join(n)].concat(t.map(function(t){return i.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(u).join("\n")},e},ao.csv=ao.dsv(",","text/csv"),ao.tsv=ao.dsv("	","text/tab-separated-values");var ua,oa,aa,la,ca=this[x(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};ao.timer=function(){qn.apply(this,arguments)},ao.timer.flush=function(){Rn(),Dn()},ao.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var fa=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Un);ao.formatPrefix=function(n,t){var e=0;return(n=+n)&&(0>n&&(n*=-1),t&&(n=ao.round(n,Pn(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),fa[8+e/3]};var sa=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ha=ao.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=ao.round(n,Pn(n,t))).toFixed(Math.max(0,Math.min(20,Pn(n*(1+1e-15),t))))}}),pa=ao.time={},ga=Date;Hn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){va.setUTCDate.apply(this._,arguments)},setDay:function(){va.setUTCDay.apply(this._,arguments)},setFullYear:function(){va.setUTCFullYear.apply(this._,arguments)},setHours:function(){va.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){va.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){va.setUTCMinutes.apply(this._,arguments)},setMonth:function(){va.setUTCMonth.apply(this._,arguments)},setSeconds:function(){va.setUTCSeconds.apply(this._,arguments)},setTime:function(){va.setTime.apply(this._,arguments)}};var va=Date.prototype;pa.year=On(function(n){return n=pa.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),pa.years=pa.year.range,pa.years.utc=pa.year.utc.range,pa.day=On(function(n){var t=new ga(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),pa.days=pa.day.range,pa.days.utc=pa.day.utc.range,pa.dayOfYear=function(n){var t=pa.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=pa[n]=On(function(n){return(n=pa.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=pa.year(n).getDay();return Math.floor((pa.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});pa[n+"s"]=e.range,pa[n+"s"].utc=e.utc.range,pa[n+"OfYear"]=function(n){var e=pa.year(n).getDay();return Math.floor((pa.dayOfYear(n)+(e+t)%7)/7)}}),pa.week=pa.sunday,pa.weeks=pa.sunday.range,pa.weeks.utc=pa.sunday.utc.range,pa.weekOfYear=pa.sundayOfYear;var da={"-":"",_:" ",0:"0"},ya=/^\s*\d+/,ma=/^%/;ao.locale=function(n){return{numberFormat:jn(n),timeFormat:Yn(n)}};var Ma=ao.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ao.format=Ma.numberFormat,ao.geo={},ft.prototype={s:0,t:0,add:function(n){st(n,this.t,xa),st(xa.s,this.s,this),this.s?this.t+=xa.t:this.s=xa.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var xa=new ft;ao.geo.stream=function(n,t){n&&ba.hasOwnProperty(n.type)?ba[n.type](n,t):ht(n,t)};var ba={Feature:function(n,t){ht(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)ht(e[r].geometry,t)}},_a={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){pt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)pt(e[r],t,0)},Polygon:function(n,t){gt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)gt(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)ht(e[r],t)}};ao.geo.area=function(n){return wa=0,ao.geo.stream(n,ka),wa};var wa,Sa=new ft,ka={sphere:function(){wa+=4*jo},point:b,lineStart:b,lineEnd:b,polygonStart:function(){Sa.reset(),ka.lineStart=vt},polygonEnd:function(){var n=2*Sa;wa+=0>n?4*jo+n:n,ka.lineStart=ka.lineEnd=ka.point=b}};ao.geo.bounds=function(){function n(n,t){M.push(x=[f=n,h=n]),s>t&&(s=t),t>p&&(p=t)}function t(t,e){var r=dt([t*Io,e*Io]);if(y){var i=mt(y,r),u=[i[1],-i[0],0],o=mt(u,i);bt(o),o=_t(o);var l=t-g,c=l>0?1:-1,v=o[0]*Yo*c,d=xo(l)>180;if(d^(v>c*g&&c*t>v)){var m=o[1]*Yo;m>p&&(p=m)}else if(v=(v+360)%360-180,d^(v>c*g&&c*t>v)){var m=-o[1]*Yo;s>m&&(s=m)}else s>e&&(s=e),e>p&&(p=e);d?g>t?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t):h>=f?(f>t&&(f=t),t>h&&(h=t)):t>g?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t)}else n(t,e);y=r,g=t}function e(){b.point=t}function r(){x[0]=f,x[1]=h,b.point=n,y=null}function i(n,e){if(y){var r=n-g;m+=xo(r)>180?r+(r>0?360:-360):r}else v=n,d=e;ka.point(n,e),t(n,e)}function u(){ka.lineStart()}function o(){i(v,d),ka.lineEnd(),xo(m)>Po&&(f=-(h=180)),x[0]=f,x[1]=h,y=null}function a(n,t){return(t-=n)<0?t+360:t}function l(n,t){return n[0]-t[0]}function c(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var f,s,h,p,g,v,d,y,m,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=i,b.lineStart=u,b.lineEnd=o,m=0,ka.polygonStart()},polygonEnd:function(){ka.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>Sa?(f=-(h=180),s=-(p=90)):m>Po?p=90:-Po>m&&(s=-90),x[0]=f,x[1]=h}};return function(n){p=h=-(f=s=1/0),M=[],ao.geo.stream(n,b);var t=M.length;if(t){M.sort(l);for(var e,r=1,i=M[0],u=[i];t>r;++r)e=M[r],c(e[0],i)||c(e[1],i)?(a(i[0],e[1])>a(i[0],i[1])&&(i[1]=e[1]),a(e[0],i[1])>a(i[0],i[1])&&(i[0]=e[0])):u.push(i=e);for(var o,e,g=-(1/0),t=u.length-1,r=0,i=u[t];t>=r;i=e,++r)e=u[r],(o=a(i[1],e[0]))>g&&(g=o,f=e[0],h=i[1])}return M=x=null,f===1/0||s===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,s],[h,p]]}}(),ao.geo.centroid=function(n){Na=Ea=Aa=Ca=za=La=qa=Ta=Ra=Da=Pa=0,ao.geo.stream(n,Ua);var t=Ra,e=Da,r=Pa,i=t*t+e*e+r*r;return Uo>i&&(t=La,e=qa,r=Ta,Po>Ea&&(t=Aa,e=Ca,r=za),i=t*t+e*e+r*r,Uo>i)?[NaN,NaN]:[Math.atan2(e,t)*Yo,tn(r/Math.sqrt(i))*Yo]};var Na,Ea,Aa,Ca,za,La,qa,Ta,Ra,Da,Pa,Ua={sphere:b,point:St,lineStart:Nt,lineEnd:Et,polygonStart:function(){Ua.lineStart=At},polygonEnd:function(){Ua.lineStart=Nt}},ja=Rt(zt,jt,Ht,[-jo,-jo/2]),Fa=1e9;ao.geo.clipExtent=function(){var n,t,e,r,i,u,o={stream:function(n){return i&&(i.valid=!1),i=u(n),i.valid=!0,i},extent:function(a){return arguments.length?(u=Zt(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),i&&(i.valid=!1,i=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(ao.geo.conicEqualArea=function(){return Vt(Xt)}).raw=Xt,ao.geo.albers=function(){return ao.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ao.geo.albersUsa=function(){function n(n){var u=n[0],o=n[1];return t=null,e(u,o),t||(r(u,o),t)||i(u,o),t}var t,e,r,i,u=ao.geo.albers(),o=ao.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ao.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=u.scale(),e=u.translate(),r=(n[0]-e[0])/t,i=(n[1]-e[1])/t;return(i>=.12&&.234>i&&r>=-.425&&-.214>r?o:i>=.166&&.234>i&&r>=-.214&&-.115>r?a:u).invert(n)},n.stream=function(n){var t=u.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,i){t.point(n,i),e.point(n,i),r.point(n,i)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(u.precision(t),o.precision(t),a.precision(t),n):u.precision()},n.scale=function(t){return arguments.length?(u.scale(t),o.scale(.35*t),a.scale(t),n.translate(u.translate())):u.scale()},n.translate=function(t){if(!arguments.length)return u.translate();var c=u.scale(),f=+t[0],s=+t[1];return e=u.translate(t).clipExtent([[f-.455*c,s-.238*c],[f+.455*c,s+.238*c]]).stream(l).point,r=o.translate([f-.307*c,s+.201*c]).clipExtent([[f-.425*c+Po,s+.12*c+Po],[f-.214*c-Po,s+.234*c-Po]]).stream(l).point,i=a.translate([f-.205*c,s+.212*c]).clipExtent([[f-.214*c+Po,s+.166*c+Po],[f-.115*c-Po,s+.234*c-Po]]).stream(l).point,n},n.scale(1070)};var Ha,Oa,Ia,Ya,Za,Va,Xa={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Oa=0,Xa.lineStart=$t},polygonEnd:function(){Xa.lineStart=Xa.lineEnd=Xa.point=b,Ha+=xo(Oa/2)}},$a={point:Bt,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Ba={point:Gt,lineStart:Kt,lineEnd:Qt,polygonStart:function(){Ba.lineStart=ne},polygonEnd:function(){Ba.point=Gt,Ba.lineStart=Kt,Ba.lineEnd=Qt}};ao.geo.path=function(){function n(n){return n&&("function"==typeof a&&u.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=i(u)),ao.geo.stream(n,o)),u.result()}function t(){return o=null,n}var e,r,i,u,o,a=4.5;return n.area=function(n){return Ha=0,ao.geo.stream(n,i(Xa)),Ha},n.centroid=function(n){return Aa=Ca=za=La=qa=Ta=Ra=Da=Pa=0,ao.geo.stream(n,i(Ba)),Pa?[Ra/Pa,Da/Pa]:Ta?[La/Ta,qa/Ta]:za?[Aa/za,Ca/za]:[NaN,NaN]},n.bounds=function(n){return Za=Va=-(Ia=Ya=1/0),ao.geo.stream(n,i($a)),[[Ia,Ya],[Za,Va]]},n.projection=function(n){return arguments.length?(i=(e=n)?n.stream||re(n):m,t()):e},n.context=function(n){return arguments.length?(u=null==(r=n)?new Wt:new te(n),"function"!=typeof a&&u.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(u.pointRadius(+t),+t),n):a},n.projection(ao.geo.albersUsa()).context(null)},ao.geo.transform=function(n){return{stream:function(t){var e=new ie(t);for(var r in n)e[r]=n[r];return e}}},ie.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ao.geo.projection=oe,ao.geo.projectionMutator=ae,(ao.geo.equirectangular=function(){return oe(ce)}).raw=ce.invert=ce,ao.geo.rotation=function(n){function t(t){return t=n(t[0]*Io,t[1]*Io),t[0]*=Yo,t[1]*=Yo,t}return n=se(n[0]%360*Io,n[1]*Io,n.length>2?n[2]*Io:0),t.invert=function(t){return t=n.invert(t[0]*Io,t[1]*Io),t[0]*=Yo,t[1]*=Yo,t},t},fe.invert=ce,ao.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=se(-n[0]*Io,-n[1]*Io,0).invert,i=[];return e(null,null,1,{point:function(n,e){i.push(n=t(n,e)),n[0]*=Yo,n[1]*=Yo}}),{type:"Polygon",coordinates:[i]}}var t,e,r=[0,0],i=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=ve((t=+r)*Io,i*Io),n):t},n.precision=function(r){return arguments.length?(e=ve(t*Io,(i=+r)*Io),n):i},n.angle(90)},ao.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Io,i=n[1]*Io,u=t[1]*Io,o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i),f=Math.sin(u),s=Math.cos(u);return Math.atan2(Math.sqrt((e=s*o)*e+(e=c*f-l*s*a)*e),l*f+c*s*a)},ao.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return ao.range(Math.ceil(u/d)*d,i,d).map(h).concat(ao.range(Math.ceil(c/y)*y,l,y).map(p)).concat(ao.range(Math.ceil(r/g)*g,e,g).filter(function(n){return xo(n%d)>Po}).map(f)).concat(ao.range(Math.ceil(a/v)*v,o,v).filter(function(n){return xo(n%y)>Po}).map(s))}var e,r,i,u,o,a,l,c,f,s,h,p,g=10,v=g,d=90,y=360,m=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(u).concat(p(l).slice(1),h(i).reverse().slice(1),p(c).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(u=+t[0][0],i=+t[1][0],c=+t[0][1],l=+t[1][1],u>i&&(t=u,u=i,i=t),c>l&&(t=c,c=l,l=t),n.precision(m)):[[u,c],[i,l]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(m)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],y=+t[1],n):[d,y]},n.minorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],n):[g,v]},n.precision=function(t){return arguments.length?(m=+t,f=ye(a,o,90),s=me(r,e,m),h=ye(c,l,90),p=me(u,i,m),n):m},n.majorExtent([[-180,-90+Po],[180,90-Po]]).minorExtent([[-180,-80-Po],[180,80+Po]])},ao.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||i.apply(this,arguments)]}}var t,e,r=Me,i=xe;return n.distance=function(){return ao.geo.distance(t||r.apply(this,arguments),e||i.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,n):i},n.precision=function(){return arguments.length?n:0},n},ao.geo.interpolate=function(n,t){return be(n[0]*Io,n[1]*Io,t[0]*Io,t[1]*Io)},ao.geo.length=function(n){return Wa=0,ao.geo.stream(n,Ja),Wa};var Wa,Ja={sphere:b,point:b,lineStart:_e,lineEnd:b,polygonStart:b,polygonEnd:b},Ga=we(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(ao.geo.azimuthalEqualArea=function(){return oe(Ga)}).raw=Ga;var Ka=we(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},m);(ao.geo.azimuthalEquidistant=function(){return oe(Ka)}).raw=Ka,(ao.geo.conicConformal=function(){return Vt(Se)}).raw=Se,(ao.geo.conicEquidistant=function(){return Vt(ke)}).raw=ke;var Qa=we(function(n){return 1/n},Math.atan);(ao.geo.gnomonic=function(){return oe(Qa)}).raw=Qa,Ne.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Oo]},(ao.geo.mercator=function(){return Ee(Ne)}).raw=Ne;var nl=we(function(){return 1},Math.asin);(ao.geo.orthographic=function(){return oe(nl)}).raw=nl;var tl=we(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(ao.geo.stereographic=function(){return oe(tl)}).raw=tl,Ae.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Oo]},(ao.geo.transverseMercator=function(){var n=Ee(Ae),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Ae,ao.geom={},ao.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,i=En(e),u=En(r),o=n.length,a=[],l=[];for(t=0;o>t;t++)a.push([+i.call(this,n[t],t),+u.call(this,n[t],t),t]);for(a.sort(qe),t=0;o>t;t++)l.push([a[t][0],-a[t][1]]);var c=Le(a),f=Le(l),s=f[0]===c[0],h=f[f.length-1]===c[c.length-1],p=[];for(t=c.length-1;t>=0;--t)p.push(n[a[c[t]][2]]);for(t=+s;t<f.length-h;++t)p.push(n[a[f[t]][2]]);return p}var e=Ce,r=ze;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},ao.geom.polygon=function(n){return ko(n,el),n};var el=ao.geom.polygon.prototype=[];el.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],i=0;++t<e;)n=r,r=this[t],i+=n[1]*r[0]-n[0]*r[1];return.5*i},el.centroid=function(n){var t,e,r=-1,i=this.length,u=0,o=0,a=this[i-1];for(arguments.length||(n=-1/(6*this.area()));++r<i;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],u+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[u*n,o*n]},el.clip=function(n){for(var t,e,r,i,u,o,a=De(n),l=-1,c=this.length-De(this),f=this[c-1];++l<c;){for(t=n.slice(),n.length=0,i=this[l],u=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],Te(o,f,i)?(Te(u,f,i)||n.push(Re(u,o,f,i)),n.push(o)):Te(u,f,i)&&n.push(Re(u,o,f,i)),u=o;a&&n.push(n[0]),f=i}return n};var rl,il,ul,ol,al,ll=[],cl=[];Ye.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Ve),t.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(n,t){var e,r,i;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=or(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(i=r.R,i&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.R&&(ir(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ur(this,r))):(i=r.L,i&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.L&&(ur(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ir(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,i=n.U,u=n.L,o=n.R;if(e=u?o?or(o):u:o,i?i.L===n?i.L=e:i.R=e:this._=e,u&&o?(r=e.C,e.C=n.C,e.L=u,u.U=e,e!==o?(i=e.U,e.U=n.U,n=e.R,i.L=n,e.R=o,o.U=e):(e.U=i,i=e,n=e.R)):(r=n.C,n=e),n&&(n.U=i),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===i.L){if(t=i.R,t.C&&(t.C=!1,i.C=!0,ir(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ur(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,ir(this,i),n=this._;break}}else if(t=i.L,t.C&&(t.C=!1,i.C=!0,ur(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,ir(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,ur(this,i),n=this._;break}t.C=!0,n=i,i=i.U}while(!n.C);n&&(n.C=!1)}}},ao.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],i=a[0][1],u=a[1][0],o=a[1][1];return ar(e(n),a).cells.forEach(function(e,a){var l=e.edges,c=e.site,f=t[a]=l.length?l.map(function(n){var t=n.start();return[t.x,t.y]}):c.x>=r&&c.x<=u&&c.y>=i&&c.y<=o?[[r,o],[u,o],[u,i],[r,i]]:[];f.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(u(n,t)/Po)*Po,y:Math.round(o(n,t)/Po)*Po,i:t}})}var r=Ce,i=ze,u=r,o=i,a=fl;return n?t(n):(t.links=function(n){return ar(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return ar(e(n)).cells.forEach(function(e,r){for(var i,u,o=e.site,a=e.edges.sort(Ve),l=-1,c=a.length,f=a[c-1].edge,s=f.l===o?f.r:f.l;++l<c;)i=f,u=s,f=a[l].edge,s=f.l===o?f.r:f.l,r<u.i&&r<s.i&&cr(o,u,s)<0&&t.push([n[r],n[u.i],n[s.i]])}),t},t.x=function(n){return arguments.length?(u=En(r=n),t):r},t.y=function(n){return arguments.length?(o=En(i=n),t):i},t.clipExtent=function(n){return arguments.length?(a=null==n?fl:n,t):a===fl?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===fl?null:a&&a[1]},t)};var fl=[[-1e6,-1e6],[1e6,1e6]];ao.geom.delaunay=function(n){return ao.geom.voronoi().triangles(n)},ao.geom.quadtree=function(n,t,e,r,i){function u(n){function u(n,t,e,r,i,u,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var l=n.x,f=n.y;if(null!=l)if(xo(l-e)+xo(f-r)<.01)c(n,t,e,r,i,u,o,a);else{var s=n.point;n.x=n.y=n.point=null,c(n,s,l,f,i,u,o,a),c(n,t,e,r,i,u,o,a)}else n.x=e,n.y=r,n.point=t}else c(n,t,e,r,i,u,o,a)}function c(n,t,e,r,i,o,a,l){var c=.5*(i+a),f=.5*(o+l),s=e>=c,h=r>=f,p=h<<1|s;n.leaf=!1,n=n.nodes[p]||(n.nodes[p]=hr()),s?i=c:a=c,h?o=f:l=f,u(n,t,e,r,i,o,a,l)}var f,s,h,p,g,v,d,y,m,M=En(a),x=En(l);if(null!=t)v=t,d=e,y=r,m=i;else if(y=m=-(v=d=1/0),s=[],h=[],g=n.length,o)for(p=0;g>p;++p)f=n[p],f.x<v&&(v=f.x),f.y<d&&(d=f.y),f.x>y&&(y=f.x),f.y>m&&(m=f.y),s.push(f.x),h.push(f.y);else for(p=0;g>p;++p){var b=+M(f=n[p],p),_=+x(f,p);v>b&&(v=b),d>_&&(d=_),b>y&&(y=b),_>m&&(m=_),s.push(b),h.push(_)}var w=y-v,S=m-d;w>S?m=d+w:y=v+S;var k=hr();if(k.add=function(n){u(k,n,+M(n,++p),+x(n,p),v,d,y,m)},k.visit=function(n){pr(n,k,v,d,y,m)},k.find=function(n){return gr(k,n[0],n[1],v,d,y,m)},p=-1,null==t){for(;++p<g;)u(k,n[p],s[p],h[p],v,d,y,m);--p}else n.forEach(k.add);return s=h=n=f=null,k}var o,a=Ce,l=ze;return(o=arguments.length)?(a=fr,l=sr,3===o&&(i=e,r=t,e=t=0),u(n)):(u.x=function(n){return arguments.length?(a=n,u):a},u.y=function(n){return arguments.length?(l=n,u):l},u.extent=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],i=+n[1][1]),u):null==t?null:[[t,e],[r,i]]},u.size=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=e=0,r=+n[0],i=+n[1]),u):null==t?null:[r-t,i-e]},u)},ao.interpolateRgb=vr,ao.interpolateObject=dr,ao.interpolateNumber=yr,ao.interpolateString=mr;var sl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hl=new RegExp(sl.source,"g");ao.interpolate=Mr,ao.interpolators=[function(n,t){var e=typeof t;return("string"===e?ia.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?vr:mr:t instanceof an?vr:Array.isArray(t)?xr:"object"===e&&isNaN(t)?dr:yr)(n,t)}],ao.interpolateArray=xr;var pl=function(){return m},gl=ao.map({linear:pl,poly:Er,quad:function(){return Sr},cubic:function(){return kr},sin:function(){return Ar},exp:function(){return Cr},circle:function(){return zr},elastic:Lr,back:qr,bounce:function(){return Tr}}),vl=ao.map({"in":m,out:_r,"in-out":wr,"out-in":function(n){return wr(_r(n))}});ao.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=gl.get(e)||pl,r=vl.get(r)||m,br(r(e.apply(null,lo.call(arguments,1))))},ao.interpolateHcl=Rr,ao.interpolateHsl=Dr,ao.interpolateLab=Pr,ao.interpolateRound=Ur,ao.transform=function(n){var t=fo.createElementNS(ao.ns.prefix.svg,"g");return(ao.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new jr(e?e.matrix:dl)})(n)},jr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var dl={a:1,b:0,c:0,d:1,e:0,f:0};ao.interpolateTransform=$r,ao.layout={},ao.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Jr(n[e]));return t}},ao.layout.chord=function(){function n(){var n,c,s,h,p,g={},v=[],d=ao.range(u),y=[];for(e=[],r=[],n=0,h=-1;++h<u;){for(c=0,p=-1;++p<u;)c+=i[h][p];v.push(c),y.push(ao.range(u)),n+=c}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&y.forEach(function(n,t){n.sort(function(n,e){return a(i[t][n],i[t][e])})}),n=(Fo-f*u)/n,c=0,h=-1;++h<u;){for(s=c,p=-1;++p<u;){var m=d[h],M=y[m][p],x=i[m][M],b=c,_=c+=x*n;g[m+"-"+M]={index:m,subindex:M,startAngle:b,endAngle:_,value:x}}r[m]={index:m,startAngle:s,endAngle:c,value:v[m]},c+=f}for(h=-1;++h<u;)for(p=h-1;++p<u;){var w=g[h+"-"+p],S=g[p+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}l&&t()}function t(){e.sort(function(n,t){return l((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,i,u,o,a,l,c={},f=0;return c.matrix=function(n){return arguments.length?(u=(i=n)&&i.length,e=r=null,c):i},c.padding=function(n){return arguments.length?(f=n,e=r=null,c):f},c.sortGroups=function(n){return arguments.length?(o=n,e=r=null,c):o},c.sortSubgroups=function(n){return arguments.length?(a=n,e=null,c):a},c.sortChords=function(n){return arguments.length?(l=n,e&&t(),c):l},c.chords=function(){return e||n(),e},c.groups=function(){return r||n(),r},c},ao.layout.force=function(){function n(n){return function(t,e,r,i){if(t.point!==n){var u=t.cx-n.x,o=t.cy-n.y,a=i-e,l=u*u+o*o;if(l>a*a/y){if(v>l){var c=t.charge/l;n.px-=u*c,n.py-=o*c}return!0}if(t.point&&l&&v>l){var c=t.pointCharge/l;n.px-=u*c,n.py-=o*c}}return!t.charge}}function t(n){n.px=ao.event.x,n.py=ao.event.y,l.resume()}var e,r,i,u,o,a,l={},c=ao.dispatch("start","tick","end"),f=[1,1],s=.9,h=yl,p=ml,g=-30,v=Ml,d=.1,y=.64,M=[],x=[];return l.tick=function(){if((i*=.99)<.005)return e=null,c.end({type:"end",alpha:i=0}),!0;var t,r,l,h,p,v,y,m,b,_=M.length,w=x.length;for(r=0;w>r;++r)l=x[r],h=l.source,p=l.target,m=p.x-h.x,b=p.y-h.y,(v=m*m+b*b)&&(v=i*o[r]*((v=Math.sqrt(v))-u[r])/v,m*=v,b*=v,p.x-=m*(y=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=b*y,h.x+=m*(y=1-y),h.y+=b*y);if((y=i*d)&&(m=f[0]/2,b=f[1]/2,r=-1,y))for(;++r<_;)l=M[r],l.x+=(m-l.x)*y,l.y+=(b-l.y)*y;if(g)for(ri(t=ao.geom.quadtree(M),i,a),r=-1;++r<_;)(l=M[r]).fixed||t.visit(n(l));for(r=-1;++r<_;)l=M[r],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*s,l.y-=(l.py-(l.py=l.y))*s);c.tick({type:"tick",alpha:i})},l.nodes=function(n){return arguments.length?(M=n,l):M},l.links=function(n){return arguments.length?(x=n,l):x},l.size=function(n){return arguments.length?(f=n,l):f},l.linkDistance=function(n){return arguments.length?(h="function"==typeof n?n:+n,l):h},l.distance=l.linkDistance,l.linkStrength=function(n){return arguments.length?(p="function"==typeof n?n:+n,l):p},l.friction=function(n){return arguments.length?(s=+n,l):s},l.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,l):g},l.chargeDistance=function(n){return arguments.length?(v=n*n,l):Math.sqrt(v)},l.gravity=function(n){return arguments.length?(d=+n,l):d},l.theta=function(n){return arguments.length?(y=n*n,l):Math.sqrt(y)},l.alpha=function(n){return arguments.length?(n=+n,i?n>0?i=n:(e.c=null,e.t=NaN,e=null,c.end({type:"end",alpha:i=0})):n>0&&(c.start({type:"start",alpha:i=n}),e=qn(l.tick)),l):i},l.start=function(){function n(n,r){if(!e){for(e=new Array(i),l=0;i>l;++l)e[l]=[];for(l=0;c>l;++l){var u=x[l];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var o,a=e[t],l=-1,f=a.length;++l<f;)if(!isNaN(o=a[l][n]))return o;return Math.random()*r}var t,e,r,i=M.length,c=x.length,s=f[0],v=f[1];for(t=0;i>t;++t)(r=M[t]).index=t,r.weight=0;for(t=0;c>t;++t)r=x[t],"number"==typeof r.source&&(r.source=M[r.source]),"number"==typeof r.target&&(r.target=M[r.target]),++r.source.weight,++r.target.weight;for(t=0;i>t;++t)r=M[t],isNaN(r.x)&&(r.x=n("x",s)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof h)for(t=0;c>t;++t)u[t]=+h.call(this,x[t],t);else for(t=0;c>t;++t)u[t]=h;if(o=[],"function"==typeof p)for(t=0;c>t;++t)o[t]=+p.call(this,x[t],t);else for(t=0;c>t;++t)o[t]=p;if(a=[],"function"==typeof g)for(t=0;i>t;++t)a[t]=+g.call(this,M[t],t);else for(t=0;i>t;++t)a[t]=g;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return r||(r=ao.behavior.drag().origin(m).on("dragstart.force",Qr).on("drag.force",t).on("dragend.force",ni)),arguments.length?void this.on("mouseover.force",ti).on("mouseout.force",ei).call(r):r},ao.rebind(l,c,"on")};var yl=20,ml=1,Ml=1/0;ao.layout.hierarchy=function(){function n(i){var u,o=[i],a=[];for(i.depth=0;null!=(u=o.pop());)if(a.push(u),(c=e.call(n,u,u.depth))&&(l=c.length)){for(var l,c,f;--l>=0;)o.push(f=c[l]),f.parent=u,f.depth=u.depth+1;r&&(u.value=0),u.children=c}else r&&(u.value=+r.call(n,u,u.depth)||0),delete u.children;return oi(i,function(n){var e,i;t&&(e=n.children)&&e.sort(t),r&&(i=n.parent)&&(i.value+=n.value)}),a}var t=ci,e=ai,r=li;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(ui(t,function(n){n.children&&(n.value=0)}),oi(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},ao.layout.partition=function(){function n(t,e,r,i){var u=t.children;if(t.x=e,t.y=t.depth*i,t.dx=r,t.dy=i,u&&(o=u.length)){var o,a,l,c=-1;for(r=t.value?r/t.value:0;++c<o;)n(a=u[c],e,l=a.value*r,i),e+=l}}function t(n){var e=n.children,r=0;if(e&&(i=e.length))for(var i,u=-1;++u<i;)r=Math.max(r,t(e[u]));return 1+r}function e(e,u){var o=r.call(this,e,u);return n(o[0],0,i[0],i[1]/t(o[0])),o}var r=ao.layout.hierarchy(),i=[1,1];return e.size=function(n){return arguments.length?(i=n,e):i},ii(e,r)},ao.layout.pie=function(){function n(o){var a,l=o.length,c=o.map(function(e,r){return+t.call(n,e,r)}),f=+("function"==typeof r?r.apply(this,arguments):r),s=("function"==typeof i?i.apply(this,arguments):i)-f,h=Math.min(Math.abs(s)/l,+("function"==typeof u?u.apply(this,arguments):u)),p=h*(0>s?-1:1),g=ao.sum(c),v=g?(s-l*p)/g:0,d=ao.range(l),y=[];return null!=e&&d.sort(e===xl?function(n,t){return c[t]-c[n]}:function(n,t){return e(o[n],o[t])}),d.forEach(function(n){y[n]={data:o[n],value:a=c[n],startAngle:f,endAngle:f+=a*v+p,padAngle:h}}),y}var t=Number,e=xl,r=0,i=Fo,u=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(i=t,n):i},n.padAngle=function(t){return arguments.length?(u=t,n):u},n};var xl={};ao.layout.stack=function(){function n(a,l){if(!(h=a.length))return a;var c=a.map(function(e,r){return t.call(n,e,r)}),f=c.map(function(t){return t.map(function(t,e){return[u.call(n,t,e),o.call(n,t,e)]})}),s=e.call(n,f,l);c=ao.permute(c,s),f=ao.permute(f,s);var h,p,g,v,d=r.call(n,f,l),y=c[0].length;for(g=0;y>g;++g)for(i.call(n,c[0][g],v=d[g],f[0][g][1]),p=1;h>p;++p)i.call(n,c[p][g],v+=f[p-1][g][1],f[p][g][1]);return a}var t=m,e=gi,r=vi,i=pi,u=si,o=hi;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:bl.get(t)||gi,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:_l.get(t)||vi,n):r},n.x=function(t){return arguments.length?(u=t,n):u},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(i=t,n):i},n};var bl=ao.map({"inside-out":function(n){var t,e,r=n.length,i=n.map(di),u=n.map(yi),o=ao.range(r).sort(function(n,t){return i[n]-i[t]}),a=0,l=0,c=[],f=[];for(t=0;r>t;++t)e=o[t],l>a?(a+=u[e],c.push(e)):(l+=u[e],f.push(e));return f.reverse().concat(c)},reverse:function(n){return ao.range(n.length).reverse()},"default":gi}),_l=ao.map({silhouette:function(n){var t,e,r,i=n.length,u=n[0].length,o=[],a=0,l=[];for(e=0;u>e;++e){for(t=0,r=0;i>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;u>e;++e)l[e]=(a-o[e])/2;return l},wiggle:function(n){var t,e,r,i,u,o,a,l,c,f=n.length,s=n[0],h=s.length,p=[];for(p[0]=l=c=0,e=1;h>e;++e){for(t=0,i=0;f>t;++t)i+=n[t][e][1];for(t=0,u=0,a=s[e][0]-s[e-1][0];f>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;u+=o*n[t][e][1]}p[e]=l-=i?u/i*a:0,c>l&&(c=l)}for(e=0;h>e;++e)p[e]-=c;return p},expand:function(n){var t,e,r,i=n.length,u=n[0].length,o=1/i,a=[];for(e=0;u>e;++e){for(t=0,r=0;i>t;t++)r+=n[t][e][1];if(r)for(t=0;i>t;t++)n[t][e][1]/=r;else for(t=0;i>t;t++)n[t][e][1]=o}for(e=0;u>e;++e)a[e]=0;return a},zero:vi});ao.layout.histogram=function(){function n(n,u){for(var o,a,l=[],c=n.map(e,this),f=r.call(this,c,u),s=i.call(this,f,c,u),u=-1,h=c.length,p=s.length-1,g=t?1:1/h;++u<p;)o=l[u]=[],o.dx=s[u+1]-(o.x=s[u]),o.y=0;if(p>0)for(u=-1;++u<h;)a=c[u],a>=f[0]&&a<=f[1]&&(o=l[ao.bisect(s,a,1,p)-1],o.y+=g,o.push(n[u]));return l}var t=!0,e=Number,r=bi,i=Mi;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=En(t),n):r},n.bins=function(t){return arguments.length?(i="number"==typeof t?function(n){return xi(n,t)}:En(t),n):i},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},ao.layout.pack=function(){function n(n,u){var o=e.call(this,n,u),a=o[0],l=i[0],c=i[1],f=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,oi(a,function(n){n.r=+f(n.value)}),oi(a,Ni),r){var s=r*(t?1:Math.max(2*a.r/l,2*a.r/c))/2;oi(a,function(n){n.r+=s}),oi(a,Ni),oi(a,function(n){n.r-=s})}return Ci(a,l/2,c/2,t?1:1/Math.max(2*a.r/l,2*a.r/c)),o}var t,e=ao.layout.hierarchy().sort(_i),r=0,i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},ii(n,e)},ao.layout.tree=function(){function n(n,i){var f=o.call(this,n,i),s=f[0],h=t(s);if(oi(h,e),h.parent.m=-h.z,ui(h,r),c)ui(s,u);else{var p=s,g=s,v=s;ui(s,function(n){n.x<p.x&&(p=n),n.x>g.x&&(g=n),n.depth>v.depth&&(v=n)});var d=a(p,g)/2-p.x,y=l[0]/(g.x+a(g,p)/2+d),m=l[1]/(v.depth||1);ui(s,function(n){n.x=(n.x+d)*y,n.y=n.depth*m})}return f}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var i,u=t.children,o=0,a=u.length;a>o;++o)r.push((u[o]=i={_:u[o],parent:t,children:(i=u[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Di(n);var u=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-u):n.z=u}else r&&(n.z=r.z+a(n._,r._));n.parent.A=i(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function i(n,t,e){if(t){for(var r,i=n,u=n,o=t,l=i.parent.children[0],c=i.m,f=u.m,s=o.m,h=l.m;o=Ti(o),i=qi(i),o&&i;)l=qi(l),u=Ti(u),u.a=n,r=o.z+s-i.z-c+a(o._,i._),r>0&&(Ri(Pi(o,n,e),n,r),c+=r,f+=r),s+=o.m,c+=i.m,h+=l.m,f+=u.m;o&&!Ti(u)&&(u.t=o,u.m+=s-f),i&&!qi(l)&&(l.t=i,l.m+=c-h,e=n)}return e}function u(n){n.x*=l[0],n.y=n.depth*l[1]}var o=ao.layout.hierarchy().sort(null).value(null),a=Li,l=[1,1],c=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(c=null==(l=t)?u:null,n):c?null:l},n.nodeSize=function(t){return arguments.length?(c=null==(l=t)?null:u,n):c?l:null},ii(n,o)},ao.layout.cluster=function(){function n(n,u){var o,a=t.call(this,n,u),l=a[0],c=0;oi(l,function(n){var t=n.children;t&&t.length?(n.x=ji(t),n.y=Ui(t)):(n.x=o?c+=e(n,o):0,n.y=0,o=n)});var f=Fi(l),s=Hi(l),h=f.x-e(f,s)/2,p=s.x+e(s,f)/2;return oi(l,i?function(n){n.x=(n.x-l.x)*r[0],n.y=(l.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(p-h)*r[0],n.y=(1-(l.y?n.y/l.y:1))*r[1]}),a}var t=ao.layout.hierarchy().sort(null).value(null),e=Li,r=[1,1],i=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(i=null==(r=t),n):i?null:r},n.nodeSize=function(t){return arguments.length?(i=null!=(r=t),n):i?r:null},ii(n,t)},ao.layout.treemap=function(){function n(n,t){for(var e,r,i=-1,u=n.length;++i<u;)r=(e=n[i]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var u=e.children;if(u&&u.length){var o,a,l,c=s(e),f=[],h=u.slice(),g=1/0,v="slice"===p?c.dx:"dice"===p?c.dy:"slice-dice"===p?1&e.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(n(h,c.dx*c.dy/e.value),f.area=0;(l=h.length)>0;)f.push(o=h[l-1]),f.area+=o.area,"squarify"!==p||(a=r(f,v))<=g?(h.pop(),g=a):(f.area-=f.pop().area,i(f,v,c,!1),v=Math.min(c.dx,c.dy),f.length=f.area=0,g=1/0);f.length&&(i(f,v,c,!0),f.length=f.area=0),u.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var u,o=s(t),a=r.slice(),l=[];for(n(a,o.dx*o.dy/t.value),l.area=0;u=a.pop();)l.push(u),l.area+=u.area,null!=u.z&&(i(l,u.z?o.dx:o.dy,o,!a.length),l.length=l.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,i=0,u=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(u>e&&(u=e),e>i&&(i=e));return r*=r,t*=t,r?Math.max(t*i*g/r,r/(t*u*g)):1/0}function i(n,t,e,r){var i,u=-1,o=n.length,a=e.x,c=e.y,f=t?l(n.area/t):0;
if(t==e.dx){for((r||f>e.dy)&&(f=e.dy);++u<o;)i=n[u],i.x=a,i.y=c,i.dy=f,a+=i.dx=Math.min(e.x+e.dx-a,f?l(i.area/f):0);i.z=!0,i.dx+=e.x+e.dx-a,e.y+=f,e.dy-=f}else{for((r||f>e.dx)&&(f=e.dx);++u<o;)i=n[u],i.x=a,i.y=c,i.dx=f,c+=i.dy=Math.min(e.y+e.dy-c,f?l(i.area/f):0);i.z=!1,i.dy+=e.y+e.dy-c,e.x+=f,e.dx-=f}}function u(r){var i=o||a(r),u=i[0];return u.x=u.y=0,u.value?(u.dx=c[0],u.dy=c[1]):u.dx=u.dy=0,o&&a.revalue(u),n([u],u.dx*u.dy/u.value),(o?e:t)(u),h&&(o=i),i}var o,a=ao.layout.hierarchy(),l=Math.round,c=[1,1],f=null,s=Oi,h=!1,p="squarify",g=.5*(1+Math.sqrt(5));return u.size=function(n){return arguments.length?(c=n,u):c},u.padding=function(n){function t(t){var e=n.call(u,t,t.depth);return null==e?Oi(t):Ii(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Ii(t,n)}if(!arguments.length)return f;var r;return s=null==(f=n)?Oi:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,u},u.round=function(n){return arguments.length?(l=n?Math.round:Number,u):l!=Number},u.sticky=function(n){return arguments.length?(h=n,o=null,u):h},u.ratio=function(n){return arguments.length?(g=n,u):g},u.mode=function(n){return arguments.length?(p=n+"",u):p},ii(u,a)},ao.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,i;do e=2*Math.random()-1,r=2*Math.random()-1,i=e*e+r*r;while(!i||i>1);return n+t*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var n=ao.random.normal.apply(ao,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=ao.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},ao.scale={};var wl={floor:m,ceil:m};ao.scale.linear=function(){return Wi([0,1],[0,1],Mr,!1)};var Sl={s:1,g:1,p:1,r:1,e:1};ao.scale.log=function(){return ru(ao.scale.linear().domain([0,1]),10,!0,[1,10])};var kl=ao.format(".0e"),Nl={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};ao.scale.pow=function(){return iu(ao.scale.linear(),1,[0,1])},ao.scale.sqrt=function(){return ao.scale.pow().exponent(.5)},ao.scale.ordinal=function(){return ou([],{t:"range",a:[[]]})},ao.scale.category10=function(){return ao.scale.ordinal().range(El)},ao.scale.category20=function(){return ao.scale.ordinal().range(Al)},ao.scale.category20b=function(){return ao.scale.ordinal().range(Cl)},ao.scale.category20c=function(){return ao.scale.ordinal().range(zl)};var El=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(xn),Al=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(xn),Cl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(xn),zl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(xn);ao.scale.quantile=function(){return au([],[])},ao.scale.quantize=function(){return lu(0,1,[0,1])},ao.scale.threshold=function(){return cu([.5],[0,1])},ao.scale.identity=function(){return fu([0,1])},ao.svg={},ao.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),c=Math.max(0,+r.apply(this,arguments)),f=o.apply(this,arguments)-Oo,s=a.apply(this,arguments)-Oo,h=Math.abs(s-f),p=f>s?0:1;if(n>c&&(g=c,c=n,n=g),h>=Ho)return t(c,p)+(n?t(n,1-p):"")+"Z";var g,v,d,y,m,M,x,b,_,w,S,k,N=0,E=0,A=[];if((y=(+l.apply(this,arguments)||0)/2)&&(d=u===Ll?Math.sqrt(n*n+c*c):+u.apply(this,arguments),p||(E*=-1),c&&(E=tn(d/c*Math.sin(y))),n&&(N=tn(d/n*Math.sin(y)))),c){m=c*Math.cos(f+E),M=c*Math.sin(f+E),x=c*Math.cos(s-E),b=c*Math.sin(s-E);var C=Math.abs(s-f-2*E)<=jo?0:1;if(E&&yu(m,M,x,b)===p^C){var z=(f+s)/2;m=c*Math.cos(z),M=c*Math.sin(z),x=b=null}}else m=M=0;if(n){_=n*Math.cos(s-N),w=n*Math.sin(s-N),S=n*Math.cos(f+N),k=n*Math.sin(f+N);var L=Math.abs(f-s+2*N)<=jo?0:1;if(N&&yu(_,w,S,k)===1-p^L){var q=(f+s)/2;_=n*Math.cos(q),w=n*Math.sin(q),S=k=null}}else _=w=0;if(h>Po&&(g=Math.min(Math.abs(c-n)/2,+i.apply(this,arguments)))>.001){v=c>n^p?0:1;var T=g,R=g;if(jo>h){var D=null==S?[_,w]:null==x?[m,M]:Re([m,M],[S,k],[x,b],[_,w]),P=m-D[0],U=M-D[1],j=x-D[0],F=b-D[1],H=1/Math.sin(Math.acos((P*j+U*F)/(Math.sqrt(P*P+U*U)*Math.sqrt(j*j+F*F)))/2),O=Math.sqrt(D[0]*D[0]+D[1]*D[1]);R=Math.min(g,(n-O)/(H-1)),T=Math.min(g,(c-O)/(H+1))}if(null!=x){var I=mu(null==S?[_,w]:[S,k],[m,M],c,T,p),Y=mu([x,b],[_,w],c,T,p);g===T?A.push("M",I[0],"A",T,",",T," 0 0,",v," ",I[1],"A",c,",",c," 0 ",1-p^yu(I[1][0],I[1][1],Y[1][0],Y[1][1]),",",p," ",Y[1],"A",T,",",T," 0 0,",v," ",Y[0]):A.push("M",I[0],"A",T,",",T," 0 1,",v," ",Y[0])}else A.push("M",m,",",M);if(null!=S){var Z=mu([m,M],[S,k],n,-R,p),V=mu([_,w],null==x?[m,M]:[x,b],n,-R,p);g===R?A.push("L",V[0],"A",R,",",R," 0 0,",v," ",V[1],"A",n,",",n," 0 ",p^yu(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-p," ",Z[1],"A",R,",",R," 0 0,",v," ",Z[0]):A.push("L",V[0],"A",R,",",R," 0 0,",v," ",Z[0])}else A.push("L",_,",",w)}else A.push("M",m,",",M),null!=x&&A.push("A",c,",",c," 0 ",C,",",p," ",x,",",b),A.push("L",_,",",w),null!=S&&A.push("A",n,",",n," 0 ",L,",",1-p," ",S,",",k);return A.push("Z"),A.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=hu,r=pu,i=su,u=Ll,o=gu,a=vu,l=du;return n.innerRadius=function(t){return arguments.length?(e=En(t),n):e},n.outerRadius=function(t){return arguments.length?(r=En(t),n):r},n.cornerRadius=function(t){return arguments.length?(i=En(t),n):i},n.padRadius=function(t){return arguments.length?(u=t==Ll?Ll:En(t),n):u},n.startAngle=function(t){return arguments.length?(o=En(t),n):o},n.endAngle=function(t){return arguments.length?(a=En(t),n):a},n.padAngle=function(t){return arguments.length?(l=En(t),n):l},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Oo;return[Math.cos(t)*n,Math.sin(t)*n]},n};var Ll="auto";ao.svg.line=function(){return Mu(m)};var ql=ao.map({linear:xu,"linear-closed":bu,step:_u,"step-before":wu,"step-after":Su,basis:zu,"basis-open":Lu,"basis-closed":qu,bundle:Tu,cardinal:Eu,"cardinal-open":ku,"cardinal-closed":Nu,monotone:Fu});ql.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Tl=[0,2/3,1/3,0],Rl=[0,1/3,2/3,0],Dl=[0,1/6,2/3,1/6];ao.svg.line.radial=function(){var n=Mu(Hu);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},wu.reverse=Su,Su.reverse=wu,ao.svg.area=function(){return Ou(m)},ao.svg.area.radial=function(){var n=Ou(Hu);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},ao.svg.chord=function(){function n(n,a){var l=t(this,u,n,a),c=t(this,o,n,a);return"M"+l.p0+r(l.r,l.p1,l.a1-l.a0)+(e(l,c)?i(l.r,l.p1,l.r,l.p0):i(l.r,l.p1,c.r,c.p0)+r(c.r,c.p1,c.a1-c.a0)+i(c.r,c.p1,l.r,l.p0))+"Z"}function t(n,t,e,r){var i=t.call(n,e,r),u=a.call(n,i,r),o=l.call(n,i,r)-Oo,f=c.call(n,i,r)-Oo;return{r:u,a0:o,a1:f,p0:[u*Math.cos(o),u*Math.sin(o)],p1:[u*Math.cos(f),u*Math.sin(f)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>jo)+",1 "+t}function i(n,t,e,r){return"Q 0,0 "+r}var u=Me,o=xe,a=Iu,l=gu,c=vu;return n.radius=function(t){return arguments.length?(a=En(t),n):a},n.source=function(t){return arguments.length?(u=En(t),n):u},n.target=function(t){return arguments.length?(o=En(t),n):o},n.startAngle=function(t){return arguments.length?(l=En(t),n):l},n.endAngle=function(t){return arguments.length?(c=En(t),n):c},n},ao.svg.diagonal=function(){function n(n,i){var u=t.call(this,n,i),o=e.call(this,n,i),a=(u.y+o.y)/2,l=[u,{x:u.x,y:a},{x:o.x,y:a},o];return l=l.map(r),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=Me,e=xe,r=Yu;return n.source=function(e){return arguments.length?(t=En(e),n):t},n.target=function(t){return arguments.length?(e=En(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},ao.svg.diagonal.radial=function(){var n=ao.svg.diagonal(),t=Yu,e=n.projection;return n.projection=function(n){return arguments.length?e(Zu(t=n)):t},n},ao.svg.symbol=function(){function n(n,r){return(Pl.get(t.call(this,n,r))||$u)(e.call(this,n,r))}var t=Xu,e=Vu;return n.type=function(e){return arguments.length?(t=En(e),n):t},n.size=function(t){return arguments.length?(e=En(t),n):e},n};var Pl=ao.map({circle:$u,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*jl)),e=t*jl;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/Ul),e=t*Ul/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/Ul),e=t*Ul/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});ao.svg.symbolTypes=Pl.keys();var Ul=Math.sqrt(3),jl=Math.tan(30*Io);Co.transition=function(n){for(var t,e,r=Fl||++Yl,i=Ku(n),u=[],o=Hl||{time:Date.now(),ease:Nr,delay:0,duration:250},a=-1,l=this.length;++a<l;){u.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(e=c[f])&&Qu(e,f,i,r,o),t.push(e)}return Wu(u,i,r)},Co.interrupt=function(n){return this.each(null==n?Ol:Bu(Ku(n)))};var Fl,Hl,Ol=Bu(Ku()),Il=[],Yl=0;Il.call=Co.call,Il.empty=Co.empty,Il.node=Co.node,Il.size=Co.size,ao.transition=function(n,t){return n&&n.transition?Fl?n.transition(t):n:ao.selection().transition(n)},ao.transition.prototype=Il,Il.select=function(n){var t,e,r,i=this.id,u=this.namespace,o=[];n=A(n);for(var a=-1,l=this.length;++a<l;){o.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(r=c[f])&&(e=n.call(r,r.__data__,f,a))?("__data__"in r&&(e.__data__=r.__data__),Qu(e,f,u,i,r[u][i]),t.push(e)):t.push(null)}return Wu(o,u,i)},Il.selectAll=function(n){var t,e,r,i,u,o=this.id,a=this.namespace,l=[];n=C(n);for(var c=-1,f=this.length;++c<f;)for(var s=this[c],h=-1,p=s.length;++h<p;)if(r=s[h]){u=r[a][o],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var g=-1,v=e.length;++g<v;)(i=e[g])&&Qu(i,g,a,o,u),t.push(i)}return Wu(l,a,o)},Il.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=O(n));for(var u=0,o=this.length;o>u;u++){i.push(t=[]);for(var e=this[u],a=0,l=e.length;l>a;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return Wu(i,this.namespace,this.id)},Il.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):Y(this,null==t?function(t){t[r][e].tween.remove(n)}:function(i){i[r][e].tween.set(n,t)})},Il.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function i(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function u(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?$r:Mr,a=ao.ns.qualify(n);return Ju(this,"attr."+n,t,a.local?u:i)},Il.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(i));return r&&function(n){this.setAttribute(i,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(i.space,i.local));return r&&function(n){this.setAttributeNS(i.space,i.local,r(n))}}var i=ao.ns.qualify(n);return this.tween("attr."+n,i.local?r:e)},Il.style=function(n,e,r){function i(){this.style.removeProperty(n)}function u(e){return null==e?i:(e+="",function(){var i,u=t(this).getComputedStyle(this,null).getPropertyValue(n);return u!==e&&(i=Mr(u,e),function(t){this.style.setProperty(n,i(t),r)})})}var o=arguments.length;if(3>o){if("string"!=typeof n){2>o&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Ju(this,"style."+n,e,u)},Il.styleTween=function(n,e,r){function i(i,u){var o=e.call(this,i,u,t(this).getComputedStyle(this,null).getPropertyValue(n));return o&&function(t){this.style.setProperty(n,o(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+n,i)},Il.text=function(n){return Ju(this,"text",n,Gu)},Il.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Il.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=ao.ease.apply(ao,arguments)),Y(this,function(r){r[e][t].ease=n}))},Il.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:Y(this,"function"==typeof n?function(r,i,u){r[e][t].delay=+n.call(r,r.__data__,i,u)}:(n=+n,function(r){r[e][t].delay=n}))},Il.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:Y(this,"function"==typeof n?function(r,i,u){r[e][t].duration=Math.max(1,n.call(r,r.__data__,i,u))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Il.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var i=Hl,u=Fl;try{Fl=e,Y(this,function(t,i,u){Hl=t[r][e],n.call(t,t.__data__,i,u)})}finally{Hl=i,Fl=u}}else Y(this,function(i){var u=i[r][e];(u.event||(u.event=ao.dispatch("start","end","interrupt"))).on(n,t)});return this},Il.transition=function(){for(var n,t,e,r,i=this.id,u=++Yl,o=this.namespace,a=[],l=0,c=this.length;c>l;l++){a.push(n=[]);for(var t=this[l],f=0,s=t.length;s>f;f++)(e=t[f])&&(r=e[o][i],Qu(e,f,o,u,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Wu(a,o,u)},ao.svg.axis=function(){function n(n){n.each(function(){var n,c=ao.select(this),f=this.__chart__||e,s=this.__chart__=e.copy(),h=null==l?s.ticks?s.ticks.apply(s,a):s.domain():l,p=null==t?s.tickFormat?s.tickFormat.apply(s,a):m:t,g=c.selectAll(".tick").data(h,s),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Po),d=ao.transition(g.exit()).style("opacity",Po).remove(),y=ao.transition(g.order()).style("opacity",1),M=Math.max(i,0)+o,x=Zi(s),b=c.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),ao.transition(b));v.append("line"),v.append("text");var w,S,k,N,E=v.select("line"),A=y.select("line"),C=g.select("text").text(p),z=v.select("text"),L=y.select("text"),q="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=no,w="x",k="y",S="x2",N="y2",C.attr("dy",0>q?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+q*u+"V0H"+x[1]+"V"+q*u)):(n=to,w="y",k="x",S="y2",N="x2",C.attr("dy",".32em").style("text-anchor",0>q?"end":"start"),_.attr("d","M"+q*u+","+x[0]+"H0V"+x[1]+"H"+q*u)),E.attr(N,q*i),z.attr(k,q*M),A.attr(S,0).attr(N,q*i),L.attr(w,0).attr(k,q*M),s.rangeBand){var T=s,R=T.rangeBand()/2;f=s=function(n){return T(n)+R}}else f.rangeBand?f=s:d.call(n,s,f);v.call(n,f,s),y.call(n,s,s)})}var t,e=ao.scale.linear(),r=Zl,i=6,u=6,o=3,a=[10],l=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Vl?t+"":Zl,n):r},n.ticks=function(){return arguments.length?(a=co(arguments),n):a},n.tickValues=function(t){return arguments.length?(l=t,n):l},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(i=+t,u=+arguments[e-1],n):i},n.innerTickSize=function(t){return arguments.length?(i=+t,n):i},n.outerTickSize=function(t){return arguments.length?(u=+t,n):u},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Zl="bottom",Vl={top:1,right:1,bottom:1,left:1};ao.svg.brush=function(){function n(t){t.each(function(){var t=ao.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=t.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=t.selectAll(".resize").data(v,m);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Xl[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var l,s=ao.transition(t),h=ao.transition(o);c&&(l=Zi(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),r(s)),f&&(l=Zi(f),h.attr("y",l[0]).attr("height",l[1]-l[0]),i(s)),e(s)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+s[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",s[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function i(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function u(){function u(){32==ao.event.keyCode&&(C||(M=null,L[0]-=s[1],L[1]-=h[1],C=2),S())}function v(){32==ao.event.keyCode&&2==C&&(L[0]+=s[1],L[1]+=h[1],C=0,S())}function d(){var n=ao.mouse(b),t=!1;x&&(n[0]+=x[0],n[1]+=x[1]),C||(ao.event.altKey?(M||(M=[(s[0]+s[1])/2,(h[0]+h[1])/2]),L[0]=s[+(n[0]<M[0])],L[1]=h[+(n[1]<M[1])]):M=null),E&&y(n,c,0)&&(r(k),t=!0),A&&y(n,f,1)&&(i(k),t=!0),t&&(e(k),w({type:"brush",mode:C?"move":"resize"}))}function y(n,t,e){var r,i,u=Zi(t),l=u[0],c=u[1],f=L[e],v=e?h:s,d=v[1]-v[0];return C&&(l-=f,c-=d+f),r=(e?g:p)?Math.max(l,Math.min(c,n[e])):n[e],C?i=(r+=f)+d:(M&&(f=Math.max(l,Math.min(c,2*M[e]-r))),r>f?(i=r,r=f):i=f),v[0]!=r||v[1]!=i?(e?a=null:o=null,v[0]=r,v[1]=i,!0):void 0}function m(){d(),k.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),ao.select("body").style("cursor",null),q.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),w({type:"brushend"})}var M,x,b=this,_=ao.select(ao.event.target),w=l.of(b,arguments),k=ao.select(b),N=_.datum(),E=!/^(n|s)$/.test(N)&&c,A=!/^(e|w)$/.test(N)&&f,C=_.classed("extent"),z=W(b),L=ao.mouse(b),q=ao.select(t(b)).on("keydown.brush",u).on("keyup.brush",v);if(ao.event.changedTouches?q.on("touchmove.brush",d).on("touchend.brush",m):q.on("mousemove.brush",d).on("mouseup.brush",m),k.interrupt().selectAll("*").interrupt(),C)L[0]=s[0]-L[0],L[1]=h[0]-L[1];else if(N){var T=+/w$/.test(N),R=+/^n/.test(N);x=[s[1-T]-L[0],h[1-R]-L[1]],L[0]=s[T],L[1]=h[R]}else ao.event.altKey&&(M=L.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),ao.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),d()}var o,a,l=N(n,"brushstart","brush","brushend"),c=null,f=null,s=[0,0],h=[0,0],p=!0,g=!0,v=$l[0];return n.event=function(n){n.each(function(){var n=l.of(this,arguments),t={x:s,y:h,i:o,j:a},e=this.__chart__||t;this.__chart__=t,Fl?ao.select(this).transition().each("start.brush",function(){o=e.i,a=e.j,s=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=xr(s,t.x),r=xr(h,t.y);return o=a=null,function(i){s=t.x=e(i),h=t.y=r(i),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,v=$l[!c<<1|!f],n):c},n.y=function(t){return arguments.length?(f=t,v=$l[!c<<1|!f],n):f},n.clamp=function(t){return arguments.length?(c&&f?(p=!!t[0],g=!!t[1]):c?p=!!t:f&&(g=!!t),n):c&&f?[p,g]:c?p:f?g:null},n.extent=function(t){var e,r,i,u,l;return arguments.length?(c&&(e=t[0],r=t[1],f&&(e=e[0],r=r[0]),o=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(l=e,e=r,r=l),e==s[0]&&r==s[1]||(s=[e,r])),f&&(i=t[0],u=t[1],c&&(i=i[1],u=u[1]),a=[i,u],f.invert&&(i=f(i),u=f(u)),i>u&&(l=i,i=u,u=l),i==h[0]&&u==h[1]||(h=[i,u])),n):(c&&(o?(e=o[0],r=o[1]):(e=s[0],r=s[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(l=e,e=r,r=l))),f&&(a?(i=a[0],u=a[1]):(i=h[0],u=h[1],f.invert&&(i=f.invert(i),u=f.invert(u)),i>u&&(l=i,i=u,u=l))),c&&f?[[e,i],[r,u]]:c?[e,r]:f&&[i,u])},n.clear=function(){return n.empty()||(s=[0,0],h=[0,0],o=a=null),n},n.empty=function(){return!!c&&s[0]==s[1]||!!f&&h[0]==h[1]},ao.rebind(n,l,"on")};var Xl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$l=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Bl=pa.format=Ma.timeFormat,Wl=Bl.utc,Jl=Wl("%Y-%m-%dT%H:%M:%S.%LZ");Bl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?eo:Jl,eo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},eo.toString=Jl.toString,pa.second=On(function(n){return new ga(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),pa.seconds=pa.second.range,pa.seconds.utc=pa.second.utc.range,pa.minute=On(function(n){return new ga(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),pa.minutes=pa.minute.range,pa.minutes.utc=pa.minute.utc.range,pa.hour=On(function(n){var t=n.getTimezoneOffset()/60;return new ga(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),pa.hours=pa.hour.range,pa.hours.utc=pa.hour.utc.range,pa.month=On(function(n){return n=pa.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),pa.months=pa.month.range,pa.months.utc=pa.month.utc.range;var Gl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Kl=[[pa.second,1],[pa.second,5],[pa.second,15],[pa.second,30],[pa.minute,1],[pa.minute,5],[pa.minute,15],[pa.minute,30],[pa.hour,1],[pa.hour,3],[pa.hour,6],[pa.hour,12],[pa.day,1],[pa.day,2],[pa.week,1],[pa.month,1],[pa.month,3],[pa.year,1]],Ql=Bl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",zt]]),nc={range:function(n,t,e){return ao.range(Math.ceil(n/e)*e,+t,e).map(io)},floor:m,ceil:m};Kl.year=pa.year,pa.scale=function(){return ro(ao.scale.linear(),Kl,Ql)};var tc=Kl.map(function(n){return[n[0].utc,n[1]]}),ec=Wl.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",zt]]);tc.year=pa.year.utc,pa.scale.utc=function(){return ro(ao.scale.linear(),tc,ec)},ao.text=An(function(n){return n.responseText}),ao.json=function(n,t){return Cn(n,"application/json",uo,t)},ao.html=function(n,t){return Cn(n,"text/html",oo,t)},ao.xml=An(function(n){return n.responseXML}),"function"==typeof define&&define.amd?(this.d3=ao,define(ao)):"object"==typeof module&&module.exports?module.exports=ao:this.d3=ao}();
},{}],301:[function(require,module,exports){
!function(t,e,n,i){"use strict";function r(t,e,n){return setTimeout(u(t,n),e)}function s(t,e,n){return Array.isArray(t)?(o(t,n[e],n),!0):!1}function o(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==i)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function a(e,n,i){var r="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=t.console&&(t.console.warn||t.console.log);return s&&s.call(t.console,r,i),e.apply(this,arguments)}}function h(t,e,n){var i,r=e.prototype;i=t.prototype=Object.create(r),i.constructor=t,i._super=r,n&&at(i,n)}function u(t,e){return function(){return t.apply(e,arguments)}}function c(t,e){return typeof t==ct?t.apply(e?e[0]||i:i,e):t}function l(t,e){return t===i?e:t}function p(t,e,n){o(m(e),function(e){t.addEventListener(e,n,!1)})}function f(t,e,n){o(m(e),function(e){t.removeEventListener(e,n,!1)})}function d(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function v(t,e){return t.indexOf(e)>-1}function m(t){return t.trim().split(/\s+/g)}function g(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function y(t,e,n){for(var i=[],r=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];g(r,o)<0&&i.push(t[s]),r[s]=o,s++}return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function E(t,e){for(var n,r,s=e[0].toUpperCase()+e.slice(1),o=0;o<ht.length;){if(n=ht[o],r=n?n+s:e,r in t)return r;o++}return i}function I(){return mt++}function A(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function _(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){c(t.options.enable,[t])&&n.handler(e)},this.init()}function w(t){var e,n=t.options.inputClass;return new(e=n?n:yt?F:Et?k:Tt?L:Y)(t,D)}function D(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,s=e&bt&&i-r===0,o=e&(Pt|Ct)&&i-r===0;n.isFirst=!!s,n.isFinal=!!o,s&&(t.session={}),n.eventType=e,b(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function b(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=C(e)),r>1&&!n.firstMultiple?n.firstMultiple=C(e):1===r&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,a=o?o.center:s.center,h=e.center=x(i);e.timeStamp=ft(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=M(a,h),e.distance=z(a,h),S(n,e),e.offsetDirection=O(e.deltaX,e.deltaY);var u=R(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=pt(u.x)>pt(u.y)?u.x:u.y,e.scale=o?X(o.pointers,i):1,e.rotation=o?N(o.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,P(n,e);var c=t.element;d(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function S(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},s=t.prevInput||{};e.eventType!==bt&&s.eventType!==Pt||(r=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}function P(t,e){var n,r,s,o,a=t.lastInterval||e,h=e.timeStamp-a.timeStamp;if(e.eventType!=Ct&&(h>Dt||a.velocity===i)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=R(h,u,c);r=l.x,s=l.y,n=pt(l.x)>pt(l.y)?l.x:l.y,o=O(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,s=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=s,e.direction=o}function C(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:lt(t.pointers[n].clientX),clientY:lt(t.pointers[n].clientY)},n++;return{timeStamp:ft(),pointers:e,center:x(e),deltaX:t.deltaX,deltaY:t.deltaY}}function x(t){var e=t.length;if(1===e)return{x:lt(t[0].clientX),y:lt(t[0].clientY)};for(var n=0,i=0,r=0;e>r;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:lt(n/e),y:lt(i/e)}}function R(t,e,n){return{x:e/t||0,y:n/t||0}}function O(t,e){return t===e?xt:pt(t)>=pt(e)?0>t?Rt:Ot:0>e?zt:Mt}function z(t,e,n){n||(n=Ft);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function M(t,e,n){n||(n=Ft);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}function N(t,e){return M(e[1],e[0],Wt)+M(t[1],t[0],Wt)}function X(t,e){return z(e[0],e[1],Wt)/z(t[0],t[1],Wt)}function Y(){this.evEl=kt,this.evWin=Ht,this.allow=!0,this.pressed=!1,_.apply(this,arguments)}function F(){this.evEl=Vt,this.evWin=jt,_.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=Zt,this.evWin=Bt,this.started=!1,_.apply(this,arguments)}function q(t,e){var n=T(t.touches),i=T(t.changedTouches);return e&(Pt|Ct)&&(n=y(n.concat(i),"identifier",!0)),[n,i]}function k(){this.evTarget=Jt,this.targetIds={},_.apply(this,arguments)}function H(t,e){var n=T(t.touches),i=this.targetIds;if(e&(bt|St)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,s,o=T(t.changedTouches),a=[],h=this.target;if(s=n.filter(function(t){return d(t.target,h)}),e===bt)for(r=0;r<s.length;)i[s[r].identifier]=!0,r++;for(r=0;r<o.length;)i[o[r].identifier]&&a.push(o[r]),e&(Pt|Ct)&&delete i[o[r].identifier],r++;return a.length?[y(s.concat(a),"identifier",!0),a]:void 0}function L(){_.apply(this,arguments);var t=u(this.handler,this);this.touch=new k(this.manager,t),this.mouse=new Y(this.manager,t)}function U(t,e){this.manager=t,this.set(e)}function V(t){if(v(t,ie))return ie;var e=v(t,re),n=v(t,se);return e&&n?ie:e||n?e?re:se:v(t,ne)?ne:ee}function j(t){this.options=at({},this.defaults,t||{}),this.id=I(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=oe,this.simultaneous={},this.requireFail=[]}function G(t){return t&le?"cancel":t&ue?"end":t&he?"move":t&ae?"start":""}function Z(t){return t==Mt?"down":t==zt?"up":t==Rt?"left":t==Ot?"right":""}function B(t,e){var n=e.manager;return n?n.get(t):t}function $(){j.apply(this,arguments)}function J(){$.apply(this,arguments),this.pX=null,this.pY=null}function K(){$.apply(this,arguments)}function Q(){j.apply(this,arguments),this._timer=null,this._input=null}function tt(){$.apply(this,arguments)}function et(){$.apply(this,arguments)}function nt(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function it(t,e){return e=e||{},e.recognizers=l(e.recognizers,it.defaults.preset),new rt(t,e)}function rt(t,e){this.options=at({},it.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=w(this),this.touchAction=new U(this,this.options.touchAction),st(this,!0),o(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function st(t,e){var n=t.element;n.style&&o(t.options.cssProps,function(t,i){n.style[E(n.style,i)]=e?t:""})}function ot(t,n){var i=e.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=n,n.target.dispatchEvent(i)}var at,ht=["","webkit","Moz","MS","ms","o"],ut=e.createElement("div"),ct="function",lt=Math.round,pt=Math.abs,ft=Date.now;at="function"!=typeof Object.assign?function(t){if(t===i||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])}return e}:Object.assign;var dt=a(function(t,e,n){for(var r=Object.keys(e),s=0;s<r.length;)(!n||n&&t[r[s]]===i)&&(t[r[s]]=e[r[s]]),s++;return t},"extend","Use `assign`."),vt=a(function(t,e){return dt(t,e,!0)},"merge","Use `assign`."),mt=1,gt=/mobile|tablet|ip(ad|hone|od)|android/i,Tt="ontouchstart"in t,yt=E(t,"PointerEvent")!==i,Et=Tt&&gt.test(navigator.userAgent),It="touch",At="pen",_t="mouse",wt="kinect",Dt=25,bt=1,St=2,Pt=4,Ct=8,xt=1,Rt=2,Ot=4,zt=8,Mt=16,Nt=Rt|Ot,Xt=zt|Mt,Yt=Nt|Xt,Ft=["x","y"],Wt=["clientX","clientY"];_.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(A(this.element),this.evWin,this.domHandler)}};var qt={mousedown:bt,mousemove:St,mouseup:Pt},kt="mousedown",Ht="mousemove mouseup";h(Y,_,{handler:function(t){var e=qt[t.type];e&bt&&0===t.button&&(this.pressed=!0),e&St&&1!==t.which&&(e=Pt),this.pressed&&this.allow&&(e&Pt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:_t,srcEvent:t}))}});var Lt={pointerdown:bt,pointermove:St,pointerup:Pt,pointercancel:Ct,pointerout:Ct},Ut={2:It,3:At,4:_t,5:wt},Vt="pointerdown",jt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Vt="MSPointerDown",jt="MSPointerMove MSPointerUp MSPointerCancel"),h(F,_,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=Lt[i],s=Ut[t.pointerType]||t.pointerType,o=s==It,a=g(e,t.pointerId,"pointerId");r&bt&&(0===t.button||o)?0>a&&(e.push(t),a=e.length-1):r&(Pt|Ct)&&(n=!0),0>a||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),n&&e.splice(a,1))}});var Gt={touchstart:bt,touchmove:St,touchend:Pt,touchcancel:Ct},Zt="touchstart",Bt="touchstart touchmove touchend touchcancel";h(W,_,{handler:function(t){var e=Gt[t.type];if(e===bt&&(this.started=!0),this.started){var n=q.call(this,t,e);e&(Pt|Ct)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:It,srcEvent:t})}}});var $t={touchstart:bt,touchmove:St,touchend:Pt,touchcancel:Ct},Jt="touchstart touchmove touchend touchcancel";h(k,_,{handler:function(t){var e=$t[t.type],n=H.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:It,srcEvent:t})}}),h(L,_,{handler:function(t,e,n){var i=n.pointerType==It,r=n.pointerType==_t;if(i)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(Pt|Ct)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Kt=E(ut.style,"touchAction"),Qt=Kt!==i,te="compute",ee="auto",ne="manipulation",ie="none",re="pan-x",se="pan-y";U.prototype={set:function(t){t==te&&(t=this.compute()),Qt&&this.manager.element.style&&(this.manager.element.style[Kt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return o(this.manager.recognizers,function(e){c(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),V(t.join(" "))},preventDefaults:function(t){if(!Qt){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,r=v(i,ie),s=v(i,se),o=v(i,re);if(r){var a=1===t.pointers.length,h=t.distance<2,u=t.deltaTime<250;if(a&&h&&u)return}if(!o||!s)return r||s&&n&Nt||o&&n&Xt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var oe=1,ae=2,he=4,ue=8,ce=ue,le=16,pe=32;j.prototype={defaults:{},set:function(t){return at(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(s(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=B(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return s(t,"dropRecognizeWith",this)?this:(t=B(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(s(t,"requireFailure",this))return this;var e=this.requireFail;return t=B(t,this),-1===g(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(s(t,"dropRequireFailure",this))return this;t=B(t,this);var e=g(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,i=this.state;ue>i&&e(n.options.event+G(i)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),i>=ue&&e(n.options.event+G(i))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=pe)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(pe|oe)))return!1;t++}return!0},recognize:function(t){var e=at({},t);return c(this.options.enable,[this,e])?(this.state&(ce|le|pe)&&(this.state=oe),this.state=this.process(e),void(this.state&(ae|he|ue|le)&&this.tryEmit(e))):(this.reset(),void(this.state=pe))},process:function(t){},getTouchAction:function(){},reset:function(){}},h($,j,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(ae|he),r=this.attrTest(t);return i&&(n&Ct||!r)?e|le:i||r?n&Pt?e|ue:e&ae?e|he:ae:pe}}),h(J,$,{defaults:{event:"pan",threshold:10,pointers:1,direction:Yt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Nt&&e.push(se),t&Xt&&e.push(re),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,s=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&Nt?(r=0===s?xt:0>s?Rt:Ot,n=s!=this.pX,i=Math.abs(t.deltaX)):(r=0===o?xt:0>o?zt:Mt,n=o!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return $.prototype.attrTest.call(this,t)&&(this.state&ae||!(this.state&ae)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Z(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),h(K,$,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ie]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ae)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),h(Q,j,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ee]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(Pt|Ct)&&!s)this.reset();else if(t.eventType&bt)this.reset(),this._timer=r(function(){this.state=ce,this.tryEmit()},e.time,this);else if(t.eventType&Pt)return ce;return pe},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ce&&(t&&t.eventType&Pt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ft(),this.manager.emit(this.options.event,this._input)))}}),h(tt,$,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ie]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ae)}}),h(et,$,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nt|Xt,pointers:1},getTouchAction:function(){return J.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Nt|Xt)?e=t.overallVelocity:n&Nt?e=t.overallVelocityX:n&Xt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&pt(e)>this.options.velocity&&t.eventType&Pt},emit:function(t){var e=Z(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),h(nt,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ne]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&bt&&0===this.count)return this.failTimeout();if(i&&s&&n){if(t.eventType!=Pt)return this.failTimeout();var o=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||z(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t;var h=this.count%e.taps;if(0===h)return this.hasRequireFailures()?(this._timer=r(function(){this.state=ce,this.tryEmit()},e.interval,this),ae):ce}return pe},failTimeout:function(){return this._timer=r(function(){this.state=pe},this.options.interval,this),pe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ce&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),it.VERSION="2.0.6",it.defaults={domEvents:!1,touchAction:te,enable:!0,inputTarget:null,inputClass:null,preset:[[tt,{enable:!1}],[K,{enable:!1},["rotate"]],[et,{direction:Nt}],[J,{direction:Nt},["swipe"]],[nt],[nt,{event:"doubletap",taps:2},["tap"]],[Q]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var fe=1,de=2;rt.prototype={set:function(t){return at(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?de:fe},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&ce)&&(r=e.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],e.stopped===de||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(ae|he|ue)&&(r=e.curRecognizer=n),s++}},get:function(t){if(t instanceof j)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(s(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(s(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=g(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return o(m(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return o(m(t),function(t){e?n[t]&&n[t].splice(g(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&ot(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&st(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},at(it,{INPUT_START:bt,INPUT_MOVE:St,INPUT_END:Pt,INPUT_CANCEL:Ct,STATE_POSSIBLE:oe,STATE_BEGAN:ae,STATE_CHANGED:he,STATE_ENDED:ue,STATE_RECOGNIZED:ce,STATE_CANCELLED:le,STATE_FAILED:pe,DIRECTION_NONE:xt,DIRECTION_LEFT:Rt,DIRECTION_RIGHT:Ot,DIRECTION_UP:zt,DIRECTION_DOWN:Mt,DIRECTION_HORIZONTAL:Nt,DIRECTION_VERTICAL:Xt,DIRECTION_ALL:Yt,Manager:rt,Input:_,TouchAction:U,TouchInput:k,MouseInput:Y,PointerEventInput:F,TouchMouseInput:L,SingleTouchInput:W,Recognizer:j,AttrRecognizer:$,Tap:nt,Pan:J,Swipe:et,Pinch:K,Rotate:tt,Press:Q,on:p,off:f,each:o,merge:vt,extend:dt,assign:at,inherit:h,bindFn:u,prefixed:E});var ve="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};ve.Hammer=it,"function"==typeof define&&define.amd?define(function(){return it}):"undefined"!=typeof module&&module.exports?module.exports=it:t[n]=it}(window,document,"Hammer");
},{}],302:[function(require,module,exports){
var jQuery=require("jquery");require("./core"),require("./widget"),require("./position"),require("./menu"),function(e,t){e.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,u="input"===n;this.isMultiLine=o?!0:u?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[o||u?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,void(i=!0);t=!1,s=!1,i=!1;var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case o.UP:t=!0,this._keyEvent("previous",n);break;case o.DOWN:t=!0,this._keyEvent("next",n);break;case o.ENTER:case o.NUMPAD_ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||s.preventDefault());if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var s=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:s})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery);
},{"./core":303,"./menu":304,"./position":305,"./widget":306,"jquery":307}],303:[function(require,module,exports){
var jQuery=require("jquery");!function(t,e){function n(e,n){var r,s,o,a=e.nodeName.toLowerCase();return"area"===a?(r=e.parentNode,s=r.name,e.href&&s&&"map"===r.nodeName.toLowerCase()?(o=t("img[usemap=#"+s+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var r=0,s=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(n,i){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),i&&i.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(n){if(n!==e)return this.css("zIndex",n);if(this.length)for(var i,r,s=t(this[0]);s.length&&s[0]!==document;){if(i=s.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(s.css("zIndex"),10),!isNaN(r)&&0!==r))return r;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,i){return!!t.data(e,i[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(e,!r)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(n,i){function r(e,n,i,r){return t.each(s,function(){n-=parseFloat(t.css(e,"padding"+this))||0,i&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var s="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(n){return n===e?a["inner"+i].call(this):this.each(function(){t(this).css(o,r(this,n)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(o,r(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,n,i){var r,s=t.ui[e].prototype;for(r in i)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([n,i[r]])},call:function(t,e,n){var i,r=t.plugins[e];if(r&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)t.options[r[i][0]]&&r[i][1].apply(t.element,n)}},hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return e[i]>0?!0:(e[i]=1,r=e[i]>0,e[i]=0,r)}})}(jQuery);
},{"jquery":307}],304:[function(require,module,exports){
var jQuery=require("jquery");require("./core"),require("./widget"),require("./position"),function(e,t){e.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,a,u,r,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,n=this.previousFilter||"",a=String.fromCharCode(t.keyCode),u=!1,clearTimeout(this.filterTimer),a===n?u=!0:a=n+a,r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())}),s=u&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s,s.length||(a=String.fromCharCode(t.keyCode),r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())})),s.length?(this.focus(t,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),s=t.prev("a"),n=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",s.attr("id"))}),t=s.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,u,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),u=this.activeMenu.height(),r=t.height(),0>n?this.activeMenu.scrollTop(a+n):n+r>u&&this.activeMenu.scrollTop(a+n-u+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s-n<0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,s,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}(jQuery);
},{"./core":303,"./position":305,"./widget":306,"jquery":307}],305:[function(require,module,exports){
var jQuery=require("jquery");!function(t,i){function e(t,i,e){return[parseFloat(t[0])*(d.test(t[0])?i/100:1),parseFloat(t[1])*(d.test(t[1])?e/100:1)]}function o(i,e){return parseInt(t.css(i,e),10)||0}function l(i){var e=i[0];return 9===e.nodeType?{width:i.width(),height:i.height(),offset:{top:0,left:0}}:t.isWindow(e)?{width:i.width(),height:i.height(),offset:{top:i.scrollTop(),left:i.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:i.outerWidth(),height:i.outerHeight(),offset:i.offset()}}t.ui=t.ui||{};var n,s=Math.max,f=Math.abs,h=Math.round,r=/left|center|right/,p=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,d=/%$/,g=t.fn.position;t.position={scrollbarWidth:function(){if(n!==i)return n;var e,o,l=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=l.children()[0];return t("body").append(l),e=s.offsetWidth,l.css("overflow","scroll"),o=s.offsetWidth,e===o&&(o=l[0].clientWidth),l.remove(),n=e-o},getScrollInfo:function(i){var e=i.isWindow||i.isDocument?"":i.element.css("overflow-x"),o=i.isWindow||i.isDocument?"":i.element.css("overflow-y"),l="scroll"===e||"auto"===e&&i.width<i.element[0].scrollWidth,n="scroll"===o||"auto"===o&&i.height<i.element[0].scrollHeight;return{width:n?t.position.scrollbarWidth():0,height:l?t.position.scrollbarWidth():0}},getWithinInfo:function(i){var e=t(i||window),o=t.isWindow(e[0]),l=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:o,isDocument:l,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:o?e.width():e.outerWidth(),height:o?e.height():e.outerHeight()}}},t.fn.position=function(i){if(!i||!i.of)return g.apply(this,arguments);i=t.extend({},i);var n,d,u,m,w,W,v=t(i.of),y=t.position.getWithinInfo(i.within),b=t.position.getScrollInfo(y),H=(i.collision||"flip").split(" "),x={};return W=l(v),v[0].preventDefault&&(i.at="left top"),d=W.width,u=W.height,m=W.offset,w=t.extend({},m),t.each(["my","at"],function(){var t,e,o=(i[this]||"").split(" ");1===o.length&&(o=r.test(o[0])?o.concat(["center"]):p.test(o[0])?["center"].concat(o):["center","center"]),o[0]=r.test(o[0])?o[0]:"center",o[1]=p.test(o[1])?o[1]:"center",t=c.exec(o[0]),e=c.exec(o[1]),x[this]=[t?t[0]:0,e?e[0]:0],i[this]=[a.exec(o[0])[0],a.exec(o[1])[0]]}),1===H.length&&(H[1]=H[0]),"right"===i.at[0]?w.left+=d:"center"===i.at[0]&&(w.left+=d/2),"bottom"===i.at[1]?w.top+=u:"center"===i.at[1]&&(w.top+=u/2),n=e(x.at,d,u),w.left+=n[0],w.top+=n[1],this.each(function(){var l,r,p=t(this),c=p.outerWidth(),a=p.outerHeight(),g=o(this,"marginLeft"),W=o(this,"marginTop"),T=c+g+o(this,"marginRight")+b.width,L=a+W+o(this,"marginBottom")+b.height,P=t.extend({},w),D=e(x.my,p.outerWidth(),p.outerHeight());"right"===i.my[0]?P.left-=c:"center"===i.my[0]&&(P.left-=c/2),"bottom"===i.my[1]?P.top-=a:"center"===i.my[1]&&(P.top-=a/2),P.left+=D[0],P.top+=D[1],t.support.offsetFractions||(P.left=h(P.left),P.top=h(P.top)),l={marginLeft:g,marginTop:W},t.each(["left","top"],function(e,o){t.ui.position[H[e]]&&t.ui.position[H[e]][o](P,{targetWidth:d,targetHeight:u,elemWidth:c,elemHeight:a,collisionPosition:l,collisionWidth:T,collisionHeight:L,offset:[n[0]+D[0],n[1]+D[1]],my:i.my,at:i.at,within:y,elem:p})}),i.using&&(r=function(t){var e=m.left-P.left,o=e+d-c,l=m.top-P.top,n=l+u-a,h={target:{element:v,left:m.left,top:m.top,width:d,height:u},element:{element:p,left:P.left,top:P.top,width:c,height:a},horizontal:0>o?"left":e>0?"right":"center",vertical:0>n?"top":l>0?"bottom":"middle"};c>d&&f(e+o)<d&&(h.horizontal="center"),a>u&&f(l+n)<u&&(h.vertical="middle"),s(f(e),f(o))>s(f(l),f(n))?h.important="horizontal":h.important="vertical",i.using.call(this,t,h)}),p.offset(t.extend(P,{using:r}))})},t.ui.position={fit:{left:function(t,i){var e,o=i.within,l=o.isWindow?o.scrollLeft:o.offset.left,n=o.width,f=t.left-i.collisionPosition.marginLeft,h=l-f,r=f+i.collisionWidth-n-l;i.collisionWidth>n?h>0&&0>=r?(e=t.left+h+i.collisionWidth-n-l,t.left+=h-e):r>0&&0>=h?t.left=l:h>r?t.left=l+n-i.collisionWidth:t.left=l:h>0?t.left+=h:r>0?t.left-=r:t.left=s(t.left-f,t.left)},top:function(t,i){var e,o=i.within,l=o.isWindow?o.scrollTop:o.offset.top,n=i.within.height,f=t.top-i.collisionPosition.marginTop,h=l-f,r=f+i.collisionHeight-n-l;i.collisionHeight>n?h>0&&0>=r?(e=t.top+h+i.collisionHeight-n-l,t.top+=h-e):r>0&&0>=h?t.top=l:h>r?t.top=l+n-i.collisionHeight:t.top=l:h>0?t.top+=h:r>0?t.top-=r:t.top=s(t.top-f,t.top)}},flip:{left:function(t,i){var e,o,l=i.within,n=l.offset.left+l.scrollLeft,s=l.width,h=l.isWindow?l.scrollLeft:l.offset.left,r=t.left-i.collisionPosition.marginLeft,p=r-h,c=r+i.collisionWidth-s-h,a="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,d="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,g=-2*i.offset[0];0>p?(e=t.left+a+d+g+i.collisionWidth-s-n,(0>e||e<f(p))&&(t.left+=a+d+g)):c>0&&(o=t.left-i.collisionPosition.marginLeft+a+d+g-h,(o>0||f(o)<c)&&(t.left+=a+d+g))},top:function(t,i){var e,o,l=i.within,n=l.offset.top+l.scrollTop,s=l.height,h=l.isWindow?l.scrollTop:l.offset.top,r=t.top-i.collisionPosition.marginTop,p=r-h,c=r+i.collisionHeight-s-h,a="top"===i.my[1],d=a?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,g="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,u=-2*i.offset[1];0>p?(o=t.top+d+g+u+i.collisionHeight-s-n,t.top+d+g+u>p&&(0>o||o<f(p))&&(t.top+=d+g+u)):c>0&&(e=t.top-i.collisionPosition.marginTop+d+g+u-h,t.top+d+g+u>c&&(e>0||f(e)<c)&&(t.top+=d+g+u))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var i,e,o,l,n,s=document.getElementsByTagName("body")[0],f=document.createElement("div");i=document.createElement(s?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"});for(n in o)i.style[n]=o[n];i.appendChild(f),e=s||document.documentElement,e.insertBefore(i,e.firstChild),f.style.cssText="position: absolute; left: 10.7432222px;",l=t(f).offset().left,t.support.offsetFractions=l>10&&11>l,i.innerHTML="",e.removeChild(i)}()}(jQuery);
},{"jquery":307}],306:[function(require,module,exports){
var jQuery=require("jquery");!function(t,e){var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(o){}s(e)},t.widget=function(e,i,n){var s,o,r,a,u={},d=e.split(".")[0];e=e.split(".")[1],s=d+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[d]=t[d]||{},o=t[d][e],r=t[d][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new r(t,e)},t.extend(r,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(u[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(u[e]=n)}),r.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},u,{constructor:r,namespace:d,widgetName:e,widgetFullName:s}),o?(t.each(o._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete o._childConstructors):i._childConstructors.push(r),t.widget.bridge(e,r)},t.widget.extend=function(i){for(var s,o,r=n.call(arguments,1),a=0,u=r.length;u>a;a++)for(s in r[a])o=r[a][s],r[a].hasOwnProperty(s)&&o!==e&&(t.isPlainObject(o)?i[s]=t.isPlainObject(i[s])?t.widget.extend({},i[s],o):t.widget.extend({},o):i[s]=o);return i},t.widget.bridge=function(i,s){var o=s.prototype.widgetFullName||i;t.fn[i]=function(r){var a="string"==typeof r,u=n.call(arguments,1),d=this;return r=!a&&u.length?t.widget.extend.apply(null,[r].concat(u)):r,a?this.each(function(){var n,s=t.data(this,o);return s?t.isFunction(s[r])&&"_"!==r.charAt(0)?(n=s[r].apply(s,u),n!==s&&n!==e?(d=n&&n.jquery?d.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+r+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,o);e?e.option(r||{})._init():t.data(this,o,new s(r,this))}),d}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var s,o,r,a=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(a={},s=i.split("."),i=s.shift(),s.length){for(o=a[i]=t.widget.extend({},this.options[i]),r=0;r<s.length-1;r++)o[s[r]]=o[s[r]]||{},o=o[s[r]];if(i=s.pop(),1===arguments.length)return o[i]===e?null:o[i];o[i]=n}else{if(1===arguments.length)return this.options[i]===e?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var s,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,function(n,r){function a(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof r?o[r]:r).apply(o,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||t.guid++);var u=n.match(/^(\w+)\s*(.*)$/),d=u[1]+o.eventNamespace,h=u[2];h?s.delegate(h,d,a):i.bind(d,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,o,r=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(t.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,o){"string"==typeof s&&(s={effect:s});var r,a=s?s===!0||"number"==typeof s?i:s.effect||i:e;s=s||{},"number"==typeof s&&(s={duration:s}),r=!t.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),r&&t.effects&&t.effects.effect[a]?n[e](s):a!==e&&n[a]?n[a](s.duration,s.easing,o):n.queue(function(i){t(this)[e](),o&&o.call(n[0]),i()})}})}(jQuery);
},{"jquery":307}],307:[function(require,module,exports){
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=!!e&&"length"in e&&e.length,n=oe.type(e);return"function"===n||oe.isWindow(e)?!1:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function r(e,t,n){if(oe.isFunction(t))return oe.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return oe.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ge.test(t))return oe.filter(t,e,n);t=oe.filter(t,e)}return oe.grep(e,function(e){return Z.call(t,e)>-1!==n})}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t={};return oe.each(e.match(we)||[],function(e,n){t[n]=!0}),t}function s(){G.removeEventListener("DOMContentLoaded",s),e.removeEventListener("load",s),oe.ready()}function a(){this.expando=oe.expando+a.uid++}function u(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(De,"-$&").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Se.test(n)?oe.parseJSON(n):n}catch(i){}Ne.set(e,t,n)}else n=void 0;return n}function l(e,t,n,r){var i,o=1,s=20,a=r?function(){return r.cur()}:function(){return oe.css(e,t,"")},u=a(),l=n&&n[3]||(oe.cssNumber[t]?"":"px"),c=(oe.cssNumber[t]||"px"!==l&&+u)&&Ae.exec(oe.css(e,t));if(c&&c[3]!==l){l=l||c[3],n=n||[],c=+u||1;do o=o||".5",c/=o,oe.style(e,t,c+l);while(o!==(o=a()/u)&&1!==o&&--s)}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}function c(e,t){var n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&oe.nodeName(e,t)?oe.merge([e],n):n}function f(e,t){for(var n=0,r=e.length;r>n;n++)Ee.set(e[n],"globalEval",!t||Ee.get(t[n],"globalEval"))}function p(e,t,n,r,i){for(var o,s,a,u,l,p,d=t.createDocumentFragment(),h=[],g=0,v=e.length;v>g;g++)if(o=e[g],o||0===o)if("object"===oe.type(o))oe.merge(h,o.nodeType?[o]:o);else if(Re.test(o)){for(s=s||d.appendChild(t.createElement("div")),a=(Oe.exec(o)||["",""])[1].toLowerCase(),u=Pe[a]||Pe._default,s.innerHTML=u[1]+oe.htmlPrefilter(o)+u[2],p=u[0];p--;)s=s.lastChild;oe.merge(h,s.childNodes),s=d.firstChild,s.textContent=""}else h.push(t.createTextNode(o));for(d.textContent="",g=0;o=h[g++];)if(r&&oe.inArray(o,r)>-1)i&&i.push(o);else if(l=oe.contains(o.ownerDocument,o),s=c(d.appendChild(o),"script"),l&&f(s),n)for(p=0;o=s[p++];)Fe.test(o.type||"")&&n.push(o);return d}function d(){return!0}function h(){return!1}function g(){try{return G.activeElement}catch(e){}}function v(e,t,n,r,i,o){var s,a;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(a in t)v(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),i===!1)i=h;else if(!i)return this;return 1===o&&(s=i,i=function(e){return oe().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=oe.guid++)),e.each(function(){oe.event.add(this,t,i,r,n)})}function m(e,t){return oe.nodeName(e,"table")&&oe.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e:e}function y(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function x(e){var t=Xe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function b(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(Ee.hasData(e)&&(o=Ee.access(e),s=Ee.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)oe.event.add(t,i,l[i][n])}Ne.hasData(e)&&(a=Ne.access(e),u=oe.extend({},a),Ne.set(t,u))}}function w(e,t){var n=t.nodeName.toLowerCase();"input"===n&&He.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function T(e,t,n,r){t=J.apply([],t);var i,o,s,a,u,l,f=0,d=e.length,h=d-1,g=t[0],v=oe.isFunction(g);if(v||d>1&&"string"==typeof g&&!re.checkClone&&_e.test(g))return e.each(function(i){var o=e.eq(i);v&&(t[0]=g.call(this,i,o.html())),T(o,t,n,r)});if(d&&(i=p(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(s=oe.map(c(i,"script"),y),a=s.length;d>f;f++)u=i,f!==h&&(u=oe.clone(u,!0,!0),a&&oe.merge(s,c(u,"script"))),n.call(e[f],u,f);if(a)for(l=s[s.length-1].ownerDocument,oe.map(s,x),f=0;a>f;f++)u=s[f],Fe.test(u.type||"")&&!Ee.access(u,"globalEval")&&oe.contains(l,u)&&(u.src?oe._evalUrl&&oe._evalUrl(u.src):oe.globalEval(u.textContent.replace(ze,"")))}return e}function C(e,t,n){for(var r,i=t?oe.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||oe.cleanData(c(r)),r.parentNode&&(n&&oe.contains(r.ownerDocument,r)&&f(c(r,"script")),r.parentNode.removeChild(r));return e}function k(e,t){var n=oe(t.createElement(e)).appendTo(t.body),r=oe.css(n[0],"display");return n.detach(),r}function E(e){var t=G,n=Ve[e];return n||(n=k(e,t),"none"!==n&&n||(Ue=(Ue||oe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Ue[0].contentDocument,t.write(),t.close(),n=k(e,t),Ue.detach()),Ve[e]=n),n}function N(e,t,n){var r,i,o,s,a=e.style;return n=n||Qe(e),n&&(s=n.getPropertyValue(t)||n[t],""!==s||oe.contains(e.ownerDocument,e)||(s=oe.style(e,t)),!re.pixelMarginRight()&&Ge.test(s)&&Ye.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function S(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function D(e){if(e in rt)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=nt.length;n--;)if(e=nt[n]+t,e in rt)return e}function j(e,t,n){var r=Ae.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function A(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=oe.css(e,n+Le[o],!0,i)),r?("content"===n&&(s-=oe.css(e,"padding"+Le[o],!0,i)),"margin"!==n&&(s-=oe.css(e,"border"+Le[o]+"Width",!0,i))):(s+=oe.css(e,"padding"+Le[o],!0,i),"padding"!==n&&(s+=oe.css(e,"border"+Le[o]+"Width",!0,i)));return s}function L(t,n,r){var i=!0,o="width"===n?t.offsetWidth:t.offsetHeight,s=Qe(t),a="border-box"===oe.css(t,"boxSizing",!1,s);if(G.msFullscreenElement&&e.top!==e&&t.getClientRects().length&&(o=Math.round(100*t.getBoundingClientRect()[n])),0>=o||null==o){if(o=N(t,n,s),(0>o||null==o)&&(o=t.style[n]),Ge.test(o))return o;i=a&&(re.boxSizingReliable()||o===t.style[n]),o=parseFloat(o)||0}return o+A(t,n,r||(a?"border":"content"),i,s)+"px"}function q(e,t){for(var n,r,i,o=[],s=0,a=e.length;a>s;s++)r=e[s],r.style&&(o[s]=Ee.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&qe(r)&&(o[s]=Ee.access(r,"olddisplay",E(r.nodeName)))):(i=qe(r),"none"===n&&i||Ee.set(r,"olddisplay",i?n:oe.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}function H(e,t,n,r,i){return new H.prototype.init(e,t,n,r,i)}function O(){return e.setTimeout(function(){it=void 0}),it=oe.now()}function F(e,t){var n,r=0,i={height:e};for(t=t?1:0;4>r;r+=2-t)n=Le[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function P(e,t,n){for(var r,i=(W.tweeners[t]||[]).concat(W.tweeners["*"]),o=0,s=i.length;s>o;o++)if(r=i[o].call(n,t,e))return r}function R(e,t,n){var r,i,o,s,a,u,l,c,f=this,p={},d=e.style,h=e.nodeType&&qe(e),g=Ee.get(e,"fxshow");n.queue||(a=oe._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,oe.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],l=oe.css(e,"display"),c="none"===l?Ee.get(e,"olddisplay")||E(e.nodeName):l,"inline"===c&&"none"===oe.css(e,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],st.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;h=!0}p[r]=g&&g[r]||oe.style(e,r)}else l=void 0;if(oe.isEmptyObject(p))"inline"===("none"===l?E(e.nodeName):l)&&(d.display=l);else{g?"hidden"in g&&(h=g.hidden):g=Ee.access(e,"fxshow",{}),o&&(g.hidden=!h),h?oe(e).show():f.done(function(){oe(e).hide()}),f.done(function(){var t;Ee.remove(e,"fxshow");for(t in p)oe.style(e,t,p[t])});for(r in p)s=P(h?g[r]:0,r,f),r in g||(g[r]=s.start,h&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function M(e,t){var n,r,i,o,s;for(n in e)if(r=oe.camelCase(n),i=t[r],o=e[n],oe.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=oe.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function W(e,t,n){var r,i,o=0,s=W.prefilters.length,a=oe.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=it||O(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:oe.extend({},t),opts:oe.extend(!0,{specialEasing:{},easing:oe.easing._default},n),originalProperties:t,originalOptions:n,startTime:it||O(),duration:n.duration,tweens:[],createTween:function(t,n){var r=oe.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),c=l.props;for(M(c,l.opts.specialEasing);s>o;o++)if(r=W.prefilters[o].call(l,e,c,l.opts))return oe.isFunction(r.stop)&&(oe._queueHooks(l.elem,l.opts.queue).stop=oe.proxy(r.stop,r)),r;return oe.map(c,P,l),oe.isFunction(l.opts.start)&&l.opts.start.call(e,l),oe.fx.timer(oe.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function I(e){return e.getAttribute&&e.getAttribute("class")||""}function $(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(we)||[];if(oe.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function B(e,t,n,r){function i(a){var u;return o[a]=!0,oe.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(t.dataTypes.unshift(l),i(l),!1)}),u}var o={},s=e===Et;return i(t.dataTypes[0])||!o["*"]&&i("*")}function _(e,t){var n,r,i=oe.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&oe.extend(!0,e,r),e}function X(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}function z(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(f){return{state:"parsererror",error:s?f:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}function U(e,t,n,r){var i;if(oe.isArray(t))oe.each(t,function(t,i){n||jt.test(e)?r(e,i):U(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==oe.type(t))r(e,t);else for(i in t)U(e+"["+i+"]",t[i],n,r)}function V(e){return oe.isWindow(e)?e:9===e.nodeType&&e.defaultView}var Y=[],G=e.document,Q=Y.slice,J=Y.concat,K=Y.push,Z=Y.indexOf,ee={},te=ee.toString,ne=ee.hasOwnProperty,re={},ie="2.2.0",oe=function(e,t){return new oe.fn.init(e,t)},se=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ae=/^-ms-/,ue=/-([\da-z])/gi,le=function(e,t){return t.toUpperCase()};oe.fn=oe.prototype={jquery:ie,constructor:oe,selector:"",length:0,toArray:function(){return Q.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:Q.call(this)},pushStack:function(e){var t=oe.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return oe.each(this,e)},map:function(e){return this.pushStack(oe.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(Q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:K,sort:Y.sort,splice:Y.splice},oe.extend=oe.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||oe.isFunction(s)||(s={}),a===u&&(s=this,a--);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(oe.isPlainObject(r)||(i=oe.isArray(r)))?(i?(i=!1,o=n&&oe.isArray(n)?n:[]):o=n&&oe.isPlainObject(n)?n:{},s[t]=oe.extend(l,o,r)):void 0!==r&&(s[t]=r));return s},oe.extend({expando:"jQuery"+(ie+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===oe.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!oe.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){return"object"!==oe.type(e)||e.nodeType||oe.isWindow(e)?!1:!e.constructor||ne.call(e.constructor.prototype,"isPrototypeOf")},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?ee[te.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=oe.trim(e),e&&(1===e.indexOf("use strict")?(t=G.createElement("script"),t.text=e,G.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(ae,"ms-").replace(ue,le)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var r,i=0;if(n(e))for(r=e.length;r>i&&t.call(e[i],i,e[i])!==!1;i++);else for(i in e)if(t.call(e[i],i,e[i])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(se,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?oe.merge(r,"string"==typeof e?[e]:e):K.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:Z.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;n>r;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,s=e.length,a=!n;s>o;o++)r=!t(e[o],o),r!==a&&i.push(e[o]);return i},map:function(e,t,r){var i,o,s=0,a=[];if(n(e))for(i=e.length;i>s;s++)o=t(e[s],s,r),null!=o&&a.push(o);else for(s in e)o=t(e[s],s,r),null!=o&&a.push(o);return J.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),oe.isFunction(e)?(r=Q.call(arguments,2),i=function(){return e.apply(t||this,r.concat(Q.call(arguments)))},i.guid=e.guid=e.guid||oe.guid++,i):void 0},now:Date.now,support:re}),"function"==typeof Symbol&&(oe.fn[Symbol.iterator]=Y[Symbol.iterator]),oe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){ee["[object "+t+"]"]=t.toLowerCase()});var ce=function(e){function t(e,t,n,r){var i,o,s,a,u,l,f,d,h=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!r&&((t?t.ownerDocument||t:I)!==q&&L(t),t=t||q,O)){if(11!==g&&(l=me.exec(e)))if(i=l[1]){if(9===g){if(!(s=t.getElementById(i)))return n;if(s.id===i)return n.push(s),n}else if(h&&(s=h.getElementById(i))&&M(t,s)&&s.id===i)return n.push(s),n}else{if(l[2])return K.apply(n,t.getElementsByTagName(e)),n;if((i=l[3])&&w.getElementsByClassName&&t.getElementsByClassName)return K.apply(n,t.getElementsByClassName(i)),n}if(w.qsa&&!z[e+" "]&&(!F||!F.test(e))){if(1!==g)h=t,d=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(xe,"\\$&"):t.setAttribute("id",a=W),f=E(e),o=f.length,u=pe.test(a)?"#"+a:"[id='"+a+"']";o--;)f[o]=u+" "+p(f[o]);d=f.join(","),h=ye.test(e)&&c(t.parentNode)||t}if(d)try{return K.apply(n,h.querySelectorAll(d)),n}catch(v){}finally{a===W&&t.removeAttribute("id")}}}return S(e.replace(ae,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>T.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[W]=!0,e}function i(e){var t=q.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=n.length;r--;)T.attrHandle[n[r]]=t}function s(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||V)-(~e.sourceIndex||V);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function u(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return r(function(t){return t=+t,r(function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function f(){}function p(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=B++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,s){var a,u,l,c=[$,o];if(s){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||i){if(l=t[W]||(t[W]={}),u=l[t.uniqueID]||(l[t.uniqueID]={}),(a=u[r])&&a[0]===$&&a[1]===o)return c[2]=a[2];if(u[r]=c,c[2]=e(t,n,s))return!0}}}function h(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function g(e,n,r){for(var i=0,o=n.length;o>i;i++)t(e,n[i],r);return r}function v(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,l=null!=t;u>a;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),l&&t.push(a)));return s}function m(e,t,n,i,o,s){return i&&!i[W]&&(i=m(i)),o&&!o[W]&&(o=m(o,s)),r(function(r,s,a,u){var l,c,f,p=[],d=[],h=s.length,m=r||g(t||"*",a.nodeType?[a]:a,[]),y=!e||!r&&t?m:v(m,p,e,a,u),x=n?o||(r?e:h||i)?[]:s:y;if(n&&n(y,x,a,u),i)for(l=v(x,d),i(l,[],a,u),c=l.length;c--;)(f=l[c])&&(x[d[c]]=!(y[d[c]]=f));if(r){if(o||e){if(o){for(l=[],c=x.length;c--;)(f=x[c])&&l.push(y[c]=f);o(null,x=[],l,u)}for(c=x.length;c--;)(f=x[c])&&(l=o?ee(r,f):p[c])>-1&&(r[l]=!(s[l]=f))}}else x=v(x===s?x.splice(h,x.length):x),o?o(null,s,x,u):K.apply(s,x)})}function y(e){for(var t,n,r,i=e.length,o=T.relative[e[0].type],s=o||T.relative[" "],a=o?1:0,u=d(function(e){return e===t},s,!0),l=d(function(e){return ee(t,e)>-1},s,!0),c=[function(e,n,r){var i=!o&&(r||n!==D)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,i}];i>a;a++)if(n=T.relative[e[a].type])c=[d(h(c),n)];else{if(n=T.filter[e[a].type].apply(null,e[a].matches),n[W]){for(r=++a;i>r&&!T.relative[e[r].type];r++);return m(a>1&&h(c),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ae,"$1"),n,r>a&&y(e.slice(a,r)),i>r&&y(e=e.slice(r)),i>r&&p(e))}c.push(n)}return h(c)}function x(e,n){var i=n.length>0,o=e.length>0,s=function(r,s,a,u,l){var c,f,p,d=0,h="0",g=r&&[],m=[],y=D,x=r||o&&T.find.TAG("*",l),b=$+=null==y?1:Math.random()||.1,w=x.length;for(l&&(D=s===q||s||l);h!==w&&null!=(c=x[h]);h++){if(o&&c){for(f=0,s||c.ownerDocument===q||(L(c),a=!O);p=e[f++];)if(p(c,s||q,a)){u.push(c);break}l&&($=b)}i&&((c=!p&&c)&&d--,r&&g.push(c))}if(d+=h,i&&h!==d){for(f=0;p=n[f++];)p(g,m,s,a);if(r){if(d>0)for(;h--;)g[h]||m[h]||(m[h]=Q.call(u));m=v(m)}K.apply(u,m),l&&!r&&m.length>0&&d+n.length>1&&t.uniqueSort(u)}return l&&($=b,D=y),g};return i?r(s):s}var b,w,T,C,k,E,N,S,D,j,A,L,q,H,O,F,P,R,M,W="sizzle"+1*new Date,I=e.document,$=0,B=0,_=n(),X=n(),z=n(),U=function(e,t){return e===t&&(A=!0),0},V=1<<31,Y={}.hasOwnProperty,G=[],Q=G.pop,J=G.push,K=G.push,Z=G.slice,ee=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie="\\["+ne+"*("+re+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ne+"*\\]",oe=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ie+")*)|.*)\\)|)",se=new RegExp(ne+"+","g"),ae=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ue=new RegExp("^"+ne+"*,"+ne+"*"),le=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ce=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),fe=new RegExp(oe),pe=new RegExp("^"+re+"$"),de={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re+"|[*])"),ATTR:new RegExp("^"+ie),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},he=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,xe=/'|\\/g,be=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},Te=function(){L()};try{K.apply(G=Z.call(I.childNodes),I.childNodes),G[I.childNodes.length].nodeType}catch(Ce){K={apply:G.length?function(e,t){J.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}w=t.support={},k=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},L=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:I;return r!==q&&9===r.nodeType&&r.documentElement?(q=r,H=q.documentElement,O=!k(q),(n=q.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Te,!1):n.attachEvent&&n.attachEvent("onunload",Te)),w.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=i(function(e){return e.appendChild(q.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=ve.test(q.getElementsByClassName),w.getById=i(function(e){return H.appendChild(e).id=W,!q.getElementsByName||!q.getElementsByName(W).length}),w.getById?(T.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&O){var n=t.getElementById(e);return n?[n]:[]}},T.filter.ID=function(e){var t=e.replace(be,we);return function(e){return e.getAttribute("id")===t}}):(delete T.find.ID,T.filter.ID=function(e){var t=e.replace(be,we);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),T.find.TAG=w.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},T.find.CLASS=w.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&O?t.getElementsByClassName(e):void 0},P=[],F=[],(w.qsa=ve.test(q.querySelectorAll))&&(i(function(e){H.appendChild(e).innerHTML="<a id='"+W+"'></a><select id='"+W+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&F.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||F.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+W+"-]").length||F.push("~="),e.querySelectorAll(":checked").length||F.push(":checked"),e.querySelectorAll("a#"+W+"+*").length||F.push(".#.+[+~]")}),i(function(e){var t=q.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&F.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(w.matchesSelector=ve.test(R=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&i(function(e){w.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),P.push("!=",oe)}),F=F.length&&new RegExp(F.join("|")),P=P.length&&new RegExp(P.join("|")),t=ve.test(H.compareDocumentPosition),M=t||ve.test(H.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},U=t?function(e,t){if(e===t)return A=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!w.sortDetached&&t.compareDocumentPosition(e)===n?e===q||e.ownerDocument===I&&M(I,e)?-1:t===q||t.ownerDocument===I&&M(I,t)?1:j?ee(j,e)-ee(j,t):0:4&n?-1:1)}:function(e,t){if(e===t)return A=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],u=[t];if(!i||!o)return e===q?-1:t===q?1:i?-1:o?1:j?ee(j,e)-ee(j,t):0;if(i===o)return s(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;a[r]===u[r];)r++;return r?s(a[r],u[r]):a[r]===I?-1:u[r]===I?1:0},q):q},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==q&&L(e),n=n.replace(ce,"='$1']"),w.matchesSelector&&O&&!z[n+" "]&&(!P||!P.test(n))&&(!F||!F.test(n)))try{var r=R.call(e,n);if(r||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return t(n,q,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==q&&L(e),M(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==q&&L(e);var n=T.attrHandle[t.toLowerCase()],r=n&&Y.call(T.attrHandle,t.toLowerCase())?n(e,t,!O):void 0;return void 0!==r?r:w.attributes||!O?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,i=0;if(A=!w.detectDuplicates,j=!w.sortStable&&e.slice(0),e.sort(U),A){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return j=null,e},C=t.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=C(t);return n},T=t.selectors={cacheLength:50,createPseudo:r,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,we),e[3]=(e[3]||e[4]||e[5]||"").replace(be,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&fe.test(n)&&(t=E(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&_(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(i){var o=t.attr(i,e);return null==o?"!="===n:n?(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(se," ")+" ").indexOf(r)>-1:"|="===n?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==s?"nextSibling":"previousSibling",v=t.parentNode,m=a&&t.nodeName.toLowerCase(),y=!u&&!a,x=!1;if(v){if(o){for(;g;){for(p=t;p=p[g];)if(a?p.nodeName.toLowerCase()===m:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[s?v.firstChild:v.lastChild],s&&y){for(p=v,f=p[W]||(p[W]={}),c=f[p.uniqueID]||(f[p.uniqueID]={}),l=c[e]||[],d=l[0]===$&&l[1],x=d&&l[2],p=d&&v.childNodes[d];p=++d&&p&&p[g]||(x=d=0)||h.pop();)if(1===p.nodeType&&++x&&p===t){c[e]=[$,d,x];break}}else if(y&&(p=t,f=p[W]||(p[W]={}),c=f[p.uniqueID]||(f[p.uniqueID]={}),l=c[e]||[],d=l[0]===$&&l[1],x=d),x===!1)for(;(p=++d&&p&&p[g]||(x=d=0)||h.pop())&&((a?p.nodeName.toLowerCase()!==m:1!==p.nodeType)||!++x||(y&&(f=p[W]||(p[W]={}),c=f[p.uniqueID]||(f[p.uniqueID]={}),c[e]=[$,x]),p!==t)););return x-=i,x===r||x%r===0&&x/r>=0}}},PSEUDO:function(e,n){var i,o=T.pseudos[e]||T.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[W]?o(n):o.length>1?(i=[e,e,"",n],T.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=o(e,n),s=i.length;s--;)r=ee(e,i[s]),e[r]=!(t[r]=i[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=N(e.replace(ae,"$1"));return i[W]?r(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(be,we),function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:r(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,we).toLowerCase(),function(t){var n;do if(n=O?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===H},focus:function(e){return e===q.activeElement&&(!q.hasFocus||q.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return he.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),
lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},T.pseudos.nth=T.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[b]=a(b);for(b in{submit:!0,reset:!0})T.pseudos[b]=u(b);return f.prototype=T.filters=T.pseudos,T.setFilters=new f,E=t.tokenize=function(e,n){var r,i,o,s,a,u,l,c=X[e+" "];if(c)return n?0:c.slice(0);for(a=e,u=[],l=T.preFilter;a;){r&&!(i=ue.exec(a))||(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),r=!1,(i=le.exec(a))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ae," ")}),a=a.slice(r.length));for(s in T.filter)!(i=de[s].exec(a))||l[s]&&!(i=l[s](i))||(r=i.shift(),o.push({value:r,type:s,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?t.error(e):X(e,u).slice(0)},N=t.compile=function(e,t){var n,r=[],i=[],o=z[e+" "];if(!o){for(t||(t=E(e)),n=t.length;n--;)o=y(t[n]),o[W]?r.push(o):i.push(o);o=z(e,x(i,r)),o.selector=e}return o},S=t.select=function(e,t,n,r){var i,o,s,a,u,l="function"==typeof e&&e,f=!r&&E(e=l.selector||e);if(n=n||[],1===f.length){if(o=f[0]=f[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&w.getById&&9===t.nodeType&&O&&T.relative[o[1].type]){if(t=(T.find.ID(s.matches[0].replace(be,we),t)||[])[0],!t)return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=de.needsContext.test(e)?0:o.length;i--&&(s=o[i],!T.relative[a=s.type]);)if((u=T.find[a])&&(r=u(s.matches[0].replace(be,we),ye.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&p(o),!e)return K.apply(n,r),n;break}}return(l||N(e,f))(r,t,!O,n,!t||ye.test(e)&&c(t.parentNode)||t),n},w.sortStable=W.split("").sort(U).join("")===W,w.detectDuplicates=!!A,L(),w.sortDetached=i(function(e){return 1&e.compareDocumentPosition(q.createElement("div"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,n){var r;return n?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);oe.find=ce,oe.expr=ce.selectors,oe.expr[":"]=oe.expr.pseudos,oe.uniqueSort=oe.unique=ce.uniqueSort,oe.text=ce.getText,oe.isXMLDoc=ce.isXML,oe.contains=ce.contains;var fe=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&oe(e).is(n))break;r.push(e)}return r},pe=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},de=oe.expr.match.needsContext,he=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ge=/^.[^:#\[\.,]*$/;oe.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?oe.find.matchesSelector(r,e)?[r]:[]:oe.find.matches(e,oe.grep(t,function(e){return 1===e.nodeType}))},oe.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(oe(e).filter(function(){for(t=0;n>t;t++)if(oe.contains(i[t],this))return!0}));for(t=0;n>t;t++)oe.find(e,i[t],r);return r=this.pushStack(n>1?oe.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&de.test(e)?oe(e):e||[],!1).length}});var ve,me=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ye=oe.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||ve,"string"==typeof e){if(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:me.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof oe?t[0]:t,oe.merge(this,oe.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:G,!0)),he.test(r[1])&&oe.isPlainObject(t))for(r in t)oe.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=G.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=G,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):oe.isFunction(e)?void 0!==n.ready?n.ready(e):e(oe):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),oe.makeArray(e,this))};ye.prototype=oe.fn,ve=oe(G);var xe=/^(?:parents|prev(?:Until|All))/,be={children:!0,contents:!0,next:!0,prev:!0};oe.fn.extend({has:function(e){var t=oe(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(oe.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],s=de.test(e)||"string"!=typeof e?oe(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&oe.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?oe.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?Z.call(oe(e),this[0]):Z.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(oe.uniqueSort(oe.merge(this.get(),oe(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),oe.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return fe(e,"parentNode")},parentsUntil:function(e,t,n){return fe(e,"parentNode",n)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return fe(e,"nextSibling")},prevAll:function(e){return fe(e,"previousSibling")},nextUntil:function(e,t,n){return fe(e,"nextSibling",n)},prevUntil:function(e,t,n){return fe(e,"previousSibling",n)},siblings:function(e){return pe((e.parentNode||{}).firstChild,e)},children:function(e){return pe(e.firstChild)},contents:function(e){return e.contentDocument||oe.merge([],e.childNodes)}},function(e,t){oe.fn[e]=function(n,r){var i=oe.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=oe.filter(r,i)),this.length>1&&(be[e]||oe.uniqueSort(i),xe.test(e)&&i.reverse()),this.pushStack(i)}});var we=/\S+/g;oe.Callbacks=function(e){e="string"==typeof e?o(e):oe.extend({},e);var t,n,r,i,s=[],a=[],u=-1,l=function(){for(i=e.once,r=t=!0;a.length;u=-1)for(n=a.shift();++u<s.length;)s[u].apply(n[0],n[1])===!1&&e.stopOnFalse&&(u=s.length,n=!1);e.memory||(n=!1),t=!1,i&&(s=n?[]:"")},c={add:function(){return s&&(n&&!t&&(u=s.length-1,a.push(n)),function r(t){oe.each(t,function(t,n){oe.isFunction(n)?e.unique&&c.has(n)||s.push(n):n&&n.length&&"string"!==oe.type(n)&&r(n)})}(arguments),n&&!t&&l()),this},remove:function(){return oe.each(arguments,function(e,t){for(var n;(n=oe.inArray(t,s,n))>-1;)s.splice(n,1),u>=n&&u--}),this},has:function(e){return e?oe.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return i=a=[],s=n="",this},disabled:function(){return!s},lock:function(){return i=a=[],n||(s=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=n||[],n=[e,n.slice?n.slice():n],a.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},oe.extend({Deferred:function(e){var t=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return oe.Deferred(function(n){oe.each(t,function(t,o){var s=oe.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&oe.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?oe.extend(e,r):r}},i={};return r.pipe=r.then,oe.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=Q.call(arguments),s=o.length,a=1!==s||e&&oe.isFunction(e.promise)?s:0,u=1===a?e:oe.Deferred(),l=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?Q.call(arguments):i,r===t?u.notifyWith(n,r):--a||u.resolveWith(n,r)}};if(s>1)for(t=new Array(s),n=new Array(s),r=new Array(s);s>i;i++)o[i]&&oe.isFunction(o[i].promise)?o[i].promise().progress(l(i,n,t)).done(l(i,r,o)).fail(u.reject):--a;return a||u.resolveWith(r,o),u.promise()}});var Te;oe.fn.ready=function(e){return oe.ready.promise().done(e),this},oe.extend({isReady:!1,readyWait:1,holdReady:function(e){e?oe.readyWait++:oe.ready(!0)},ready:function(e){(e===!0?--oe.readyWait:oe.isReady)||(oe.isReady=!0,e!==!0&&--oe.readyWait>0||(Te.resolveWith(G,[oe]),oe.fn.triggerHandler&&(oe(G).triggerHandler("ready"),oe(G).off("ready"))))}}),oe.ready.promise=function(t){return Te||(Te=oe.Deferred(),"complete"===G.readyState||"loading"!==G.readyState&&!G.documentElement.doScroll?e.setTimeout(oe.ready):(G.addEventListener("DOMContentLoaded",s),e.addEventListener("load",s))),Te.promise(t)},oe.ready.promise();var Ce=function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===oe.type(n)){i=!0;for(a in n)Ce(e,t,a,n[a],!0,o,s)}else if(void 0!==r&&(i=!0,oe.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(oe(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},ke=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};a.uid=1,a.prototype={register:function(e,t){var n=t||{};return e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!ke(e))return{};var t=e[this.expando];return t||(t={},ke(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[t]=n;else for(r in t)i[r]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?(r=this.get(e,t),void 0!==r?r:this.get(e,oe.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,i,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{oe.isArray(t)?r=t.concat(t.map(oe.camelCase)):(i=oe.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(we)||[])),n=r.length;for(;n--;)delete o[r[n]]}(void 0===t||oe.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!oe.isEmptyObject(t)}};var Ee=new a,Ne=new a,Se=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,De=/[A-Z]/g;oe.extend({hasData:function(e){return Ne.hasData(e)||Ee.hasData(e)},data:function(e,t,n){return Ne.access(e,t,n)},removeData:function(e,t){Ne.remove(e,t)},_data:function(e,t,n){return Ee.access(e,t,n)},_removeData:function(e,t){Ee.remove(e,t)}}),oe.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=Ne.get(o),1===o.nodeType&&!Ee.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(r=s[n].name,0===r.indexOf("data-")&&(r=oe.camelCase(r.slice(5)),u(o,r,i[r])));Ee.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Ne.set(this,e)}):Ce(this,function(t){var n,r;if(o&&void 0===t){if(n=Ne.get(o,e)||Ne.get(o,e.replace(De,"-$&").toLowerCase()),void 0!==n)return n;if(r=oe.camelCase(e),n=Ne.get(o,r),void 0!==n)return n;if(n=u(o,r,void 0),void 0!==n)return n}else r=oe.camelCase(e),this.each(function(){var n=Ne.get(this,r);Ne.set(this,r,t),e.indexOf("-")>-1&&void 0!==n&&Ne.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Ne.remove(this,e)})}}),oe.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=Ee.get(e,t),n&&(!r||oe.isArray(n)?r=Ee.access(e,t,oe.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=oe.queue(e,t),r=n.length,i=n.shift(),o=oe._queueHooks(e,t),s=function(){oe.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Ee.get(e,n)||Ee.access(e,n,{empty:oe.Callbacks("once memory").add(function(){Ee.remove(e,[t+"queue",n])})})}}),oe.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?oe.queue(this[0],e):void 0===t?this:this.each(function(){var n=oe.queue(this,e,t);oe._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&oe.dequeue(this,e)})},dequeue:function(e){return this.each(function(){oe.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=oe.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=Ee.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var je=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ae=new RegExp("^(?:([+-])=|)("+je+")([a-z%]*)$","i"),Le=["Top","Right","Bottom","Left"],qe=function(e,t){return e=t||e,"none"===oe.css(e,"display")||!oe.contains(e.ownerDocument,e)},He=/^(?:checkbox|radio)$/i,Oe=/<([\w:-]+)/,Fe=/^$|\/(?:java|ecma)script/i,Pe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Pe.optgroup=Pe.option,Pe.tbody=Pe.tfoot=Pe.colgroup=Pe.caption=Pe.thead,Pe.th=Pe.td;var Re=/<|&#?\w+;/;!function(){var e=G.createDocumentFragment(),t=e.appendChild(G.createElement("div")),n=G.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),re.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",re.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Me=/^key/,We=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ie=/^([^.]*)(?:\.(.+)|)/;oe.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,v=Ee.get(e);if(v)for(n.handler&&(o=n,n=o.handler,i=o.selector),n.guid||(n.guid=oe.guid++),(u=v.events)||(u=v.events={}),(s=v.handle)||(s=v.handle=function(t){return"undefined"!=typeof oe&&oe.event.triggered!==t.type?oe.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(we)||[""],l=t.length;l--;)a=Ie.exec(t[l])||[],d=g=a[1],h=(a[2]||"").split(".").sort(),d&&(f=oe.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=oe.event.special[d]||{},c=oe.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&oe.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||(p=u[d]=[],p.delegateCount=0,f.setup&&f.setup.call(e,r,h,s)!==!1||e.addEventListener&&e.addEventListener(d,s)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),oe.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,v=Ee.hasData(e)&&Ee.get(e);if(v&&(u=v.events)){for(t=(t||"").match(we)||[""],l=t.length;l--;)if(a=Ie.exec(t[l])||[],d=g=a[1],h=(a[2]||"").split(".").sort(),d){for(f=oe.event.special[d]||{},d=(r?f.delegateType:f.bindType)||d,p=u[d]||[],a=a[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));s&&!p.length&&(f.teardown&&f.teardown.call(e,h,v.handle)!==!1||oe.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)oe.event.remove(e,d+t[l],n,r,!0);oe.isEmptyObject(u)&&Ee.remove(e,"handle events")}},dispatch:function(e){e=oe.event.fix(e);var t,n,r,i,o,s=[],a=Q.call(arguments),u=(Ee.get(this,"events")||{})[e.type]||[],l=oe.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(s=oe.event.handlers.call(this,e,u),t=0;(i=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,r=((oe.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),void 0!==r&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",void 0===r[i]&&(r[i]=o.needsContext?oe(i,this).index(u)>-1:oe.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||G,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[oe.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=We.test(i)?this.mouseHooks:Me.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new oe.Event(o),t=r.length;t--;)n=r[t],e[n]=o[n];return e.target||(e.target=G),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==g()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===g()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&oe.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return oe.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},oe.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},oe.Event=function(e,t){return this instanceof oe.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?d:h):this.type=e,t&&oe.extend(this,t),this.timeStamp=e&&e.timeStamp||oe.now(),void(this[oe.expando]=!0)):new oe.Event(e,t)},oe.Event.prototype={constructor:oe.Event,isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=d,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=d,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=d,e&&e.stopImmediatePropagation(),this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){oe.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||oe.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),oe.fn.extend({on:function(e,t,n,r){return v(this,e,t,n,r)},one:function(e,t,n,r){return v(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,oe(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return t!==!1&&"function"!=typeof t||(n=t,t=void 0),n===!1&&(n=h),this.each(function(){oe.event.remove(this,e,n,t)})}});var $e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Be=/<script|<style|<link/i,_e=/checked\s*(?:[^=]|=\s*.checked.)/i,Xe=/^true\/(.*)/,ze=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;oe.extend({htmlPrefilter:function(e){return e.replace($e,"<$1></$2>")},clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=oe.contains(e.ownerDocument,e);if(!(re.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||oe.isXMLDoc(e)))for(s=c(a),o=c(e),r=0,i=o.length;i>r;r++)w(o[r],s[r]);if(t)if(n)for(o=o||c(e),s=s||c(a),r=0,i=o.length;i>r;r++)b(o[r],s[r]);else b(e,a);return s=c(a,"script"),s.length>0&&f(s,!u&&c(e,"script")),a},cleanData:function(e){for(var t,n,r,i=oe.event.special,o=0;void 0!==(n=e[o]);o++)if(ke(n)){if(t=n[Ee.expando]){if(t.events)for(r in t.events)i[r]?oe.event.remove(n,r):oe.removeEvent(n,r,t.handle);n[Ee.expando]=void 0}n[Ne.expando]&&(n[Ne.expando]=void 0)}}}),oe.fn.extend({domManip:T,detach:function(e){return C(this,e,!0)},remove:function(e){return C(this,e)},text:function(e){return Ce(this,function(e){return void 0===e?oe.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return T(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=m(this,e);t.appendChild(e)}})},prepend:function(){return T(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=m(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return T(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return T(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(oe.cleanData(c(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return oe.clone(this,e,t)})},html:function(e){return Ce(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Be.test(e)&&!Pe[(Oe.exec(e)||["",""])[1].toLowerCase()]){e=oe.htmlPrefilter(e);try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(oe.cleanData(c(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return T(this,arguments,function(t){var n=this.parentNode;oe.inArray(this,e)<0&&(oe.cleanData(c(this)),n&&n.replaceChild(t,this))},e)}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){oe.fn[e]=function(e){for(var n,r=[],i=oe(e),o=i.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),oe(i[s])[t](n),K.apply(r,n.get());return this.pushStack(r)}});var Ue,Ve={HTML:"block",BODY:"block"},Ye=/^margin/,Ge=new RegExp("^("+je+")(?!px)[a-z%]+$","i"),Qe=function(t){var n=t.ownerDocument.defaultView;return n.opener||(n=e),n.getComputedStyle(t)},Je=function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i},Ke=G.documentElement;!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",Ke.appendChild(s);var t=e.getComputedStyle(a);n="1%"!==t.top,o="2px"===t.marginLeft,r="4px"===t.width,a.style.marginRight="50%",i="4px"===t.marginRight,Ke.removeChild(s)}var n,r,i,o,s=G.createElement("div"),a=G.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",re.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),oe.extend(re,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==r&&t(),r},pixelMarginRight:function(){return null==r&&t(),i},reliableMarginLeft:function(){return null==r&&t(),o},reliableMarginRight:function(){var t,n=a.appendChild(G.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",Ke.appendChild(s),t=!parseFloat(e.getComputedStyle(n).marginRight),Ke.removeChild(s),a.removeChild(n),t}}))}();var Ze=/^(none|table(?!-c[ea]).+)/,et={position:"absolute",visibility:"hidden",display:"block"},tt={letterSpacing:"0",fontWeight:"400"},nt=["Webkit","O","Moz","ms"],rt=G.createElement("div").style;oe.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=N(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=oe.camelCase(t),u=e.style;return t=oe.cssProps[a]||(oe.cssProps[a]=D(a)||a),s=oe.cssHooks[t]||oe.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t]:(o=typeof n,"string"===o&&(i=Ae.exec(n))&&i[1]&&(n=l(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(oe.cssNumber[a]?"":"px")),re.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(u[t]=n)),void 0)}},css:function(e,t,n,r){var i,o,s,a=oe.camelCase(t);return t=oe.cssProps[a]||(oe.cssProps[a]=D(a)||a),s=oe.cssHooks[t]||oe.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=N(e,t,r)),"normal"===i&&t in tt&&(i=tt[t]),""===n||n?(o=parseFloat(i),n===!0||isFinite(o)?o||0:i):i}}),oe.each(["height","width"],function(e,t){oe.cssHooks[t]={get:function(e,n,r){return n?Ze.test(oe.css(e,"display"))&&0===e.offsetWidth?Je(e,et,function(){return L(e,t,r)}):L(e,t,r):void 0},set:function(e,n,r){var i,o=r&&Qe(e),s=r&&A(e,t,r,"border-box"===oe.css(e,"boxSizing",!1,o),o);return s&&(i=Ae.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=oe.css(e,t)),j(e,n,s)}}}),oe.cssHooks.marginLeft=S(re.reliableMarginLeft,function(e,t){return t?(parseFloat(N(e,"marginLeft"))||e.getBoundingClientRect().left-Je(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),oe.cssHooks.marginRight=S(re.reliableMarginRight,function(e,t){return t?Je(e,{display:"inline-block"},N,[e,"marginRight"]):void 0}),oe.each({margin:"",padding:"",border:"Width"},function(e,t){oe.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Le[r]+t]=o[r]||o[r-2]||o[0];return i}},Ye.test(e)||(oe.cssHooks[e+t].set=j)}),oe.fn.extend({css:function(e,t){return Ce(this,function(e,t,n){var r,i,o={},s=0;if(oe.isArray(t)){for(r=Qe(e),i=t.length;i>s;s++)o[t[s]]=oe.css(e,t[s],!1,r);return o}return void 0!==n?oe.style(e,t,n):oe.css(e,t)},e,t,arguments.length>1)},show:function(){return q(this,!0)},hide:function(){return q(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){qe(this)?oe(this).show():oe(this).hide()})}}),oe.Tween=H,H.prototype={constructor:H,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||oe.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(oe.cssNumber[n]?"":"px")},cur:function(){var e=H.propHooks[this.prop];return e&&e.get?e.get(this):H.propHooks._default.get(this)},run:function(e){var t,n=H.propHooks[this.prop];return this.options.duration?this.pos=t=oe.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=oe.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){oe.fx.step[e.prop]?oe.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[oe.cssProps[e.prop]]&&!oe.cssHooks[e.prop]?e.elem[e.prop]=e.now:oe.style(e.elem,e.prop,e.now+e.unit)}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},oe.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},oe.fx=H.prototype.init,oe.fx.step={};var it,ot,st=/^(?:toggle|show|hide)$/,at=/queueHooks$/;oe.Animation=oe.extend(W,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return l(n.elem,e,Ae.exec(t),n),n}]},tweener:function(e,t){oe.isFunction(e)?(t=e,e=["*"]):e=e.match(we);for(var n,r=0,i=e.length;i>r;r++)n=e[r],W.tweeners[n]=W.tweeners[n]||[],W.tweeners[n].unshift(t)},prefilters:[R],prefilter:function(e,t){t?W.prefilters.unshift(e):W.prefilters.push(e)}}),oe.speed=function(e,t,n){var r=e&&"object"==typeof e?oe.extend({},e):{complete:n||!n&&t||oe.isFunction(e)&&e,duration:e,easing:n&&t||t&&!oe.isFunction(t)&&t};return r.duration=oe.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in oe.fx.speeds?oe.fx.speeds[r.duration]:oe.fx.speeds._default,null!=r.queue&&r.queue!==!0||(r.queue="fx"),r.old=r.complete,r.complete=function(){oe.isFunction(r.old)&&r.old.call(this),r.queue&&oe.dequeue(this,r.queue)},r},oe.fn.extend({fadeTo:function(e,t,n,r){return this.filter(qe).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=oe.isEmptyObject(e),o=oe.speed(t,n,r),s=function(){var t=W(this,oe.extend({},e),o);(i||Ee.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=oe.timers,s=Ee.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&at.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||oe.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=Ee.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=oe.timers,s=r?r.length:0;for(n.finish=!0,oe.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),oe.each(["toggle","show","hide"],function(e,t){var n=oe.fn[t];oe.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(F(t,!0),e,r,i)}}),oe.each({slideDown:F("show"),slideUp:F("hide"),slideToggle:F("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){oe.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),oe.timers=[],oe.fx.tick=function(){var e,t=0,n=oe.timers;for(it=oe.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||oe.fx.stop(),it=void 0},oe.fx.timer=function(e){oe.timers.push(e),e()?oe.fx.start():oe.timers.pop();
},oe.fx.interval=13,oe.fx.start=function(){ot||(ot=e.setInterval(oe.fx.tick,oe.fx.interval))},oe.fx.stop=function(){e.clearInterval(ot),ot=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fn.delay=function(t,n){return t=oe.fx?oe.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=G.createElement("input"),t=G.createElement("select"),n=t.appendChild(G.createElement("option"));e.type="checkbox",re.checkOn=""!==e.value,re.optSelected=n.selected,t.disabled=!0,re.optDisabled=!n.disabled,e=G.createElement("input"),e.value="t",e.type="radio",re.radioValue="t"===e.value}();var ut,lt=oe.expr.attrHandle;oe.fn.extend({attr:function(e,t){return Ce(this,oe.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){oe.removeAttr(this,e)})}}),oe.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?oe.prop(e,t,n):(1===o&&oe.isXMLDoc(e)||(t=t.toLowerCase(),i=oe.attrHooks[t]||(oe.expr.match.bool.test(t)?ut:void 0)),void 0!==n?null===n?void oe.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=oe.find.attr(e,t),null==r?void 0:r))},attrHooks:{type:{set:function(e,t){if(!re.radioValue&&"radio"===t&&oe.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(we);if(o&&1===e.nodeType)for(;n=o[i++];)r=oe.propFix[n]||n,oe.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)}}),ut={set:function(e,t,n){return t===!1?oe.removeAttr(e,n):e.setAttribute(n,n),n}},oe.each(oe.expr.match.bool.source.match(/\w+/g),function(e,t){var n=lt[t]||oe.find.attr;lt[t]=function(e,t,r){var i,o;return r||(o=lt[t],lt[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,lt[t]=o),i}});var ct=/^(?:input|select|textarea|button)$/i,ft=/^(?:a|area)$/i;oe.fn.extend({prop:function(e,t){return Ce(this,oe.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[oe.propFix[e]||e]})}}),oe.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&oe.isXMLDoc(e)||(t=oe.propFix[t]||t,i=oe.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=oe.find.attr(e,"tabindex");return t?parseInt(t,10):ct.test(e.nodeName)||ft.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),re.optSelected||(oe.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),oe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){oe.propFix[this.toLowerCase()]=this});var pt=/[\t\r\n\f]/g;oe.fn.extend({addClass:function(e){var t,n,r,i,o,s,a,u=0;if(oe.isFunction(e))return this.each(function(t){oe(this).addClass(e.call(this,t,I(this)))});if("string"==typeof e&&e)for(t=e.match(we)||[];n=this[u++];)if(i=I(n),r=1===n.nodeType&&(" "+i+" ").replace(pt," ")){for(s=0;o=t[s++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");a=oe.trim(r),i!==a&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,r,i,o,s,a,u=0;if(oe.isFunction(e))return this.each(function(t){oe(this).removeClass(e.call(this,t,I(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(we)||[];n=this[u++];)if(i=I(n),r=1===n.nodeType&&(" "+i+" ").replace(pt," ")){for(s=0;o=t[s++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");a=oe.trim(r),i!==a&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):oe.isFunction(e)?this.each(function(n){oe(this).toggleClass(e.call(this,n,I(this),t),t)}):this.each(function(){var t,r,i,o;if("string"===n)for(r=0,i=oe(this),o=e.match(we)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||(t=I(this),t&&Ee.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Ee.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+I(n)+" ").replace(pt," ").indexOf(t)>-1)return!0;return!1}});var dt=/\r/g;oe.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=oe.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,oe(this).val()):e,null==i?i="":"number"==typeof i?i+="":oe.isArray(i)&&(i=oe.map(i,function(e){return null==e?"":e+""})),t=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return t=oe.valHooks[i.type]||oe.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(dt,""):null==n?"":n)}}}),oe.extend({valHooks:{option:{get:function(e){return oe.trim(e.value)}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;a>u;u++)if(n=r[u],(n.selected||u===i)&&(re.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!oe.nodeName(n.parentNode,"optgroup"))){if(t=oe(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=oe.makeArray(t),s=i.length;s--;)r=i[s],(r.selected=oe.inArray(oe.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(e,t){return oe.isArray(t)?e.checked=oe.inArray(oe(e).val(),t)>-1:void 0}},re.checkOn||(oe.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var ht=/^(?:focusinfocus|focusoutblur)$/;oe.extend(oe.event,{trigger:function(t,n,r,i){var o,s,a,u,l,c,f,p=[r||G],d=ne.call(t,"type")?t.type:t,h=ne.call(t,"namespace")?t.namespace.split("."):[];if(s=a=r=r||G,3!==r.nodeType&&8!==r.nodeType&&!ht.test(d+oe.event.triggered)&&(d.indexOf(".")>-1&&(h=d.split("."),d=h.shift(),h.sort()),l=d.indexOf(":")<0&&"on"+d,t=t[oe.expando]?t:new oe.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=h.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:oe.makeArray(n,[t]),f=oe.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!oe.isWindow(r)){for(u=f.delegateType||d,ht.test(u+d)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(r.ownerDocument||G)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)t.type=o>1?u:f.bindType||d,c=(Ee.get(s,"events")||{})[t.type]&&Ee.get(s,"handle"),c&&c.apply(s,n),c=l&&s[l],c&&c.apply&&ke(s)&&(t.result=c.apply(s,n),t.result===!1&&t.preventDefault());return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(p.pop(),n)!==!1||!ke(r)||l&&oe.isFunction(r[d])&&!oe.isWindow(r)&&(a=r[l],a&&(r[l]=null),oe.event.triggered=d,r[d](),oe.event.triggered=void 0,a&&(r[l]=a)),t.result}},simulate:function(e,t,n){var r=oe.extend(new oe.Event,n,{type:e,isSimulated:!0});oe.event.trigger(r,null,t),r.isDefaultPrevented()&&n.preventDefault()}}),oe.fn.extend({trigger:function(e,t){return this.each(function(){oe.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?oe.event.trigger(e,t,n,!0):void 0}}),oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){oe.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),oe.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),re.focusin="onfocusin"in e,re.focusin||oe.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){oe.event.simulate(t,e.target,oe.event.fix(e))};oe.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=Ee.access(r,t);i||r.addEventListener(e,n,!0),Ee.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=Ee.access(r,t)-1;i?Ee.access(r,t,i):(r.removeEventListener(e,n,!0),Ee.remove(r,t))}}});var gt=e.location,vt=oe.now(),mt=/\?/;oe.parseJSON=function(e){return JSON.parse(e+"")},oe.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(r){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||oe.error("Invalid XML: "+t),n};var yt=/#.*$/,xt=/([?&])_=[^&]*/,bt=/^(.*?):[ \t]*([^\r\n]*)$/gm,wt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tt=/^(?:GET|HEAD)$/,Ct=/^\/\//,kt={},Et={},Nt="*/".concat("*"),St=G.createElement("a");St.href=gt.href,oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gt.href,type:"GET",isLocal:wt.test(gt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Nt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_(_(e,oe.ajaxSettings),t):_(oe.ajaxSettings,e)},ajaxPrefilter:$(kt),ajaxTransport:$(Et),ajax:function(t,n){function r(t,n,r,a){var l,f,y,x,w,C=n;2!==b&&(b=2,u&&e.clearTimeout(u),i=void 0,s=a||"",T.readyState=t>0?4:0,l=t>=200&&300>t||304===t,r&&(x=X(p,T,r)),x=z(p,x,T,l),l?(p.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(oe.lastModified[o]=w),w=T.getResponseHeader("etag"),w&&(oe.etag[o]=w)),204===t||"HEAD"===p.type?C="nocontent":304===t?C="notmodified":(C=x.state,f=x.data,y=x.error,l=!y)):(y=C,!t&&C||(C="error",0>t&&(t=0))),T.status=t,T.statusText=(n||C)+"",l?g.resolveWith(d,[f,C,T]):g.rejectWith(d,[T,C,y]),T.statusCode(m),m=void 0,c&&h.trigger(l?"ajaxSuccess":"ajaxError",[T,p,l?f:y]),v.fireWith(d,[T,C]),c&&(h.trigger("ajaxComplete",[T,p]),--oe.active||oe.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,s,a,u,l,c,f,p=oe.ajaxSetup({},n),d=p.context||p,h=p.context&&(d.nodeType||d.jquery)?oe(d):oe.event,g=oe.Deferred(),v=oe.Callbacks("once memory"),m=p.statusCode||{},y={},x={},b=0,w="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!a)for(a={};t=bt.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=x[n]=x[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),r(0,t),this}};if(g.promise(T).complete=v.add,T.success=T.done,T.error=T.fail,p.url=((t||p.url||gt.href)+"").replace(yt,"").replace(Ct,gt.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=oe.trim(p.dataType||"*").toLowerCase().match(we)||[""],null==p.crossDomain){l=G.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=St.protocol+"//"+St.host!=l.protocol+"//"+l.host}catch(C){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=oe.param(p.data,p.traditional)),B(kt,p,n,T),2===b)return T;c=oe.event&&p.global,c&&0===oe.active++&&oe.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Tt.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(mt.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=xt.test(o)?o.replace(xt,"$1_="+vt++):o+(mt.test(o)?"&":"?")+"_="+vt++)),p.ifModified&&(oe.lastModified[o]&&T.setRequestHeader("If-Modified-Since",oe.lastModified[o]),oe.etag[o]&&T.setRequestHeader("If-None-Match",oe.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Nt+"; q=0.01":""):p.accepts["*"]);for(f in p.headers)T.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(p.beforeSend.call(d,T,p)===!1||2===b))return T.abort();w="abort";for(f in{success:1,error:1,complete:1})T[f](p[f]);if(i=B(Et,p,n,T)){if(T.readyState=1,c&&h.trigger("ajaxSend",[T,p]),2===b)return T;p.async&&p.timeout>0&&(u=e.setTimeout(function(){T.abort("timeout")},p.timeout));try{b=1,i.send(y,r)}catch(C){if(!(2>b))throw C;r(-1,C)}}else r(-1,"No Transport");return T},getJSON:function(e,t,n){return oe.get(e,t,n,"json")},getScript:function(e,t){return oe.get(e,void 0,t,"script")}}),oe.each(["get","post"],function(e,t){oe[t]=function(e,n,r,i){return oe.isFunction(n)&&(i=i||r,r=n,n=void 0),oe.ajax(oe.extend({url:e,type:t,dataType:i,data:n,success:r},oe.isPlainObject(e)&&e))}}),oe._evalUrl=function(e){return oe.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},oe.fn.extend({wrapAll:function(e){var t;return oe.isFunction(e)?this.each(function(t){oe(this).wrapAll(e.call(this,t))}):(this[0]&&(t=oe(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return oe.isFunction(e)?this.each(function(t){oe(this).wrapInner(e.call(this,t))}):this.each(function(){var t=oe(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=oe.isFunction(e);return this.each(function(n){oe(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}}),oe.expr.filters.hidden=function(e){return!oe.expr.filters.visible(e)},oe.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var Dt=/%20/g,jt=/\[\]$/,At=/\r?\n/g,Lt=/^(?:submit|button|image|reset|file)$/i,qt=/^(?:input|select|textarea|keygen)/i;oe.param=function(e,t){var n,r=[],i=function(e,t){t=oe.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(e)||e.jquery&&!oe.isPlainObject(e))oe.each(e,function(){i(this.name,this.value)});else for(n in e)U(n,e[n],t,i);return r.join("&").replace(Dt,"+")},oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=oe.prop(this,"elements");return e?oe.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!oe(this).is(":disabled")&&qt.test(this.nodeName)&&!Lt.test(e)&&(this.checked||!He.test(e))}).map(function(e,t){var n=oe(this).val();return null==n?null:oe.isArray(n)?oe.map(n,function(e){return{name:t.name,value:e.replace(At,"\r\n")}}):{name:t.name,value:n.replace(At,"\r\n")}}).get()}}),oe.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var Ht={0:200,1223:204},Ot=oe.ajaxSettings.xhr();re.cors=!!Ot&&"withCredentials"in Ot,re.ajax=Ot=!!Ot,oe.ajaxTransport(function(t){var n,r;return re.cors||Ot&&!t.crossDomain?{send:function(i,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)a.setRequestHeader(s,i[s]);n=function(e){return function(){n&&(n=r=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Ht[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),r=a.onerror=n("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(u){if(n)throw u}},abort:function(){n&&n()}}:void 0}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return oe.globalEval(e),e}}}),oe.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),oe.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=oe("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),G.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Ft=[],Pt=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ft.pop()||oe.expando+"_"+vt++;return this[e]=!0,e}}),oe.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(Pt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pt.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=oe.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Pt,"$1"+i):t.jsonp!==!1&&(t.url+=(mt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||oe.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){void 0===o?oe(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Ft.push(i)),s&&oe.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),re.createHTMLDocument=function(){var e=G.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),oe.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||(re.createHTMLDocument?G.implementation.createHTMLDocument(""):G);var r=he.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=p([e],t,i),i&&i.length&&oe(i).remove(),oe.merge([],r.childNodes))};var Rt=oe.fn.load;oe.fn.load=function(e,t,n){if("string"!=typeof e&&Rt)return Rt.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>-1&&(r=oe.trim(e.slice(a)),e=e.slice(0,a)),oe.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&oe.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?oe("<div>").append(oe.parseHTML(e)).find(r):e)}).always(n&&function(e,t){s.each(function(){n.apply(s,o||[e.responseText,t,e])})}),this},oe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){oe.fn[t]=function(e){return this.on(t,e)}}),oe.expr.filters.animated=function(e){return oe.grep(oe.timers,function(t){return e===t.elem}).length},oe.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=oe.css(e,"position"),f=oe(e),p={};"static"===c&&(e.style.position="relative"),a=f.offset(),o=oe.css(e,"top"),u=oe.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=f.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),oe.isFunction(t)&&(t=t.call(e,n,oe.extend({},a))),null!=t.top&&(p.top=t.top-a.top+s),null!=t.left&&(p.left=t.left-a.left+i),"using"in t?t.using.call(e,p):f.css(p)}},oe.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){oe.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;if(o)return t=o.documentElement,oe.contains(t,r)?(i=r.getBoundingClientRect(),n=V(o),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===oe.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),oe.nodeName(e[0],"html")||(r=e.offset()),r.top+=oe.css(e[0],"borderTopWidth",!0)-e.scrollTop(),r.left+=oe.css(e[0],"borderLeftWidth",!0)-e.scrollLeft()),{top:t.top-r.top-oe.css(n,"marginTop",!0),left:t.left-r.left-oe.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===oe.css(e,"position");)e=e.offsetParent;return e||Ke})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;oe.fn[e]=function(r){return Ce(this,function(e,r,i){var o=V(e);return void 0===i?o?o[t]:e[r]:void(o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i)},e,r,arguments.length)}}),oe.each(["top","left"],function(e,t){oe.cssHooks[t]=S(re.pixelPosition,function(e,n){return n?(n=N(e,t),Ge.test(n)?oe(e).position()[t]+"px":n):void 0})}),oe.each({Height:"height",Width:"width"},function(e,t){oe.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){oe.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return Ce(this,function(t,n,r){var i;return oe.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?oe.css(t,n,s):oe.style(t,n,r,s)},t,o?r:void 0,o,null)}})}),oe.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},size:function(){return this.length}}),oe.fn.andSelf=oe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return oe});var Mt=e.jQuery,Wt=e.$;return oe.noConflict=function(t){return e.$===oe&&(e.$=Wt),t&&e.jQuery===oe&&(e.jQuery=Mt),oe},t||(e.jQuery=e.$=oe),oe});
},{}],308:[function(require,module,exports){
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var i,r,s=0,n=!1,a=!1,o=!1,d=[],c=e("script:last").attr("src"),l=window.document,h=l.createElement("LI");h.setAttribute("role","treeitem"),i=l.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),h.appendChild(i),i=l.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),r=l.createElement("I"),r.className="jstree-icon jstree-themeicon",r.setAttribute("role","presentation"),i.appendChild(r),h.appendChild(i),i=r=null,e.jstree={version:"3.2.1",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var r=new e.jstree.core(++s),n=i;return i=e.extend(!0,{},e.jstree.defaults,i),n&&n.plugins&&(i.plugins=n.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),e(t).data("jstree",r),r.init(t,i),r},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(l).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var i=null,r=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!r||!r.length)try{r=e(t)}catch(s){}if(!r||!r.length)try{r=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(s){}return r&&r.length&&(r=r.closest(".jstree")).length&&(r=r.data("jstree"))?i=r:e(".jstree").each(function(){var r=e(this).data("jstree");return r&&r._model.data[t]?(i=r,!1):void 0}),i},e.fn.jstree=function(i){var r="string"==typeof i,s=Array.prototype.slice.call(arguments,1),n=null;return i!==!0||this.length?(this.each(function(){var a=e.jstree.reference(this),o=r&&a?a[i]:null;return n=r&&o?o.apply(a,s):null,a||r||i!==t&&!e.isPlainObject(i)||e.jstree.create(this,i),(a&&!r||i===!0)&&(n=a||!1),null!==n&&n!==t?!1:void 0}),null!==n&&n!==t?n:this):!1},e.expr[":"].jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,i){var r=e.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",i=null,r=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(i){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),r=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return e.target.tagName&&"input"===e.target.tagName.toLowerCase()?!0:void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==l.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget),i&&i.id!==e.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),i=this.get_prev_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],i&&e(this._firstChild(i)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),i=this.get_next_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),i=this._firstChild(this.get_container_ul()[0]),i&&e(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",e.proxy(function(t,i){i.status&&(i.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,i,r=[];for(t=0,i=this._data.core.selected.length;i>t;t++)r=r.concat(this._model.data[this._data.core.selected[t]].parents);for(r=e.vakata.array_unique(r),t=0,i=r.length;i>t;t++)this.open_node(r[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(r){if(r.target.tagName&&"input"===r.target.tagName.toLowerCase())return!0;i&&clearTimeout(i),i=setTimeout(function(){t=""},500);var s=String.fromCharCode(r.which).toLowerCase(),n=this.element.find(".jstree-anchor").filter(":visible"),a=n.index(l.activeElement)||0,o=!1;if(t+=s,t.length>1){if(n.slice(a).each(e.proxy(function(i,r){return 0===e(r).text().toLowerCase().indexOf(t)?(e(r).focus(),o=!0,!1):void 0},this)),o)return;if(n.slice(0,a).each(e.proxy(function(i,r){return 0===e(r).text().toLowerCase().indexOf(t)?(e(r).focus(),o=!0,!1):void 0},this)),o)return}if(new RegExp("^"+s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(n.slice(a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===s?(e(i).focus(),o=!0,!1):void 0},this)),o)return;if(n.slice(0,a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===s?(e(i).focus(),o=!0,!1):void 0},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-r>500&&!this._data.core.focused){r=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(l).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return e.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,i){t&&t.id&&(t=t.id);var r;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(r=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=e(t,this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=e(t,this.element)).length||!r.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return i&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(s){return!1}},get_path:function(t,i,r){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var s,n,a=[];for(a.push(r?t.id:t.text),s=0,n=t.parents.length;n>s;s++)a.push(r?t.parents[s]:this.get_text(t.parents[s]));return a=a.reverse().slice(1),i?a.join(i):a},get_next_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);return r?e(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return r?e(r):!1}if(t.hasClass("jstree-open")){for(r=this._firstChild(t.children(".jstree-children")[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);if(null!==r)return e(r)}r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return null!==r?e(r):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&0===r.offsetHeight;)r=this._previousSibling(r);return r?e(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);return r?e(r):!1}r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);if(null!==r){for(t=e(r);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return r=t[0].parentNode.parentNode,r&&r.className&&-1!==r.className.indexOf("jstree-node")?e(r):!1},get_parent:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.parent:!1},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):e&&e.length?e.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var r,s,n,a,o;if(e.isArray(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,r=0,s=t.children_d.length;s>r;r++){for(n=0,a=t.parents.length;a>n;n++)this._model.data[t.parents[n]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[n]].children_d,t.children_d[r]);this._model.data[t.children_d[r]].state.selected&&(o=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[r])),delete this._model.data[t.children_d[r]]}t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var r=this.get_node(t,!0),s=0,n=0,a=this._model.data,o=!1;for(s=0,n=t.children.length;n>s;s++)if(a[t.children[s]]&&!a[t.children[s]].state.hidden){o=!0;break}t.state.loaded&&!o&&r&&r.length&&!r.hasClass("jstree-leaf")&&r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),r.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),i&&i.call(this,t,e)},this)),!0},_load_nodes:function(e,t,i){var r,s,n=!0,a=function(){this._load_nodes(e,t,!0)},o=this._model.data,d=[];for(r=0,s=e.length;s>r;r++)!o[e[r]]||(o[e[r]].state.loaded||o[e[r]].state.failed)&&i||(this.is_loading(e[r])||this.load_node(e[r],a),n=!1);if(n){for(r=0,s=e.length;s>r;r++)o[e[r]]&&o[e[r]].state.loaded&&d.push(e[r]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,s,n=[],a=this._model.data,o=a[t.id].children_d;for(t.state&&!t.state.loaded&&n.push(t.id),r=0,s=o.length;s>r;r++)a[o[r]]&&a[o[r]].state&&!a[o[r]].state.loaded&&n.push(o[r]);n.length?this._load_nodes(n,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var r,s=this.settings.core.data;return s?e.isFunction(s)?s.call(this,t,e.proxy(function(r){r===!1&&i.call(this,!1),this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(e){i.call(this,e)})},this)):"object"==typeof s?s.url?(s=e.extend(!0,{},s),e.isFunction(s.url)&&(s.url=s.url.call(this,t)),e.isFunction(s.data)&&(s.data=s.data.call(this,t)),e.ajax(s).done(e.proxy(function(r,s,n){var a=n.getResponseHeader("Content-Type");return a&&-1!==a.indexOf("json")||"object"==typeof r?this._append_json_data(t,r,function(e){i.call(this,e)}):a&&-1!==a.indexOf("html")||"string"==typeof r?this._append_html_data(t,e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(e.proxy(function(e){i.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(r=e.isArray(s)||e.isPlainObject(s)?JSON.parse(JSON.stringify(s)):s,t.id===e.jstree.root?this._append_json_data(t,r,function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof s?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)}):i.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,i,r){t=this.get_node(t),t.children=[],t.children_d=[];var s,n,a,o=i.is("ul")?i.children():i,d=t.id,c=[],l=[],h=this._model.data,_=h[d],u=this._data.core.selected.length;for(o.each(e.proxy(function(t,i){s=this._parse_model_from_html(e(i),d,_.parents.concat()),s&&(c.push(s),l.push(s),h[s].children_d.length&&(l=l.concat(h[s].children_d)))},this)),_.children=c,_.children_d=l,n=0,a=_.parents.length;a>n;n++)h[_.parents[n]].children_d=h[_.parents[n]].children_d.concat(l);this.trigger("model",{nodes:l,parent:d}),d!==e.jstree.root?(this._node_changed(d),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==u&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)},_append_json_data:function(t,i,r,s){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],i.d&&(i=i.d,"string"==typeof i&&(i=JSON.parse(i))),e.isArray(i)||(i=[i]);var n=null,a={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var i,r,s,n,a=e.dat,o=e.par,d=[],c=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,g=e.m,f=g[o],p=e.sel,m=function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d=e.id.toString(),c={id:d,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(c.state[s]=h[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(c.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(c.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(c.li_attr[s]=e.li_attr[s]);if(c.li_attr.id||(c.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(c.a_attr[s]=e.a_attr[s]);for(e&&e.children&&e.children===!0&&(c.state.loaded=!1,c.children=[],c.children_d=[]),g[c.id]=c,s=0,n=c.children.length;n>s;s++)a=m(g[c.children[s]],c.id,r),o=g[a],c.children_d.push(a),o.children_d.length&&(c.children_d=c.children_d.concat(o.children_d));return delete e.data,delete e.children,g[c.id].original=e,c.state.selected&&l.push(c.id),c.id},v=function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d,c=!1;do c="j"+_+"_"+ ++u;while(g[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;n>s;s++)a=v(e.children[s],d.id,r),o=g[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,g[d.id]=d,d.state.selected&&l.push(d.id),d.id};if(a.length&&a[0].id!==t&&a[0].parent!==t){for(r=0,s=a.length;s>r;r++)a[r].children||(a[r].children=[]),g[a[r].id.toString()]=a[r];for(r=0,s=a.length;s>r;r++)g[a[r].parent.toString()].children.push(a[r].id.toString()),f.children_d.push(a[r].id.toString());for(r=0,s=f.children.length;s>r;r++)i=m(g[f.children[r]],o,f.parents.concat()),c.push(i),g[i].children_d.length&&(c=c.concat(g[i].children_d));for(r=0,s=f.parents.length;s>r;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(c);n={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}else{for(r=0,s=a.length;s>r;r++)i=v(a[r],o,f.parents.concat()),i&&(d.push(i),c.push(i),g[i].children_d.length&&(c=c.concat(g[i].children_d)));for(f.children=d,f.children_d=c,r=0,s=f.parents.length;s>r;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(c);n={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?n:void postMessage(n)},d=function(t,i){if(null!==this.element){if(this._cnt=t.cnt,this._model.data=t.mod,i){var s,n,a=t.add,o=t.sel,d=this._data.core.selected.slice(),c=this._model.data;if(o.length!==d.length||e.vakata.array_unique(o.concat(d)).length!==o.length){for(s=0,n=o.length;n>s;s++)-1===e.inArray(o[s],a)&&-1===e.inArray(o[s],d)&&(c[o[s]].state.selected=!1);for(s=0,n=d.length;n>s;s++)-1===e.inArray(d[s],o)&&(c[d[s]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||s?(this._data.core.working=!0,n=new window.Worker(this._wrk),n.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{n.terminate(),n=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?n.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,r,!0])}catch(c){d.call(this,o(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,o(a),!1)}},_parse_model_from_html:function(i,r,s){s=s?[].concat(s):[],r&&s.unshift(r);var n,a,o,d,c,l=this._model.data,h={id:!1,text:!1,icon:!0,parent:r,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(d=e.vakata.attributes(i,!0),e.each(d,function(t,i){return i=e.trim(i),i.length?(h.li_attr[t]=i,void("id"===t&&(h.id=i.toString()))):!0}),d=i.children("a").first(),d.length&&(d=e.vakata.attributes(d,!0),e.each(d,function(t,i){i=e.trim(i),i.length&&(h.a_attr[t]=i)})),d=i.children("a").first().length?i.children("a").first().clone():i.clone(),d.children("ins, i, ul").remove(),d=d.html(),d=e("<div />").html(d),h.text=this.settings.core.force_text?d.text():d.html(),d=i.data(),h.data=d?e.extend(!0,{},d):null,h.state.opened=i.hasClass("jstree-open"),h.state.selected=i.children("a").hasClass("jstree-clicked"),h.state.disabled=i.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);d=i.children("a").children(".jstree-themeicon"),d.length&&(h.icon=d.hasClass("jstree-themeicon-hidden")?!1:d.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),d=i.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,d.length?(d.each(e.proxy(function(t,i){n=this._parse_model_from_html(e(i),h.id,s),a=this._model.data[n],h.children.push(n),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):i.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),l[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d=e.id.toString(),c=this._model.data,l=this._model.default_state,h={id:d,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in l)l.hasOwnProperty(s)&&(h.state[s]=l[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(h.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(h.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(h.li_attr[s]=e.li_attr[s]);if(h.li_attr.id||(h.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(h.a_attr[s]=e.a_attr[s]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,s=0,n=h.children.length;n>s;s++)a=this._parse_model_from_flat_json(c[h.children[s]],h.id,r),o=c[a],h.children_d.push(a),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d,c=!1,l=this._model.data,h=this._model.default_state;do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;n>s;s++)a=this._parse_model_from_json(e.children[s],d.id,r),o=l[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,l[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,i,r,s=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),n=l.createElement("UL"),a=this._data.core.focused;for(i=0,r=s.length;r>i;i++)t=this.redraw_node(s[i],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&n.appendChild(t);this._model.force_full_redraw&&(n.className=this.get_container_ul()[0].className,n.setAttribute("role","group"),this.element.empty().append(n)),null!==a&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==l.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:s})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var i=this.get_node(t),r=!1,s=!1,n=!1,a=l;if(!i)return!1;if(i.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],i.children.length&&i.state.loaded){for(n=a.createElement("UL"),n.setAttribute("role","group"),n.className="jstree-children",r=0,s=i.children.length;s>r;r++)n.appendChild(this.redraw_node(i.children[r],!0,!0));t.appendChild(n)}},redraw_node:function(t,i,r,s){var n=this.get_node(t),a=!1,o=!1,d=!1,c=!1,_=!1,u=!1,g="",f=l,p=this._model.data,m=!1,v=null,j=0,y=0,k=!1,x=!1;if(!n)return!1;if(n.id===e.jstree.root)return this.redraw(!0);if(i=i||0===n.children.length,t=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(n.id[0])?"\\3"+n.id[0]+" "+n.id.substr(1).replace(e.jstree.idregex,"\\$&"):n.id.replace(e.jstree.idregex,"\\$&"))):l.getElementById(n.id))t=e(t),r||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),o=t.index()),i||!n.children.length||t.children(".jstree-children").length||(i=!0),
i||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===l.activeElement,t.remove();else if(i=!0,!r){if(a=n.parent!==e.jstree.root?e("#"+n.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===a||a&&p[n.parent].state.opened))return!1;o=e.inArray(n.id,null===a?p[e.jstree.root].children:p[n.parent].children)}t=h.cloneNode(!0),g="jstree-node ";for(c in n.li_attr)if(n.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,n.li_attr[c]):g+=n.li_attr[c]}for(n.a_attr.id||(n.a_attr.id=n.id+"_anchor"),t.setAttribute("aria-selected",!!n.state.selected),t.setAttribute("aria-level",n.parents.length),t.setAttribute("aria-labelledby",n.a_attr.id),n.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,_=n.children.length;_>c;c++)if(!p[n.children[c]].state.hidden){k=!0;break}if(null!==n.parent&&p[n.parent]&&!n.state.hidden&&(c=e.inArray(n.id,p[n.parent].children),x=n.id,-1!==c))for(c++,_=p[n.parent].children.length;_>c&&(p[p[n.parent].children[c]].state.hidden||(x=p[n.parent].children[c]),x===n.id);c++);n.state.hidden&&(g+=" jstree-hidden"),n.state.loaded&&!k?g+=" jstree-leaf":(g+=n.state.opened&&n.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",n.state.opened&&n.state.loaded)),x===n.id&&(g+=" jstree-last"),t.id=n.id,t.className=g,g=(n.state.selected?" jstree-clicked":"")+(n.state.disabled?" jstree-disabled":"");for(_ in n.a_attr)if(n.a_attr.hasOwnProperty(_)){if("href"===_&&"#"===n.a_attr[_])continue;"class"!==_?t.childNodes[1].setAttribute(_,n.a_attr[_]):g+=" "+n.a_attr[_]}if(g.length&&(t.childNodes[1].className="jstree-anchor "+g),(n.icon&&n.icon!==!0||n.icon===!1)&&(n.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===n.icon.indexOf("/")&&-1===n.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+n.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+n.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(f.createTextNode(n.text)):t.childNodes[1].innerHTML+=n.text,i&&n.children.length&&(n.state.opened||s)&&n.state.loaded){for(u=f.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,_=n.children.length;_>c;c++)u.appendChild(this.redraw_node(n.children[c],i,!0));t.appendChild(u)}if(d&&t.appendChild(d),!r){for(a||(a=this.element[0]),c=0,_=a.childNodes.length;_>c;c++)if(a.childNodes[c]&&a.childNodes[c].className&&-1!==a.childNodes[c].className.indexOf("jstree-children")){v=a.childNodes[c];break}v||(v=f.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",a.appendChild(v)),a=v,o<a.childNodes.length?a.insertBefore(t,a.childNodes[o]):a.appendChild(t),m&&(j=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=j,this.element[0].scrollLeft=y)}return n.state.opened&&!n.state.loaded&&(n.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(n.id,!1,0)},this),0)),t},open_node:function(i,r,s){var n,a,o,d;if(e.isArray(i)){for(i=i.slice(),n=0,a=i.length;a>n;n++)this.open_node(i[n],r,s);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?(s=s===t?this.settings.core.animation:s,this.is_closed(i)?this.is_loaded(i)?(o=this.get_node(i,!0),d=this,o.length&&(s&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(i),s?(this.trigger("before_open",{node:i}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(s,function(){this.style.display="",d.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,r&&r.call(this,i,!0),o.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),s&&o.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(e.proxy(function(){this.open_node(i,r,s)},this),500):void this.load_node(i,function(e,t){return t?this.open_node(e,r,s):r?r.call(this,e,!1):!1}):(r&&r.call(this,i,!1),!1)):!1},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i,r,s=t.parents;for(i=0,r=s.length;r>i;i+=1)i!==e.jstree.root&&this.open_node(s[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,r){var s,n,a,o;if(e.isArray(i)){for(i=i.slice(),s=0,n=i.length;n>s;s++)this.close_node(i[s],r);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?this.is_closed(i)?!1:(r=r===t?this.settings.core.animation:r,a=this,o=this.get_node(i,!0),o.length&&(r?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="",o.children(".jstree-children").remove(),a.trigger("after_close",{node:i})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove())),i.state.opened=!1,this.trigger("close_node",{node:i}),void(r&&o.length||this.trigger("after_close",{node:i}))):!1},toggle_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,r){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var s,n,a,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(s=0,n=t.children_d.length;n>s;s++)this.is_closed(this._model.data[t.children_d[s]])&&(this._model.data[t.children_d[s]].state.opened=!0);return this.trigger("open_all",{node:t})}r=r||o,a=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,r)},i||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,s,n=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(n.length&&(n=this.is_open(t)?n.find(".jstree-open").addBack():n.find(".jstree-open"),e(n.get().reverse()).each(function(){a.close_node(this,i||0)})),r=0,s=t.children_d.length;s>r;r++)this._model.data[t.children_d[r]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.enable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t})):!1},disable_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.disable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t})):!1},hide_node:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.hide_node(t[r],!0);return this.redraw(),!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t}))):!1},show_node:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.show_node(t[r],!0);return this.redraw(),!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t}))):!1},hide_all:function(t){var i,r=this._model.data,s=[];for(i in r)r.hasOwnProperty(i)&&i!==e.jstree.root&&!r[i].state.hidden&&(r[i].state.hidden=!0,s.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:s}),s},show_all:function(t){var i,r=this._model.data,s=[];for(i in r)r.hasOwnProperty(i)&&i!==e.jstree.root&&r[i].state.hidden&&(r[i].state.hidden=!1,s.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:s}),s},activate_node:function(e,i){if(this.is_disabled(e))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(i.shiftKey){var r,s,n=this.get_node(e).id,a=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(r=0,s=o.length;s>r;r+=1)o[r]===n&&(d=!d),o[r]===a&&(d=!d),this.is_disabled(o[r])||!d&&o[r]!==n&&o[r]!==a?this.deselect_node(o[r],!0,i):this.select_node(o[r],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):this.select_node(e,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):(this.deselect_all(!0),this.select_node(e,!1,!1,i),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),e&&e.length&&e.children(".jstree-hovered").length?(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)})):!1},select_node:function(t,i,r,s){var n,a,o;if(e.isArray(t)){for(t=t.slice(),a=0,o=t.length;o>a;a++)this.select_node(t[a],i,r,s);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),r||(n=this._open_to(t)),n&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:s}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:s})))):!1},deselect_node:function(t,i,r){var s,n,a;if(e.isArray(t)){for(t=t.slice(),s=0,n=t.length;n>s;s++)this.deselect_node(t[s],i,r);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(a=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r})))):!1},select_all:function(t){var i,r,s=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),i=0,r=this._data.core.selected.length;r>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:s})},deselect_all:function(e){var t,i,r=this._data.core.selected.concat([]);for(t=0,i=this._data.core.selected.length;i>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:r}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:r})},is_selected:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.state.selected:!1},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i,r,s,n,a=this.get_selected(!0),o={};for(i=0,r=a.length;r>i;i++)o[a[i].id]=a[i];for(i=0,r=a.length;r>i;i++)for(s=0,n=a[i].children_d.length;n>s;s++)o[a[i].children_d[s]]&&delete o[a[i].children_d[s]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var i,r,s=this.get_selected(!0),n=[];for(i=0,r=s.length;r>i;i++)s[i].children.length||n.push(s[i].id);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},get_state:function(){var t,i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,r){if(i){if(i.core){var s,n;if(i.core.open)return e.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(e){this.open_node(e,!1,0),delete i.core.open,this.set_state(i,r)},!0):(delete i.core.open,this.set_state(i,r)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,r),!1;if(i.core.selected)return s=this,this.deselect_all(),e.each(i.core.selected,function(e,t){s.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,r),!1;for(n in i)i.hasOwnProperty(n)&&"core"!==n&&-1===e.inArray(n,this.settings.plugins)&&delete i[n];if(e.isEmptyObject(i.core))return delete i.core,this.set_state(i,r),!1}return e.isEmptyObject(i)?(i=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state(),i&&e.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var r=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i=[],r=[];this._data.core.selected.concat([]);r.push(t.id),t.state.opened===!0&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)}),this._load_nodes(r,e.proxy(function(e){this.open_node(i,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var r,s,n=this._model.data;for(i=i.toString(),n[t.parent].children[e.inArray(t.id,n[t.parent].children)]=i,r=0,s=t.parents.length;s>r;r++)n[t.parents[r]].children_d[e.inArray(t.id,n[t.parents[r]].children_d)]=i;for(r=0,s=t.children.length;s>r;r++)n[t.children[r]].parent=i;for(r=0,s=t.children_d.length;s>r;r++)n[t.children_d[r]].parents[e.inArray(t.id,n[t.children_d[r]].parents)]=i;return r=e.inArray(t.id,this._data.core.selected),-1!==r&&(this._data.core.selected[r]=i),r=this.get_node(t.id,!0),r&&(r.attr("id",i).children(".jstree-anchor").attr("id",i+"_anchor").end().attr("aria-labelledby",i+"_anchor"),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete n[t.id],t.id=i,t.li_attr.id=i,n[i]=t,!0},get_text:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.text:!1},set_text:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.set_text(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0):!1},get_json:function(t,i,r){if(t=this.get_node(t||e.jstree.root),!t)return!1;i&&i.flat&&!r&&(r=[]);var s,n,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:i&&i.no_data?!1:e.extend(!0,{},t.data)};if(i&&i.flat?a.parent=t.parent:a.children=[],!i||!i.no_state)for(s in t.state)t.state.hasOwnProperty(s)&&(a.state[s]=t.state[s]);if(i&&i.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),i&&i.flat&&t.id!==e.jstree.root&&r.push(a),!i||!i.no_children)for(s=0,n=t.children.length;n>s;s++)i&&i.flat?this.get_json(t.children[s],i,r):a.children.push(this.get_json(t.children[s],i));return i&&i.flat?r:t.id===e.jstree.root?a.children:a},create_node:function(i,r,s,n,a){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return!1;if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,r,s,n,!0)});r||(r={text:this.get_string("New node")}),"string"==typeof r&&(r={text:r}),r.text===t&&(r.text=this.get_string("New node"));var o,d,c,l;switch(i.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":o=this.get_node(i.parent),s=e.inArray(i.id,o.children),i=o;break;case"after":o=this.get_node(i.parent),s=e.inArray(i.id,o.children)+1,i=o;break;case"inside":case"first":s=0;break;case"last":s=i.children.length;break;default:s||(s=0)}if(s>i.children.length&&(s=i.children.length),r.id||(r.id=!0),!this.check("create_node",r,i,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,i.id,i.parents.concat()),!r)return!1;for(o=this.get_node(r),d=[],d.push(r),d=d.concat(o.children_d),this.trigger("model",{nodes:d,parent:i.id}),i.children_d=i.children_d.concat(d),c=0,l=i.parents.length;l>c;c++)this._model.data[i.parents[c]].children_d=this._model.data[i.parents[c]].children_d.concat(d);for(r=o,o=[],c=0,l=i.children.length;l>c;c++)o[c>=s?c+1:c]=i.children[c];return o[s]=r.id,i.children=o,this.redraw_node(i,!0),n&&n.call(this,this.get_node(r)),this.trigger("create_node",{node:this.get_node(r),parent:i.id,position:s}),r.id},rename_node:function(t,i){var r,s,n;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.rename_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:n}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(t){var i,r,s,n,a,o,d,c,l,h,_,u;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.delete_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(s=this.get_node(t.parent),n=e.inArray(t.id,s.children),h=!1,!this.check("delete_node",t,s,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==n&&(s.children=e.vakata.array_remove(s.children,n)),a=t.children_d.concat([]),a.push(t.id),c=0,l=a.length;l>c;c++){for(o=0,d=t.parents.length;d>o;o++)n=e.inArray(a[c],this._model.data[t.parents[o]].children_d),-1!==n&&(this._model.data[t.parents[o]].children_d=e.vakata.array_remove(this._model.data[t.parents[o]].children_d,n));this._model.data[a[c]].state.selected&&(h=!0,n=e.inArray(a[c],this._data.core.selected),-1!==n&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,n)))}for(this.trigger("delete_node",{node:t,parent:s.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:s.id}),c=0,l=a.length;l>c;c++)delete this._model.data[a[c]];return-1!==e.inArray(this._data.core.focused,a)&&(this._data.core.focused=null,_=this.element[0].scrollTop,u=this.element[0].scrollLeft,s.id===e.jstree.root?this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(s,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=_,this.element[0].scrollLeft=u),this.redraw_node(s,!0),!0},check:function(t,i,r,s,n){i=i&&i.id?i:this.get_node(i),r=r&&r.id?r:this.get_node(r);var a=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||n&&n.is_multi||i.id!==r.id&&e.inArray(i.id,r.children)!==s&&-1===e.inArray(r.id,i.children_d)?(a&&a.data&&(a=a.data),a&&a.functions&&(a.functions[t]===!1||a.functions[t]===!0)?(a.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),a.functions[t]):o===!1||e.isFunction(o)&&o.call(this,t,i,r,s,n)===!1||o&&o[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1):!0):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(i,r,s,n,a,o,d){var c,l,h,_,u,g,f,p,m,v,j,y,k,x;if(r=this.get_node(r),s=s===t?0:s,!r)return!1;if(!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(i,r,s,n,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(c=0,l=i.length;l>c;c++)(m=this.move_node(i[c],r,s,n,a,!1,d))&&(r=m,s="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;if(h=(i.parent||e.jstree.root).toString(),u=s.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,g=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),f=!g||!g._id||this._id!==g._id,_=g&&g._id&&h&&g._model.data[h]&&g._model.data[h].children?e.inArray(i.id,g._model.data[h].children):-1,g&&g._id&&(i=g._model.data[i.id]),f)return(m=this.copy_node(i,r,s,n,a,!1,d))?(g&&g.delete_node(i),m):!1;switch(r.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(r.id,u.children);break;case"after":s=e.inArray(r.id,u.children)+1;break;case"inside":case"first":s=0;break;case"last":s=u.children.length;break;default:s||(s=0)}if(s>u.children.length&&(s=u.children.length),!this.check("move_node",i,u,s,{core:!0,origin:d,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===u.id){for(p=u.children.concat(),m=e.inArray(i.id,p),-1!==m&&(p=e.vakata.array_remove(p,m),s>m&&s--),m=[],v=0,j=p.length;j>v;v++)m[v>=s?v+1:v]=p[v];m[s]=i.id,u.children=m,this._node_changed(u.id),this.redraw(u.id===e.jstree.root)}else{for(m=i.children_d.concat(),m.push(i.id),v=0,j=i.parents.length;j>v;v++){for(p=[],x=g._model.data[i.parents[v]].children_d,y=0,k=x.length;k>y;y++)-1===e.inArray(x[y],m)&&p.push(x[y]);g._model.data[i.parents[v]].children_d=p}for(g._model.data[h].children=e.vakata.array_remove_item(g._model.data[h].children,i.id),v=0,j=u.parents.length;j>v;v++)this._model.data[u.parents[v]].children_d=this._model.data[u.parents[v]].children_d.concat(m);for(p=[],v=0,j=u.children.length;j>v;v++)p[v>=s?v+1:v]=u.children[v];for(p[s]=i.id,u.children=p,u.children_d.push(i.id),u.children_d=u.children_d.concat(i.children_d),i.parent=u.id,m=u.parents.concat(),m.unshift(u.id),x=i.parents.length,i.parents=m,m=m.concat(),v=0,j=i.children_d.length;j>v;v++)this._model.data[i.children_d[v]].parents=this._model.data[i.children_d[v]].parents.slice(0,-1*x),Array.prototype.push.apply(this._model.data[i.children_d[v]].parents,m);h!==e.jstree.root&&u.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(u.id)),o||this.redraw()}return n&&n.call(this,i,u,s),this.trigger("move_node",{node:i,parent:u.id,position:s,old_parent:h,old_position:_,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this}),i.id},copy_node:function(i,r,s,n,a,o,d){var c,l,h,_,u,g,f,p,m,v,j;if(r=this.get_node(r),s=s===t?0:s,!r)return!1;if(!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(i,r,s,n,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(c=0,l=i.length;l>c;c++)(_=this.copy_node(i[c],r,s,n,a,!0,d))&&(r=_,s="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;switch(p=(i.parent||e.jstree.root).toString(),m=s.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,v=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),j=!v||!v._id||this._id!==v._id,v&&v._id&&(i=v._model.data[i.id]),r.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(r.id,m.children);break;case"after":s=e.inArray(r.id,m.children)+1;break;case"inside":case"first":s=0;break;case"last":s=m.children.length;break;default:s||(s=0)}if(s>m.children.length&&(s=m.children.length),!this.check("copy_node",i,m,s,{core:!0,origin:d,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(f=v?v.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!f)return!1;if(f.id===!0&&delete f.id,f=this._parse_model_from_json(f,m.id,m.parents.concat()),!f)return!1;for(_=this.get_node(f),i&&i.state&&i.state.loaded===!1&&(_.state.loaded=!1),h=[],h.push(f),h=h.concat(_.children_d),this.trigger("model",{nodes:h,parent:m.id}),u=0,g=m.parents.length;g>u;u++)this._model.data[m.parents[u]].children_d=this._model.data[m.parents[u]].children_d.concat(h);for(h=[],u=0,g=m.children.length;g>u;u++)h[u>=s?u+1:u]=m.children[u];return h[s]=_.id,m.children=h,m.children_d.push(_.id),m.children_d=m.children_d.concat(_.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),n&&n.call(this,_,m,s),this.trigger("copy_node",{node:_,original:i,parent:m.id,position:s,old_parent:p,old_position:v&&v._id&&p&&v._model.data[p]&&v._model.data[p].children?e.inArray(i.id,v._model.data[p].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),_.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,r,s,d=[];for(r=0,s=t.length;s>r;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return d.length?(n=d,o=this,a="move_node",void this.trigger("cut",{node:t})):!1},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,r,s,d=[];for(r=0,s=t.length;s>r;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return d.length?(n=d,o=this,a="copy_node",void this.trigger("copy",{node:t})):!1},get_buffer:function(){return{mode:a,node:n,inst:o}},can_paste:function(){return a!==!1&&n!==!1},paste:function(e,t){return e=this.get_node(e),e&&a&&a.match(/^(copy_node|move_node)$/)&&n?(this[a](n,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:n,mode:a}),n=!1,a=!1,void(o=!1)):!1},clear_buffer:function(){n=!1,a=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,i,r){var s,n,a,o,d,c,l,h,_,u=!1;return(t=this.get_node(t))?this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(_=t,i="string"==typeof i?i:t.text,this.set_text(t,""),t=this._open_to(t),_.text=i,s=this._data.core.rtl,n=this.element.width(),this._data.core.focused=_.id,a=t.children(".jstree-anchor").focus(),o=e("<span>"),d=i,c=e("<div />",{css:{position:"absolute",top:"-200px",left:s?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),l=e("<input />",{value:d,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation(),i.preventDefault();var s,n=o.children(".jstree-rename-input"),l=n.val(),h=this.settings.core.force_text;""===l&&(l=d),c.remove(),o.replaceWith(a),o.remove(),d=h?d:e("<div></div>").append(e.parseHTML(d)).html(),this.set_text(t,d),s=!!this.rename_node(t,h?e("<div></div>").text(l).text():e("<div></div>").append(e.parseHTML(l)).html()),s||this.set_text(t,d),this._data.core.focused=_.id,setTimeout(e.proxy(function(){var e=this.get_node(_.id,!0);e.length&&(this._data.core.focused=_.id,e.children(".jstree-anchor").focus())},this),0),r&&r.call(this,_,s,u)},this),keydown:function(e){var t=e.which;27===t&&(u=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){l.width(Math.min(c.text("pW"+this.value).width(),n))},keypress:function(e){return 13===e.which?!1:void 0}}),h={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},o.attr("class",a.attr("class")).append(a.contents().clone()).append(l),a.replaceWith(o),c.css(h),void l.css(h).width(Math.min(c.text("pW"+l[0].value).width(),n))[0].select()):!1},set_theme:function(t,i){if(!t)return!1;if(i===!0){var r=this.settings.core.themes.dir;r||(r=e.jstree.path+"/themes"),i=r+"/"+t+"/style.css"}i&&-1===e.inArray(i,d)&&(e("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),d.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),
this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,r){var s,n,a,o;if(e.isArray(i)){for(i=i.slice(),s=0,n=i.length;n>s;s++)this.set_icon(i[s],r);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?(o=i.icon,i.icon=r===!0||null===r||r===t||""===r?!0:r,a=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),r===!1?this.hide_icon(i):r===!0||null===r||r===t||""===r?(a.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),o===!1&&this.show_icon(i)):-1===r.indexOf("/")&&-1===r.indexOf(".")?(a.removeClass(o).css("background",""),a.addClass(r+" jstree-themeicon-custom").attr("rel",r),o===!1&&this.show_icon(i)):(a.removeClass(o).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r),o===!1&&this.show_icon(i)),!0):!1},get_icon:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.icon:!1},hide_icon:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.hide_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==e.jstree.root?(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.show_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==e.jstree.root?(s=this.get_node(t,!0),t.icon=s.length?s.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),s.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},e.vakata={},e.vakata.attributes=function(t,i){t=e(t)[0];var r=i?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,s){-1===e.inArray(s.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==s.value&&""!==e.trim(s.value)&&(i?r[s.name]=s.value:r.push(s.name))}),r},e.vakata.array_unique=function(e){var i,r,s=[],n={};for(i=0,r=e.length;r>i;i++)n[e[i]]===t&&(s.push(e[i]),n[e[i]]=!0);return s},e.vakata.array_remove=function(e,t,i){var r=e.slice((i||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,r),e},e.vakata.array_remove_item=function(t,i){var r=e.inArray(i,t);return-1!==r?e.vakata.array_remove(t,r):t},e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,r){var s,n;if(r||(r={}),"changed"===e.replace(".jstree","")){r.changed={selected:[],deselected:[]};var a={};for(s=0,n=i.length;n>s;s++)a[i[s]]=1;for(s=0,n=r.selected.length;n>s;s++)a[r.selected[s]]?a[r.selected[s]]=2:r.changed.selected.push(r.selected[s]);for(s=0,n=i.length;n>s;s++)1===a[i[s]]&&r.changed.deselected.push(i[s]);i=r.selected.slice()}t.trigger.call(this,e,r)},this.refresh=function(e,r){return i=[],t.refresh.apply(this,arguments)}};var _=l.createElement("I");_.className="jstree-icon jstree-checkbox",_.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(i,r){this.bind=function(){r.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var i,r,s=this._model.data,n=(s[t.parent],t.nodes);for(i=0,r=n.length;r>i;i++)s[n[i]].state.checked=s[n[i]].state.checked||s[n[i]].original&&s[n[i]].original.state&&s[n[i]].original.state.checked,s[n[i]].state.checked&&this._data.checkbox.selected.push(n[i])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",e.proxy(function(t,i){var r,s,n,a,o,d,c=this._model.data,l=c[i.parent],h=i.nodes,_=[],u=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(-1!==u.indexOf("down"))if(l.state[g?"selected":"checked"]){for(s=0,n=h.length;n>s;s++)c[h[s]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(h)}else for(s=0,n=h.length;n>s;s++)if(c[h[s]].state[g?"selected":"checked"]){for(a=0,o=c[h[s]].children_d.length;o>a;a++)c[c[h[s]].children_d[a]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(c[h[s]].children_d)}if(-1!==u.indexOf("up")){for(s=0,n=l.children_d.length;n>s;s++)c[l.children_d[s]].children.length||_.push(c[l.children_d[s]].parent);for(_=e.vakata.array_unique(_),a=0,o=_.length;o>a;a++)for(l=c[_[a]];l&&l.id!==e.jstree.root;){for(r=0,s=0,n=l.children.length;n>s;s++)r+=c[l.children[s]].state[g?"selected":"checked"];if(r!==n)break;l.state[g?"selected":"checked"]=!0,this._data[g?"core":"checkbox"].selected.push(l.id),d=this.get_node(l,!0),d&&d.length&&d.attr("aria-selected",!0).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}}this._data[g?"core":"checkbox"].selected=e.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var r,s,n,a,o=i.node,d=this._model.data,c=this.get_node(o.parent),l=this.get_node(o,!0),h=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==h.indexOf("down"))for(this._data[_?"core":"checkbox"].selected=e.vakata.array_unique(this._data[_?"core":"checkbox"].selected.concat(o.children_d)),r=0,s=o.children_d.length;s>r;r++)a=d[o.children_d[r]],a.state[_?"selected":"checked"]=!0,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&c.id!==e.jstree.root;){for(n=0,r=0,s=c.children.length;s>r;r++)n+=d[c.children[r]].state[_?"selected":"checked"];if(n!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),a=this.get_node(c,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}-1!==h.indexOf("down")&&l.length&&l.find(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var r,s,n,a=this.get_node(e.jstree.root),o=this._model.data;for(r=0,s=a.children_d.length;s>r;r++)n=o[a.children_d[r]],n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var r,s,n,a=i.node,o=this.get_node(a,!0),d=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection;if(a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),-1!==d.indexOf("down"))for(r=0,s=a.children_d.length;s>r;r++)n=this._model.data[a.children_d[r]],n.state[c?"selected":"checked"]=!1,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1);if(-1!==d.indexOf("up"))for(r=0,s=a.parents.length;s>r;r++)n=this._model.data[a.parents[r]],n.state[c?"selected":"checked"]=!1,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1),n=this.get_node(a.parents[r],!0),n&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(n=[],r=0,s=this._data[c?"core":"checkbox"].selected.length;s>r;r++)-1!==d.indexOf("down")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[r],a.children_d)||-1!==d.indexOf("up")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[r],a.parents)||n.push(this._data[c?"core":"checkbox"].selected[r]);this._data[c?"core":"checkbox"].selected=e.vakata.array_unique(n),-1!==d.indexOf("down")&&o.length&&o.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,i){for(var r,s,n,a,o=this.get_node(i.parent),d=this._model.data,c=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[c?"selected":"checked"];){for(n=0,r=0,s=o.children.length;s>r;r++)n+=d[o.children[r]].state[c?"selected":"checked"];if(!(s>0&&n===s))break;o.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(o.id),a=this.get_node(o,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var r,s,n,a,o,d=i.is_multi,c=i.old_parent,l=this.get_node(i.parent),h=this._model.data,_=this.settings.checkbox.tie_selection;if(!d)for(r=this.get_node(c);r&&r.id!==e.jstree.root&&!r.state[_?"selected":"checked"];){for(s=0,n=0,a=r.children.length;a>n;n++)s+=h[r.children[n]].state[_?"selected":"checked"];if(!(a>0&&s===a))break;r.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),r=this.get_node(r.parent)}for(r=l;r&&r.id!==e.jstree.root;){for(s=0,n=0,a=r.children.length;a>n;n++)s+=h[r.children[n]].state[_?"selected":"checked"];if(s===a)r.state[_?"selected":"checked"]||(r.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"));else{if(!r.state[_?"selected":"checked"])break;r.state[_?"selected":"checked"]=!1,this._data[_?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[_?"core":"checkbox"].selected,r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(_?"jstree-clicked":"jstree-checked")}r=this.get_node(r.parent)}},this))},this._undetermined=function(){if(null!==this.element){var i,r,s,n,a={},o=this._model.data,d=this.settings.checkbox.tie_selection,c=this._data[d?"core":"checkbox"].selected,l=[],h=this;for(i=0,r=c.length;r>i;i++)if(o[c[i]]&&o[c[i]].parents)for(s=0,n=o[c[i]].parents.length;n>s;s++)a[o[c[i]].parents[s]]===t&&o[c[i]].parents[s]!==e.jstree.root&&(a[o[c[i]].parents[s]]=!0,l.push(o[c[i]].parents[s]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var d,c=h.get_node(this);if(c.state.loaded){for(i=0,r=c.children_d.length;r>i;i++)if(d=o[c.children_d[i]],!d.state.loaded&&d.original&&d.original.state&&d.original.state.undetermined&&d.original.state.undetermined===!0)for(a[d.id]===t&&d.id!==e.jstree.root&&(a[d.id]=!0,l.push(d.id)),s=0,n=d.parents.length;n>s;s++)a[d.parents[s]]===t&&d.parents[s]!==e.jstree.root&&(a[d.parents[s]]=!0,l.push(d.parents[s]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(a[c.id]===t&&c.id!==e.jstree.root&&(a[c.id]=!0,l.push(c.id)),s=0,n=c.parents.length;n>s;s++)a[c.parents[s]]===t&&c.parents[s]!==e.jstree.root&&(a[c.parents[s]]=!0,l.push(c.parents[s]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,r=l.length;r>i;i++)o[l[i]].state[d?"selected":"checked"]||(c=this.get_node(l[i],!0),c&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,i,s,n){if(t=r.redraw_node.apply(this,arguments)){var a,o,d=null,c=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){d=t.childNodes[a];break}d&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(d.className+=" jstree-checked"),c=_.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),d.insertBefore(c,d.childNodes[0]))}return s||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var i,r,s=this.settings.checkbox.cascade,n=this.settings.checkbox.tie_selection,a=this._data[n?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[n?"selected":"checked"]===!0||-1===s.indexOf("undetermined")||-1===s.indexOf("down")&&-1===s.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,r=t.children_d.length;r>i;i++)if(-1!==e.inArray(t.children_d[i],a)||!o[t.children_d[i]].state.loaded&&o[t.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.disable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(s=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t})))):!1},this.enable_checkbox=function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.enable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(s=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t})))):!1},this.activate_node=function(t,i){return e(i.target).hasClass("jstree-checkbox-disabled")?!1:(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")?r.activate_node.call(this,t,i):this.is_disabled(t)?!1:(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var r,s,n;if(e.isArray(t)){for(t=t.slice(),s=0,n=t.length;n>s;s++)this.check_node(t[s],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(r=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1},this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var r,s,n;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.uncheck_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),n.length&&n.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,i;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,i=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),t&&t.id!==e.jstree.root?t.state.checked:!1)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var i,r,s,n,a=this.get_checked(!0),o={};for(i=0,r=a.length;r>i;i++)o[a[i].id]=a[i];for(i=0,r=a.length;r>i;i++)for(s=0,n=a[i].children_d.length;n>s;s++)o[a[i].children_d[s]]&&delete o[a[i].children_d[s]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var i,r,s=this.get_checked(!0),n=[];for(i=0,r=s.length;r>i;i++)s[i].children.length||n.push(s[i].id);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},this.load_node=function(t,i){var s,n,a,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(s=0,n=o.children_d.length;n>s;s++)this._model.data[o.children_d[s]].state.checked&&(a=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[s]));return r.load_node.apply(this,arguments)},this.get_state=function(){var e=r.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,i){var s=r.set_state.apply(this,arguments);if(s&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var n=this;e.each(t.checkbox,function(e,t){n.check_node(t)})}return delete t.checkbox,this.set_state(t,i),!1}return s},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),r.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){this.settings.conditionalselect.call(this,this.get_node(e),i)&&t.activate_node.call(this,e,i)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.delete_node(i.get_selected()):i.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.cut(i.get_top_selected()):i.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.copy(i.get_top_selected()):i.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}},e.jstree.plugins.contextmenu=function(i,r){this.bind=function(){r.bind.call(this);var t,i,s=0,n=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){e.preventDefault(),s=e.ctrlKey?+new Date:0,(t||n)&&(s=+new Date+1e4),n&&clearTimeout(n),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!s||+new Date-s>250)&&e.vakata.context.hide(),s=0},this)).on("touchstart.jstree",".jstree-anchor",function(r){r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(t=r.pageX,i=r.pageY,n=setTimeout(function(){e(r.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){n&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.pageX)>50||Math.abs(i-e.pageY)>50)&&clearTimeout(n)}).on("touchend.vakata.jstree",function(e){n&&clearTimeout(n)}),e(l).on("context_hide.vakata.jstree",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),r.teardown.call(this)},this.show_contextmenu=function(i,r,s,n){if(i=this.get_node(i),!i||i.id===e.jstree.root)return!1;var a=this.settings.contextmenu,o=this.get_node(i,!0),d=o.children(".jstree-anchor"),c=!1,l=!1;(a.show_at_node||r===t||s===t)&&(c=d.offset(),r=c.left,s=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,n),l=a.items,e.isFunction(l)&&(l=l.call(this,i,e.proxy(function(e){this._show_contextmenu(i,r,s,e)},this))),e.isPlainObject(l)&&this._show_contextmenu(i,r,s,l)},this._show_contextmenu=function(t,i,r,s){var n=this.get_node(t,!0),a=n.children(".jstree-anchor");e(l).one("context_show.vakata.jstree",e.proxy(function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(r)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:i,y:r},s),this.trigger("show_contextmenu",{node:t,x:i,y:r})}},function(e){var t=!1,i={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(l).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){return t=i.items[t],t&&(!t._disabled||e.isFunction(t._disabled)&&!t._disabled({item:t,reference:i.reference,element:i.element}))&&t.action?t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}}):!1},_parse:function(t,r){if(!t)return!1;r||(i.html="",i.items=[]);var s,n="",a=!1;return r&&(n+="<ul>"),e.each(t,function(t,r){return r?(i.items.push(r),!a&&r.separator_before&&(n+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,n+="<li class='"+(r._class||"")+(r._disabled===!0||e.isFunction(r._disabled)&&r._disabled({item:r,reference:i.reference,element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">",n+="<a href='#' rel='"+(i.items.length-1)+"'>",e.vakata.context.settings.icons&&(n+="<i ",r.icon&&(n+=-1!==r.icon.indexOf("/")||-1!==r.icon.indexOf(".")?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),n+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),n+=(e.isFunction(r.label)?r.label({item:t,reference:i.reference,element:i.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"</span>":"")+"</a>",r.submenu&&(s=e.vakata.context._parse(r.submenu,!0),s&&(n+=s)),n+="</li>",void(r.separator_after&&(n+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0))):!0}),n=n.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(n+="</ul>"),r||(i.html=n,e.vakata.context._trigger("parse")),n.length>10?n:!1},_show_submenu:function(i){if(i=e(i),i.length&&i.children("ul").length){var r=i.children("ul"),s=i.offset().left+i.outerWidth(),n=i.offset().top,a=r.width(),o=r.height(),d=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?i[s-(a+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):i[s+a+10>d?"addClass":"removeClass"]("vakata-context-right"),n+o+10>c&&r.css("bottom","-1px"),r.show()}},show:function(r,s,n){var a,o,d,c,l,h,_,u,g=!0;switch(i.element&&i.element.length&&i.element.width(""),g){case!s&&!r:return!1;case!!s&&!!r:i.reference=r,i.position_x=s.x,i.position_y=s.y;break;case!s&&!!r:i.reference=r,a=r.offset(),i.position_x=a.left+r.outerHeight(),i.position_y=a.top;break;case!!s&&!r:i.position_x=s.x,i.position_y=s.y}r&&!n&&e(r).data("vakata_contextmenu")&&(n=e(r).data("vakata_contextmenu")),e.vakata.context._parse(n)&&i.element.html(i.html),i.items.length&&(i.element.appendTo("body"),o=i.element,d=i.position_x,c=i.position_y,l=o.width(),h=o.height(),_=e(window).width()+e(window).scrollLeft(),u=e(window).height()+e(window).scrollTop(),t&&(d-=o.outerWidth()-e(r).outerWidth(),d<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20)),d+l+20>_&&(d=_-(l+20)),c+h+20>u&&(c=u-(h+20)),i.element.css({left:d,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),i.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){i.is_visible&&(i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),i.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var r=!1;i.element=e("<ul class='vakata-context'></ul>"),i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(r&&clearTimeout(r),i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(r=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var r=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:i.is_visible&&(i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:i.is_visible&&(r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:i.is_visible&&(i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:i.is_visible&&(r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(l).on("mousedown.vakata.jstree",function(t){i.is_visible&&!e.contains(i.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,r){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&i.element.addClass("vakata-context-rtl").css("direction","rtl"),i.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},e.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){
if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),r=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,s=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);return this.settings.core.force_text&&(s=e.vakata.html.escape(s)),i&&i.id&&i.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[i],t))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:r>1?this.get_top_selected():[i.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+s+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},e(function(){var t=!1,i=!1,r=!1,s=!1,n=e('<div id="jstree-marker">&#160;</div>').hide();e(l).on("dnd_start.vakata.jstree",function(e,i){t=!1,r=!1,i&&i.data&&i.data.jstree&&n.appendTo("body")}).on("dnd_move.vakata.jstree",function(a,o){if(s&&clearTimeout(s),o&&o.data&&o.data.jstree&&(!o.event.target.id||"jstree-marker"!==o.event.target.id)){r=o.event;var d,c,l,h,_,u,g,f,p,m,v,j,y,k,x=e.jstree.reference(o.event.target),b=!1,w=!1,C=!1;if(x&&x._data&&x._data.dnd)if(n.attr("class","jstree-"+x.get_theme()+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+x.get_theme()+" jstree-"+x.get_theme()+"-"+x.get_theme_variant()+" "+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),o.event.target!==x.element[0]&&o.event.target!==x.get_container_ul()[0]||0!==x.get_container_ul().children().length){if(b=x.settings.dnd.large_drop_target?e(o.event.target).closest(".jstree-node").children(".jstree-anchor"):e(o.event.target).closest(".jstree-anchor"),b&&b.length&&b.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(w=b.offset(),C=o.event.pageY-w.top,l=b.outerHeight(),u=l/3>C?["b","i","a"]:C>l-l/3?["a","i","b"]:C>l/2?["i","a","b"]:["i","b","a"],e.each(u,function(r,a){switch(a){case"b":d=w.left-6,c=w.top,h=x.get_parent(b),_=b.parent().index();break;case"i":y=x.settings.dnd.inside_pos,k=x.get_node(b.parent()),d=w.left-2,c=w.top+l/2+1,h=k.id,_="first"===y?0:"last"===y?k.children.length:Math.min(y,k.children.length);break;case"a":d=w.left-6,c=w.top+l,h=x.get_parent(b),_=b.parent().index()+1}for(g=!0,f=0,p=o.data.nodes.length;p>f;f++)if(m=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",v=_,"move_node"===m&&"a"===a&&o.data.origin&&o.data.origin===x&&h===x.get_parent(o.data.nodes[f])&&(j=x.get_node(h),v>e.inArray(o.data.nodes[f],j.children)&&(v-=1)),g=g&&(x&&x.settings&&x.settings.dnd&&x.settings.dnd.check_while_dragging===!1||x.check(m,o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[f]):o.data.nodes[f],h,v,{dnd:!0,ref:x.get_node(b.parent()),pos:a,origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin})),!g){x&&x.last_error&&(i=x.last_error());break}return"i"===a&&b.parent().is(".jstree-closed")&&x.settings.dnd.open_timeout&&(s=setTimeout(function(e,t){return function(){e.open_node(t)}}(x,b),x.settings.dnd.open_timeout)),g?(t={ins:x,par:h,pos:"i"!==a||"last"!==y||0!==_||x.is_loaded(k)?_:"last"},n.css({left:d+"px",top:c+"px"}).show(),o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),i={},u=!0,!1):void 0}),u===!0))return}else{for(g=!0,f=0,p=o.data.nodes.length;p>f&&(g=g&&x.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[f]):o.data.nodes[f],e.jstree.root,"last",{dnd:!0,ref:x.get_node(e.jstree.root),pos:"i",origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin}),g);f++);if(g)return t={ins:x,par:e.jstree.root,pos:"last"},n.hide(),void o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")}t=!1,o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),n.hide()}}).on("dnd_scroll.vakata.jstree",function(e,i){i&&i.data&&i.data.jstree&&(n.hide(),t=!1,r=!1,i.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(a,o){if(s&&clearTimeout(s),o&&o.data&&o.data.jstree){n.hide().detach();var d,c,l=[];if(t){for(d=0,c=o.data.nodes.length;c>d;d++)l[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d];t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](l,t.par,t.pos,!1,!1,!1,o.data.origin)}else d=e(o.event.target).closest(".jstree"),d.length&&i&&i.error&&"check"===i.error&&(d=d.jstree(!0),d&&d.settings.core.error.call(this,i));r=!1,t=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=e.vakata.dnd._get(),i&&i.data&&i.data.jstree&&(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),r&&(r.metaKey=t.metaKey,r.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",r)))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,i){var r=e.vakata.dnd._get();r.event=i,e(l).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var r=t.scroll_e.scrollTop(),s=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(r+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(s+t.scroll_l*e.vakata.dnd.settings.scroll_speed),r===t.scroll_e.scrollTop()&&s===t.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(i,r,s){"touchstart"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{i.currentTarget.unselectable="on",i.currentTarget.onselectstart=function(){return!1},i.currentTarget.style&&(i.currentTarget.style.MozUserSelect="none")}catch(n){}return t.init_x=i.pageX,t.init_y=i.pageY,t.data=r,t.is_down=!0,t.element=i.currentTarget,t.target=i.target,t.is_touch="touchstart"===i.type,s!==!1&&(t.helper=e("<div id='vakata-dnd'></div>").html(s).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(i.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(i.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e.vakata.dnd._trigger("start",i)}var r=!1,s=!1,n=!1,a=!1,o=!1,d=!1,c=!1,h=!1,_=!1,u=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var r=e(this),s=r.offset();return this.scrollHeight>this.offsetHeight&&(s.top+r.height()-i.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),i.pageY-s.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(s.left+r.width()-i.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),i.pageX-s.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=e(this),!1):void 0}),t.scroll_e||(r=e(l),s=e(window),n=r.height(),a=s.height(),o=r.width(),d=s.width(),c=r.scrollTop(),h=r.scrollLeft(),n>a&&i.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),n>a&&a-(i.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),o>d&&i.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),o>d&&d-(i.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=r)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(_=parseInt(i.pageY+e.vakata.dnd.settings.helper_top,10),u=parseInt(i.pageX+e.vakata.dnd.settings.helper_left,10),n&&_+25>n&&(_=n-50),o&&u+t.helper_w>o&&(u=o-(t.helper_w+2)),t.helper.css({left:u+"px",top:_+"px"})),e.vakata.dnd._trigger("move",i),!1}},stop:function(i){if("touchend"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)e.vakata.dnd._trigger("stop",i);else if("touchend"===i.type&&i.target===t.target){var r=setTimeout(function(){e(i.target).click()},100);e(i.target).one("click",function(){r&&clearTimeout(r)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,i){this.init=function(e,t){i.init.call(this,e,t),this._data.massload={}},this._load_nodes=function(t,r,s){var n=this.settings.massload;return s&&!e.isEmptyObject(this._data.massload)?i._load_nodes.call(this,t,r,s):e.isFunction(n)?n.call(this,t,e.proxy(function(e){if(e)for(var n in e)e.hasOwnProperty(n)&&(this._data.massload[n]=e[n]);i._load_nodes.call(this,t,r,s)},this)):"object"==typeof n&&n&&n.url?(n=e.extend(!0,{},n),e.isFunction(n.url)&&(n.url=n.url.call(this,t)),e.isFunction(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(e.proxy(function(e,n,a){if(e)for(var o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);i._load_nodes.call(this,t,r,s)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,r,s)},this))):i._load_nodes.call(this,t,r,s)},this._load_node=function(t,r){var s=this._data.massload[t.id];return s?this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}):s,function(e){r.call(this,e),delete this._data.massload[t.id]}):i._load_node.call(this,t,r)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(i,r){this.bind=function(){r.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var r,s,n=this._model.data,a=[];for(r=0,s=i.res.length;s>r;r++)n[i.res[r]]&&!n[i.res[r]].state.hidden&&(a.push(i.res[r]),a=a.concat(n[i.res[r]].parents),this._data.search.smc&&(a=a.concat(n[i.res[r]].children_d)));a=e.vakata.array_remove_item(e.vakata.array_unique(a),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(a)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&this.show_node(this._data.search.hdn)},this))},this.search=function(i,r,s,n,a,o){if(i===!1||""===e.trim(i.toString()))return this.clear_search();n=this.get_node(n),n=n&&n.id?n.id:null,i=i.toString();var d,c,l=this.settings.search,h=l.ajax?l.ajax:!1,_=this._model.data,u=null,g=[],f=[];if(this._data.search.res.length&&!a&&this.clear_search(),s===t&&(s=l.show_only_matches),o===t&&(o=l.show_only_matches_children),!r&&h!==!1)return e.isFunction(h)?h.call(this,i,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,s,n,a)},!0)},this),n):(h=e.extend({},h),h.data||(h.data={}),h.data.str=i,n&&(h.data.inside=n),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,s,n,a)},!0)},this)));if(a||(this._data.search.str=i,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=s,this._data.search.smc=o),u=new e.vakata.search(i,!0,{caseSensitive:l.case_sensitive,fuzzy:l.fuzzy}),e.each(_[n?n:e.jstree.root].children_d,function(e,t){var r=_[t];r.text&&(!l.search_leaves_only||r.state.loaded&&0===r.children.length)&&(l.search_callback&&l.search_callback.call(this,i,r)||!l.search_callback&&u.search(r.text).isMatch)&&(g.push(t),f=f.concat(r.parents))}),g.length){for(f=e.vakata.array_unique(f),d=0,c=f.length;c>d;d++)f[d]!==e.jstree.root&&_[f[d]]&&this.open_node(f[d],null,0)===!0&&this._data.search.opn.push(f[d]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(g))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=g),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:s})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,i,s,n){if(t=r.redraw_node.apply(this,arguments),t&&-1!==e.inArray(t.id,this._data.search.res)){var a,o,d=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){d=t.childNodes[a];break}d&&(d.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,i,r){r=r||{},r=e.extend({},e.vakata.search.defaults,r),r.fuzzy!==!1&&(r.fuzzy=!0),t=r.caseSensitive?t:t.toLowerCase();var s,n,a,o,d=r.location,c=r.distance,l=r.threshold,h=t.length;return h>32&&(r.fuzzy=!1),r.fuzzy&&(s=1<<h-1,n=function(){var e={},i=0;for(i=0;h>i;i++)e[t.charAt(i)]=0;for(i=0;h>i;i++)e[t.charAt(i)]|=1<<h-i-1;return e}(),a=function(e,t){var i=e/h,r=Math.abs(d-t);return c?i+r/c:r?1:i}),o=function(e){if(e=r.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var i,o,c,_,u,g,f,p,m,v=e.length,j=l,y=e.indexOf(t,d),k=h+v,x=1,b=[];for(-1!==y&&(j=Math.min(a(0,y),j),y=e.lastIndexOf(t,d+h),-1!==y&&(j=Math.min(a(0,y),j))),y=-1,i=0;h>i;i++){for(c=0,_=k;_>c;)a(i,d+_)<=j?c=_:k=_,_=Math.floor((k-c)/2+c);for(k=_,g=Math.max(1,d-_+1),f=Math.min(d+_,v)+h,p=new Array(f+2),p[f+1]=(1<<i)-1,o=f;o>=g;o--)if(m=n[e.charAt(o-1)],0===i?p[o]=(p[o+1]<<1|1)&m:p[o]=(p[o+1]<<1|1)&m|((u[o+1]|u[o])<<1|1)|u[o+1],p[o]&s&&(x=a(i,o-1),j>=x)){if(j=x,y=o-1,b.push(y),!(y>d))break;g=Math.max(1,2*d-y)}if(a(i+1,d)>j)break;u=p}return{isMatch:y>=0,score:x}},i===!0?{search:o}:o(i)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,i){var r,s;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),i))for(r=0,s=t.children_d.length;s>r;r++)this.sort(t.children_d[r],!1)}};var u=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){u&&clearTimeout(u),u=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(i){return!1}return t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0):!1)},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(i,r){this.init=function(i,s){var n,a;if(s&&s.types&&s.types["default"])for(n in s.types)if("default"!==n&&n!==e.jstree.root&&s.types.hasOwnProperty(n))for(a in s.types["default"])s.types["default"].hasOwnProperty(a)&&s.types[n][a]===t&&(s.types[n][a]=s.types["default"][a]);r.init.call(this,i,s),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,i){r.refresh.call(this,t,i),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,r){var s,n,a=this._model.data,o=r.nodes,d=this.settings.types,c="default";for(s=0,n=o.length;n>s;s++)c="default",a[o[s]].original&&a[o[s]].original.type&&d[a[o[s]].original.type]&&(c=a[o[s]].original.type),a[o[s]].data&&a[o[s]].data.jstree&&a[o[s]].data.jstree.type&&d[a[o[s]].data.jstree.type]&&(c=a[o[s]].data.jstree.type),a[o[s]].type=c,a[o[s]].icon===!0&&d[c].icon!==t&&(a[o[s]].icon=d[c].icon);a[e.jstree.root].type=e.jstree.root},this)),r.bind.call(this)},this.get_json=function(t,i,s){var n,a,o=this._model.data,d=i?e.extend(!0,{},i,{no_id:!1}):{},c=r.get_json.call(this,t,d,s);if(c===!1)return!1;if(e.isArray(c))for(n=0,a=c.length;a>n;n++)c[n].type=c[n].id&&o[c[n].id]&&o[c[n].id].type?o[c[n].id].type:"default",i&&i.no_id&&(delete c[n].id,c[n].li_attr&&c[n].li_attr.id&&delete c[n].li_attr.id,c[n].a_attr&&c[n].a_attr.id&&delete c[n].a_attr.id);else c.type=c.id&&o[c.id]&&o[c.id].type?o[c.id].type:"default",i&&i.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,r=t.length;r>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(i,s,n,a,o){if(r.check.call(this,i,s,n,a,o)===!1)return!1;s=s&&s.id?s:this.get_node(s),n=n&&n.id?n:this.get_node(n);var d,c,l,h,_=s&&s.id?o&&o.origin?o.origin:e.jstree.reference(s.id):null;switch(_=_&&_._model&&_._model.data?_._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===e.inArray(s.id,n.children)){if(d=this.get_rules(n),d.max_children!==t&&-1!==d.max_children&&d.max_children===n.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;if(d.valid_children!==t&&-1!==d.valid_children&&-1===e.inArray(s.type||"default",d.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;if(_&&s.children_d&&s.parents){for(c=0,l=0,h=s.children_d.length;h>l;l++)c=Math.max(c,_[s.children_d[l]].parents.length);c=c-s.parents.length+1}(0>=c||c===t)&&(c=1);do{if(d.max_depth!==t&&-1!==d.max_depth&&d.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;n=this.get_node(n.parent),d=this.get_rules(n),c++}while(n)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var i=this.get_type(e,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i},this.get_type=function(t,i){return t=this.get_node(t),t?i?e.extend({type:t.type},this.settings.types[t.type]):t.type:!1},this.set_type=function(i,r){var s,n,a,o,d;if(e.isArray(i)){for(i=i.slice(),n=0,a=i.length;a>n;n++)this.set_type(i[n],r);return!0}return s=this.settings.types,i=this.get_node(i),s[r]&&i?(o=i.type,d=this.get_icon(i),i.type=r,(d===!0||s[o]&&s[o].icon!==t&&d===s[o].icon)&&this.set_icon(i,s[r].icon!==t?s[r].icon:!0),!0):!1}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(i,r){this.check=function(t,i,s,n,a){if(r.check.call(this,t,i,s,n,a)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),s=s&&s.id?s:this.get_node(s),!s||!s.children)return!0;var o,d,c="rename_node"===t?n:i.text,l=[],h=this.settings.unique.case_sensitive,_=this._model.data;for(o=0,d=s.children.length;d>o;o++)l.push(h?_[s.children[o]].text:_[s.children[o]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=-1===e.inArray(c,l)||i.text&&i.text[h?"toString":"toLowerCase"]()===c,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"create_node":return o=-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"copy_node":return o=-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"move_node":return o=i.parent===s.id&&(!a||!a.is_multi)||-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o}return!0},this.create_node=function(i,s,n,a,o){if(!s||s.text===t){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return r.create_node.call(this,i,s,n,a,o);if(n=n===t?"last":n,!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return r.create_node.call(this,i,s,n,a,o);s||(s={});var d,c,l,h,_,u=this._model.data,g=this.settings.unique.case_sensitive,f=this.settings.unique.duplicate;for(c=d=this.get_string("New node"),l=[],h=0,_=i.children.length;_>h;h++)l.push(g?u[i.children[h]].text:u[i.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(g?c:c.toLowerCase(),l);)c=f.call(this,d,++h).toString();s.text=c}return r.create_node.call(this,i,s,n,a,o)}};var g=l.createElement("DIV");if(g.setAttribute("unselectable","on"),g.setAttribute("role","presentation"),g.className="jstree-wholerow",g.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,r,s=!1;for(i=0,r=t.selected.length;r>i;i++)s=this.get_node(t.selected[i],!0),s&&s.length&&s.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,r,s,n){if(t=i.redraw_node.apply(this,arguments)){var a=g.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},l.registerElement&&Object&&Object.create){var f=Object.create(HTMLElement.prototype);f.createdCallback=function(){var t,i={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(i)};try{l.registerElement("vakata-jstree",{prototype:f})}catch(p){}}}});
},{"jquery":307}],309:[function(require,module,exports){
(function (global){
(function(){function n(n,t){if(n!==t){var r=null===n,e=n===b,u=n===n,i=null===t,o=t===b,f=t===t;if(n>t&&!i||!u||r&&!o&&f||e&&f)return 1;if(t>n&&!r||!f||i&&!e&&u||o&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return s(n,r);for(var e=r-1,u=n.length;++e<u;)if(n[e]===t)return e;return-1}function e(n){return"function"==typeof n||!1}function u(n){return"string"==typeof n?n:null==n?"":n+""}function i(n,t){for(var r=-1,e=n.length;++r<e&&t.indexOf(n.charAt(r))>-1;);return r}function o(n,t){for(var r=n.length;r--&&t.indexOf(n.charAt(r))>-1;);return r}function f(t,r){return n(t.criteria,r.criteria)||t.index-r.index}function a(t,r,e){for(var u=-1,i=t.criteria,o=r.criteria,f=i.length,a=e.length;++u<f;){var l=n(i[u],o[u]);if(l)return u>=a?l:l*(e[u]?1:-1)}return t.index-r.index}function l(n){return Dn[n]}function c(n){return Mn[n]}function p(n){return"\\"+Yn[n]}function s(n,t,r){for(var e=n.length,u=t+(r?0:-1);r?u--:++u<e;){var i=n[u];if(i!==i)return u}return-1}function h(n){return!!n&&"object"==typeof n}function v(n){return 160>=n&&n>=9&&13>=n||32==n||160==n||5760==n||6158==n||n>=8192&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n)}function _(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;)n[r]===t&&(n[r]=z,i[++u]=r);return i}function g(n,t){for(var r,e=-1,u=n.length,i=-1,o=[];++e<u;){var f=n[e],a=t?t(f,e,n):f;e&&r===a||(r=a,o[++i]=f)}return o}function y(n){for(var t=-1,r=n.length;++t<r&&v(n.charCodeAt(t)););return t}function d(n){for(var t=n.length;t--&&v(n.charCodeAt(t)););return t}function w(n){return Kn[n]}function m(v){function Y(n){if(h(n)&&!If(n)&&!(n instanceof Dn)){if(n instanceof Q)return n;if(Gi.call(n,"__chain__")&&Gi.call(n,"__wrapped__"))return le(n)}return new Q(n)}function Z(){}function Q(n,t,r){this.__wrapped__=n,this.__actions__=r||[],this.__chain__=!!t}function Dn(n){this.__wrapped__=n,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=Oo,this.__views__=null}function Mn(){var n=this.__actions__,t=this.__iteratees__,r=this.__views__,e=new Dn(this.__wrapped__);return e.__actions__=n?et(n):null,e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=t?et(t):null,e.__takeCount__=this.__takeCount__,e.__views__=r?et(r):null,e}function Kn(){if(this.__filtered__){var n=new Dn(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function Vn(){var n=this.__wrapped__.value();if(!If(n))return rr(n,this.__actions__);var t=this.__dir__,r=0>t,e=qr(0,n.length,this.__views__),u=e.start,i=e.end,o=i-u,f=r?i:u-1,a=wo(o,this.__takeCount__),l=this.__iteratees__,c=l?l.length:0,p=0,s=[];n:for(;o--&&a>p;){f+=t;for(var h=-1,v=n[f];++h<c;){var _=l[h],g=_.iteratee,y=_.type;if(y==F){if(_.done&&(r?f>_.index:f<_.index)&&(_.count=0,_.done=!1),_.index=f,!_.done){var d=_.limit;if(!(_.done=d>-1?_.count++>=d:!g(v)))continue n}}else{var w=g(v);if(y==L)v=w;else if(!w){if(y==N)continue n;break n}}}s[p++]=v}return s}function Yn(){this.__data__={}}function Gn(n){return this.has(n)&&delete this.__data__[n]}function Jn(n){return"__proto__"==n?b:this.__data__[n]}function Xn(n){return"__proto__"!=n&&Gi.call(this.__data__,n)}function Zn(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this}function Hn(n){var t=n?n.length:0;for(this.data={hash:ho(null),set:new fo};t--;)this.push(n[t])}function Qn(n,t){var r=n.data,e="string"==typeof t||Iu(t)?r.set.has(t):r.hash[t];return e?0:-1}function rt(n){var t=this.data;"string"==typeof n||Iu(n)?t.set.add(n):t.hash[n]=!0}function et(n,t){var r=-1,e=n.length;for(t||(t=Ti(e));++r<e;)t[r]=n[r];return t}function ut(n,t){for(var r=-1,e=n.length;++r<e&&t(n[r],r,n)!==!1;);return n}function it(n,t){for(var r=n.length;r--&&t(n[r],r,n)!==!1;);return n}function ot(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function ft(n,t,r,e){for(var u=-1,i=n.length,o=e,f=o;++u<i;){var a=n[u],l=+t(a);r(l,o)&&(o=l,f=a)}return f}function at(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[++u]=o)}return i}function lt(n,t){for(var r=-1,e=n.length,u=Ti(e);++r<e;)u[r]=t(n[r],r,n);return u}function ct(n,t,r,e){var u=-1,i=n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function pt(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function st(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function ht(n){for(var t=n.length,r=0;t--;)r+=+n[t]||0;return r}function vt(n,t){return n===b?t:n}function _t(n,t,r,e){return n!==b&&Gi.call(e,r)?n:t}function gt(n,t,r){for(var e=-1,u=zf(t),i=u.length;++e<i;){var o=u[e],f=n[o],a=r(f,t[o],o,n,t);(a===a?a===f:f!==f)&&(f!==b||o in n)||(n[o]=a)}return n}function yt(n,t){return null==t?n:wt(t,zf(t),n)}function dt(n,t){for(var r=-1,e=null==n,u=!e&&Yr(n),i=u?n.length:0,o=t.length,f=Ti(o);++r<o;){var a=t[r];u?f[r]=Gr(a,i)?n[a]:b:f[r]=e?b:n[a]}return f}function wt(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var i=t[e];r[i]=n[i]}return r}function mt(n,t,r){var e=typeof n;return"function"==e?t===b?n:ir(n,t,r):null==n?mi:"object"==e?Bt(n):t===b?Ri(n):zt(n,t)}function bt(n,t,r,e,u,i,o){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==b)return f;if(!Iu(n))return n;var a=If(n);if(a){if(f=Dr(n),!t)return et(n,f)}else{var l=Xi.call(n),c=l==V;if(l!=J&&l!=P&&(!c||u))return Pn[l]?Kr(n,l,t):u?n:{};if(f=Mr(c?{}:n),!t)return yt(f,n)}i||(i=[]),o||(o=[]);for(var p=i.length;p--;)if(i[p]==n)return o[p];return i.push(n),o.push(f),(a?ut:Wt)(n,function(e,u){f[u]=bt(e,t,r,u,n,i,o)}),f}function xt(n,t,r){if("function"!=typeof n)throw new qi(B);return ao(function(){n.apply(b,r)},t)}function At(n,t){var e=n?n.length:0,u=[];if(!e)return u;var i=-1,o=Br(),f=o==r,a=f&&t.length>=200?zo(t):null,l=t.length;a&&(o=Qn,f=!1,t=a);n:for(;++i<e;){var c=n[i];if(f&&c===c){for(var p=l;p--;)if(t[p]===c)continue n;u.push(c)}else o(t,c,0)<0&&u.push(c)}return u}function jt(n,t){var r=!0;return $o(n,function(n,e,u){return r=!!t(n,e,u)}),r}function Ot(n,t,r,e){var u=e,i=u;return $o(n,function(n,o,f){var a=+t(n,o,f);(r(a,u)||a===e&&a===i)&&(u=a,i=n)}),i}function Rt(n,t,r,e){var u=n.length;for(r=null==r?0:+r||0,0>r&&(r=-r>u?0:u+r),e=e===b||e>u?u:+e||0,0>e&&(e+=u),u=r>e?0:e>>>0,r>>>=0;u>r;)n[r++]=t;return n}function kt(n,t){var r=[];return $o(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function It(n,t,r,e){var u;return r(n,function(n,r,i){return t(n,r,i)?(u=e?r:n,!1):void 0}),u}function Et(n,t,r){for(var e=-1,u=n.length,i=-1,o=[];++e<u;){var f=n[e];if(h(f)&&Yr(f)&&(r||If(f)||bu(f))){t&&(f=Et(f,t,r));for(var a=-1,l=f.length;++a<l;)o[++i]=f[a]}else r||(o[++i]=f)}return o}function Ct(n,t){return No(n,t,Yu)}function Wt(n,t){return No(n,t,zf)}function St(n,t){return Lo(n,t,zf)}function Tt(n,t){for(var r=-1,e=t.length,u=-1,i=[];++r<e;){var o=t[r];Cf(n[o])&&(i[++u]=o)}return i}function Ut(n,t,r){if(null!=n){r!==b&&r in fe(n)&&(t=[r]);for(var e=0,u=t.length;null!=n&&u>e;)n=n[t[e++]];return e&&e==u?n:b}}function $t(n,t,r,e,u,i){return n===t?!0:null==n||null==t||!Iu(n)&&!h(t)?n!==n&&t!==t:Ft(n,t,$t,r,e,u,i)}function Ft(n,t,r,e,u,i,o){var f=If(n),a=If(t),l=q,c=q;f||(l=Xi.call(n),l==P?l=J:l!=J&&(f=Fu(n))),a||(c=Xi.call(t),c==P?c=J:c!=J&&(a=Fu(t)));var p=l==J,s=c==J,h=l==c;if(h&&!f&&!p)return $r(n,t,l);if(!u){var v=p&&Gi.call(n,"__wrapped__"),_=s&&Gi.call(t,"__wrapped__");if(v||_)return r(v?n.value():n,_?t.value():t,e,u,i,o)}if(!h)return!1;i||(i=[]),o||(o=[]);for(var g=i.length;g--;)if(i[g]==n)return o[g]==t;i.push(n),o.push(t);var y=(f?Ur:Fr)(n,t,r,e,u,i,o);return i.pop(),o.pop(),y}function Nt(n,t,r){var e=t.length,u=e,i=!r;if(null==n)return!u;for(n=fe(n);e--;){var o=t[e];if(i&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++e<u;){o=t[e];var f=o[0],a=n[f],l=o[1];if(i&&o[2]){if(a===b&&!(f in n))return!1}else{var c=r?r(a,l,f):b;if(!(c===b?$t(l,a,r,!0):c))return!1}}return!0}function Lt(n,t){var r=-1,e=Yr(n)?Ti(n.length):[];return $o(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function Bt(n){var t=zr(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?!1:n[r]===e&&(e!==b||r in fe(n))}}return function(n){return Nt(n,t)}}function zt(n,t){var r=If(n),e=Xr(n)&&Qr(t),u=n+"";return n=ae(n),function(i){if(null==i)return!1;var o=u;if(i=fe(i),(r||!e)&&!(o in i)){if(i=1==n.length?i:Ut(i,Gt(n,0,-1)),null==i)return!1;o=xe(n),i=fe(i)}return i[o]===t?t!==b||o in i:$t(t,i[o],b,!0)}}function Pt(n,t,r,e,u){if(!Iu(n))return n;var i=Yr(t)&&(If(t)||Fu(t)),o=i?null:zf(t);return ut(o||t,function(f,a){if(o&&(a=f,f=t[a]),h(f))e||(e=[]),u||(u=[]),qt(n,t,a,Pt,r,e,u);else{var l=n[a],c=r?r(l,f,a,n,t):b,p=c===b;p&&(c=f),c===b&&(!i||a in n)||!p&&(c===c?c===l:l!==l)||(n[a]=c)}}),n}function qt(n,t,r,e,u,i,o){for(var f=i.length,a=t[r];f--;)if(i[f]==a)return void(n[r]=o[f]);var l=n[r],c=u?u(l,a,r,n,t):b,p=c===b;p&&(c=a,Yr(a)&&(If(a)||Fu(a))?c=If(l)?l:Yr(l)?et(l):[]:Wf(a)||bu(a)?c=bu(l)?Pu(l):Wf(l)?l:{}:p=!1),i.push(a),o.push(c),p?n[r]=e(c,a,u,i,o):(c===c?c!==l:l===l)&&(n[r]=c)}function Dt(n){return function(t){return null==t?b:t[n]}}function Mt(n){var t=n+"";return n=ae(n),function(r){return Ut(r,n,t)}}function Kt(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Gr(e)){var u=e;lo.call(n,e,1)}}return n}function Vt(n,t){return n+eo(Ao()*(t-n+1))}function Yt(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=!1,n):t(r,n,u,i)}),r}function Gt(n,t,r){var e=-1,u=n.length;t=null==t?0:+t||0,0>t&&(t=-t>u?0:u+t),r=r===b||r>u?u:+r||0,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var i=Ti(u);++e<u;)i[e]=n[e+t];return i}function Jt(n,t){var r;return $o(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function Xt(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].value;return n}function Zt(n,t,r){var e=Nr(),u=-1;t=lt(t,function(n){return e(n)});var i=Lt(n,function(n){var r=lt(t,function(t){return t(n)});return{criteria:r,index:++u,value:n}});return Xt(i,function(n,t){return a(n,t,r)})}function Ht(n,t){var r=0;return $o(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function Qt(n,t){var e=-1,u=Br(),i=n.length,o=u==r,f=o&&i>=200,a=f?zo():null,l=[];a?(u=Qn,o=!1):(f=!1,a=t?[]:l);n:for(;++e<i;){var c=n[e],p=t?t(c,e,n):c;if(o&&c===c){for(var s=a.length;s--;)if(a[s]===p)continue n;t&&a.push(p),l.push(c)}else u(a,p,0)<0&&((t||f)&&a.push(p),l.push(c))}return l}function nr(n,t){for(var r=-1,e=t.length,u=Ti(e);++r<e;)u[r]=n[t[r]];return u}function tr(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?Gt(n,e?0:i,e?i+1:u):Gt(n,e?i+1:0,e?u:i)}function rr(n,t){var r=n;r instanceof Dn&&(r=r.value());for(var e=-1,u=t.length;++e<u;){var i=[r],o=t[e];oo.apply(i,o.args),r=o.func.apply(o.thisArg,i)}return r}function er(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&Io>=u){for(;u>e;){var i=e+u>>>1,o=n[i];(r?t>=o:t>o)&&null!==o?e=i+1:u=i}return u}return ur(n,t,mi,r)}function ur(n,t,r,e){t=r(t);for(var u=0,i=n?n.length:0,o=t!==t,f=null===t,a=t===b;i>u;){var l=eo((u+i)/2),c=r(n[l]),p=c!==b,s=c===c;if(o)var h=s||e;else h=f?s&&p&&(e||null!=c):a?s&&(e||p):null==c?!1:e?t>=c:t>c;h?u=l+1:i=l}return wo(i,ko)}function ir(n,t,r){if("function"!=typeof n)return mi;if(t===b)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,o){return n.call(t,r,e,u,i,o)}}return function(){return n.apply(t,arguments)}}function or(n){return no.call(n,0)}function fr(n,t,r){for(var e=r.length,u=-1,i=yo(n.length-e,0),o=-1,f=t.length,a=Ti(i+f);++o<f;)a[o]=t[o];for(;++u<e;)a[r[u]]=n[u];for(;i--;)a[o++]=n[u++];return a}function ar(n,t,r){for(var e=-1,u=r.length,i=-1,o=yo(n.length-u,0),f=-1,a=t.length,l=Ti(o+a);++i<o;)l[i]=n[i];for(var c=i;++f<a;)l[c+f]=t[f];for(;++e<u;)l[c+r[e]]=n[i++];return l}function lr(n,t){return function(r,e,u){var i=t?t():{};if(e=Nr(e,u,3),If(r))for(var o=-1,f=r.length;++o<f;){var a=r[o];n(i,a,e(a,o,r),r)}else $o(r,function(t,r,u){n(i,t,e(t,r,u),u)});return i}}function cr(n){return hu(function(t,r){var e=-1,u=null==t?0:r.length,i=u>2?r[u-2]:b,o=u>2?r[2]:b,f=u>1?r[u-1]:b;for("function"==typeof i?(i=ir(i,f,5),u-=2):(i="function"==typeof f?f:b,u-=i?1:0),o&&Jr(r[0],r[1],o)&&(i=3>u?b:i,u=1);++e<u;){var a=r[e];a&&n(t,a,i)}return t})}function pr(n,t){return function(r,e){var u=r?qo(r):0;if(!Hr(u))return n(r,e);for(var i=t?u:-1,o=fe(r);(t?i--:++i<u)&&e(o[i],i,o)!==!1;);return r}}function sr(n){return function(t,r,e){for(var u=fe(t),i=e(t),o=i.length,f=n?o:-1;n?f--:++f<o;){var a=i[f];if(r(u[a],a,u)===!1)break}return t}}function hr(n,t){function r(){var u=this&&this!==nt&&this instanceof r?e:n;return u.apply(t,arguments)}var e=_r(n);return r}function vr(n){return function(t){for(var r=-1,e=yi(ei(t)),u=e.length,i="";++r<u;)i=n(i,e[r],r);return i}}function _r(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4])}var r=Uo(n.prototype),e=n.apply(r,t);return Iu(e)?e:r}}function gr(n){function t(r,e,u){u&&Jr(r,e,u)&&(e=null);var i=Tr(r,n,null,null,null,null,null,e);return i.placeholder=t.placeholder,i}return t}function yr(n,t){return function(r,e,u){if(u&&Jr(r,e,u)&&(e=null),e=Nr(e,u,3),1==e.length){r=oe(r);var i=ft(r,e,n,t);if(!r.length||i!==t)return i}return Ot(r,e,n,t)}}function dr(n,r){return function(e,u,i){if(u=Nr(u,i,3),If(e)){var o=t(e,u,r);return o>-1?e[o]:b}return It(e,u,n)}}function wr(n){return function(r,e,u){return r&&r.length?(e=Nr(e,u,3),t(r,e,n)):-1}}function mr(n){return function(t,r,e){return r=Nr(r,e,3),It(t,r,n,!0)}}function br(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,i=Ti(r);n?e--:++e<r;){var o=i[u++]=arguments[e];if("function"!=typeof o)throw new qi(B);!t&&Q.prototype.thru&&"wrapper"==Lr(o)&&(t=new Q([]))}for(e=t?-1:r;++e<r;){o=i[e];var f=Lr(o),a="wrapper"==f?Po(o):null;t=a&&Zr(a[0])&&a[1]==(C|R|I|W)&&!a[4].length&&1==a[9]?t[Lr(a[0])].apply(t,a[3]):1==o.length&&Zr(o)?t[f]():t.thru(o)}return function(){var n=arguments;if(t&&1==n.length&&If(n[0]))return t.plant(n[0]).value();for(var e=0,u=r?i[e].apply(this,n):n[0];++e<r;)u=i[e].call(this,u);return u}}}function xr(n,t){return function(r,e,u){return"function"==typeof e&&u===b&&If(r)?n(r,e):t(r,ir(e,u,3))}}function Ar(n){return function(t,r,e){return"function"==typeof r&&e===b||(r=ir(r,e,3)),n(t,r,Yu)}}function jr(n){return function(t,r,e){return"function"==typeof r&&e===b||(r=ir(r,e,3)),n(t,r)}}function Or(n){return function(t,r,e){var u={};return r=Nr(r,e,3),Wt(t,function(t,e,i){var o=r(t,e,i);e=n?o:e,t=n?t:o,u[e]=t}),u}}function Rr(n){return function(t,r,e){return t=u(t),(n?t:"")+Cr(t,r,e)+(n?"":t)}}function kr(n){var t=hu(function(r,e){var u=_(e,t.placeholder);return Tr(r,n,null,e,u)});return t}function Ir(n,t){return function(r,e,u,i){var o=arguments.length<3;return"function"==typeof e&&i===b&&If(r)?n(r,e,u,o):Yt(r,Nr(e,i,4),u,o,t)}}function Er(n,t,r,e,u,i,o,f,a,l){function c(){for(var w=arguments.length,m=w,x=Ti(w);m--;)x[m]=arguments[m];if(e&&(x=fr(x,e,u)),i&&(x=ar(x,i,o)),v||y){var O=c.placeholder,R=_(x,O);if(w-=R.length,l>w){var k=f?et(f):null,C=yo(l-w,0),W=v?R:null,S=v?null:R,T=v?x:null,U=v?null:x;t|=v?I:E,t&=~(v?E:I),g||(t&=~(A|j));var $=[n,t,r,T,W,U,S,k,a,C],F=Er.apply(b,$);return Zr(n)&&Do(F,$),F.placeholder=O,F}}var N=s?r:this,L=h?N[n]:n;return f&&(x=ee(x,f)),p&&a<x.length&&(x.length=a),this&&this!==nt&&this instanceof c&&(L=d||_r(n)),L.apply(N,x)}var p=t&C,s=t&A,h=t&j,v=t&R,g=t&O,y=t&k,d=h?null:_r(n);return c}function Cr(n,t,r){var e=n.length;if(t=+t,e>=t||!_o(t))return"";var u=t-e;return r=null==r?" ":r+"",li(r,to(u/r.length)).slice(0,u)}function Wr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,a=-1,l=e.length,c=Ti(f+l);++a<l;)c[a]=e[a];for(;f--;)c[a++]=arguments[++t];var p=this&&this!==nt&&this instanceof u?o:n;return p.apply(i?r:this,c)}var i=t&A,o=_r(n);return u}function Sr(n){return function(t,r,e,u){var i=Nr(e);return null==e&&i===mt?er(t,r,n):ur(t,r,i(e,u,1),n)}}function Tr(n,t,r,e,u,i,o,f){var a=t&j;if(!a&&"function"!=typeof n)throw new qi(B);var l=e?e.length:0;if(l||(t&=~(I|E),e=u=null),l-=u?u.length:0,t&E){var c=e,p=u;e=u=null}var s=a?null:Po(n),h=[n,t,r,e,u,c,p,i,o,f];if(s&&(ne(h,s),t=h[1],f=h[9]),h[9]=null==f?a?0:n.length:yo(f-l,0)||0,t==A)var v=hr(h[0],h[2]);else v=t!=I&&t!=(A|I)||h[4].length?Er.apply(b,h):Wr.apply(b,h);var _=s?Bo:Do;return _(v,h)}function Ur(n,t,r,e,u,i,o){var f=-1,a=n.length,l=t.length;if(a!=l&&!(u&&l>a))return!1;for(;++f<a;){var c=n[f],p=t[f],s=e?e(u?p:c,u?c:p,f):b;if(s!==b){if(s)continue;return!1}if(u){if(!st(t,function(n){return c===n||r(c,n,e,u,i,o)}))return!1}else if(c!==p&&!r(c,p,e,u,i,o))return!1}return!0}function $r(n,t,r){switch(r){case D:case M:return+n==+t;case K:return n.name==t.name&&n.message==t.message;case G:return n!=+n?t!=+t:n==+t;case X:case H:return n==t+""}return!1}function Fr(n,t,r,e,u,i,o){var f=zf(n),a=f.length,l=zf(t),c=l.length;if(a!=c&&!u)return!1;for(var p=a;p--;){var s=f[p];if(!(u?s in t:Gi.call(t,s)))return!1}for(var h=u;++p<a;){s=f[p];var v=n[s],_=t[s],g=e?e(u?_:v,u?v:_,s):b;if(!(g===b?r(v,_,e,u,i,o):g))return!1;h||(h="constructor"==s)}if(!h){var y=n.constructor,d=t.constructor;if(y!=d&&"constructor"in n&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof d&&d instanceof d))return!1}return!0}function Nr(n,t,r){var e=Y.callback||di;return e=e===di?mt:e,r?e(n,t,r):e}function Lr(n){for(var t=n.name,r=So[t],e=r?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function Br(n,t,e){var u=Y.indexOf||me;return u=u===me?r:u,n?u(n,t,e):u}function zr(n){for(var t=Gu(n),r=t.length;r--;)t[r][2]=Qr(t[r][1]);return t}function Pr(n,t){var r=null==n?b:n[t];return Wu(r)?r:b}function qr(n,t,r){for(var e=-1,u=r?r.length:0;++e<u;){var i=r[e],o=i.size;switch(i.type){case"drop":n+=o;break;case"dropRight":t-=o;break;case"take":t=wo(t,n+o);break;case"takeRight":n=yo(n,t-o)}}return{start:n,end:t}}function Dr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&Gi.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Mr(n){var t=n.constructor;return"function"==typeof t&&t instanceof t||(t=Bi),new t}function Kr(n,t,r){var e=n.constructor;switch(t){case nn:return or(n);case D:case M:return new e(+n);case tn:case rn:case en:case un:case on:case fn:case an:case ln:case cn:var u=n.buffer;return new e(r?or(u):u,n.byteOffset,n.length);case G:case H:return new e(n);case X:var i=new e(n.source,En.exec(n));i.lastIndex=n.lastIndex}return i}function Vr(n,t,r){null==n||Xr(t,n)||(t=ae(t),n=1==t.length?n:Ut(n,Gt(t,0,-1)),t=xe(t));var e=null==n?n:n[t];return null==e?b:e.apply(n,r)}function Yr(n){return null!=n&&Hr(qo(n))}function Gr(n,t){return n="number"==typeof n||Sn.test(n)?+n:-1,t=null==t?Co:t,n>-1&&n%1==0&&t>n}function Jr(n,t,r){if(!Iu(r))return!1;var e=typeof t;if("number"==e?Yr(r)&&Gr(t,r.length):"string"==e&&t in r){var u=r[t];return n===n?n===u:u!==u}return!1}function Xr(n,t){var r=typeof n;if("string"==r&&xn.test(n)||"number"==r)return!0;if(If(n))return!1;var e=!bn.test(n);return e||null!=t&&n in fe(t)}function Zr(n){var t=Lr(n);if(!(t in Dn.prototype))return!1;var r=Y[t];if(n===r)return!0;var e=Po(r);return!!e&&n===e[0]}function Hr(n){return"number"==typeof n&&n>-1&&n%1==0&&Co>=n}function Qr(n){return n===n&&!Iu(n)}function ne(n,t){var r=n[1],e=t[1],u=r|e,i=C>u,o=e==C&&r==R||e==C&&r==W&&n[7].length<=t[8]||e==(C|W)&&r==R;if(!i&&!o)return n;e&A&&(n[2]=t[2],u|=r&A?0:O);var f=t[3];if(f){var a=n[3];n[3]=a?fr(a,f,t[4]):et(f),n[4]=a?_(n[3],z):et(t[4])}return f=t[5],f&&(a=n[5],n[5]=a?ar(a,f,t[6]):et(f),n[6]=a?_(n[5],z):et(t[6])),f=t[7],f&&(n[7]=et(f)),e&C&&(n[8]=null==n[8]?t[8]:wo(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=u,n}function te(n,t){n=fe(n);for(var r=-1,e=t.length,u={};++r<e;){var i=t[r];i in n&&(u[i]=n[i])}return u}function re(n,t){var r={};return Ct(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function ee(n,t){for(var r=n.length,e=wo(t.length,r),u=et(n);e--;){var i=t[e];n[e]=Gr(i,r)?u[i]:b}return n}function ue(n){var t;Y.support;if(!h(n)||Xi.call(n)!=J||!Gi.call(n,"constructor")&&(t=n.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var r;return Ct(n,function(n,t){r=t}),r===b||Gi.call(n,r)}function ie(n){for(var t=Yu(n),r=t.length,e=r&&n.length,u=!!e&&Hr(e)&&(If(n)||bu(n)),i=-1,o=[];++i<r;){var f=t[i];(u&&Gr(f,e)||Gi.call(n,f))&&o.push(f)}return o}function oe(n){return null==n?[]:Yr(n)?Iu(n)?n:Bi(n):Hu(n)}function fe(n){return Iu(n)?n:Bi(n)}function ae(n){if(If(n))return n;var t=[];return u(n).replace(An,function(n,r,e,u){t.push(e?u.replace(kn,"$1"):r||n)}),t}function le(n){return n instanceof Dn?n.clone():new Q(n.__wrapped__,n.__chain__,et(n.__actions__))}function ce(n,t,r){t=(r?Jr(n,t,r):null==t)?1:yo(+t||1,1);for(var e=0,u=n?n.length:0,i=-1,o=Ti(to(u/t));u>e;)o[++i]=Gt(n,e,e+=t);return o}function pe(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var i=n[t];i&&(u[++e]=i)}return u}function se(n,t,r){var e=n?n.length:0;return e?((r?Jr(n,t,r):null==t)&&(t=1),Gt(n,0>t?0:t)):[]}function he(n,t,r){var e=n?n.length:0;return e?((r?Jr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Gt(n,0,0>t?0:t)):[]}function ve(n,t,r){return n&&n.length?tr(n,Nr(t,r,3),!0,!0):[]}function _e(n,t,r){return n&&n.length?tr(n,Nr(t,r,3),!0):[]}function ge(n,t,r,e){var u=n?n.length:0;return u?(r&&"number"!=typeof r&&Jr(n,t,r)&&(r=0,e=u),Rt(n,t,r,e)):[]}function ye(n){return n?n[0]:b}function de(n,t,r){var e=n?n.length:0;return r&&Jr(n,t,r)&&(t=!1),e?Et(n,t):[]}function we(n){var t=n?n.length:0;return t?Et(n,!0):[]}function me(n,t,e){var u=n?n.length:0;if(!u)return-1;if("number"==typeof e)e=0>e?yo(u+e,0):e;else if(e){var i=er(n,t),o=n[i];return(t===t?t===o:o!==o)?i:-1}return r(n,t,e||0)}function be(n){return he(n,1)}function xe(n){var t=n?n.length:0;return t?n[t-1]:b}function Ae(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if("number"==typeof r)u=(0>r?yo(e+r,0):wo(r||0,e-1))+1;else if(r){u=er(n,t,!0)-1;var i=n[u];return(t===t?t===i:i!==i)?u:-1}if(t!==t)return s(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1}function je(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=Br(),u=n.length;++r<u;)for(var i=0,o=n[r];(i=e(t,o,i))>-1;)lo.call(t,i,1);return t}function Oe(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,i=[],o=n.length;for(t=Nr(t,r,3);++u<o;){var f=n[u];t(f,u,n)&&(e.push(f),i.push(u))}return Kt(n,i),e}function Re(n){return se(n,1)}function ke(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Jr(n,t,r)&&(t=0,r=e),Gt(n,t,r)):[]}function Ie(n,t,r){var e=n?n.length:0;return e?((r?Jr(n,t,r):null==t)&&(t=1),Gt(n,0,0>t?0:t)):[]}function Ee(n,t,r){var e=n?n.length:0;return e?((r?Jr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Gt(n,0>t?0:t)):[]}function Ce(n,t,r){return n&&n.length?tr(n,Nr(t,r,3),!1,!0):[]}function We(n,t,r){return n&&n.length?tr(n,Nr(t,r,3)):[]}function Se(n,t,e,u){var i=n?n.length:0;if(!i)return[];null!=t&&"boolean"!=typeof t&&(u=e,e=Jr(n,t,u)?null:t,t=!1);var o=Nr();return null==e&&o===mt||(e=o(e,u,3)),t&&Br()==r?g(n,e):Qt(n,e)}function Te(n){if(!n||!n.length)return[];var t=-1,r=0;n=at(n,function(n){return Yr(n)?(r=yo(n.length,r),!0):void 0});for(var e=Ti(r);++t<r;)e[t]=lt(n,Dt(t));return e}function Ue(n,t,r){var e=n?n.length:0;if(!e)return[];var u=Te(n);return null==t?u:(t=ir(t,r,4),lt(u,function(n){return ct(n,t,b,!0)}))}function $e(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Yr(r))var e=e?At(e,r).concat(At(r,e)):r}return e?Qt(e):[]}function Fe(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||If(n[0])||(t=[]);++r<e;){var i=n[r];t?u[i]=t[r]:i&&(u[i[0]]=i[1])}return u}function Ne(n){var t=Y(n);return t.__chain__=!0,t}function Le(n,t,r){return t.call(r,n),n}function Be(n,t,r){return t.call(r,n)}function ze(){return Ne(this)}function Pe(){return new Q(this.value(),this.__chain__)}function qe(n){for(var t,r=this;r instanceof Z;){var e=le(r);t?u.__wrapped__=e:t=e;var u=e;r=r.__wrapped__}return u.__wrapped__=n,t}function De(){var n=this.__wrapped__;return n instanceof Dn?(this.__actions__.length&&(n=new Dn(this)),new Q(n.reverse(),this.__chain__)):this.thru(function(n){return n.reverse()})}function Me(){return this.value()+""}function Ke(){return rr(this.__wrapped__,this.__actions__)}function Ve(n,t,r){var e=If(n)?ot:jt;return r&&Jr(n,t,r)&&(t=null),"function"==typeof t&&r===b||(t=Nr(t,r,3)),e(n,t)}function Ye(n,t,r){var e=If(n)?at:kt;return t=Nr(t,r,3),e(n,t)}function Ge(n,t){return ef(n,Bt(t))}function Je(n,t,r,e){var u=n?qo(n):0;return Hr(u)||(n=Hu(n),u=n.length),u?(r="number"!=typeof r||e&&Jr(t,r,e)?0:0>r?yo(u+r,0):r||0,"string"==typeof n||!If(n)&&$u(n)?u>r&&n.indexOf(t,r)>-1:Br(n,t,r)>-1):!1}function Xe(n,t,r){var e=If(n)?lt:Lt;return t=Nr(t,r,3),e(n,t)}function Ze(n,t){return Xe(n,Ri(t))}function He(n,t,r){var e=If(n)?at:kt;return t=Nr(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})}function Qe(n,t,r){if(r?Jr(n,t,r):null==t){n=oe(n);var e=n.length;return e>0?n[Vt(0,e-1)]:b}var u=-1,i=zu(n),e=i.length,o=e-1;for(t=wo(0>t?0:+t||0,e);++u<t;){var f=Vt(u,o),a=i[f];i[f]=i[u],i[u]=a}return i.length=t,i}function nu(n){return Qe(n,Oo)}function tu(n){var t=n?qo(n):0;return Hr(t)?t:zf(n).length}function ru(n,t,r){var e=If(n)?st:Jt;return r&&Jr(n,t,r)&&(t=null),"function"==typeof t&&r===b||(t=Nr(t,r,3)),e(n,t)}function eu(n,t,r){if(null==n)return[];r&&Jr(n,t,r)&&(t=null);var e=-1;t=Nr(t,r,3);var u=Lt(n,function(n,r,u){return{criteria:t(n,r,u),index:++e,value:n}});return Xt(u,f)}function uu(n,t,r,e){return null==n?[]:(e&&Jr(t,r,e)&&(r=null),If(t)||(t=null==t?[]:[t]),If(r)||(r=null==r?[]:[r]),Zt(n,t,r))}function iu(n,t){return Ye(n,Bt(t))}function ou(n,t){if("function"!=typeof t){if("function"!=typeof n)throw new qi(B);var r=n;n=t,t=r}return n=_o(n=+n)?n:0,function(){return--n<1?t.apply(this,arguments):void 0}}function fu(n,t,r){return r&&Jr(n,t,r)&&(t=null),t=n&&null==t?n.length:yo(+t||0,0),Tr(n,C,null,null,null,null,t)}function au(n,t){var r;if("function"!=typeof t){if("function"!=typeof n)throw new qi(B);var e=n;n=t,t=e}return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}}function lu(n,t,r){function e(){s&&ro(s),a&&ro(a),a=s=h=b}function u(){var r=t-(_f()-c);if(0>=r||r>t){a&&ro(a);var e=h;a=s=h=b,e&&(v=_f(),l=n.apply(p,f),s||a||(f=p=null))}else s=ao(u,r)}function i(){s&&ro(s),a=s=h=b,(g||_!==t)&&(v=_f(),l=n.apply(p,f),s||a||(f=p=null))}function o(){if(f=arguments,c=_f(),p=this,h=g&&(s||!y),_===!1)var r=y&&!s;else{a||y||(v=c);var e=_-(c-v),o=0>=e||e>_;o?(a&&(a=ro(a)),v=c,l=n.apply(p,f)):a||(a=ao(i,e))}return o&&s?s=ro(s):s||t===_||(s=ao(u,t)),r&&(o=!0,l=n.apply(p,f)),!o||s||a||(f=p=null),l}var f,a,l,c,p,s,h,v=0,_=!1,g=!0;if("function"!=typeof n)throw new qi(B);if(t=0>t?0:+t||0,r===!0){var y=!0;g=!1}else Iu(r)&&(y=r.leading,_="maxWait"in r&&yo(+r.maxWait||0,t),g="trailing"in r?r.trailing:g);return o.cancel=e,o}function cu(n,t){if("function"!=typeof n||t&&"function"!=typeof t)throw new qi(B);var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;if(i.has(u))return i.get(u);var o=n.apply(this,e);return r.cache=i.set(u,o),o};return r.cache=new cu.Cache,r}function pu(n){if("function"!=typeof n)throw new qi(B);return function(){return!n.apply(this,arguments)}}function su(n){return au(2,n)}function hu(n,t){if("function"!=typeof n)throw new qi(B);return t=yo(t===b?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=yo(r.length-t,0),i=Ti(u);++e<u;)i[e]=r[t+e];switch(t){case 0:return n.call(this,i);case 1:return n.call(this,r[0],i);case 2:return n.call(this,r[0],r[1],i)}var o=Ti(t+1);for(e=-1;++e<t;)o[e]=r[e];return o[t]=i,n.apply(this,o)}}function vu(n){if("function"!=typeof n)throw new qi(B);return function(t){return n.apply(this,t)}}function _u(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new qi(B);return r===!1?e=!1:Iu(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),qn.leading=e,qn.maxWait=+t,qn.trailing=u,lu(n,t,qn)}function gu(n,t){return t=null==t?mi:t,Tr(t,I,null,[n],[])}function yu(n,t,r,e){return t&&"boolean"!=typeof t&&Jr(n,t,r)?t=!1:"function"==typeof t&&(e=r,r=t,t=!1),"function"==typeof r?bt(n,t,ir(r,e,1)):bt(n,t)}function du(n,t,r){return"function"==typeof t?bt(n,!0,ir(t,r,1)):bt(n,!0)}function wu(n,t){return n>t}function mu(n,t){return n>=t}function bu(n){return h(n)&&Yr(n)&&Xi.call(n)==P}function xu(n){return n===!0||n===!1||h(n)&&Xi.call(n)==D}function Au(n){return h(n)&&Xi.call(n)==M}function ju(n){return!!n&&1===n.nodeType&&h(n)&&Xi.call(n).indexOf("Element")>-1}function Ou(n){return null==n?!0:Yr(n)&&(If(n)||$u(n)||bu(n)||h(n)&&Cf(n.splice))?!n.length:!zf(n).length}function Ru(n,t,r,e){r="function"==typeof r?ir(r,e,3):b;var u=r?r(n,t):b;return u===b?$t(n,t,r):!!u}function ku(n){return h(n)&&"string"==typeof n.message&&Xi.call(n)==K}function Iu(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function Eu(n,t,r,e){return r="function"==typeof r?ir(r,e,3):b,Nt(n,zr(t),r)}function Cu(n){return Tu(n)&&n!=+n}function Wu(n){return null==n?!1:Xi.call(n)==V?Hi.test(Yi.call(n)):h(n)&&Wn.test(n)}function Su(n){return null===n}function Tu(n){return"number"==typeof n||h(n)&&Xi.call(n)==G}function Uu(n){return h(n)&&Xi.call(n)==X}function $u(n){return"string"==typeof n||h(n)&&Xi.call(n)==H}function Fu(n){return h(n)&&Hr(n.length)&&!!zn[Xi.call(n)]}function Nu(n){return n===b}function Lu(n,t){return t>n}function Bu(n,t){return t>=n}function zu(n){var t=n?qo(n):0;return Hr(t)?t?et(n):[]:Hu(n)}function Pu(n){return wt(n,Yu(n))}function qu(n,t,r){var e=Uo(n);return r&&Jr(n,t,r)&&(t=null),t?yt(e,t):e}function Du(n){return Tt(n,Yu(n))}function Mu(n,t,r){var e=null==n?b:Ut(n,ae(t),t+"");return e===b?r:e}function Ku(n,t){if(null==n)return!1;var r=Gi.call(n,t);if(!r&&!Xr(t)){if(t=ae(t),n=1==t.length?n:Ut(n,Gt(t,0,-1)),null==n)return!1;t=xe(t),r=Gi.call(n,t)}return r||Hr(n.length)&&Gr(t,n.length)&&(If(n)||bu(n))}function Vu(n,t,r){r&&Jr(n,t,r)&&(t=null);for(var e=-1,u=zf(n),i=u.length,o={};++e<i;){var f=u[e],a=n[f];t?Gi.call(o,a)?o[a].push(f):o[a]=[f]:o[a]=f}return o}function Yu(n){if(null==n)return[];Iu(n)||(n=Bi(n));var t=n.length;t=t&&Hr(t)&&(If(n)||bu(n))&&t||0;for(var r=n.constructor,e=-1,u="function"==typeof r&&r.prototype===n,i=Ti(t),o=t>0;++e<t;)i[e]=e+"";for(var f in n)o&&Gr(f,t)||"constructor"==f&&(u||!Gi.call(n,f))||i.push(f);return i}function Gu(n){n=fe(n);for(var t=-1,r=zf(n),e=r.length,u=Ti(e);++t<e;){var i=r[t];u[t]=[i,n[i]]}return u}function Ju(n,t,r){var e=null==n?b:n[t];return e===b&&(null==n||Xr(t,n)||(t=ae(t),n=1==t.length?n:Ut(n,Gt(t,0,-1)),e=null==n?b:n[xe(t)]),e=e===b?r:e),Cf(e)?e.call(n):e}function Xu(n,t,r){if(null==n)return n;var e=t+"";t=null!=n[e]||Xr(t,n)?[e]:ae(t);for(var u=-1,i=t.length,o=i-1,f=n;null!=f&&++u<i;){var a=t[u];Iu(f)&&(u==o?f[a]=r:null==f[a]&&(f[a]=Gr(t[u+1])?[]:{})),f=f[a]}return n}function Zu(n,t,r,e){var u=If(n)||Fu(n);if(t=Nr(t,e,4),null==r)if(u||Iu(n)){var i=n.constructor;r=u?If(n)?new i:[]:Uo(Cf(i)?i.prototype:null)}else r={};return(u?ut:Wt)(n,function(n,e,u){return t(r,n,e,u)}),r}function Hu(n){return nr(n,zf(n))}function Qu(n){return nr(n,Yu(n))}function ni(n,t,r){return t=+t||0,"undefined"==typeof r?(r=t,t=0):r=+r||0,n>=wo(t,r)&&n<yo(t,r)}function ti(n,t,r){r&&Jr(n,t,r)&&(t=r=null);var e=null==n,u=null==t;if(null==r&&(u&&"boolean"==typeof n?(r=n,n=1):"boolean"==typeof t&&(r=t,u=!0)),e&&u&&(t=1,u=!1),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1){var i=Ao();return wo(n+i*(t-n+io("1e-"+((i+"").length-1))),t)}return Vt(n,t)}function ri(n){return n=u(n),n&&n.charAt(0).toUpperCase()+n.slice(1)}function ei(n){return n=u(n),n&&n.replace(Tn,l).replace(Rn,"")}function ui(n,t,r){n=u(n),t+="";var e=n.length;return r=r===b?e:wo(0>r?0:+r||0,e),r-=t.length,r>=0&&n.indexOf(t,r)==r}function ii(n){return n=u(n),n&&yn.test(n)?n.replace(_n,c):n}function oi(n){return n=u(n),n&&On.test(n)?n.replace(jn,"\\$&"):n}function fi(n,t,r){n=u(n),t=+t;var e=n.length;if(e>=t||!_o(t))return n;var i=(t-e)/2,o=eo(i),f=to(i);return r=Cr("",f,r),r.slice(0,o)+n+r}function ai(n,t,r){return r&&Jr(n,t,r)&&(t=0),xo(n,t)}function li(n,t){
var r="";if(n=u(n),t=+t,1>t||!n||!_o(t))return r;do t%2&&(r+=n),t=eo(t/2),n+=n;while(t);return r}function ci(n,t,r){return n=u(n),r=null==r?0:wo(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r}function pi(n,t,r){var e=Y.templateSettings;r&&Jr(n,t,r)&&(t=r=null),n=u(n),t=gt(yt({},r||t),e,_t);var i,o,f=gt(yt({},t.imports),e.imports,_t),a=zf(f),l=nr(f,a),c=0,s=t.interpolate||Un,h="__p += '",v=zi((t.escape||Un).source+"|"+s.source+"|"+(s===mn?In:Un).source+"|"+(t.evaluate||Un).source+"|$","g"),_="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Bn+"]")+"\n";n.replace(v,function(t,r,e,u,f,a){return e||(e=u),h+=n.slice(c,a).replace($n,p),r&&(i=!0,h+="' +\n__e("+r+") +\n'"),f&&(o=!0,h+="';\n"+f+";\n__p += '"),e&&(h+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),c=a+t.length,t}),h+="';\n";var g=t.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(pn,""):h).replace(sn,"$1").replace(hn,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=Hf(function(){return Fi(a,_+"return "+h).apply(b,l)});if(y.source=h,ku(y))throw y;return y}function si(n,t,r){var e=n;return(n=u(n))?(r?Jr(e,t,r):null==t)?n.slice(y(n),d(n)+1):(t+="",n.slice(i(n,t),o(n,t)+1)):n}function hi(n,t,r){var e=n;return n=u(n),n?(r?Jr(e,t,r):null==t)?n.slice(y(n)):n.slice(i(n,t+"")):n}function vi(n,t,r){var e=n;return n=u(n),n?(r?Jr(e,t,r):null==t)?n.slice(0,d(n)+1):n.slice(0,o(n,t+"")+1):n}function _i(n,t,r){r&&Jr(n,t,r)&&(t=null);var e=S,i=T;if(null!=t)if(Iu(t)){var o="separator"in t?t.separator:o;e="length"in t?+t.length||0:e,i="omission"in t?u(t.omission):i}else e=+t||0;if(n=u(n),e>=n.length)return n;var f=e-i.length;if(1>f)return i;var a=n.slice(0,f);if(null==o)return a+i;if(Uu(o)){if(n.slice(f).search(o)){var l,c,p=n.slice(0,f);for(o.global||(o=zi(o.source,(En.exec(o)||"")+"g")),o.lastIndex=0;l=o.exec(p);)c=l.index;a=a.slice(0,null==c?f:c)}}else if(n.indexOf(o,f)!=f){var s=a.lastIndexOf(o);s>-1&&(a=a.slice(0,s))}return a+i}function gi(n){return n=u(n),n&&gn.test(n)?n.replace(vn,w):n}function yi(n,t,r){return r&&Jr(n,t,r)&&(t=null),n=u(n),n.match(t||Fn)||[]}function di(n,t,r){return r&&Jr(n,t,r)&&(t=null),h(n)?bi(n):mt(n,t)}function wi(n){return function(){return n}}function mi(n){return n}function bi(n){return Bt(bt(n,!0))}function xi(n,t){return zt(n,bt(t,!0))}function Ai(n,t,r){if(null==r){var e=Iu(t),u=e?zf(t):null,i=u&&u.length?Tt(t,u):null;(i?i.length:e)||(i=!1,r=t,t=n,n=this)}i||(i=Tt(t,zf(t)));var o=!0,f=-1,a=Cf(n),l=i.length;r===!1?o=!1:Iu(r)&&"chain"in r&&(o=r.chain);for(;++f<l;){var c=i[f],p=t[c];n[c]=p,a&&(n.prototype[c]=function(t){return function(){var r=this.__chain__;if(o||r){var e=n(this.__wrapped__),u=e.__actions__=et(this.__actions__);return u.push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}var i=[this.value()];return oo.apply(i,arguments),t.apply(n,i)}}(p))}return n}function ji(){return v._=Zi,this}function Oi(){}function Ri(n){return Xr(n)?Dt(n):Mt(n)}function ki(n){return function(t){return Ut(n,ae(t),t+"")}}function Ii(n,t,r){r&&Jr(n,t,r)&&(t=r=null),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;for(var e=-1,u=yo(to((t-n)/(r||1)),0),i=Ti(u);++e<u;)i[e]=n,n+=r;return i}function Ei(n,t,r){if(n=eo(n),1>n||!_o(n))return[];var e=-1,u=Ti(wo(n,Ro));for(t=ir(t,r,1);++e<n;)Ro>e?u[e]=t(e):t(e);return u}function Ci(n){var t=++Ji;return u(n)+t}function Wi(n,t){return(+n||0)+(+t||0)}function Si(n,t,r){r&&Jr(n,t,r)&&(t=null);var e=Nr(),u=null==t;return u&&e===mt||(u=!1,t=e(t,r,3)),u?ht(If(n)?n:oe(n)):Ht(n,t)}v=v?tt.defaults(nt.Object(),v,tt.pick(nt,Ln)):nt;var Ti=v.Array,Ui=v.Date,$i=v.Error,Fi=v.Function,Ni=v.Math,Li=v.Number,Bi=v.Object,zi=v.RegExp,Pi=v.String,qi=v.TypeError,Di=Ti.prototype,Mi=Bi.prototype,Ki=Pi.prototype,Vi=(Vi=v.window)?Vi.document:null,Yi=Fi.prototype.toString,Gi=Mi.hasOwnProperty,Ji=0,Xi=Mi.toString,Zi=v._,Hi=zi("^"+oi(Yi.call(Gi)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qi=Pr(v,"ArrayBuffer"),no=Pr(Qi&&new Qi(0),"slice"),to=Ni.ceil,ro=v.clearTimeout,eo=Ni.floor,uo=Pr(Bi,"getPrototypeOf"),io=v.parseFloat,oo=Di.push,fo=Pr(v,"Set"),ao=v.setTimeout,lo=Di.splice,co=Pr(v,"Uint8Array"),po=Pr(v,"WeakMap"),so=function(){try{var n=Pr(v,"Float64Array"),t=new n(new Qi(10),0,1)&&n}catch(r){}return t||null}(),ho=Pr(Bi,"create"),vo=Pr(Ti,"isArray"),_o=v.isFinite,go=Pr(Bi,"keys"),yo=Ni.max,wo=Ni.min,mo=Pr(Ui,"now"),bo=Pr(Li,"isFinite"),xo=v.parseInt,Ao=Ni.random,jo=Li.NEGATIVE_INFINITY,Oo=Li.POSITIVE_INFINITY,Ro=4294967295,ko=Ro-1,Io=Ro>>>1,Eo=so?so.BYTES_PER_ELEMENT:0,Co=9007199254740991,Wo=po&&new po,So={},To=Y.support={};!function(n){var t=function(){this.x=n},r=[];t.prototype={valueOf:n,y:n};for(var e in new t)r.push(e);try{To.dom=11===Vi.createDocumentFragment().nodeType}catch(u){To.dom=!1}}(1,0),Y.templateSettings={escape:dn,evaluate:wn,interpolate:mn,variable:"",imports:{_:Y}};var Uo=function(){function n(){}return function(t){if(Iu(t)){n.prototype=t;var r=new n;n.prototype=null}return r||{}}}(),$o=pr(Wt),Fo=pr(St,!0),No=sr(),Lo=sr(!0),Bo=Wo?function(n,t){return Wo.set(n,t),n}:mi;no||(or=Qi&&co?function(n){var t=n.byteLength,r=so?eo(t/Eo):0,e=r*Eo,u=new Qi(t);if(r){var i=new so(u,0,r);i.set(new so(n,0,r))}return t!=e&&(i=new co(u,e),i.set(new co(n,e))),u}:wi(null));var zo=ho&&fo?function(n){return new Hn(n)}:wi(null),Po=Wo?function(n){return Wo.get(n)}:Oi,qo=Dt("length"),Do=function(){var n=0,t=0;return function(r,e){var u=_f(),i=$-(u-t);if(t=u,i>0){if(++n>=U)return r}else n=0;return Bo(r,e)}}(),Mo=hu(function(n,t){return Yr(n)?At(n,Et(t,!1,!0)):[]}),Ko=wr(),Vo=wr(!0),Yo=hu(function(n){for(var t=n.length,e=t,u=Ti(p),i=Br(),o=i==r,f=[];e--;){var a=n[e]=Yr(a=n[e])?a:[];u[e]=o&&a.length>=120?zo(e&&a):null}var l=n[0],c=-1,p=l?l.length:0,s=u[0];n:for(;++c<p;)if(a=l[c],(s?Qn(s,a):i(f,a,0))<0){for(var e=t;--e;){var h=u[e];if((h?Qn(h,a):i(n[e],a,0))<0)continue n}s&&s.push(a),f.push(a)}return f}),Go=hu(function(t,r){r=Et(r);var e=dt(t,r);return Kt(t,r.sort(n)),e}),Jo=Sr(),Xo=Sr(!0),Zo=hu(function(n){return Qt(Et(n,!1,!0))}),Ho=hu(function(n,t){return Yr(n)?At(n,t):[]}),Qo=hu(Te),nf=hu(function(n){var t=n.length,r=t>2?n[t-2]:b,e=t>1?n[t-1]:b;return t>2&&"function"==typeof r?t-=2:(r=t>1&&"function"==typeof e?(--t,e):b,e=b),n.length=t,Ue(n,r,e)}),tf=hu(function(n,t){return dt(n,Et(t))}),rf=lr(function(n,t,r){Gi.call(n,r)?++n[r]:n[r]=1}),ef=dr($o),uf=dr(Fo,!0),of=xr(ut,$o),ff=xr(it,Fo),af=lr(function(n,t,r){Gi.call(n,r)?n[r].push(t):n[r]=[t]}),lf=lr(function(n,t,r){n[r]=t}),cf=hu(function(n,t,r){var e=-1,u="function"==typeof t,i=Xr(t),o=Yr(n)?Ti(n.length):[];return $o(n,function(n){var f=u?t:i&&null!=n?n[t]:null;o[++e]=f?f.apply(n,r):Vr(n,t,r)}),o}),pf=lr(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),sf=Ir(ct,$o),hf=Ir(pt,Fo),vf=hu(function(n,t){if(null==n)return[];var r=t[2];return r&&Jr(t[0],t[1],r)&&(t.length=1),Zt(n,Et(t),[])}),_f=mo||function(){return(new Ui).getTime()},gf=hu(function(n,t,r){var e=A;if(r.length){var u=_(r,gf.placeholder);e|=I}return Tr(n,e,t,r,u)}),yf=hu(function(n,t){t=t.length?Et(t):Du(n);for(var r=-1,e=t.length;++r<e;){var u=t[r];n[u]=Tr(n[u],A,n)}return n}),df=hu(function(n,t,r){var e=A|j;if(r.length){var u=_(r,df.placeholder);e|=I}return Tr(t,e,n,r,u)}),wf=gr(R),mf=gr(k),bf=hu(function(n,t){return xt(n,1,t)}),xf=hu(function(n,t,r){return xt(n,t,r)}),Af=br(),jf=br(!0),Of=kr(I),Rf=kr(E),kf=hu(function(n,t){return Tr(n,W,null,null,null,Et(t))}),If=vo||function(n){return h(n)&&Hr(n.length)&&Xi.call(n)==q};To.dom||(ju=function(n){return!!n&&1===n.nodeType&&h(n)&&!Wf(n)});var Ef=bo||function(n){return"number"==typeof n&&_o(n)},Cf=e(/x/)||co&&!e(co)?function(n){return Xi.call(n)==V}:e,Wf=uo?function(n){if(!n||Xi.call(n)!=J)return!1;var t=Pr(n,"valueOf"),r=t&&(r=uo(t))&&uo(r);return r?n==r||uo(n)==r:ue(n)}:ue,Sf=cr(function(n,t,r){return r?gt(n,t,r):yt(n,t)}),Tf=hu(function(n){var t=n[0];return null==t?t:(n.push(vt),Sf.apply(b,n))}),Uf=mr(Wt),$f=mr(St),Ff=Ar(No),Nf=Ar(Lo),Lf=jr(Wt),Bf=jr(St),zf=go?function(n){var t=null==n?null:n.constructor;return"function"==typeof t&&t.prototype===n||"function"!=typeof n&&Yr(n)?ie(n):Iu(n)?go(n):[]}:ie,Pf=Or(!0),qf=Or(),Df=cr(Pt),Mf=hu(function(n,t){if(null==n)return{};if("function"!=typeof t[0]){var t=lt(Et(t),Pi);return te(n,At(Yu(n),t))}var r=ir(t[0],t[1],3);return re(n,function(n,t,e){return!r(n,t,e)})}),Kf=hu(function(n,t){return null==n?{}:"function"==typeof t[0]?re(n,ir(t[0],t[1],3)):te(n,Et(t))}),Vf=vr(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Yf=vr(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Gf=Rr(),Jf=Rr(!0);8!=xo(Nn+"08")&&(ai=function(n,t,r){return(r?Jr(n,t,r):null==t)?t=0:t&&(t=+t),n=si(n),xo(n,t||(Cn.test(n)?16:10))});var Xf=vr(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Zf=vr(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Hf=hu(function(n,t){try{return n.apply(b,t)}catch(r){return ku(r)?r:new $i(r)}}),Qf=hu(function(n,t){return function(r){return Vr(r,n,t)}}),na=hu(function(n,t){return function(r){return Vr(n,r,t)}}),ta=yr(wu,jo),ra=yr(Lu,Oo);return Y.prototype=Z.prototype,Q.prototype=Uo(Z.prototype),Q.prototype.constructor=Q,Dn.prototype=Uo(Z.prototype),Dn.prototype.constructor=Dn,Yn.prototype["delete"]=Gn,Yn.prototype.get=Jn,Yn.prototype.has=Xn,Yn.prototype.set=Zn,Hn.prototype.push=rt,cu.Cache=Yn,Y.after=ou,Y.ary=fu,Y.assign=Sf,Y.at=tf,Y.before=au,Y.bind=gf,Y.bindAll=yf,Y.bindKey=df,Y.callback=di,Y.chain=Ne,Y.chunk=ce,Y.compact=pe,Y.constant=wi,Y.countBy=rf,Y.create=qu,Y.curry=wf,Y.curryRight=mf,Y.debounce=lu,Y.defaults=Tf,Y.defer=bf,Y.delay=xf,Y.difference=Mo,Y.drop=se,Y.dropRight=he,Y.dropRightWhile=ve,Y.dropWhile=_e,Y.fill=ge,Y.filter=Ye,Y.flatten=de,Y.flattenDeep=we,Y.flow=Af,Y.flowRight=jf,Y.forEach=of,Y.forEachRight=ff,Y.forIn=Ff,Y.forInRight=Nf,Y.forOwn=Lf,Y.forOwnRight=Bf,Y.functions=Du,Y.groupBy=af,Y.indexBy=lf,Y.initial=be,Y.intersection=Yo,Y.invert=Vu,Y.invoke=cf,Y.keys=zf,Y.keysIn=Yu,Y.map=Xe,Y.mapKeys=Pf,Y.mapValues=qf,Y.matches=bi,Y.matchesProperty=xi,Y.memoize=cu,Y.merge=Df,Y.method=Qf,Y.methodOf=na,Y.mixin=Ai,Y.negate=pu,Y.omit=Mf,Y.once=su,Y.pairs=Gu,Y.partial=Of,Y.partialRight=Rf,Y.partition=pf,Y.pick=Kf,Y.pluck=Ze,Y.property=Ri,Y.propertyOf=ki,Y.pull=je,Y.pullAt=Go,Y.range=Ii,Y.rearg=kf,Y.reject=He,Y.remove=Oe,Y.rest=Re,Y.restParam=hu,Y.set=Xu,Y.shuffle=nu,Y.slice=ke,Y.sortBy=eu,Y.sortByAll=vf,Y.sortByOrder=uu,Y.spread=vu,Y.take=Ie,Y.takeRight=Ee,Y.takeRightWhile=Ce,Y.takeWhile=We,Y.tap=Le,Y.throttle=_u,Y.thru=Be,Y.times=Ei,Y.toArray=zu,Y.toPlainObject=Pu,Y.transform=Zu,Y.union=Zo,Y.uniq=Se,Y.unzip=Te,Y.unzipWith=Ue,Y.values=Hu,Y.valuesIn=Qu,Y.where=iu,Y.without=Ho,Y.wrap=gu,Y.xor=$e,Y.zip=Qo,Y.zipObject=Fe,Y.zipWith=nf,Y.backflow=jf,Y.collect=Xe,Y.compose=jf,Y.each=of,Y.eachRight=ff,Y.extend=Sf,Y.iteratee=di,Y.methods=Du,Y.object=Fe,Y.select=Ye,Y.tail=Re,Y.unique=Se,Ai(Y,Y),Y.add=Wi,Y.attempt=Hf,Y.camelCase=Vf,Y.capitalize=ri,Y.clone=yu,Y.cloneDeep=du,Y.deburr=ei,Y.endsWith=ui,Y.escape=ii,Y.escapeRegExp=oi,Y.every=Ve,Y.find=ef,Y.findIndex=Ko,Y.findKey=Uf,Y.findLast=uf,Y.findLastIndex=Vo,Y.findLastKey=$f,Y.findWhere=Ge,Y.first=ye,Y.get=Mu,Y.gt=wu,Y.gte=mu,Y.has=Ku,Y.identity=mi,Y.includes=Je,Y.indexOf=me,Y.inRange=ni,Y.isArguments=bu,Y.isArray=If,Y.isBoolean=xu,Y.isDate=Au,Y.isElement=ju,Y.isEmpty=Ou,Y.isEqual=Ru,Y.isError=ku,Y.isFinite=Ef,Y.isFunction=Cf,Y.isMatch=Eu,Y.isNaN=Cu,Y.isNative=Wu,Y.isNull=Su,Y.isNumber=Tu,Y.isObject=Iu,Y.isPlainObject=Wf,Y.isRegExp=Uu,Y.isString=$u,Y.isTypedArray=Fu,Y.isUndefined=Nu,Y.kebabCase=Yf,Y.last=xe,Y.lastIndexOf=Ae,Y.lt=Lu,Y.lte=Bu,Y.max=ta,Y.min=ra,Y.noConflict=ji,Y.noop=Oi,Y.now=_f,Y.pad=fi,Y.padLeft=Gf,Y.padRight=Jf,Y.parseInt=ai,Y.random=ti,Y.reduce=sf,Y.reduceRight=hf,Y.repeat=li,Y.result=Ju,Y.runInContext=m,Y.size=tu,Y.snakeCase=Xf,Y.some=ru,Y.sortedIndex=Jo,Y.sortedLastIndex=Xo,Y.startCase=Zf,Y.startsWith=ci,Y.sum=Si,Y.template=pi,Y.trim=si,Y.trimLeft=hi,Y.trimRight=vi,Y.trunc=_i,Y.unescape=gi,Y.uniqueId=Ci,Y.words=yi,Y.all=Ve,Y.any=ru,Y.contains=Je,Y.eq=Ru,Y.detect=ef,Y.foldl=sf,Y.foldr=hf,Y.head=ye,Y.include=Je,Y.inject=sf,Ai(Y,function(){var n={};return Wt(Y,function(t,r){Y.prototype[r]||(n[r]=t)}),n}(),!1),Y.sample=Qe,Y.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return Qe(t,n)}):Qe(this.value())},Y.VERSION=x,ut(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){Y[n].placeholder=Y}),ut(["dropWhile","filter","map","takeWhile"],function(n,t){var r=t!=L,e=t==F;Dn.prototype[n]=function(n,u){var i=this.__filtered__,o=i&&e?new Dn(this):this.clone(),f=o.__iteratees__||(o.__iteratees__=[]);return f.push({done:!1,count:0,index:0,iteratee:Nr(n,u,1),limit:-1,type:t}),o.__filtered__=i||r,o}}),ut(["drop","take"],function(n,t){var r=n+"While";Dn.prototype[n]=function(r){var e=this.__filtered__,u=e&&!t?this.dropWhile():this.clone();if(r=null==r?1:yo(eo(r)||0,0),e)t?u.__takeCount__=wo(u.__takeCount__,r):xe(u.__iteratees__).limit=r;else{var i=u.__views__||(u.__views__=[]);i.push({size:r,type:n+(u.__dir__<0?"Right":"")})}return u},Dn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()},Dn.prototype[n+"RightWhile"]=function(n,t){return this.reverse()[r](n,t).reverse()}}),ut(["first","last"],function(n,t){var r="take"+(t?"Right":"");Dn.prototype[n]=function(){return this[r](1).value()[0]}}),ut(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");Dn.prototype[n]=function(){return this[r](1)}}),ut(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?Bt:Ri;Dn.prototype[n]=function(n){return this[r](e(n))}}),Dn.prototype.compact=function(){return this.filter(mi)},Dn.prototype.reject=function(n,t){return n=Nr(n,t,1),this.filter(function(t){return!n(t)})},Dn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return 0>n?r=this.takeRight(-n):n&&(r=this.drop(n)),t!==b&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r},Dn.prototype.toArray=function(){return this.drop(0)},Wt(Dn.prototype,function(n,t){var r=Y[t];if(r){var e=/^(?:filter|map|reject)|While$/.test(t),u=/^(?:first|last)$/.test(t);Y.prototype[t]=function(){var t=arguments,i=this.__chain__,o=this.__wrapped__,f=!!this.__actions__.length,a=o instanceof Dn,l=t[0],c=a||If(o);c&&e&&"function"==typeof l&&1!=l.length&&(a=c=!1);var p=a&&!f;if(u&&!i)return p?n.call(o):r.call(Y,this.value());var s=function(n){var e=[n];return oo.apply(e,t),r.apply(Y,e)};if(c){var h=p?o:new Dn(this),v=n.apply(h,t);if(!u&&(f||v.__actions__)){var _=v.__actions__||(v.__actions__=[]);_.push({func:Be,args:[s],thisArg:Y})}return new Q(v,i)}return this.thru(s)}}}),ut(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(n){var t=(/^(?:replace|split)$/.test(n)?Ki:Di)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);Y.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),Wt(Dn.prototype,function(n,t){var r=Y[t];if(r){var e=r.name,u=So[e]||(So[e]=[]);u.push({name:t,func:r})}}),So[Er(null,j).name]=[{name:"wrapper",func:null}],Dn.prototype.clone=Mn,Dn.prototype.reverse=Kn,Dn.prototype.value=Vn,Y.prototype.chain=ze,Y.prototype.commit=Pe,Y.prototype.plant=qe,Y.prototype.reverse=De,Y.prototype.toString=Me,Y.prototype.run=Y.prototype.toJSON=Y.prototype.valueOf=Y.prototype.value=Ke,Y.prototype.collect=Y.prototype.map,Y.prototype.head=Y.prototype.first,Y.prototype.select=Y.prototype.filter,Y.prototype.tail=Y.prototype.rest,Y}var b,x="3.9.3",A=1,j=2,O=4,R=8,k=16,I=32,E=64,C=128,W=256,S=30,T="...",U=150,$=16,F=0,N=1,L=2,B="Expected a function",z="__lodash_placeholder__",P="[object Arguments]",q="[object Array]",D="[object Boolean]",M="[object Date]",K="[object Error]",V="[object Function]",Y="[object Map]",G="[object Number]",J="[object Object]",X="[object RegExp]",Z="[object Set]",H="[object String]",Q="[object WeakMap]",nn="[object ArrayBuffer]",tn="[object Float32Array]",rn="[object Float64Array]",en="[object Int8Array]",un="[object Int16Array]",on="[object Int32Array]",fn="[object Uint8Array]",an="[object Uint8ClampedArray]",ln="[object Uint16Array]",cn="[object Uint32Array]",pn=/\b__p \+= '';/g,sn=/\b(__p \+=) '' \+/g,hn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vn=/&(?:amp|lt|gt|quot|#39|#96);/g,_n=/[&<>"'`]/g,gn=RegExp(vn.source),yn=RegExp(_n.source),dn=/<%-([\s\S]+?)%>/g,wn=/<%([\s\S]+?)%>/g,mn=/<%=([\s\S]+?)%>/g,bn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,xn=/^\w*$/,An=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,jn=/[.*+?^${}()|[\]\/\\]/g,On=RegExp(jn.source),Rn=/[\u0300-\u036f\ufe20-\ufe23]/g,kn=/\\(\\)?/g,In=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,En=/\w*$/,Cn=/^0[xX]/,Wn=/^\[object .+?Constructor\]$/,Sn=/^\d+$/,Tn=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Un=/($^)/,$n=/['\n\r\u2028\u2029\\]/g,Fn=function(){var n="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(n+"+(?="+n+t+")|"+n+"?"+t+"|"+n+"+|[0-9]+","g")}(),Nn=" 	\x0B\f \ufeff\n\r\u2028\u2029 ᠎             　",Ln=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],Bn=-1,zn={};zn[tn]=zn[rn]=zn[en]=zn[un]=zn[on]=zn[fn]=zn[an]=zn[ln]=zn[cn]=!0,zn[P]=zn[q]=zn[nn]=zn[D]=zn[M]=zn[K]=zn[V]=zn[Y]=zn[G]=zn[J]=zn[X]=zn[Z]=zn[H]=zn[Q]=!1;var Pn={};Pn[P]=Pn[q]=Pn[nn]=Pn[D]=Pn[M]=Pn[tn]=Pn[rn]=Pn[en]=Pn[un]=Pn[on]=Pn[G]=Pn[J]=Pn[X]=Pn[H]=Pn[fn]=Pn[an]=Pn[ln]=Pn[cn]=!0,Pn[K]=Pn[V]=Pn[Y]=Pn[Z]=Pn[Q]=!1;var qn={leading:!1,maxWait:0,trailing:!1},Dn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Kn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Vn={"function":!0,object:!0},Yn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gn=Vn[typeof exports]&&exports&&!exports.nodeType&&exports,Jn=Vn[typeof module]&&module&&!module.nodeType&&module,Xn=Gn&&Jn&&"object"==typeof global&&global&&global.Object&&global,Zn=Vn[typeof self]&&self&&self.Object&&self,Hn=Vn[typeof window]&&window&&window.Object&&window,Qn=Jn&&Jn.exports===Gn&&Gn,nt=Xn||Hn!==(this&&this.window)&&Hn||Zn||this,tt=m();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(nt._=tt,define(function(){return tt})):Gn&&Jn?Qn?(Jn.exports=tt)._=tt:Gn._=tt:nt._=tt}).call(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],310:[function(require,module,exports){
!function(e,t,n){function r(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function o(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return m[e.which]?m[e.which]:k[e.which]?k[e.which]:String.fromCharCode(e.which).toLowerCase()}function i(e,t){return e.sort().join(",")===t.sort().join(",")}function a(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function c(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function u(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function l(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function s(){if(!v){v={};for(var e in m)e>95&&112>e||m.hasOwnProperty(e)&&(v[m[e]]=e)}return v}function f(e,t,n){return n||(n=s()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function p(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function d(e,t){var n,r,o,i=[];for(n=p(e),o=0;o<n.length;++o)r=n[o],g[r]&&(r=g[r]),t&&"keypress"!=t&&b[r]&&(r=b[r],i.push("shift")),l(r)&&i.push(r);return t=f(r,i,t),{key:r,modifiers:i,action:t}}function h(e,n){return null===e||e===t?!1:e===n?!0:h(e.parentNode,n)}function y(e){function n(e){e=e||{};var t,n=!1;for(t in g)e[t]?n=!0:g[t]=0;n||(C=!1)}function s(e,t,n,r,o,a){var c,u,s=[],f=n.type;if(!k._callbacks[e])return[];for("keyup"==f&&l(e)&&(t=[e]),c=0;c<k._callbacks[e].length;++c)if(u=k._callbacks[e][c],(r||!u.seq||g[u.seq]==u.level)&&f==u.action&&("keypress"==f&&!n.metaKey&&!n.ctrlKey||i(t,u.modifiers))){var p=!r&&u.combo==o,d=r&&u.seq==r&&u.level==a;(p||d)&&k._callbacks[e].splice(c,1),s.push(u)}return s}function f(e,t,n,r){k.stopCallback(t,t.target||t.srcElement,n,r)||e(t,n)===!1&&(c(t),u(t))}function p(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=o(e);if(t)return"keyup"==e.type&&w===t?void(w=!1):void k.handleKey(t,a(e),e)}function h(){clearTimeout(b),b=setTimeout(n,1e3)}function v(e,t,r,i){function a(t){return function(){C=t,++g[e],h()}}function c(t){f(r,t,e),"keyup"!==i&&(w=o(t)),setTimeout(n,10)}g[e]=0;for(var u=0;u<t.length;++u){var l=u+1===t.length,s=l?c:a(i||d(t[u+1]).action);m(t[u],s,i,e,u)}}function m(e,t,n,r,o){k._directMap[e+":"+n]=t,e=e.replace(/\s+/g," ");var i,a=e.split(" ");return a.length>1?void v(e,a,t,n):(i=d(e,n),k._callbacks[i.key]=k._callbacks[i.key]||[],s(i.key,i.modifiers,{type:i.action},r,e,o),void k._callbacks[i.key][r?"unshift":"push"]({callback:t,modifiers:i.modifiers,action:i.action,seq:r,level:o,combo:e}))}var k=this;if(e=e||t,!(k instanceof y))return new y(e);k.target=e,k._callbacks={},k._directMap={};var b,g={},w=!1,_=!1,C=!1;k._handleKey=function(e,t,r){var o,i=s(e,t,r),a={},c=0,u=!1;for(o=0;o<i.length;++o)i[o].seq&&(c=Math.max(c,i[o].level));for(o=0;o<i.length;++o)if(i[o].seq){if(i[o].level!=c)continue;u=!0,a[i[o].seq]=1,f(i[o].callback,r,i[o].combo,i[o].seq)}else u||f(i[o].callback,r,i[o].combo);var p="keypress"==r.type&&_;r.type!=C||l(e)||p||n(a),_=u&&"keydown"==r.type},k._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)m(e[r],t,n)},r(e,"keypress",p),r(e,"keydown",p),r(e,"keyup",p)}for(var v,m={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},b={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},g={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},w=1;20>w;++w)m[111+w]="f"+w;for(w=0;9>=w;++w)m[w+96]=w;y.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:h(t,n.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.init=function(){var e=y(t);for(var n in e)"_"!==n.charAt(0)&&(y[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n))},y.init(),e.Mousetrap=y,"undefined"!=typeof module&&module.exports&&(module.exports=y),"function"==typeof define&&define.amd&&define(function(){return y})}(window,document);
},{}],311:[function(require,module,exports){
(function(){function n(n){function t(t,r,e,u,i,o){for(;i>=0&&o>i;i+=n){var a=u?u[i]:i;e=r(e,t[a],a,t)}return e}return function(r,e,u,i){e=b(e,i,4);var o=!k(r)&&m.keys(r),a=(o||r).length,c=n>0?0:a-1;return arguments.length<3&&(u=r[o?o[c]:c],c+=n),t(r,e,u,o,c,a)}}function t(n){return function(t,r,e){r=x(r,e);for(var u=O(t),i=n>0?0:u-1;i>=0&&u>i;i+=n)if(r(t[i],i,t))return i;return-1}}function r(n,t,r){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(r&&i&&a)return i=r(e,u),e[i]===u?i:-1;if(u!==u)return i=t(l.call(e,o,a),m.isNaN),i>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&a>i;i+=n)if(e[i]===u)return i;return-1}}function e(n,t){var r=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(t,i)&&t.push(i);r--;)i=I[r],i in n&&n[i]!==u[i]&&!m.contains(t,i)&&t.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,y=c.bind,d=Object.create,g=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,t,r){if(void 0===t)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}},x=function(n,t,r){return null==n?m.identity:m.isFunction(n)?b(n,t,r):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,t){return x(n,t,1/0)};var _=function(n,t){return function(r){var e=arguments.length;if(2>e||null==r)return r;for(var u=1;e>u;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;a>c;c++){var f=o[c];t&&void 0!==r[f]||(r[f]=i[f])}return r}},j=function(n){if(!m.isObject(n))return{};if(d)return d(n);g.prototype=n;var t=new g;return g.prototype=null,t},w=function(n){return function(t){return null==t?void 0:t[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var t=O(n);return"number"==typeof t&&t>=0&&A>=t};m.each=m.forEach=function(n,t,r){t=b(t,r);var e,u;if(k(n))for(e=0,u=n.length;u>e;e++)t(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;u>o;o++){var a=e?e[o]:o;i[o]=t(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,t,r){var e;return e=k(n)?m.findIndex(n,t,r):m.findKey(n,t,r),void 0!==e&&-1!==e?n[e]:void 0},m.filter=m.select=function(n,t,r){var e=[];return t=x(t,r),m.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e},m.reject=function(n,t,r){return m.filter(n,m.negate(x(t)),r)},m.every=m.all=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(!t(n[o],o,n))return!1}return!0},m.some=m.any=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(t(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,t,r,e){return k(n)||(n=m.values(n)),("number"!=typeof r||e)&&(r=0),m.indexOf(n,t,r)>=0},m.invoke=function(n,t){var r=l.call(arguments,2),e=m.isFunction(t);return m.map(n,function(n){var u=e?t:n[t];return null==u?u:u.apply(n,r)})},m.pluck=function(n,t){return m.map(n,m.property(t))},m.where=function(n,t){return m.filter(n,m.matcher(t))},m.findWhere=function(n,t){return m.find(n,m.matcher(t))},m.max=function(n,t,r){var e,u,i=-(1/0),o=-(1/0);if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],e>i&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(u>o||u===-(1/0)&&i===-(1/0))&&(i=n,o=u)});return i},m.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],i>e&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(o>u||u===1/0&&i===1/0)&&(i=n,o=u)});return i},m.shuffle=function(n){for(var t,r=k(n)?n:m.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=m.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},m.sample=function(n,t,r){return null==t||r?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,t))},m.sortBy=function(n,t,r){return t=x(t,r),m.pluck(m.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=x(r,e),m.each(t,function(e,i){var o=r(e,i,t);n(u,e,o)}),u}};m.groupBy=F(function(n,t,r){m.has(n,r)?n[r].push(t):n[r]=[t]}),m.indexBy=F(function(n,t,r){n[r]=t}),m.countBy=F(function(n,t,r){m.has(n,r)?n[r]++:n[r]=1}),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,t,r){t=x(t,r);var e=[],u=[];return m.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},m.first=m.head=m.take=function(n,t,r){return null!=n?null==t||r?n[0]:m.initial(n,n.length-t):void 0},m.initial=function(n,t,r){return l.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},m.last=function(n,t,r){return null!=n?null==t||r?n[n.length-1]:m.rest(n,Math.max(0,n.length-t)):void 0},m.rest=m.tail=m.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,t,r,e){for(var u=[],i=0,o=e||0,a=O(n);a>o;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){t||(c=S(c,t,r));var f=0,l=c.length;for(u.length+=l;l>f;)u[i++]=c[f++]}else r||(u[i++]=c)}return u};m.flatten=function(n,t){return S(n,t,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,t,r,e){m.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=x(r,e));for(var u=[],i=[],o=0,a=O(n);a>o;o++){var c=n[o],f=r?r(c,o,n):c;t?(o&&i===f||u.push(c),i=f):r?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var t=[],r=arguments.length,e=0,u=O(n);u>e;e++){var i=n[e];if(!m.contains(t,i)){for(var o=1;r>o&&m.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},m.difference=function(n){var t=S(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(t,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var t=n&&m.max(n,O).length||0,r=Array(t),e=0;t>e;e++)r[e]=m.pluck(n,e);return r},m.object=function(n,t){for(var r={},e=0,u=O(n);u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},m.findIndex=t(1),m.findLastIndex=t(-1),m.sortedIndex=function(n,t,r,e){r=x(r,e,1);for(var u=r(t),i=0,o=O(n);o>i;){var a=Math.floor((i+o)/2);r(n[a])<u?i=a+1:o=a}return i},m.indexOf=r(1,m.findIndex,m.sortedIndex),m.lastIndexOf=r(-1,m.findLastIndex),m.range=function(n,t,r){null==t&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var E=function(n,t,r,e,u){if(!(e instanceof t))return n.apply(r,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,t){if(y&&n.bind===y)return y.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),e=function(){return E(n,e,t,this,r.concat(l.call(arguments)))};return e},m.partial=function(n){var t=l.call(arguments,1),r=function(){for(var e=0,u=t.length,i=Array(u),o=0;u>o;o++)i[o]=t[o]===m?arguments[e++]:t[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,r,this,this,i)};return r},m.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=m.bind(n[r],n);return n},m.memoize=function(n,t){var r=function(e){var u=r.cache,i=""+(t?t.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},m.delay=function(n,t){var r=l.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var c=function(){a=r.leading===!1?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||r.leading!==!1||(a=f);var l=t-(f-a);return e=this,u=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||r.trailing===!1||(o=setTimeout(c,l)),i}},m.debounce=function(n,t,r){var e,u,i,o,a,c=function(){var f=m.now()-o;t>f&&f>=0?e=setTimeout(c,t-f):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=r&&!e;return e||(e=setTimeout(c,t)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,t){return m.partial(t,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},m.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},m.before=function(n,t){var r;return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var t=[];for(var r in n)m.has(n,r)&&t.push(r);return M&&e(n,t),t},m.allKeys=function(n){if(!m.isObject(n))return[];var t=[];for(var r in n)t.push(r);return M&&e(n,t),t},m.values=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},m.mapObject=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=u.length,o={},a=0;i>a;a++)e=u[a],o[e]=t(n[e],e,n);return o},m.pairs=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},m.invert=function(n){for(var t={},r=m.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},m.functions=m.methods=function(n){var t=[];for(var r in n)m.isFunction(n[r])&&t.push(r);return t.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=0,o=u.length;o>i;i++)if(e=u[i],t(n[e],e,n))return e},m.pick=function(n,t,r){var e,u,i={},o=n;if(null==o)return i;m.isFunction(t)?(u=m.allKeys(o),e=b(t,r)):(u=S(arguments,!1,!1,1),e=function(n,t,r){return t in r},o=Object(o));for(var a=0,c=u.length;c>a;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,t,r){if(m.isFunction(t))t=m.negate(t);else{var e=m.map(S(arguments,!1,!1,1),String);t=function(n,t){return!m.contains(e,t)}}return m.pick(n,t,r)},m.defaults=_(m.allKeys,!0),m.create=function(n,t){var r=j(n);return t&&m.extendOwn(r,t),r},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,t){return t(n),n},m.isMatch=function(n,t){var r=m.keys(t),e=r.length;if(null==n)return!e;for(var u=Object(n),i=0;e>i;i++){var o=r[i];if(t[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof m&&(n=n._wrapped),t instanceof m&&(t=t._wrapped);var u=s.call(n);if(u!==s.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof t)return!1;var o=n.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}r=r||[],e=e||[];for(var c=r.length;c--;)if(r[c]===n)return e[c]===t;if(r.push(n),e.push(t),i){if(c=n.length,c!==t.length)return!1;for(;c--;)if(!N(n[c],t[c],r,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(t).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(t,f)||!N(n[f],t[f],r,e))return!1}return r.pop(),e.pop(),!0};m.isEqual=function(n,t){return N(n,t)},m.isEmpty=function(n){return null==n?!0:k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(t){return s.call(t)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return void 0===n},m.has=function(n,t){return null!=n&&p.call(n,t)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(t){return n[t]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(t){return m.isMatch(t,n)}},m.times=function(n,t,r){var e=Array(Math.max(0,n));t=b(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},m.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var t=function(t){return n[t]},r="(?:"+m.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,t,r){var e=null==n?void 0:n[t];return void 0===e&&(e=r),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var t=++q+"";return n?n+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,t,r){!t&&r&&(t=r),t=m.defaults({},t,m.templateSettings);var e=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(a){throw a.source=i,a}var c=function(n){return o.call(this,n,m)},f=t.variable||"obj";return c.source="function("+f+"){\n"+i+"}",c},m.chain=function(n){var t=m(n);return t._chain=!0,t};var P=function(n,t){return n._chain?m(t).chain():t};m.mixin=function(n){m.each(m.functions(n),function(t){var r=m[t]=n[t];m.prototype[t]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,r.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=o[n];m.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],P(this,r)}}),m.each(["concat","join","slice"],function(n){var t=o[n];m.prototype[n]=function(){return P(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);
},{}],312:[function(require,module,exports){
(function (global){
!function(r){function e(r){for(var e,t,n=[],o=0,i=r.length;i>o;)e=r.charCodeAt(o++),e>=55296&&56319>=e&&i>o?(t=r.charCodeAt(o++),56320==(64512&t)?n.push(((1023&e)<<10)+(1023&t)+65536):(n.push(e),o--)):n.push(e);return n}function t(r){for(var e,t=r.length,n=-1,o="";++n<t;)e=r[n],e>65535&&(e-=65536,o+=b(e>>>10&1023|55296),e=56320|1023&e),o+=b(e);return o}function n(r){if(r>=55296&&57343>=r)throw Error("Lone surrogate U+"+r.toString(16).toUpperCase()+" is not a scalar value")}function o(r,e){return b(r>>e&63|128)}function i(r){if(0==(4294967168&r))return b(r);var e="";return 0==(4294965248&r)?e=b(r>>6&31|192):0==(4294901760&r)?(n(r),e=b(r>>12&15|224),e+=o(r,6)):0==(4292870144&r)&&(e=b(r>>18&7|240),e+=o(r,12),e+=o(r,6)),e+=b(63&r|128)}function f(r){for(var t,n=e(r),o=n.length,f=-1,u="";++f<o;)t=n[f],u+=i(t);return u}function u(){if(p>=s)throw Error("Invalid byte index");var r=255&v[p];if(p++,128==(192&r))return 63&r;throw Error("Invalid continuation byte")}function a(){var r,e,t,o,i;if(p>s)throw Error("Invalid byte index");if(p==s)return!1;if(r=255&v[p],p++,0==(128&r))return r;if(192==(224&r)){var e=u();if(i=(31&r)<<6|e,i>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&r)){if(e=u(),t=u(),i=(15&r)<<12|e<<6|t,i>=2048)return n(i),i;throw Error("Invalid continuation byte")}if(240==(248&r)&&(e=u(),t=u(),o=u(),i=(15&r)<<18|e<<12|t<<6|o,i>=65536&&1114111>=i))return i;throw Error("Invalid UTF-8 detected")}function d(r){v=e(r),s=v.length,p=0;for(var n,o=[];(n=a())!==!1;)o.push(n);return t(o)}var l="object"==typeof exports&&exports,c="object"==typeof module&&module&&module.exports==l&&module,h="object"==typeof global&&global;h.global!==h&&h.window!==h||(r=h);var v,s,p,b=String.fromCharCode,y={version:"2.0.0",encode:f,decode:d};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return y});else if(l&&!l.nodeType)if(c)c.exports=y;else{var g={},w=g.hasOwnProperty;for(var m in y)w.call(y,m)&&(l[m]=y[m])}else r.utf8=y}(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])


//# sourceMappingURL=aeontimeline_bundle.js.map